---
title: Klasa COleControl
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 074b0e1df5a8d70c8b32ee03dcb073c26c13be9b
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/25/2020
ms.locfileid: "88841002"
---
# <a name="colecontrol-class"></a>Klasa COleControl

Zaawansowana Klasa bazowa służąca do opracowywania formantów OLE.

## <a name="syntax"></a>Składnia

```
class COleControl : public CWnd
```

## <a name="members"></a>Elementy członkowskie

### <a name="public-constructors"></a>Konstruktory publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Tworzy obiekt `COleControl`.|

### <a name="public-methods"></a>Metody publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Pobiera bieżący wygląd formantu.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Zwraca wartość właściwości otaczającego koloru.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Zwraca nazwę kontrolki określoną przez kontener.|
|[COleControl::AmbientFont](#ambientfont)|Zwraca wartość właściwości otaczającej czcionki.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Zwraca wartość właściwości ForeColor otaczającej.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Zwraca identyfikator ustawień regionalnych kontenera.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Zwraca typ jednostek używanych przez kontener.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Określa, czy mają być wyświetlane uchwyty pobierania.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Określa, czy mają być wyświetlane kreski.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Zwraca typ wyrównania tekstu określony przez kontener.|
|[COleControl::AmbientUIDead](#ambientuidead)|Określa, czy formant powinien odpowiadać na akcje interfejsu użytkownika.|
|[COleControl::AmbientUserMode](#ambientusermode)|Określa tryb kontenera.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Powiadamia kontener o zmianie właściwości powiązanej.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Żąda uprawnień do edytowania wartości właściwości.|
|[COleControl::ClientToParent](#clienttoparent)|Tłumaczy punkt względem źródła kontrolki na punkt względem jego pochodzenia kontenera.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Dostosowuje prostokąt karetki, jeśli pokrywa się z kontrolką.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Wywołaj tę funkcję po zmianie zestawu symboli obsługiwanych przez formant.|
|[COleControl::D isplayError](#displayerror)|Wyświetla zdarzenia błędu giełdowego dla użytkownika kontrolki.|
|[COleControl::D oClick](#doclick)|Implementacja metody giełdowej `DoClick` .|
|[COleControl::D oPropExchange](#dopropexchange)|Serializować właściwości `COleControl` obiektu.|
|[COleControl::D oSuperclassPaint](#dosuperclasspaint)|Ponownie rysuje kontrolkę OLE, która została poddana klasy z formantu systemu Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Włącza prostą obsługę ramki dla kontrolki.|
|[COleControl::ExchangeExtent](#exchangeextent)|Deserializacji szerokość i wysokość kontrolki.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Deserializacji właściwości giełdy formantu.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serializować numer wersji kontrolki.|
|[COleControl::FireClick](#fireclick)|Wyzwala wydarzenie giełdowe `Click` .|
|[COleControl::FireDblClick](#firedblclick)|Wyzwala wydarzenie giełdowe `DblClick` .|
|[COleControl:: FireError —](#fireerror)|Wyzwala wydarzenie giełdowe `Error` .|
|[COleControl::FireEvent](#fireevent)|Wyzwala zdarzenie niestandardowe.|
|[COleControl::FireKeyDown](#firekeydown)|Wyzwala wydarzenie giełdowe `KeyDown` .|
|[COleControl::FireKeyPress](#firekeypress)|Wyzwala wydarzenie giełdowe `KeyPress` .|
|[COleControl::FireKeyUp](#firekeyup)|Wyzwala wydarzenie giełdowe `KeyUp` .|
|[COleControl::FireMouseDown](#firemousedown)|Wyzwala wydarzenie giełdowe `MouseDown` .|
|[COleControl::FireMouseMove](#firemousemove)|Wyzwala wydarzenie giełdowe `MouseMove` .|
|[COleControl::FireMouseUp](#firemouseup)|Wyzwala wydarzenie giełdowe `MouseUp` .|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Wyzwala zdarzenie, gdy stan gotowości formantu zostanie zmieniony.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Zmienia domyślne zachowanie aktywacji kontrolki, która obsługuje `IPointerInactive` interfejs.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Zwraca wartość określonej właściwości otoczenia.|
|[COleControl:: getpozornie](#getappearance)|Zwraca wartość właściwości wyglądu akcji.|
|[COleControl::GetBackColor](#getbackcolor)|Zwraca wartość właściwości Stock Color.|
|[COleControl:: getborderer](#getborderstyle)|Zwraca wartość właściwości Borderer.|
|[COleControl:: getcapture](#getcapture)|Określa, czy obiekt kontrolki, który został aktywowany, ma przechwycić myszą.|
|[COleControl:: GetClassID](#getclassid)|Pobiera identyfikator klasy OLE formantu.|
|[COleControl::GetClientOffset](#getclientoffset)|Pobiera różnicę między lewym górnym rogu prostokątnego obszaru kontrolki a lewym górnym rogiem obszaru klienckiego.|
|[COleControl::GetClientRect](#getclientrect)|Pobiera rozmiar obszaru klienckiego kontrolki.|
|[COleControl::GetClientSite](#getclientsite)|Wysyła zapytanie do obiektu dla wskaźnika do jego bieżącej lokacji klienta w jego kontenerze.|
|[COleControl::GetControlFlags](#getcontrolflags)|Pobiera ustawienia flagi kontrolki.|
|[COleControl::GetControlSize](#getcontrolsize)|Zwraca pozycję i rozmiar kontrolki OLE.|
|[COleControl:: GetDC —](#getdc)|Zapewnia metodę kontroli bezokienkowej w celu uzyskania kontekstu urządzenia z jego kontenera.|
|[COleControl:: GetEnabled](#getenabled)|Zwraca wartość właściwości z włączonymi zapasami.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Pobiera wskaźnik do obiektu rozszerzonej kontroli należącego do kontenera.|
|[COleControl:: GetFocus](#getfocus)|Określa, czy kontrolka ma fokus.|
|[COleControl:: GetFont](#getfont)|Zwraca wartość właściwości "giełdowy".|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Zwraca metryki `CFontHolder` obiektu.|
|[COleControl:: GetForeColor](#getforecolor)|Zwraca wartość właściwości ForeColor zasobu.|
|[COleControl:: GetHwnd](#gethwnd)|Zwraca wartość właściwości giełdowy elementu.|
|[COleControl::GetMessageString](#getmessagestring)|Zawiera tekst paska stanu dla elementu menu.|
|[COleControl::GetNotSupported](#getnotsupported)|Uniemożliwia dostęp do wartości właściwości kontrolki przez użytkownika.|
|[COleControl::GetReadyState](#getreadystate)|Zwraca stan gotowości formantu.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Zwraca prostokąt kontrolki względem jego kontenera.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Zwraca metryki właściwości "giełdowy".|
|[COleControl:: gettext](#gettext)|Zwraca wartość właściwości "text" lub "Caption".|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Przesłoń, aby zezwolić, aby kontrolka bez okien była elementem docelowym operacji przeciągania i upuszczania.|
|[COleControl::InitializeIIDs](#initializeiids)|Informuje klasę bazową IID, która będzie używana przez formant.|
|[COleControl::InternalGetFont](#internalgetfont)|Zwraca `CFontHolder` obiekt dla właściwości podstawowego czcionki.|
|[COleControl::InternalGetText](#internalgettext)|Pobiera podpis lub właściwość Text.|
|[COleControl:: InternalSetReadyState](#internalsetreadystate)|Ustawia stan gotowości kontrolki i wyzwala zdarzenie Read-State-Change.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Unieważnia obszar wyświetlonej kontrolki, powodując jej Odrysowanie.|
|[COleControl::InvalidateRgn](#invalidatergn)|Unieważnia obszar klienta okna kontenera w danym regionie. Może służyć do ponownego rysowania kontrolek bez okien w regionie.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Umożliwia wyspecjalizowane ładowanie formantu OLE.|
|[COleControl:: IsModified](#ismodified)|Określa, czy stan formantu został zmieniony.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Wskazuje, czy kontener obsługuje zoptymalizowany rysunek dla bieżącej operacji rysowania.|
|[COleControl:: IsSubclassedControl](#issubclassedcontrol)|Wywołuje się, by określić czy kontrolka jest podklasą kontrolki systemu Windows.|
|[COleControl:: Load](#load)|Resetuje wszystkie poprzednie dane asynchroniczne i Inicjuje nowe obciążenie właściwości asynchronicznej kontrolki.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Określa, czy formant może zostać zdezaktywowany przez kontener.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Wywoływana, gdy zostanie zmieniona Właściwość otoczenia.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Wywoływana, gdy zmieni się Właściwość wyglądu giełdowego.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Wywoływana, gdy zostanie zmieniona wartość właściwości BackColor.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Wywoływana, gdy zostanie zmieniona właściwość Borderer.|
|[COleControl:: onkliknięcia](#onclick)|Wywołuje się, by uruchomić wydarzenie giełdowe.|
|[COleControl:: OnClose](#onclose)|Powiadamia formant, który został `IOleControl::Close` wywołany.|
|[COleControl::OnDoVerb](#ondoverb)|Wywołuje się po wykonaniu zlecenia sterującego.|
|[COleControl:: OnDraw](#ondraw)|Wywołuje się, gdy kontrolka zażądała ponownego narysowania.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Wywoływane przez kontener, gdy kontrolka jest zażądana ponownego narysowania przy użyciu kontekstu urządzenia metapliku.|
|[COleControl:: onedit](#onedit)|Wywoływane przez kontener do interfejsu użytkownika aktywowanie kontrolki OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Wywoływana, gdy zostanie zmieniona właściwość z włączonymi zapasami.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Wywoływane przez kontener, aby wyliczyć zlecenia kontrolki.|
|[COleControl::OnEventAdvise](#oneventadvise)|Wywołuje się, gdy programy obsługi zdarzeń są połączone lub odłączane od formantu.|
|[COleControl::OnFontChanged](#onfontchanged)|Wywoływana, gdy zostanie zmieniona właściwość fontal.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Wywoływana, gdy zostanie zmieniona właściwość ForeColor zasobu.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Wywołuje się, gdy zdarzenia kontrolki są zamrożone lub odblokowane.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Powiadamia formant, który został `IOleObject::GetColorSet` wywołany.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Zawiera informacje o tym kontenerze.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Wywołuje się, by uzyskać ciąg reprezentujący wartość właściwości.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Żąda uchwytu menu kontrolki, które zostanie scalone z menu kontener.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Przesłoń, aby pobrać rozmiar wyświetlania formantu znajdujący się najbliżej proponowanego trybu rozmiaru i zakresu.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Zwraca ciągi reprezentujące możliwe wartości właściwości.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Zwraca wartość odpowiadającą wstępnie zdefiniowanym ciągiem.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Przesłoń, aby pobrać rozmiar obszarów wyświetlania formantu (można go użyć do włączenia rysowania dwuetapowego).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Przesłoń, aby przekonwertować rozmiar kontrolki na prostokąt, rozpoczynając od konkretnego położenia.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Zastąpienie w celu pobrania stanu widoku kontrolki.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Wywoływane przez kontener, gdy kontrolka jest zdezaktywowana przez interfejs użytkownika.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Przesłoń, aby kontener dla nieaktywnej kontrolki pod wskaźnikiem myszy wysyłał WM_MOUSEMOVE komunikatów do kontrolki.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Przesłoń, aby kontener dla nieaktywnej kontrolki pod wskaźnikiem myszy wysyłał WM_SETCURSOR komunikatów do kontrolki.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Wywoływana po rozpoczęciu zdarzenia magazynu akcji.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Wywoływana po wywołaniu zdarzenia KeyPress.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Wywoływana po uruchomieniu zdarzenia KeyUp zasobu.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Wskazuje, która strona właściwości ma być używana do edycji właściwości.|
|[COleControl::](#onmnemonic)|Wywołuje się, gdy naciśnięto klawisz skrótu kontrolki.|
|[COleControl:: onproperties](#onproperties)|Wywołuje się, gdy wywołano zlecenie "Properties" kontrolki.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Przesłoń, aby zbadać, czy ekran kontrolki pokrywa się z danym punktem.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Przesłoń, aby zbadać, czy ekran kontrolki pokrywa się z dowolnym punktem w danym prostokącie.|
|[COleControl::OnRenderData](#onrenderdata)|Wywoływane przez platformę, by pobrać dane w określonym formacie.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Wywoływane przez platformę, by pobrać dane z pliku w określonym formacie.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Wywoływane przez platformę, by pobrać dane z pamięci globalnej w określonym formacie.|
|[COleControl:: OnResetState](#onresetstate)|Resetuje właściwości kontrolki do wartości domyślnych.|
|[COleControl:: OnSetClientSite](#onsetclientsite)|Powiadamia formant, który został `IOleControl::SetClientSite` wywołany.|
|[COleControl:: OnSetData](#onsetdata)|Zamienia dane kontrolki na inną wartość.|
|[COleControl::OnSetExtent](#onsetextent)|Wywołuje się po zmianie zakresu formantu.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Wywoływana po zmianie wymiarów kontrolki.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Wywołuje się, gdy aktywowano kontrolkę interfejsu użytkownika.|
|[COleControl:: OnTextChanged.](#ontextchanged)|Wywoływana, gdy zmieni się właściwość tekst podstawowy lub napis.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Przetwarza komunikaty okna (inne niż komunikaty myszy i klawiatury) dla kontrolek bez okien.|
|[COleControl::P arentToClient](#parenttoclient)|Tłumaczy punkt względem początku kontenera do punktu odnoszącego się do źródła kontrolki.|
|[COleControl::P ostModalDialog](#postmodaldialog)|Powiadamia kontener o zamknięciu modalnego okna dialogowego.|
|[COleControl::P reModalDialog](#premodaldialog)|Powiadamia kontener, aby wyświetlić modalne okno dialogowe.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Niszczy i odtwarza okno kontrolki.|
|[COleControl:: Refresh](#refresh)|Wymusza Repaint wyglądu kontrolki.|
|[COleControl::ReleaseCapture](#releasecapture)|Zwalnia przechwytywanie myszy.|
|[COleControl:: ReleaseDC](#releasedc)|Zwalnia kontekst urządzenia wyświetlania kontenera kontroli bez okien.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Resetuje element nadrzędny okna kontrolki.|
|[COleControl::ResetStockProps](#resetstockprops)|Inicjuje `COleControl` właściwości podstawowe do ich wartości domyślnych.|
|[COleControl::ResetVersion](#resetversion)|Inicjuje numer wersji w danej wartości.|
|[COleControl::ScrollWindow](#scrollwindow)|Umożliwia kontrolowanie bezokienkowe przewijania obszaru w obrazie aktywnym na ekranie.|
|[COleControl::SelectFontObject](#selectfontobject)|Wybiera niestandardową Właściwość czcionki w kontekście urządzenia.|
|[COleControl::SelectStockFont](#selectstockfont)|Wybiera Właściwość "podstawowe czcionki" w kontekście urządzenia.|
|[COleControl::SerializeExtent](#serializeextent)|Deserializacji lub inicjuje miejsce wyświetlania dla kontrolki.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serializować lub inicjuje `COleControl` Właściwości giełdowe.|
|[COleControl::SerializeVersion](#serializeversion)|Serializować lub inicjuje informacje o wersji formantu.|
|[COleControl:: setpozornie](#setappearance)|Ustawia wartość właściwości wygląd giełdowy.|
|[COleControl::SetBackColor](#setbackcolor)|Ustawia wartość właściwości Stock Color.|
|[COleControl:: setborderer](#setborderstyle)|Ustawia wartość właściwości Borderer.|
|[COleControl:: setcapture](#setcapture)|Powoduje, że okno kontenera kontrolki będzie miało przechwycenie myszy w imieniu formantu.|
|[COleControl::SetControlSize](#setcontrolsize)|Ustawia położenie i rozmiar kontrolki OLE.|
|[COleControl:: SetEnabled](#setenabled)|Ustawia wartość właściwości włączony magazyn.|
|[COleControl:: SetFocus](#setfocus)|Powoduje, że okno kontenera kontrolki będzie miało fokus wejścia w imieniu formantu.|
|[COleControl:: SetFont](#setfont)|Ustawia wartość właściwości podstawowe czcionki.|
|[COleControl:: setforecolor](#setforecolor)|Ustawia wartość właściwości ForeColor zasobu.|
|[COleControl::SetInitialSize](#setinitialsize)|Ustawia rozmiar kontrolki OLE podczas pierwszego wyświetlania w kontenerze.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Zmienia zmodyfikowany stan kontrolki.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Wskazuje, że żądanie edycji nie powiodło się.|
|[COleControl::SetNotSupported](#setnotsupported)|Zapobiega modyfikacji wartości właściwości kontrolki przez użytkownika.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Ustawia prostokąt kontrolki względem jego kontenera.|
|[COleControl::SetText](#settext)|Ustawia wartość właściwości tekst podstawowy lub napis.|
|[COleControl:: ThrowError](#throwerror)|Sygnalizuje, że wystąpił błąd w kontrolce OLE.|
|[COleControl::TransformCoords](#transformcoords)|Przekształca wartości współrzędnych między kontenerem i kontrolką.|
|[COleControl::TranslateColor](#translatecolor)|Konwertuje wartość OLE_COLOR na wartość COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Określa, czy właściwości otoczenia będą dostępne podczas następnego ładowania kontrolki.|
|[COleControl::WindowProc](#windowproc)|Zawiera procedurę systemu Windows dla `COleControl` obiektu.|

### <a name="protected-methods"></a>Metody chronione

|Nazwa|Opis|
|----------|-----------------|
|[COleControl::D rawContent](#drawcontent)|Wywoływane przez platformę, gdy konieczna jest aktualizacja wyglądu kontrolki.|
|[COleControl::D rawMetafile](#drawmetafile)|Wywoływane przez platformę, gdy jest używany kontekst urządzenia metapliku.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Włącza wywołanie metody automatyzacji.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Wywoływane przez platformę, aby zainicjować listę formatów danych obsługiwanych przez formant.|

## <a name="remarks"></a>Uwagi

Pochodny od `CWnd` , ta klasa dziedziczy wszystkie funkcje obiektu okna systemu Windows oraz dodatkowe funkcje specyficzne dla OLE, takie jak Wyzwalanie zdarzeń i możliwość obsługi metod i właściwości.

Formanty OLE można wstawiać do aplikacji kontenera OLE i komunikować się z kontenerem przy użyciu dwukierunkowego systemu zdarzeń do uruchamiania i ujawniania metod i właściwości do kontenera. Należy zauważyć, że standardowe kontenery OLE obsługują tylko podstawowe funkcje formantu OLE. Nie są w stanie obsługiwać rozszerzonych funkcji formantu OLE. Wyzwalanie zdarzeń odbywa się, gdy zdarzenia są wysyłane do kontenera w wyniku pewnych akcji wykonywanych w formancie. Z kolei kontener komunikuje się z kontrolką przy użyciu uwidocznionego zestawu metod i właściwości analogicznych do funkcji składowych i danych klasy języka C++. Takie podejście umożliwia deweloperowi kontrolowanie wyglądu kontrolki i powiadamianie kontenera o wystąpieniu pewnych akcji.

## <a name="windowless-controls"></a>Kontrolki bez okien

Kontrolki OLE mogą być używane w miejscu aktywnym bez okna. Kontrolki bez okien mają znaczące zalety:

- Kontrolki bez okien mogą być przezroczyste i nieprostokątne

- Kontrolki bez okna zmniejszają rozmiar wystąpienia i czas utworzenia obiektu

Kontrolki nie potrzebują okna. Usługi, które oferuje okno można łatwo udostępnić za pośrednictwem jednego udostępnionego okna (zazwyczaj kontenera) i bitu wysyłania kodu. Posiadanie okna jest przede wszystkim niepotrzebnym komplikacją dla obiektu.

Gdy jest używana Aktywacja bez okien, kontener (który ma okno) jest odpowiedzialny za świadczenie usług, które w przeciwnym razie byłyby udostępniane przez własne okno kontrolki. Na przykład, Jeśli kontrolka musi zbadać fokus klawiatury, wykonać zapytanie dotyczące przechwytywania myszy lub uzyskać kontekst urządzenia, te operacje są zarządzane przez kontener. `COleControl`Funkcje elementu członkowskiego bez okna wywołują te operacje na kontenerze.

Gdy Aktywacja bez okien jest włączona, kontener deleguje komunikaty wejściowe do interfejsu kontrolki `IOleInPlaceObjectWindowless` (rozszerzenie [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) dla obsługi bez okien). `COleControl`implementacja tego interfejsu będzie wysyłać te komunikaty za pomocą mapy komunikatów kontrolki, po odpowiednim dopasowaniu współrzędnych myszy. Możesz przetwarzać te komunikaty, takie jak zwykłe komunikaty okna, dodając odpowiednie wpisy do mapy komunikatów.

W kontrolce bez okien należy zawsze używać `COleControl` funkcji składowych zamiast odpowiednich `CWnd` funkcji składowych lub związanych z nimi funkcji interfejsu API systemu Windows.

Obiekty kontrolne OLE mogą również utworzyć okno tylko wtedy, gdy stają się aktywne, ale ilość pracy wymaganej do przejścia nieaktywnego jest ustawiana, a szybkość przejścia zostaje wyłączona. Występują sytuacje, w których jest to problem: na przykład rozważmy siatkę pól tekstowych. Po umieszczeniu kursora w górę i w dół w kolumnie, każda kontrolka musi być aktywowana w miejscu, a następnie dezaktywowana. Szybkość nieaktywnego/aktywnego przejścia będzie miała bezpośredni wpływ na szybkość przewijania.

Aby uzyskać więcej informacji na temat tworzenia struktury formantów OLE, zobacz artykuły [formanty ActiveX MFC](../../mfc/mfc-activex-controls.md) i [przegląd: Tworzenie programu MFC ActiveX Control](../../mfc/reference/mfc-activex-control-wizard.md). Aby uzyskać informacje na temat optymalizowania formantów OLE, w tym bezokienkowe i kontrolki bez migotania, zobacz [kontrolki ActiveX MFC: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Wymagania

**Nagłówek:** 'afxctl. h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a> COleControl::AmbientBackColor

Zwraca wartość właściwości otaczającego koloru.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Wartość zwracana

Bieżąca wartość właściwości otoczenia otaczającego kontenera (jeśli istnieje). Jeśli właściwość nie jest obsługiwana, ta funkcja zwraca kolor tła systemu Windows zdefiniowany przez system.

### <a name="remarks"></a>Uwagi

Właściwość otaczającego koloru jest dostępna dla wszystkich kontrolek i jest definiowana przez kontener. Należy zauważyć, że kontener nie jest wymagany do obsługi tej właściwości.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a> COleControl::AmbientDisplayName

Nazwę kontenera przypisanego do formantu można użyć w komunikatach o błędach wyświetlanych użytkownikowi.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Wartość zwracana

Nazwa kontrolki OLE. Wartość domyślna to ciąg o zerowej długości.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że kontener nie jest wymagany do obsługi tej właściwości.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a> COleControl::AmbientFont

Zwraca wartość właściwości otaczającej czcionki.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do interfejsu wysyłania czcionki otaczającej kontenera. Wartość domyślna to NULL. Jeśli zwracana wartość nie jest równa NULL, użytkownik jest odpowiedzialny za zwolnienie czcionki przez wywołanie funkcji elementu członkowskiego [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) .

### <a name="remarks"></a>Uwagi

Właściwość Font otoczenia jest definiowana przez kontener i dostępna dla wszystkich kontrolek. Należy zauważyć, że kontener nie jest wymagany do obsługi tej właściwości.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a> COleControl::AmbientForeColor

Zwraca wartość właściwości ForeColor otaczającej.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Wartość zwracana

Bieżąca wartość właściwości ForeColor otaczającej kontenera (jeśli istnieje). Jeśli nie jest obsługiwana, ta funkcja zwraca kolor tekstu systemu Windows zdefiniowany przez system.

### <a name="remarks"></a>Uwagi

Właściwość ForeColor otaczająca jest dostępna dla wszystkich kontrolek i jest definiowana przez kontener. Należy zauważyć, że kontener nie jest wymagany do obsługi tej właściwości.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a> COleControl::AmbientLocaleID

Zwraca identyfikator ustawień regionalnych kontenera.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Wartość zwracana

Wartość właściwości LocaleID kontenera (jeśli istnieje). Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwróci wartość 0.

### <a name="remarks"></a>Uwagi

Kontrolka może używać LocaleID do dostosowywania interfejsu użytkownika dla określonych ustawień regionalnych. Należy zauważyć, że kontener nie jest wymagany do obsługi tej właściwości.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a> COleControl::AmbientAppearance

Pobiera bieżące ustawienie wyglądu dla obiektu Control.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Wartość zwracana

Wygląd formantu:

- **0** płaski wygląd

- **1** wygląd 3W

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, aby pobrać bieżącą wartość właściwości DISPID_AMBIENT_APPEARANCE dla kontrolki.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a> COleControl::AmbientScaleUnits

Zwraca typ jednostek używanych przez kontener.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Wartość zwracana

Ciąg zawierający ScaleUnits otoczenia kontenera. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca ciąg o zerowej długości.

### <a name="remarks"></a>Uwagi

Właściwość ScaleUnits otaczająca kontenera może służyć do wyświetlania pozycji lub wymiarów, które są oznaczone wybraną jednostką, taką jak twipach lub centymetry. Należy zauważyć, że kontener nie jest wymagany do obsługi tej właściwości.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a> COleControl::AmbientShowGrabHandles

Określa, czy kontener umożliwia kontrolce wyświetlanie uchwytów dla siebie, gdy jest aktywny.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różna od zera, jeśli powinny zostać wyświetlone uchwyty pobierania; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość różną od zera.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że kontener nie jest wymagany do obsługi tej właściwości.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a> COleControl::AmbientShowHatching

Określa, czy kontener umożliwia formantowi wyświetlenie siebie przy użyciu wzorca kreskowanego, gdy interfejs użytkownika jest aktywny.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli powinien być pokazywany wzór zakreskowany; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość różną od zera.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że kontener nie jest wymagany do obsługi tej właściwości.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a> COleControl::AmbientTextAlign

Określa wyrównanie tekstu otoczenia preferowanego przez kontener sterowania.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Wartość zwracana

Stan właściwości TextAlign kontenera. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwróci wartość 0.

Poniżej znajduje się lista prawidłowych wartości zwracanych:

|Wartość zwracana|Znaczenie|
|------------------|-------------|
|0|Ogólne wyrównanie (liczby po prawej stronie, tekst po lewej).|
|1|Wyrównaj do lewej|
|2|Wyśrodkuj|
|3|Wyrównaj do prawej|

### <a name="remarks"></a>Uwagi

Ta właściwość jest dostępna dla wszystkich osadzonych formantów i jest definiowana przez kontener. Należy zauważyć, że kontener nie jest wymagany do obsługi tej właściwości.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a> COleControl::AmbientUIDead

Określa, czy kontener chce, aby formant odpowiadał na akcje interfejsu użytkownika.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, Jeśli kontrolka powinna odpowiedzieć na akcje interfejsu użytkownika; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwróci wartość 0.

### <a name="remarks"></a>Uwagi

Na przykład kontener może ustawić na wartość TRUE w trybie projektowania.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a> COleControl::AmbientUserMode

Określa, czy kontener jest w trybie projektowania czy w trybie użytkownika.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli kontener jest w trybie użytkownika; w przeciwnym razie 0 (w trybie projektowania). Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość TRUE.

### <a name="remarks"></a>Uwagi

Na przykład kontener może ustawić na FALSE w trybie projektowania.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a> COleControl::BoundPropertyChanged

Sygnalizuje, że wartość właściwości powiązanej została zmieniona.

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
Identyfikator wysyłania powiązanej właściwości formantu.

### <a name="remarks"></a>Uwagi

Musi być wywoływana za każdym razem, gdy wartość właściwości ulega zmianie, nawet w przypadkach, gdy zmiana nie została wprowadzona za pomocą metody set właściwości. Należy szczególnie wiedzieć o właściwościach powiązanych, które są mapowane na zmienne składowe. Zawsze, gdy taka zmienna członkowska zmienia się, `BoundPropertyChanged` musi zostać wywołana.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a> COleControl::BoundPropertyRequestEdit

Żąda od interfejsu uprawnienia `IPropertyNotifySink` do zmiany wartości właściwości powiązanej dostarczonej przez formant.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
Identyfikator wysyłania powiązanej właściwości formantu.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli zmiana jest dozwolona; w przeciwnym razie 0. Wartość domyślna to różna od zera.

### <a name="remarks"></a>Uwagi

Jeśli uprawnienie jest odrzucane, formant nie może zmienić wartości właściwości. Można to zrobić przez zignorowanie lub niepowodzenie akcji, która podjęła próbę zmiany wartości właściwości.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a> COleControl::ClientToParent

Tłumaczy współrzędne *pPoint* na współrzędne nadrzędne.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Wskaźnik do granic formantu OLE w kontenerze. Nie jest to obszar klienta, ale obszar całej kontrolki, w tym obramowania i paski przewijania.

*pPoint*<br/>
Wskaźnik do punktu obszaru klienta OLE, który ma zostać przetłumaczony na współrzędne obiektu nadrzędnego (kontenera).

### <a name="remarks"></a>Uwagi

Na wejściu *pPoint* jest określana względem początku obszaru klienta kontrolki OLE (górny lewy róg obszaru klienckiego kontrolki). W danych wyjściowych *pPoint* jest względem źródła elementu nadrzędnego (górny lewy róg kontenera).

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a> COleControl::ClipCaretRect

Dostosowuje prostokąt karetki, jeśli jest w całości lub częściowo objęty przez nakładające się obiekty nieprzezroczyste.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Na wejściu, wskaźnik do struktury [Rect](/windows/win32/api/windef/ns-windef-rect) , która zawiera obszar karetki do dopasowania. W danych wyjściowych, dostosowany obszar karetki lub wartość NULL, jeśli prostokąt karetki jest całkowicie pokryty.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Karetka to migająca linia, blok lub mapa bitowa, która zwykle wskazuje, gdzie zostanie wstawiony tekst lub grafika.

Obiekt bez okna nie może bezpiecznie pokazać karetki, nie sprawdzając przed sprawdzeniem, czy karetka jest częściowo czy całkowicie ukryta przez nakładające się obiekty. Aby to umożliwić, obiekt może użyć w `ClipCaretRect` celu uzyskania skorygowanego karetki (zredukowany), aby upewnić się, że mieści się w regionie przycinania.

Obiekty tworzące karetkę powinny przesyłać prostokąt karetki do `ClipCaretRect` i używać dopasowanego prostokąta dla karetki. Jeśli karetka jest całkowicie ukryta, ta metoda zwróci wartość FALSE, a karetka nie powinna być wyświetlana w tym przypadku.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a> COleControl::COleControl

Konstruuje `COleControl` obiekt.

```
COleControl();
```

### <a name="remarks"></a>Uwagi

Ta funkcja zazwyczaj nie jest wywoływana bezpośrednio. Zamiast tego formant OLE jest zwykle tworzony przez fabrykę klas.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a> COleControl::ControlInfoChanged

Wywołaj tę funkcję, gdy zestaw symboli obsługiwany przez formant został zmieniony.

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>Uwagi

Po otrzymaniu tego powiadomienia kontener kontrolki uzyskuje nowy zestaw symboli, wykonując wywołanie do [IOleControl:: GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Należy zauważyć, że kontener nie jest wymagany do odpowiadania na to powiadomienie.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a> COleControl::D isplayError

Wywoływane przez platformę po obsłudze zdarzenia błędu giełdowego (chyba że program obsługi zdarzeń pomija wyświetlanie błędu).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parametry

*SCODE*<br/>
Wartość kodu stanu do zgłoszenia. Aby uzyskać pełną listę możliwych kodów, zobacz artykuł [formanty ActiveX: Tematy zaawansowane](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Opis raportowanego błędu.

*lpszSource*<br/>
Nazwa modułu generującego błąd (zazwyczaj Nazwa modułu kontrolki OLE).

*lpszHelpFile*<br/>
Nazwa pliku pomocy zawierającego opis błędu.

*nHelpID*<br/>
Identyfikator kontekstu pomocy dla zgłaszanego błędu.

### <a name="remarks"></a>Uwagi

Zachowanie domyślne powoduje wyświetlenie okna komunikatu zawierającego opis błędu, zawarte w *lpszDescription*.

Zastąp tę funkcję, aby dostosować sposób wyświetlania błędów.

## <a name="colecontroldoclick"></a><a name="doclick"></a> COleControl::D oClick

Symuluje akcję kliknięcia myszą na kontrolce.

```cpp
void DoClick();
```

### <a name="remarks"></a>Uwagi

`COleControl::OnClick`Zostanie wywołana funkcja członkowskej składowej i zostanie wyzwolone zdarzenie kliknięcia akcji, jeśli jest ono obsługiwane przez formant.

Ta funkcja jest obsługiwana przez `COleControl` klasę bazową jako metoda giełdowa o nazwie DoClick. Aby uzyskać więcej informacji, zobacz artykuł [formanty ActiveX: metody](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a> COleControl::D oPropExchange

Wywoływane przez platformę podczas ładowania lub przechowywania formantu z trwałej reprezentacji magazynu, na przykład strumienia lub zestawu właściwości.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Wskaźnik do `CPropExchange` obiektu. Platforma dostarcza ten obiekt do ustanowienia kontekstu wymiany właściwości, w tym jego kierunku.

### <a name="remarks"></a>Uwagi

Ta funkcja zwykle nawiązuje wywołania do **PX_ej** rodziny funkcji w celu załadowania lub zapisania określonych właściwości kontrolki OLE.

Jeśli Kreator kontroli został użyty do utworzenia projektu kontrolki OLE, zastąpiona wersja tej funkcji będzie serializować właściwości podstawowe obsługiwane przez `COleControl` wywołanie funkcji klasy bazowej `COleControl::DoPropExchange` . Podczas dodawania właściwości zdefiniowanych przez użytkownika do kontrolki OLE należy zmodyfikować tę funkcję, aby serializować nowe właściwości. Aby uzyskać więcej informacji na temat serializacji, zobacz artykuł [formanty ActiveX: serializacji](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a> COleControl::D oSuperclassPaint

Ponownie rysuje kontrolkę OLE, która została poddana klasy z formantu systemu Windows.

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*Domeny*<br/>
Wskaźnik do kontekstu urządzenia kontenera sterowania.

*rcBounds*<br/>
Obszar, w którym ma zostać narysowany formant.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, aby prawidłowo obsłużyć malowanie nieaktywnej kontrolki OLE. Ta funkcja powinna być używana tylko wtedy, gdy formant OLE podklasuje kontrolkę Windows i powinien być wywoływany w `OnDraw` funkcji formantu.

Aby uzyskać więcej informacji na temat tej funkcji i podklasy kontrolki systemu Windows, zobacz artykuł [formanty ActiveX: Tworzenie podklasy kontrolki systemu Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a> COleControl::D rawContent

Wywoływane przez platformę, gdy konieczna jest aktualizacja wyglądu kontrolki.

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*Domeny*<br/>
Wskaźnik do kontekstu urządzenia.

*zwrot*<br/>
Prostokątny obszar do narysowania.

### <a name="remarks"></a>Uwagi

Ta funkcja bezpośrednio wywołuje funkcję do zastąpienia `OnDraw` .

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a> COleControl::D rawMetafile

Wywoływane przez platformę, gdy jest używany kontekst urządzenia metapliku.

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*Domeny*<br/>
Wskaźnik do kontekstu urządzenia metapliku.

*zwrot*<br/>
Prostokątny obszar do narysowania.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a> COleControl::EnableSimpleFrame

Włącza prostą charakterystykę ramki dla kontrolki OLE.

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>Uwagi

Ta cecha pozwala formantowi na obsługę wizualizacji innych kontrolek, ale nie zawiera wartości true OLE. Przykładem może być pole grupy z kilkoma kontrolkami wewnątrz. Formanty te nie są zawarte w elemencie OLE, ale znajdują się w tym samym polu grupy.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a> COleControl::ExchangeExtent

Deserializacji lub inicjuje stan zakresu formantu (jego wymiary w jednostkach HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Wskaźnik do obiektu [CPropExchange](../../mfc/reference/cpropexchange-class.md) . Platforma dostarcza ten obiekt do ustanowienia kontekstu wymiany właściwości, w tym jego kierunku.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli funkcja się powiedzie; 0 w przeciwnym razie.

### <a name="remarks"></a>Uwagi

Ta funkcja jest zwykle wywoływana przez implementację domyślną `COleControl::DoPropExchange` .

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a> COleControl::ExchangeStockProps

Deserializacji lub inicjuje stan właściwości podstawowych formantu.

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Wskaźnik do obiektu [CPropExchange](../../mfc/reference/cpropexchange-class.md) . Platforma dostarcza ten obiekt do ustanowienia kontekstu wymiany właściwości, w tym jego kierunku.

### <a name="remarks"></a>Uwagi

Ta funkcja jest zwykle wywoływana przez implementację domyślną `COleControl::DoPropExchange` .

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a> COleControl::ExchangeVersion

Deserializacji lub inicjuje stan informacji o wersji formantu.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Wskaźnik do `CPropExchange` obiektu. Platforma dostarcza ten obiekt do ustanowienia kontekstu wymiany właściwości, w tym jego kierunku.

*dwVersionDefault*<br/>
Numer bieżącej wersji formantu.

*bConvert*<br/>
Wskazuje, czy trwałe dane mają być konwertowane do najnowszego formatu po zapisaniu lub obsługiwane w tym samym formacie, który został załadowany.

### <a name="return-value"></a>Wartość zwracana

Wartość niezerowa funkcji zakończyła się pomyślnie; 0 w przeciwnym razie.

### <a name="remarks"></a>Uwagi

Zazwyczaj jest to pierwsza funkcja wywołana przez przesłonięcie kontrolki `COleControl::DoPropExchange` . Podczas ładowania ta funkcja odczytuje numer wersji trwałych danych i ustawia odpowiednio atrybut Version obiektu [CPropExchange](../../mfc/reference/cpropexchange-class.md) . Podczas zapisywania ta funkcja zapisuje numer wersji danych trwałych.

Aby uzyskać więcej informacji na temat trwałości i przechowywania wersji, zobacz artykuł [formanty ActiveX: serializacji](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontrolfireclick"></a><a name="fireclick"></a> COleControl::FireClick

Wywoływane przez platformę, gdy mysz jest kliknięta nad aktywną kontrolką.

```cpp
void FireClick();
```

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest wyzwalane.

Aby wystąpiło automatyczne Wyzwalanie zdarzenia kliknięcia, Mapa zdarzeń kontrolki musi mieć zdefiniowane zdarzenie kliknięcia.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a> COleControl::FireDblClick

Wywoływane przez platformę po dwukrotnym kliknięciu przycisku myszy nad aktywną kontrolką.

```cpp
void FireDblClick();
```

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest wyzwalane.

Aby automatyczne Wyzwalanie zdarzenia DblClick miało miejsce, Mapa zdarzeń kontrolki musi mieć zdefiniowane zdarzenie zdarzenia DblClick.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a> COleControl:: FireError —

Wyzwala zdarzenie błędu giełdowego.

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*SCODE*<br/>
Wartość kodu stanu do zgłoszenia. Aby uzyskać pełną listę możliwych kodów, zobacz artykuł [formanty ActiveX: Tematy zaawansowane](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Opis raportowanego błędu.

*nHelpID*<br/>
Identyfikator pomocy zgłaszanego błędu.

### <a name="remarks"></a>Uwagi

To zdarzenie zapewnia sposób sygnalizowania w odpowiednich miejscach w kodzie, że wystąpił błąd w kontrolce. W przeciwieństwie do innych zdarzeń giełdowych, takich jak kliknięcie lub MouseMove, błąd nigdy nie jest uruchamiany przez platformę.

Aby zgłosić błąd, który występuje podczas funkcji pobierania właściwości, funkcji zestawu właściwości lub metody automatyzacji, wywołaj [COleControl:: ThrowError](#throwerror).

Implementacja zdarzenia błędu giełdowego formantu OLE używa wartości SCODE. Jeśli kontrolka używa tego zdarzenia i jest przeznaczona do użycia w Visual Basic 4,0, zostaną wyświetlone błędy, ponieważ wartość SCODE nie jest obsługiwana w Visual Basic.

Aby rozwiązać ten problem, należy ręcznie zmienić parametr SCODE w kontrolce. Plik ODL na **`long`** . Ponadto wszelkie zdarzenia niestandardowe, metody lub właściwości, które używają parametru SCODE również powodują ten sam problem.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a> COleControl::FireEvent

Uruchamia zdefiniowane przez użytkownika zdarzenie z formantu z dowolną liczbą argumentów opcjonalnych.

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
Identyfikator wysyłania zdarzenia, które ma zostać wyzwolone.

*pbParams*<br/>
Deskryptor typów parametrów zdarzenia.

### <a name="remarks"></a>Uwagi

Zwykle ta funkcja nie powinna być wywoływana bezpośrednio. Zamiast tego w sekcji Mapa zdarzeń deklaracji klasy kontrolki zostanie wywołana funkcja uruchamiania zdarzeń.

Argument *pbParams* jest rozdzieloną spacjami listą **VTS_**. Co najmniej jedna z tych wartości rozdzielonych spacjami (nie przecinkami) określa listę parametrów funkcji. Dopuszczalne są następujące wartości:

|Symbol|Typ parametru|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> Dodatkowe stałe wariantowe zostały zdefiniowane dla wszystkich typów wariantów, z wyjątkiem VTS_FONT i VTS_PICTURE, które zapewniają wskaźnik do stałej danych Variant. Te stałe są nazwane przy użyciu \<CONSTANT-NAME> konwencji VTS_P. Na przykład VTS_PCOLOR jest wskaźnikiem do stałej VTS_COLOR.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a> COleControl::FireKeyDown

Wywoływane przez platformę po naciśnięciu klawisza, gdy kontrolka jest aktywna przez interfejs użytkownika.

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Wskaźnik do wartości kodu wirtualnego klucza naciśniętego klawisza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser. h

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK naciśnięcie klawisza SHIFT podczas działania.

- CTRL_MASK naciśnięcie klawisza CTRL podczas akcji.

- ALT_MASK naciśnięcie klawisza ALT podczas działania.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest wyzwalane.

Aby automatyczne Wyzwalanie zdarzenia KeyDown miało miejsce, Mapa zdarzeń kontrolki musi mieć zdefiniowane zdarzenie.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a> COleControl::FireKeyPress

Wywoływane przez platformę, gdy klawisz zostanie wciśnięty i wydzierżawiony, gdy kontrolka niestandardowa jest aktywnym interfejsem użytkownika w kontenerze.

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Wskaźnik do wartości znaku naciśniętego klawisza.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest wyzwalane.

Odbiorca zdarzenia może zmodyfikować *pnChar*, na przykład przekonwertować wszystkie małe litery na wielkie litery. Jeśli chcesz przejrzeć zmodyfikowany znak, Przesłoń `OnKeyPressEvent` .

Aby automatyczne Wyzwalanie zdarzenia KeyPress miało miejsce, Mapa zdarzeń kontrolki musi mieć zdefiniowane zdarzenie KeyPress.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a> COleControl::FireKeyUp

Wywoływane przez platformę, gdy klucz jest wydawany, gdy kontrolka niestandardowa jest aktywnym interfejsem użytkownika w kontenerze.

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Wskaźnik do wartości kodu klucza wirtualnego wydanego klucza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser. h

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK naciśnięcie klawisza SHIFT podczas działania.

- CTRL_MASK naciśnięcie klawisza CTRL podczas akcji.

- ALT_MASK naciśnięcie klawisza ALT podczas działania.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest wyzwalane.

Aby można było automatycznie wyzwalać zdarzenie KeyUp, Mapa zdarzeń kontrolki musi mieć zdefiniowane zdarzenie KeyUp.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a> COleControl::FireMouseDown

Wywoływane przez platformę po naciśnięciu przycisku myszy nad aktywną kontrolką niestandardową.

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*Nprzycisk*<br/>
Wartość liczbowa naciśniętego przycisku myszy. Może zawierać jedną z następujących wartości:

- LEFT_BUTTON lewym przyciskiem myszy naciśnięto.

- MIDDLE_BUTTON środkowego przycisku myszy zostało naciśnięte.

- RIGHT_BUTTON naciśnięcie prawego przycisku myszy.

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK naciśnięcie klawisza SHIFT podczas działania.

- CTRL_MASK naciśnięcie klawisza CTRL podczas akcji.

- ALT_MASK naciśnięcie klawisza ALT podczas działania.

*x*<br/>
Współrzędna x kursora po naciśnięciu przycisku myszy. Współrzędna jest względem lewego górnego rogu okna sterowania.

*t*<br/>
Współrzędna y kursora po naciśnięciu przycisku myszy. Współrzędna jest względem lewego górnego rogu okna sterowania.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest wyzwalane.

Aby automatyczne Wyzwalanie zdarzenia MouseDown mogło wystąpić, Mapa zdarzeń kontrolki musi mieć zdefiniowane zdarzenie MouseDown elementu.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a> COleControl::FireMouseMove

Wywoływane przez platformę, gdy kursor jest przenoszony przez aktywną kontrolkę niestandardową.

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*Nprzycisk*<br/>
Wartość liczbowa przycisków myszy. Zawiera kombinację następujących wartości:

- LEFT_BUTTON lewym przyciskiem myszy naciśnięto w trakcie działania.

- MIDDLE_BUTTON środkowego przycisku myszy naciśniętego podczas działania.

- RIGHT_BUTTON prawy przycisk myszy został nacionięty w trakcie działania.

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK naciśnięcie klawisza SHIFT podczas działania.

- CTRL_MASK naciśnięcie klawisza CTRL podczas akcji.

- ALT_MASK naciśnięcie klawisza ALT podczas działania.

*x*<br/>
Współrzędna x kursora. Współrzędna jest względem lewego górnego rogu okna sterowania.

*t*<br/>
Współrzędna y kursora. Współrzędna jest względem lewego górnego rogu okna sterowania.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest wyzwalane.

Aby można było automatycznie wyzwalać zdarzenie MouseMove, Mapa zdarzeń kontrolki musi mieć zdefiniowane podstawowe Zdarzenie MouseMove.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a> COleControl::FireMouseUp

Wywoływane przez platformę, gdy przycisk myszy zostanie wydzierżawiony przez aktywną kontrolkę niestandardową.

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*Nprzycisk*<br/>
Wartość liczbowa przycisku myszy wydano. Może mieć jedną z następujących wartości:

- LEFT_BUTTON został wystawiony lewy przycisk myszy.

- MIDDLE_BUTTON wydano środkowego przycisku myszy.

- RIGHT_BUTTON został opublikowany prawy przycisk myszy.

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK naciśnięcie klawisza SHIFT podczas działania.

- CTRL_MASK naciśnięcie klawisza CTRL podczas akcji.

- ALT_MASK naciśnięcie klawisza ALT podczas działania.

*x*<br/>
Współrzędna x kursora po wydaniu przycisku myszy. Współrzędna jest względem lewego górnego rogu okna sterowania.

*t*<br/>
Współrzędna y kursora po wydaniu przycisku myszy. Współrzędna jest względem lewego górnego rogu okna sterowania.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest wyzwalane.

Aby automatyczne Wyzwalanie zdarzenia MouseUp miało miejsce, Mapa zdarzeń kontrolki musi mieć zdefiniowane wydarzenie giełdowe.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a> COleControl::FireReadyStateChange

Uruchamia zdarzenie z bieżącą wartością stanu gotowości kontroli.

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>Uwagi

Stan gotowości może być jedną z następujących wartości:

|Nazwa|Opis|
|-|-|
|READYSTATE_UNINITIALIZED|Domyślny stan inicjowania|
|READYSTATE_LOADING|Kontrolka aktualnie ładuje jej właściwości|
|READYSTATE_LOADED|Kontrolka została zainicjowana|
|READYSTATE_INTERACTIVE|Formant ma wystarczającą ilość danych, które mają być interaktywne, ale nie wszystkie dane asynchroniczne zostały jeszcze załadowane|
|READYSTATE_COMPLETE|Kontrolka ma wszystkie dane|

Użyj [GetReadyState](#getreadystate) , aby określić bieżącą gotowość formantu.

[InternalSetReadyState](#internalsetreadystate) zmienia stan gotowości na podaną wartość, a następnie wywołuje `FireReadyStateChange` .

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a> COleControl::GetActivationPolicy

Zmienia domyślne zachowanie aktywacji kontrolki, która obsługuje `IPointerInactive` interfejs.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Wartość zwracana

Kombinacja flag z wyliczenia POINTERINACTIVE. Możliwe flagi to:

|Nazwa|Opis|
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Obiekt powinien być aktywowany w miejscu, gdy wskaźnik myszy zostanie wprowadzony podczas operacji przenoszenia myszy.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Obiekt powinien zostać zdezaktywowany, gdy mysz opuszcza obiekt podczas operacji przenoszenia myszy.|
|POINTERINACTIVE_ACTIVATEONDRAG|Obiekt powinien być aktywowany w miejscu, gdy wskaźnik myszy jest przeciągany w trakcie operacji przeciągania i upuszczania.|

### <a name="remarks"></a>Uwagi

Gdy `IPointerInactive` interfejs jest włączony, kontener będzie delegować do niego WM_SETCURSOR i WM_MOUSEMOVE komunikatów. `COleControl`implementacja tego interfejsu będzie wysyłać te komunikaty za pomocą mapy komunikatów kontrolki, po odpowiednim dopasowaniu współrzędnych myszy.

Za każdym razem, gdy kontener otrzymuje WM_SETCURSOR lub WM_MOUSEMOVE komunikat z wskaźnikiem myszy nad nieaktywnym obiektem `IPointerInactive` , powinien wywołać `GetActivationPolicy` interfejs i zwracać flagi z wyliczenia POINTERINACTIVE.

Możesz przetwarzać te komunikaty podobnie jak zwykłe komunikaty okna przez dodanie odpowiednich wpisów do mapy komunikatów. W programach obsługi należy unikać używania `m_hWnd` zmiennej składowej (lub wszelkich funkcji Członkowskich, które go używają) bez uprzedniego sprawdzenia, czy jej wartość jest inna niż null.

Każdy obiekt przeznaczony do wykonywania więcej niż ustawiać wskaźnik myszy i/lub wyzwalać zdarzenie przenoszenia myszy, na przykład dawać specjalne Opinie wizualne, powinien zwrócić flagę POINTERINACTIVE_ACTIVATEONENTRY i narysować opinię tylko wtedy, gdy jest aktywna. Jeśli obiekt zwraca tę flagę, kontener powinien natychmiast aktywować go w miejscu, a następnie przesłać do niego ten sam komunikat, który wyzwolił wywołanie `GetActivationPolicy` .

Jeśli są zwracane flagi POINTERINACTIVE_ACTIVATEONENTRY i POINTERINACTIVE_DEACTIVATEONLEAVE, obiekt zostanie aktywowany tylko wtedy, gdy wskaźnik myszy znajduje się nad obiektem. Jeśli zwracana jest tylko flaga POINTERINACTIVE_ACTIVATEONENTRY, obiekt zostanie aktywowany tylko raz, gdy mysz najpierw przejdzie do obiektu.

Może być również potrzebna nieaktywna kontrolka, która będzie elementem docelowym operacji przeciągania i upuszczania OLE. Wymaga to aktywowania kontrolki w momencie, gdy użytkownik przeciągnie obiekt nad nim, aby okno kontrolki było rejestrowane jako miejsce docelowe upuszczania. Aby spowodować, że aktywacja wystąpi podczas przeciągania, zwróć POINTERINACTIVE_ACTIVATEONDRAG flagi:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Informacje przekazywane przez `GetActivationPolicy` nie powinny być buforowane przez kontener. Zamiast tego Metoda ta powinna być wywoływana za każdym razem, gdy mysz przejdzie do nieaktywnego obiektu.

Jeśli nieaktywny obiekt nie zażąda, aby znajdował się w miejscu aktywowanym po umieszczeniu wskaźnika myszy, jego kontener powinien wysyłać kolejne WM_SETCURSOR komunikatów do tego obiektu przez wywołanie [OnInactiveSetCursor](#oninactivesetcursor) o ile wskaźnik myszy znajduje się nad obiektem.

Włączenie `IPointerInactive` interfejsu zazwyczaj oznacza, że kontrolka ma mieć możliwość przetwarzania komunikatów myszy przez cały czas. Aby można było to zrobić w kontenerze, który nie obsługuje `IPointerInactive` interfejsu, formant musi być zawsze aktywowany, gdy jest widoczny, co oznacza, że kontrolka powinna mieć flagę OLEMISC_ACTIVATEWHENVISIBLE wśród jej różnych flag. Aby jednak zapobiec wprowadzeniu tej flagi do kontenera, który obsługuje `IPointerInactive` , można również określić flagę OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a> COleControl::GetAmbientProperty

Pobiera wartość właściwości otoczenia kontenera.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parametry

*dwDispid*<br/>
Identyfikator wysyłki odpowiedniej właściwości otoczenia.

*vtProp*<br/>
Tag typu variant, który określa typ wartości, która ma zostać zwrócona w *pvProp*.

*pvProp*<br/>
Wskaźnik na adres zmiennej, która będzie odbierać wartość właściwości lub wartość zwracaną. Rzeczywisty typ wskaźnika musi być zgodny z typem określonym przez *vtProp*.

|vtProp|Typ elementu pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli właściwość otoczenia jest obsługiwana; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli używasz `GetAmbientProperty` , aby pobrać wartość właściwości DisplayName otoczenia i ScaleUnits, ustaw wartość *vtProp* na VT_BSTR i *pvProp* na `CString*` . Jeśli pobierasz Właściwość Font otaczająca, ustaw *vtProp* na VT_FONT i *pvProp* na LPFONTDISP *.

Należy pamiętać, że funkcje zostały już dostarczone dla wspólnych właściwości otoczenia, takich jak [AmbientBackColor](#ambientbackcolor) i [AmbientFont](#ambientfont).

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a> COleControl:: getpozornie

Implementuje funkcję get właściwości wyglądu akcji formantu.

```
short GetAppearance ();
```

### <a name="return-value"></a>Wartość zwracana

Wartość zwracana określa bieżące ustawienie wyglądu jako **`short`** wartość (VT_I2), jeśli to się powiedzie. Ta wartość jest równa zero, jeśli wygląd kontrolki jest płaski i 1, jeśli wygląd formantu to 3D.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a> COleControl::GetBackColor

Implementuje funkcję get właściwości notowań kolorów dla kontrolki.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Wartość zwracana

Wartość zwracana określa bieżący kolor tła jako wartość OLE_COLOR, jeśli to się powiedzie. Tę wartość można przetłumaczyć na wartość COLORREF z wywołaniem do `TranslateColor` .

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a> COleControl:: getborderer

Implementuje funkcję get właściwości Border obramowania kontrolki.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Wartość zwracana

1, Jeśli kontrolka ma normalne obramowanie; 0, jeśli formant nie ma obramowania.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a> COleControl:: getcapture

Określa, czy `COleControl` obiekt ma przechwycenie myszy.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Wartość zwracana

Jeśli formant jest aktywowany i bez okien, zwraca, **`this`** czy kontrolka ma obecnie funkcję przechwytywania myszy (określoną przez kontener kontrolki) lub wartość null, jeśli nie ma przechwytywania.

W przeciwnym razie zwraca `CWnd` obiekt, który ma przechwycenie myszy (tak samo jak `CWnd::GetCapture` ).

### <a name="remarks"></a>Uwagi

Uaktywniona kontrolka bez okien odbiera przechwytywanie myszy po wywołaniu metody [setcapture](#setcapture) .

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a> COleControl:: GetClassID

Wywoływane przez platformę, by pobrać identyfikator klasy OLE formantu.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parametry

*pclsid*<br/>
Wskaźnik do lokalizacji identyfikatora klasy.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli wywołanie zakończyło się niepowodzeniem; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zwykle zaimplementowane przez [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a> COleControl::GetClientOffset

Pobiera różnicę między lewym górnym rogu prostokątnego obszaru kontrolki a lewym górnym rogiem obszaru klienckiego.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parametry

*pdxOffset*<br/>
Wskaźnik na przesunięcie w poziomie obszaru klienckiego kontrolki OLE.

*pdyOffset*<br/>
Wskaźnik na przesunięcie w pionie obszaru klienckiego kontrolki OLE.

### <a name="remarks"></a>Uwagi

Kontrolka OLE ma prostokątny obszar w obrębie jego kontenera. Obszar klienta kontrolki jest obszarem sterowania z wyjątkiem obramowań i pasków przewijania. Przesunięcie pobrane przez `GetClientOffset` to różnica między lewym górnym rogu prostokątnego obszaru kontrolki a górnym lewym rogu jego obszaru klienckiego. Jeśli kontrolka zawiera elementy nieklienckie inne niż standardowe obramowania i paski przewijania, Przesłoń tę funkcję elementu członkowskiego, aby określić przesunięcie.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a> COleControl::GetClientRect

Pobiera rozmiar obszaru klienckiego kontrolki.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Wskaźnik do `RECT` struktury zawierającej wymiary obszaru klienckiego kontrolki bez okna, czyli rozmiar kontrolki pomniejszonej o obramowanie okna, ramki, paski przewijania itd. Parametr *lpRect* wskazuje rozmiar prostokąta klienta kontrolki, a nie jego położenia.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a> COleControl::GetClientSite

Wysyła zapytanie do obiektu dla wskaźnika do jego bieżącej lokacji klienta w jego kontenerze.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do bieżącej lokacji klienta kontrolki w jej kontenerze.

### <a name="remarks"></a>Uwagi

Zwrócony wskaźnik wskazuje wystąpienie elementu `IOleClientSite` . `IOleClientSite`Interfejs wdrożony przez kontenery to widok obiektu jego kontekstu: gdzie jest zakotwiczony w dokumencie, gdzie pobiera magazyn, interfejs użytkownika i inne zasoby.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a> COleControl::GetControlFlags

Pobiera ustawienia flagi kontrolki.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Wartość zwracana

Kombinacja logicznie flag w wyliczeniu ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Uwagi

Domyślnie `GetControlFlags` Funkcja zwraca wartość `fastBeginPaint | clipPaintDC` .

|Nazwa|Opis|
|-|-|
|`fastBeginPaint`|Jeśli jest ustawiona, używa funkcji BEGIN-Paint dopasowanej do kontrolek OLE zamiast interfejsu API [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) (domyślnie ustawiana).|
|`clipPaintDC`|Jeśli nie zostanie ustawiona, program wyłączy wywołanie `IntersectClipRect` wykonane przez `COleControl` i uzyska niewielką korzyść. W przypadku korzystania z aktywacji bezokienkowej flaga nie ma żadnego wpływu.|
|`pointerInactive`|Jeśli ta wartość jest ustawiona, zapewnia interakcję myszy, gdy kontrolka jest nieaktywna przez włączenie `COleControl` implementacji `IPointerInactive` interfejsu, która jest domyślnie wyłączona.|
|`noFlickerActivate`|Jeśli ta wartość jest ustawiona, eliminuje dodatkowe operacje rysowania i towarzyszące Migotanie wizualne. Użyj, gdy kontrolka rysuje się identycznie w stanie nieaktywnym i aktywnym. W przypadku korzystania z aktywacji bezokienkowej flaga nie ma żadnego wpływu.|
|`windowlessActivate`|Jeśli ustawiona, oznacza, że kontrolka używa aktywacji bezokienkowej.|
|`canOptimizeDraw`|Jeśli ta wartość jest ustawiona, oznacza, że kontrolka przeprowadzi zoptymalizowane rysowanie, jeśli kontener ją obsługuje.|

Aby uzyskać więcej informacji na temat `GetControlFlags` i inne optymalizacje formantów OLE, zobacz [kontrolki ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a> COleControl::GetControlSize

Pobiera rozmiar okna formantu OLE.

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parametry

*PCX*<br/>
Określa szerokość formantu w pikselach.

*pcy*<br/>
Określa wysokość formantu w pikselach.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że wszystkie współrzędne okna sterowania są względne w lewym górnym rogu kontrolki.

## <a name="colecontrolgetdc"></a><a name="getdc"></a> COleControl:: GetDC —

Zapewnia, że obiekt bez okien w celu uzyskania kontekstu urządzenia ekranu (lub zgodnego) z jego kontenera.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parametry

*lprcRect*<br/>
Wskaźnik do prostokąta, który ma być ponownie rysowany przez kontrolkę bez okna, we współrzędnych klienta formantu. Wartość zerowa oznacza zakres pełnego obiektu.

*flagiDW*<br/>
Rysowanie atrybutów kontekstu urządzenia. Dostępne są następujące opcje:

- OLEDC_NODRAW wskazuje, że obiekt nie używa kontekstu urządzenia do wykonywania jakiegokolwiek rysowania, ale tylko do uzyskiwania informacji o urządzeniu wyświetlającym. Kontener powinien po prostu przekazać kontroler domeny okna bez dalszej obróbki.

- OLEDC_PAINTBKGND żądania odrysowania tła przez kontener przed zwróceniem kontrolera domeny. Obiekt powinien używać tej flagi, jeśli żąda kontrolera domeny w celu przerysowania obszaru z przezroczystym tłem.

- OLEDC_OFFSCREEN informuje kontener, który obiekt chce renderować do mapy bitowej poza ekranem, która powinna zostać skopiowana na ekran. Obiekt powinien używać tej flagi, gdy operacja rysowania, która ma zostać wykonana, generuje wiele migotania. Kontener jest bezpłatny do honorowania tego żądania. Jeśli jednak ta flaga nie jest ustawiona, kontener musi odwrócić do kontrolera domeny na ekranie. Pozwala to obiektom na wykonywanie bezpośrednich operacji ekranu, takich jak wyświetlanie zaznaczenia (za pośrednictwem operacji **XOR** ).

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do kontekstu wyświetlania urządzenia dla `CWnd` obszaru klienckiego kontenera, jeśli się powiedzie; w przeciwnym razie wartość zwracana jest równa null. Kontekstu wyświetlania urządzenia można użyć w kolejnych funkcjach GDI do rysowania w obszarze klienta okna kontenera.

### <a name="remarks"></a>Uwagi

Funkcja członkowska [ReleaseDC](#releasedc) musi zostać wywołana w celu zwolnienia kontekstu po narysowaniu. Gdy wywoływanie `GetDC` , obiekty przechodzą prostokąt, do którego mają być narysowane własne współrzędne klienta. `GetDC` tłumaczy je na współrzędne obszaru klienta kontenera. Obiekt nie powinien żądać żądanego prostokąta rysowania większego niż własny prostokąt obszaru klienta, którego rozmiar można pobrać przy użyciu [GetClientRect](#getclientrect). Zapobiega to przypadkowemu rysowaniu obiektów, gdzie nie są one przypuszczalne.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a> COleControl:: GetEnabled

Implementuje funkcję get właściwości z włączonymi zapasami kontrolki.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, Jeśli kontrolka jest włączona; w przeciwnym razie 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a> COleControl::GetExtendedControl

Uzyskuje wskaźnik do obiektu obsługiwanego przez kontener, który reprezentuje kontrolkę z rozszerzonym zestawem właściwości.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do obiektu formantu rozszerzonego kontenera. Jeśli nie ma dostępnego obiektu, wartość jest RÓWNa NULL.

Ten obiekt może być manipulowany przez `IDispatch` interfejs. Można również użyć, `QueryInterface` Aby uzyskać inne dostępne interfejsy dostarczone przez obiekt. Jednak obiekt nie jest wymagany do obsługi określonego zestawu interfejsów. Należy pamiętać, że poleganie na konkretnych funkcjach obiektu rozszerzonej kontroli kontenera ogranicza przenośność formantu do innych dowolnych kontenerów.

### <a name="remarks"></a>Uwagi

Funkcja, która wywołuje tę funkcję, jest odpowiedzialna za zwolnienie wskaźnika po zakończeniu pracy z obiektem. Należy zauważyć, że kontener nie jest wymagany do obsługi tego obiektu.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a> COleControl:: GetFocus

Określa, czy `COleControl` obiekt ma fokus.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Wartość zwracana

Jeśli formant jest aktywowany i bez okien, zwraca, **`this`** czy kontrolka ma aktualnie fokus klawiatury (zgodnie z kontenerem kontrolki), lub wartość null, jeśli nie ma fokusu.

W przeciwnym razie zwraca `CWnd` obiekt, który ma fokus (taki sam jak `CWnd::GetFocus` ).

### <a name="remarks"></a>Uwagi

Uaktywniona kontrolka bez okien otrzymuje fokus, gdy jest wywoływana funkcja [SetFocus](#setfocus) .

## <a name="colecontrolgetfont"></a><a name="getfont"></a> COleControl:: GetFont

Implementuje funkcję get właściwości "giełdowy".

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do interfejsu wysyłania czcionki dla właściwości czcionki giełdowej formantu.

### <a name="remarks"></a>Uwagi

Należy zwrócić uwagę, że obiekt wywołujący musi zwolnić obiektu po zakończeniu. W ramach implementacji formantu, użyj, `InternalGetFont` Aby uzyskać dostęp do obiektu czcionki o tej kontrolce. Aby uzyskać więcej informacji na temat używania czcionek w kontrolce, zobacz artykuł [formanty ActiveX: Używanie czcionek w kontrolce ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a> COleControl::GetFontTextMetrics

Mierzy metryki tekstowe dla każdego `CFontHolder` obiektu, którego właścicielem jest formant.

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Wskaźnik na strukturę [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

*fontHolder*<br/>
Odwołanie do obiektu [CFontHolder](../../mfc/reference/cfontholder-class.md) .

### <a name="remarks"></a>Uwagi

Taką czcionkę można wybrać za pomocą funkcji [COleControl:: SelectFontObject](#selectfontobject) . `GetFontTextMetrics` spowoduje zainicjowanie `TEXTMETRIC` struktury wskazywanej przez *lptm* z prawidłowymi informacjami o metrykach w `fontHolder` przypadku pomyślnego wykonania lub wypełnienie struktury zerami, jeśli nie powiedzie się. Należy używać tej funkcji zamiast [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) podczas malowania kontrolki, ponieważ kontrolki, takie jak każdy osadzony obiekt OLE, mogą być wymagane do renderowania samego metapliku.

`TEXTMETRIC`Struktura dla czcionki domyślnej jest odświeżana, gdy wywoływana jest funkcja [SelectFontObject](#selectfontobject) . Należy wywołać `GetFontTextMetrics` tylko wtedy, gdy wybierzesz Właściwość "podstawowe czcionki", aby upewnić się, że informacje są prawidłowe.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a> COleControl:: GetForeColor

Implementuje funkcję get właściwości ForeColor.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Wartość zwracana

Wartość zwracana określa bieżący kolor pierwszego planu jako wartość OLE_COLOR, jeśli to się powiedzie. Tę wartość można przetłumaczyć na wartość [COLORREF](/windows/win32/gdi/colorref) z wywołaniem do `TranslateColor` .

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a> COleControl:: GetHwnd

Implementuje funkcję get właściwości hWnd elementu.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Wartość zwracana

Uchwyt okna kontrolki OLE, jeśli istnieje; w przeciwnym razie wartość NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a> COleControl::GetMessageString

Wywoływane przez platformę, aby uzyskać krótki ciąg, który opisuje przeznaczenie elementu menu identyfikowanego przez *NID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parametry

*nID*<br/>
Identyfikator elementu menu.

*rMessage*<br/>
Odwołanie do obiektu [CString](../../atl-mfc-shared/reference/cstringt-class.md) , za pomocą którego zostanie zwrócony ciąg.

### <a name="remarks"></a>Uwagi

Może służyć do uzyskania komunikatu do wyświetlania na pasku stanu, gdy element menu zostanie wyróżniony. Domyślna implementacja próbuje załadować zasób ciągu identyfikowany przez *NID*.

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a> COleControl::GetNotSupported

Uniemożliwia dostęp do wartości właściwości kontrolki przez użytkownika.

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję zamiast funkcji get właściwości, gdzie pobieranie właściwości przez użytkownika kontrolki nie jest obsługiwane. Przykładem może być właściwość, która jest tylko do zapisu.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a> COleControl::GetReadyState

Zwraca stan gotowości formantu.

```
long GetReadyState();
```

### <a name="return-value"></a>Wartość zwracana

Stan gotowości formantu, jedną z następujących wartości:

|Nazwa|Opis|
|-|-|
|READYSTATE_UNINITIALIZED|Domyślny stan inicjowania|
|READYSTATE_LOADING|Kontrolka aktualnie ładuje jej właściwości|
|READYSTATE_LOADED|Kontrolka została zainicjowana|
|READYSTATE_INTERACTIVE|Formant ma wystarczającą ilość danych, które mają być interaktywne, ale nie wszystkie dane asynchroniczne zostały jeszcze załadowane|
|READYSTATE_COMPLETE|Kontrolka ma wszystkie dane|

### <a name="remarks"></a>Uwagi

Najbardziej proste kontrolki nigdy nie muszą odróżnić między załadowane i interaktywne. Jednak kontrolki obsługujące właściwości ścieżki danych mogą nie być gotowe do działania w trybie interaktywnym, dopóki co najmniej część danych nie zostanie odebrana asynchronicznie. Kontrolka powinna podjąć próbę interaktywnego działania tak szybko, jak to możliwe.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a> COleControl::GetRectInContainer

Uzyskuje współrzędne prostokąta kontrolki względem kontenera wyrażone w jednostkach urządzeń.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Wskaźnik do struktury prostokąta, do której zostaną skopiowane współrzędne kontrolki.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli formant jest aktywny w miejscu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Prostokąt jest prawidłowy tylko wtedy, gdy kontrolka jest aktywna.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a> COleControl::GetStockTextMetrics

Mierzy tekst metryki dla właściwości czcionki giełdowej, którą można wybrać za pomocą funkcji [SelectStockFont](#selectstockfont) .

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Wskaźnik do struktury [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

### <a name="remarks"></a>Uwagi

`GetStockTextMetrics`Funkcja będzie inicjować `TEXTMETRIC` strukturę wskazywaną przez *lptm* z prawidłowymi informacjami o metrykach, jeśli się powiedzie, lub wypełnić strukturę zerami, jeśli nie powiedzie się. Użyj tej funkcji zamiast [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) podczas malowania kontrolki, ponieważ kontrolki, takie jak każdy osadzony obiekt OLE, mogą być wymagane do renderowania samego metapliku.

`TEXTMETRIC`Struktura dla czcionki domyślnej jest odświeżana po `SelectStockFont` wywołaniu funkcji. Należy wywołać tę funkcję dopiero po wybraniu czcionki giełdowej, aby upewnić się, że informacje są prawidłowe.

## <a name="colecontrolgettext"></a><a name="gettext"></a> COleControl:: gettext

Implementuje funkcję get właściwości "text" lub "Caption".

```
BSTR GetText();
```

### <a name="return-value"></a>Wartość zwracana

Bieżąca wartość ciągu tekstowego kontrolki lub ciągu o zerowej długości, jeśli nie ma żadnego ciągu.

> [!NOTE]
> Aby uzyskać więcej informacji o typie danych BSTR, zobacz [typy danych](../../mfc/reference/data-types-mfc.md) w sekcji makra i Globals.

### <a name="remarks"></a>Uwagi

Należy pamiętać, że obiekt wywołujący tę funkcję musi wywołać `SysFreeString` dla ciągu zwracanego w celu zwolnienia zasobu. W ramach implementacji formantu, użyj, `InternalGetText` Aby uzyskać dostęp do właściwości tekstu lub napisu kontrolki.

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a> COleControl::GetWindowlessDropTarget

Przesłoń `GetWindowlessDropTarget` , gdy chcesz, aby kontrolka bez okien była elementem docelowym operacji przeciągania i upuszczania OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do `IDropTarget` interfejsu obiektu. Ponieważ nie ma okna, obiekt bez okna nie może zarejestrować `IDropTarget` interfejsu. Jednak, aby wziąć udział w przeciąganiu i upuszczaniu, obiekt bez okien może nadal zaimplementować interfejs i zwrócić go w `GetWindowlessDropTarget` .

### <a name="remarks"></a>Uwagi

Zwykle jest to wymagane, aby okno kontrolki było rejestrowane jako miejsce docelowe upuszczania. Ale ponieważ kontrolka nie ma własnego okna, Kontener użyje własnego okna jako elementu docelowego upuszczania. Formant po prostu musi dostarczyć implementację `IDropTarget` interfejsu, do którego kontener może delegować wywołania w odpowiednim czasie. Na przykład:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a> COleControl::InitializeIIDs

Informuje klasę bazową IID, która będzie używana przez formant.

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parametry

*piidPrimary*<br/>
Wskaźnik na identyfikator interfejsu podstawowego interfejsu wysyłania formantu.

*piidEvents*<br/>
Wskaźnik na identyfikator interfejsu interfejsu zdarzenia kontrolki.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję w konstruktorze kontrolki, aby poinformować klasę bazową identyfikatorów interfejsów, które będą używane przez formant.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a> COleControl::InternalGetFont

Uzyskuje dostęp do właściwości czcionki giełdowej formantu

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Wartość zwracana

Odwołanie do obiektu [CFontHolder](../../mfc/reference/cfontholder-class.md) , który zawiera obiekt fontal.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a> COleControl::InternalGetText

Uzyskuje dostęp do właściwości tekstu lub podpisu formantu.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Wartość zwracana

Odwołanie do ciągu tekstowego formantu.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a> COleControl:: InternalSetReadyState

Ustawia stan gotowości formantu.

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parametry

*lNewReadyState*<br/>
Stan gotowości do ustawienia dla kontrolki, jedną z następujących wartości:

|Nazwa|Opis|
|-|-|
|READYSTATE_UNINITIALIZED|Domyślny stan inicjowania|
|READYSTATE_LOADING|Kontrolka aktualnie ładuje jej właściwości|
|READYSTATE_LOADED|Kontrolka została zainicjowana|
|READYSTATE_INTERACTIVE|Formant ma wystarczającą ilość danych, które mają być interaktywne, ale nie wszystkie dane asynchroniczne zostały jeszcze załadowane|
|READYSTATE_COMPLETE|Kontrolka ma wszystkie dane|

### <a name="remarks"></a>Uwagi

Najbardziej proste kontrolki nigdy nie muszą odróżnić między załadowane i interaktywne. Jednak kontrolki obsługujące właściwości ścieżki danych mogą nie być gotowe do działania w trybie interaktywnym, dopóki co najmniej część danych nie zostanie odebrana asynchronicznie. Kontrolka powinna podjąć próbę interaktywnego działania tak szybko, jak to możliwe.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a> COleControl::InvalidateControl

Wymusza, aby formant był ponownie rysowany.

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Wskaźnik do regionu kontrolki, który ma zostać unieważniony.

*bErase*<br/>
Określa, czy tło w regionie aktualizacji ma być wymazywane, gdy region aktualizacji jest przetwarzany.

### <a name="remarks"></a>Uwagi

Jeśli *lpRect* ma wartość null, cała kontrolka zostanie narysowana ponownie. Jeśli *lpRect* nie ma wartości null, oznacza to, że część prostokąta kontrolki, która ma zostać unieważniona. W przypadkach, gdy kontrolka nie ma okna lub nie jest aktualnie aktywna, prostokąt jest ignorowany, a wywołanie jest nawiązywane w funkcji składowej [IAdviseSink:: OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) lokacji klienta. Użyj tej funkcji zamiast `CWnd::InvalidateRect` lub `InvalidateRect` .

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a> COleControl::InvalidateRgn

Unieważnia obszar klienta okna kontenera w danym regionie.

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*pRgn*<br/>
Wskaźnik do obiektu [CRgn](../../mfc/reference/crgn-class.md) , który identyfikuje region wyświetlania obiektu OLE do unieważnienia, we współrzędnych klienta okna zawierającego. Jeśli ten parametr ma wartość NULL, zakres jest cały obiekt.

*bErase*<br/>
Określa, czy tło w niezweryfikowanym regionie ma być wymazane. Jeśli wartość jest równa TRUE, tło zostanie wymazane. W przypadku wartości FALSE tło pozostaje niezmienione.

### <a name="remarks"></a>Uwagi

Służy do ponownego rysowania kontrolek bez okien w kontenerze. Unieważniony region, wraz ze wszystkimi innymi obszarami w regionie aktualizacji, jest oznaczony do malowania podczas wysyłania następnej wiadomości [WM_PAINT](/windows/win32/gdi/wm-paint) .

Jeśli *bErase* ma wartość true dla dowolnej części regionu aktualizacji, to tło w całym regionie, a nie tylko w danej części, jest wymazywane.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a> COleControl::IsConvertingVBX

Umożliwia wyspecjalizowane ładowanie formantu OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli formant jest konwertowany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

W przypadku konwertowania formularza korzystającego z formantów VBX do jednego, który używa formantów OLE, może być wymagany specjalny kod ładowania dla formantów OLE. Na przykład, Jeśli ładujesz wystąpienie formantu OLE, może wystąpić wywołanie [PX_Font](persistence-of-ole-controls.md#px_font) w `DoPropExchange` :

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Jednak kontrolki VBX nie miały obiektu Font; Każda właściwość czcionki została zapisana pojedynczo. W takim przypadku należy użyć `IsConvertingVBX` do rozróżnienia między tymi dwoma przypadkami:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Innym przypadkiem jest to, że formant VBX zapisał dane binarne danych binarnych (w ramach obsługi komunikatów VBM_SAVEPROPERTY), a formant OLE zapisuje dane binarne w innym formacie. Jeśli chcesz, aby kontrolka OLE była zgodna z poprzednimi wersjami z kontrolką VBX, możesz odczytać zarówno stare, jak i nowe formaty, używając `IsConvertingVBX` funkcji, odróżniając, czy jest ładowany formant VBX lub formant OLE.

W funkcji kontrolki `DoPropExchange` można sprawdzić, czy jest to warunek i w przypadku wartości true wykonać Wczytaj kod specyficzny dla tej konwersji (na przykład poprzednie przykłady). Jeśli formant nie jest konwertowany, można wykonać zwykły kod ładowania. Ta możliwość ma zastosowanie tylko do formantów konwertowanych z odpowiedników VBX.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a> COleControl::IsInvokeAllowed

Włącza wywołanie metody automatyzacji.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, Jeśli kontrolka została zainicjowana; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Implementacja wdrożenia `IDispatch::Invoke` `IsInvokeAllowed` w celu ustalenia, czy dana funkcja (identyfikowana przez `dispid` ) może być wywoływana. Domyślnym zachowaniem formantu OLE jest Zezwalanie na wywoływanie metod automatyzacji tylko wtedy, gdy formant został zainicjowany. jednak `IsInvokeAllowed` Funkcja jest funkcją wirtualną i może zostać przesłonięta w razie potrzeby (na przykład gdy kontrolka jest używana jako serwer automatyzacji).

## <a name="colecontrolismodified"></a><a name="ismodified"></a> COleControl:: IsModified

Określa, czy stan kontrolki został zmodyfikowany.

```
BOOL IsModified();
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli stan kontrolki został zmodyfikowany od czasu ostatniego zapisania; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Stan kontrolki jest modyfikowany, gdy właściwość zmienia wartość.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a> COleControl::IsOptimizedDraw

Określa, czy kontener obsługuje zoptymalizowany rysunek dla bieżącej operacji rysowania.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Wartość zwracana

Ma wartość TRUE, jeśli kontener obsługuje zoptymalizowany rysunek dla bieżącej operacji rysowania; w przeciwnym razie FALSE.

### <a name="remarks"></a>Uwagi

Jeśli Optymalizacja jest zoptymalizowana, formant nie musi wybierać starych obiektów (pióra, pędzle, czcionki itp.) w kontekście urządzenia po zakończeniu rysowania.

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a> COleControl:: IsSubclassedControl

Wywoływane przez platformę, aby określić, czy kontrolka jest podklasą kontrolki systemu Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, Jeśli kontrolka jest podklasą; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję i zwrócić wartość TRUE, jeśli formant OLE podklasuje kontrolkę Windows.

## <a name="colecontrolload"></a><a name="load"></a> COleControl:: Load

Resetuje wszystkie poprzednie dane załadowane asynchronicznie i Inicjuje nowe ładowanie właściwości asynchronicznej kontrolki.

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parametry

*strNewPath*<br/>
Wskaźnik do ciągu zawierającego ścieżkę odwołującą się do absolutnej lokalizacji właściwości kontrolki asynchronicznej.

*wierszy*<br/>
Obiekt [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) implementujący właściwość kontrolki asynchronicznej.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a> COleControl::LockInPlaceActive

Uniemożliwia kontenerowi dezaktywowanie formantu.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parametry

*odblokowan*<br/>
PRAWDA, jeśli aktywny stan formantu w miejscu ma być zablokowany; FAŁSZ, jeśli ma być odblokowany.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli blokada zakończyła się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy pamiętać, że każde zablokowanie kontrolki musi być sparowane z odblokowaniem formantu po zakończeniu. Kontrolkę należy blokować tylko przez krótkie okresy, na przykład podczas wyzwalania zdarzenia.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a> COleControl::OnAmbientPropertyChange

Wywoływane przez platformę, gdy właściwość otoczenia kontenera zmieniła wartość.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*dispID*<br/>
Identyfikator wysyłki właściwości otoczenia, która uległa zmianie lub DISPID_UNKNOWN, Jeśli zmieniono wiele właściwości.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a> COleControl::OnAppearanceChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości wyglądu akcji.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Uwagi

Zastąp tę funkcję, jeśli chcesz, aby powiadomienie działało po zmianie tej właściwości. Domyślne wywołania implementacji `InvalidateControl` .

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a> COleControl::OnBackColorChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości zmiany koloru zapasu.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Uwagi

Zastąp tę funkcję, jeśli chcesz, aby powiadomienie działało po zmianie tej właściwości. Domyślne wywołania implementacji `InvalidateControl` .

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a> COleControl::OnBorderStyleChanged

Wywoływane przez platformę, gdy wartość właściwości Borderer została zmieniona.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Uwagi

Domyślne wywołania implementacji `InvalidateControl` .

Zastąp tę funkcję, jeśli chcesz, aby powiadomienie działało po zmianie tej właściwości.

## <a name="colecontrolonclick"></a><a name="onclick"></a> COleControl:: onkliknięcia

Wywoływane przez platformę, gdy kliknięto przycisk myszy lub metoda DoClick Stock została wywołana.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parametry

*iButton*<br/>
Indeks przycisku myszy. Może mieć jedną z następujących wartości:

- LEFT_BUTTON kliknięciu lewym przyciskiem myszy.

- MIDDLE_BUTTON kliknięciu środkowego przycisku myszy.

- RIGHT_BUTTON kliknięciu prawym przyciskiem myszy.

### <a name="remarks"></a>Uwagi

Domyślne wywołania implementacji `COleControl::FireClick` .

Przesłoń tę funkcję elementu członkowskiego, aby zmodyfikować lub zwiększyć domyślną obsługę.

## <a name="colecontrolonclose"></a><a name="onclose"></a> COleControl:: OnClose

Wywoływane przez platformę, gdy kontener wywołuje funkcję kontrolki `IOleControl::Close` .

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parametry

*dwSaveOption*<br/>
Flaga wskazująca, czy obiekt powinien być zapisany przed załadowaniem. Prawidłowe wartości:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Uwagi

Domyślnie program `OnClose` zapisuje obiekt Control, jeśli został zmodyfikowany, a *dwSaveOption* jest OLECLOSE_SAVEIFDIRTY lub OLECLOSE_PROMPTSAVE.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a> COleControl::OnDoVerb

Wywoływane przez platformę, gdy kontener wywołuje `IOleObject::DoVerb` funkcję członkowską.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*iVerb*<br/>
Indeks zlecenia kontroli, który ma zostać wywołany.

*lpMsg*<br/>
Wskaźnik do komunikatu systemu Windows, który spowodował wywołanie zlecenia.

*hWndParent*<br/>
Uchwyt do okna nadrzędnego formantu. Jeśli wykonanie zlecenia tworzy okno (lub Windows), *hWndParent* powinno być używane jako element nadrzędny.

*lpRect*<br/>
Wskaźnik do struktury RECT, do którego zostaną skopiowane współrzędne kontrolki względem kontenera.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Implementacja domyślna używa wpisów mapy komunikatów ON_OLEVERB i ON_STDOLEVERB, aby określić odpowiednią funkcję do wywołania.

Zastąp tę funkcję, aby zmienić domyślną obsługę zlecenia.

## <a name="colecontrolondraw"></a><a name="ondraw"></a> COleControl:: OnDraw

Wywoływane przez platformę, by narysować kontrolkę OLE w określonym prostokącie ograniczenia przy użyciu określonego kontekstu urządzenia.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parametry

*Domeny*<br/>
Kontekst urządzenia, w którym odbywa się rysowanie.

*rcBounds*<br/>
Prostokątny obszar kontrolki, łącznie z obramowaniem.

*rcInvalid*<br/>
Prostokątny obszar formantu, który jest nieprawidłowy.

### <a name="remarks"></a>Uwagi

`OnDraw` jest zazwyczaj wywoływana do wyświetlania ekranu, przekazując kontekst urządzenia ekranu jako *PDC*. Parametr *rcBounds* identyfikuje prostokąt w kontekście urządzenia docelowego (względem bieżącego trybu mapowania). Parametr *rcInvalid* jest bieżącym prostokątem, który jest nieprawidłowy. W niektórych przypadkach będzie to mniejszy obszar niż *rcBounds*.

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a> COleControl::OnDrawMetafile

Wywoływane przez platformę, by narysować kontrolkę OLE w określonym prostokącie obwiedni przy użyciu określonego kontekstu urządzenia metapliku.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*Domeny*<br/>
Kontekst urządzenia, w którym odbywa się rysowanie.

*rcBounds*<br/>
Prostokątny obszar kontrolki, łącznie z obramowaniem.

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje funkcję [OnDraw](#ondraw) .

## <a name="colecontrolonedit"></a><a name="onedit"></a> COleControl:: onedit

Powoduje, że formant jest aktywowany przez interfejs użytkownika.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Wskaźnik do komunikatu systemu Windows, który wywołał zlecenie.

*hWndParent*<br/>
Uchwyt do okna nadrzędnego formantu.

*lpRect*<br/>
Wskaźnik do prostokąta używany przez formant w kontenerze.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ma to taki sam efekt jak wywoływanie czasownika OLEIVERB_UIACTIVATE formantu.

Ta funkcja jest zwykle używana jako funkcja obsługi dla wpisu mapy wiadomości ON_OLEVERB. Powoduje to, że zlecenie "Edit" jest dostępne w menu "Object" kontrolki. Na przykład:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a> COleControl::OnEnabledChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości z włączonymi zapasami.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Uwagi

Zastąp tę funkcję, jeśli chcesz, aby powiadomienie działało po zmianie tej właściwości. Domyślne wywołania implementacji [InvalidateControl](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a> COleControl::OnEnumVerbs

Wywoływane przez platformę, gdy kontener wywołuje `IOleObject::EnumVerbs` funkcję członkowską.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parametry

*ppenumOleVerb*<br/>
Wskaźnik do `IEnumOLEVERB` obiektu, który wylicza czasowniki formantu.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli zlecenia są dostępne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Implementacja domyślna wylicza ON_OLEVERB wpisów w mapie wiadomości.

Zastąp tę funkcję, aby zmienić domyślny sposób wyliczania zleceń.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a> COleControl::OnEventAdvise

Wywoływane przez platformę, gdy procedura obsługi zdarzeń jest połączona z kontrolką OLE lub z nią odłączona.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parametry

*bAdvise*<br/>
Wartość TRUE wskazuje, że program obsługi zdarzeń został połączony z kontrolką. Wartość FALSE wskazuje, że program obsługi zdarzeń został odłączony od formantu.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a> COleControl::OnFontChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości czcionki giełdowej.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Uwagi

Domyślne wywołania implementacji `COleControl::InvalidateControl` . Jeśli kontrolka jest podklasą kontrolki systemu Windows, domyślna implementacja również wysyła komunikat WM_SETFONT do okna kontrolki.

Zastąp tę funkcję, jeśli chcesz, aby powiadomienie działało po zmianie tej właściwości.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a> COleControl::OnForeColorChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości ForeColor zasobu.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Uwagi

Domyślne wywołania implementacji `InvalidateControl` .

Zastąp tę funkcję, jeśli chcesz, aby powiadomienie działało po zmianie tej właściwości.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a> COleControl::OnFreezeEvents

Wywoływane przez platformę po wywołaniu kontenera `IOleControl::FreezeEvents` .

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parametry

*bFreeze*<br/>
PRAWDA, jeśli obsługa zdarzeń kontrolki jest zamrożona; w przeciwnym razie FALSE.

### <a name="remarks"></a>Uwagi

Domyślna implementacja nie robi nic.

Przesłoń tę funkcję, jeśli chcesz mieć dodatkowe zachowanie w przypadku zamrożonej lub niezamrożonej obsługi zdarzeń.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a> COleControl::OnGetColorSet

Wywoływane przez platformę, gdy kontener wywołuje `IViewObject::GetColorSet` funkcję członkowską.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parametry

*ptd*<br/>
Wskazuje na urządzenie docelowe, dla którego ma być renderowany obraz. Jeśli ta wartość jest RÓWNa NULL, obraz powinien być renderowany dla domyślnego urządzenia docelowego, zazwyczaj urządzenia wyświetlającego.

*hicTargetDev*<br/>
Określa kontekst informacji na urządzeniu docelowym wskazywanym przez *PTD*. Ten parametr może być kontekstem urządzenia, ale nie jest to konieczne. Jeśli *PTD* ma wartość null, *hicTargetDev* powinien również mieć wartość null.

*ppColorSet*<br/>
Wskaźnik do lokalizacji, do której ma zostać skopiowany zestaw kolorów, które mają zostać użyte. Jeśli funkcja nie zwraca zestawu kolorów, zwracana jest wartość NULL.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli jest zwracany prawidłowy zestaw kolorów; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Kontener wywołuje tę funkcję, aby uzyskać wszystkie kolory, które są konieczne do rysowania kontrolki OLE. Kontener może używać zestawów kolorów uzyskanych w połączeniu z kolory potrzebne do ustawienia ogólnej palety kolorów. Domyślna implementacja zwraca wartość FALSE.

Przesłoń tę funkcję, aby wykonać wszelkie specjalne przetwarzanie tego żądania.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a> COleControl::OnGetControlInfo

Wywoływane przez platformę, gdy kontener kontrolki zażądał informacji o kontrolce.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parametry

*pControlInfo*<br/>
Wskaźnik do struktury [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) , która ma zostać wypełniona.

### <a name="remarks"></a>Uwagi

Te informacje obejmują głównie opis klawiszy kontrolki. Domyślna implementacja powoduje wypełnienie *pControlInfo* z informacjami domyślnymi.

Przesłoń tę funkcję, Jeśli kontrolka wymaga przetworzenia kluczy.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a> COleControl::OnGetDisplayString

Wywoływane przez platformę, aby uzyskać ciąg, który reprezentuje bieżącą wartość właściwości identyfikowanej przez *DISPID*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
Identyfikator wysyłania właściwości formantu.

*strValue*<br/>
Odwołanie do obiektu [CString](../../atl-mfc-shared/reference/cstringt-class.md) , za pomocą którego zostanie zwrócony ciąg.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli ciąg został zwrócony w *strValue;* w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Przesłoń tę funkcję, Jeśli kontrolka ma właściwość, której wartość nie może być bezpośrednio konwertowana na ciąg i chcesz, aby wartość właściwości była wyświetlana w przeglądarce właściwości dostarczonej z kontenerem.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a> COleControl::OnGetInPlaceMenu

Wywoływane przez platformę, gdy kontrolka jest aktywowana przez interfejs użytkownika w celu uzyskania menu, które ma zostać scalone z istniejącym menu kontenera.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Wartość zwracana

Uchwyt menu kontrolki lub wartość NULL, jeśli formant nie ma żadnego elementu. Domyślna implementacja zwraca wartość NULL.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji na temat scalania zasobów OLE, zobacz [menu artykułów i zasoby (OLE)](../../mfc/menus-and-resources-ole.md).

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a> COleControl::OnGetNaturalExtent

Wywoływane przez platformę w odpowiedzi na `IViewObjectEx::GetNaturalExtent` żądanie kontenera.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Określa sposób reprezentowania obiektu. Reprezentacje obejmują zawartość, ikonę, miniaturę lub dokument drukowany. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2.

*lindex*<br/>
Część interesującego obiektu. Obecnie tylko-1 jest prawidłowy.

*ptd*<br/>
Wskazuje strukturę [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) definiującą urządzenie docelowe, dla którego ma zostać zwrócony rozmiar obiektu.

*hicTargetDev*<br/>
Określa kontekst informacji dla urządzenia docelowego wskazywanego przez parametr *PTD* , z którego obiekt może wyodrębnić metryki urządzeń i przetestować możliwości urządzenia. Jeśli *PTD* ma wartość null, obiekt powinien ignorować wartość w parametrze *hicTargetDev* .

*pExtentInfo*<br/>
Wskazuje `DVEXTENTINFO` strukturę, która określa dane dotyczące zmiany wielkości. `DVEXTENTINFO`Struktura jest:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Składowa struktury `dwExtentMode` może przyjmować jedną z dwóch wartości:

- DVEXTENT_CONTENT dowiedzieć się, jak Big formant powinien być dokładnie dopasowany do zawartości (przyciąganie do rozmiaru)

- DVEXTENT_INTEGRAL podczas zmiany rozmiaru, Przekaż Proponowany rozmiar do kontrolki

*psizel*<br/>
Wskazuje rozmiar danych zwracanych przez formant. Zwrócone dane rozmiaru są ustawiane na wartość-1 dla dowolnego wymiaru, który nie został dostosowany.

### <a name="return-value"></a>Wartość zwracana

Wartość różna od zera, jeśli pomyślnie zwraca lub dostosowuje rozmiar; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Przesłoń tę funkcję, aby przywrócić rozmiar wyświetlania obiektu znajdujący się najbliżej proponowanego rozmiaru i trybu zakresu w `DVEXTENTINFO` strukturze. Domyślna implementacja zwraca wartość FALSE i nie wprowadza żadnych zmian rozmiaru.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a> COleControl::OnGetPredefinedStrings

Wywoływane przez platformę w celu uzyskania zestawu wstępnie zdefiniowanych ciągów reprezentujących możliwe wartości właściwości.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
Identyfikator wysyłania właściwości formantu.

*pStringArray*<br/>
Tablica ciągów, która ma zostać wypełniona wartościami zwracanymi.

*pCookieArray*<br/>
Tablica DWORD, która ma zostać wypełniona wartościami zwracanymi.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli dodano elementy do *pStringArray* i *pCookieArray*.

### <a name="remarks"></a>Uwagi

Przesłoń tę funkcję, Jeśli kontrolka ma właściwość z zestawem możliwych wartości, które mogą być reprezentowane przez ciągi. Dla każdego elementu dodanego do *pStringArray*należy dodać odpowiadający element "cookie" do *pCookieArray.* Te wartości "cookie" mogą być później przesyłane przez platformę do `COleControl::OnGetPredefinedValue` funkcji.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a> COleControl::OnGetPredefinedValue

Wywoływane przez platformę, aby uzyskać wartość odpowiadającą jednemu ze wstępnie zdefiniowanych ciągów zwracanych wcześniej przez przesłonięcie `COleControl::OnGetPredefinedStrings` .

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
Identyfikator wysyłania właściwości formantu.

*dwCookie*<br/>
Wartość cookie poprzednio zwrócona przez przesłonięcie `COleControl::OnGetPredefinedStrings` .

*lpvarOut*<br/>
Wskaźnik do `VARIANT` struktury, za pomocą której zostanie zwrócona wartość właściwości.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli wartość została zwrócona w *lpvarOut*; w przeciwnym razie 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a> COleControl::OnGetViewExtent

Wywoływane przez platformę w odpowiedzi na żądanie [IViewObject2:: getzakres](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) .

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parametry

*dwDrawAspect*<br/>
Wartość DWORD opisująca, która forma lub aspekt obiektu ma być wyświetlany. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2.

*lindex*<br/>
Część interesującego obiektu. Obecnie tylko-1 jest prawidłowy.

*ptd*<br/>
Wskazuje strukturę [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) definiującą urządzenie docelowe, dla którego ma zostać zwrócony rozmiar obiektu.

*lpsizel*<br/>
Wskazuje lokalizację, w której jest zwracany rozmiar obiektu.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli informacje o zakresie zostały pomyślnie zwrócone; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Przesłoń tę funkcję, jeśli formant używa rysowania dwuetapowego, a jego części nieprzezroczyste i przezroczyste mają różne wymiary.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a> COleControl::OnGetViewRect

Wywoływane przez platformę w odpowiedzi na `IViewObjectEx::GetRect` żądanie kontenera.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Wartość DWORD opisująca, która forma lub aspekt obiektu ma być wyświetlany. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2:

- DVASPECT_CONTENTy prostokąt ograniczający cały obiekt. Lewy górny róg w pochodzeniu obiektu i rozmiarze równy zakresowi zwróconemu przez `GetViewExtent` *.*

- DVASPECT_OPAQUE obiektów z prostokątnym regionem nieprzezroczystym zwraca ten prostokąt. Inne nie powiodą się.

- DVASPECT_TRANSPARENT prostokąt obejmujący wszystkie nieprzezroczyste lub nieregularne części.

*pRect*<br/>
Wskazuje na strukturę [recta](/windows/win32/api/windef/ns-windef-rectl) określającą prostokąt, w którym obiekt powinien być rysowany. Ten parametr steruje rozmieszczeniem i rozciąganiem obiektu.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli rozmiar prostokąta do obiektu został pomyślnie zwrócony; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Rozmiar obiektu jest konwertowany przez `OnGetViewRect` do prostokąta rozpoczynającego się do określonej pozycji (wartość domyślna to górny lewy róg ekranu). Przesłoń tę funkcję, jeśli formant używa rysowania dwuetapowego, a jego części nieprzezroczyste i przezroczyste mają różne wymiary.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a> COleControl::OnGetViewStatus

Wywoływane przez platformę w odpowiedzi na `IViewObjectEx::GetViewStatus` żądanie kontenera.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Wartość zwracana

Jedna z wartości wyliczenia podwójne, jeśli to się powiedzie; w przeciwnym razie 0. Możliwe wartości to następujące:

|Nazwa|Opis|
|-|-|
|VIEWSTATUS_OPAQUE|Obiekt jest całkowicie nieprzezroczysty. Jeśli ten bit nie jest ustawiony, obiekt zawiera elementy przezroczyste. Ten bit ma zastosowanie tylko do aspektów związanych z treścią, a nie do DVASPECT_ICON lub DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Obiekt ma pełne tło (składające się z pełnego koloru, a nie wzorca pędzla). Ten bit ma znaczenie tylko wtedy, gdy VIEWSTATUS_OPAQUE jest ustawiony i ma zastosowanie tylko do aspektów związanych z treścią, a nie do DVASPECT_ICON lub DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Obiekt obsługuje DVASPECT_OPAQUE. Wszystkie metody IViewObjectEx, które pobierają aspekt rysowania jako parametr można wywołać przy użyciu tego aspektu.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Obiekt obsługuje DVASPECT_TRANSPARENT. Wszystkie `IViewObjectEx` metody, które pobierają aspekt rysowania jako parametr można wywołać przy użyciu tego aspektu.|

### <a name="remarks"></a>Uwagi

Przesłoń tę funkcję, Jeśli kontrolka używa rysowania dwuetapowego. Domyślna implementacja zwraca VIEWSTATUS_OPAQUE.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a> COleControl::OnHideToolBars

Wywoływane przez platformę, gdy kontrolka jest zdezaktywowana przez interfejs użytkownika.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Uwagi

Implementacja powinna ukrywać wszystkie paski narzędzi wyświetlane przez `OnShowToolbars` .

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a> COleControl::OnInactiveMouseMove

Wywoływane przez kontener dla nieaktywnego obiektu pod wskaźnikiem myszy po odebraniu komunikatu WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Prostokąt ograniczający obiekt w współrzędnej klienta okna zawierającego. Informuje obiekt o dokładnej pozycji i rozmiarze na ekranie po odebraniu komunikatu WM_MOUSEMOVE.

*x*<br/>
Współrzędna x lokalizacji myszy w współrzędnej klienta okna zawierającego.

*t*<br/>
Współrzędna y lokalizacji myszy w współrzędnej klienta okna zawierającego.

*dwKeyState*<br/>
Określa bieżący stan klawiszy modyfikujących klawiaturę na klawiaturze. Prawidłowe wartości mogą być kombinacją dowolnej z flag MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON i MK_RBUTTON.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że współrzędne klienta okna są używane do przekazywania położenia kursora myszy. Jest to możliwe przez również przekazanie prostokąta związanego z obiektem w tym samym układzie współrzędnych.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a> COleControl::OnInactiveSetCursor

Wywoływane przez kontener dla nieaktywnego obiektu pod wskaźnikiem myszy po odebraniu komunikatu WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Prostokąt ograniczający obiekt w współrzędnej klienta okna zawierającego. Informuje obiekt o dokładnej pozycji i rozmiarze na ekranie po odebraniu komunikatu WM_SETCURSOR.

*x*<br/>
Współrzędna x lokalizacji myszy w współrzędnej klienta okna zawierającego.

*t*<br/>
Współrzędna y lokalizacji myszy w współrzędnej klienta okna zawierającego.

*dwMouseMsg*<br/>
Identyfikator komunikatu myszy, dla którego wystąpiło WM_SETCURSOR.

*bSetAlways*<br/>
Określa, czy obiekt musi ustawić kursor. Jeśli wartość jest równa TRUE, obiekt musi ustawić kursor; w przypadku wartości FALSE kursor nie jest zobowiązany do ustawienia kursora i powinien zwrócić S_FALSE w tym przypadku.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że współrzędne klienta okna są używane do przekazywania położenia kursora myszy. Jest to możliwe przez również przekazanie prostokąta związanego z obiektem w tym samym układzie współrzędnych.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a> COleControl::OnKeyDownEvent

Wywoływane przez platformę po przetworzeniu zapasowej zdarzenia KeyDown.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*nChar*<br/>
Wartość kodu klucza wirtualnego naciśniętego klucza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser. h

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK naciśnięcie klawisza SHIFT podczas działania.

- CTRL_MASK naciśnięcie klawisza CTRL podczas akcji.

- ALT_MASK naciśnięcie klawisza ALT podczas działania.

### <a name="remarks"></a>Uwagi

Przesłoń tę funkcję, Jeśli kontrolka potrzebuje dostępu do informacji o kluczu po jego wyzwoleniu.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a> COleControl::OnKeyPressEvent

Wywoływane przez platformę po uruchomieniu zdarzenia KeyPress.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parametry

*nChar*<br/>
Zawiera wartość kodu klucza wirtualnego naciśniętego klawisza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser. h

### <a name="remarks"></a>Uwagi

Należy zauważyć, że wartość *nchar* mogła zostać zmodyfikowana przez kontener.

Przesłoń tę funkcję, jeśli chcesz powiadomienia po wystąpieniu tego zdarzenia.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a> COleControl::OnKeyUpEvent

Wywoływane przez platformę po przetworzeniu zapasowej zdarzenia KeyDown.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*nChar*<br/>
Wartość kodu klucza wirtualnego naciśniętego klucza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser. h

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK naciśnięcie klawisza SHIFT podczas działania.

- CTRL_MASK naciśnięcie klawisza CTRL podczas akcji.

- ALT_MASK naciśnięcie klawisza ALT podczas działania.

### <a name="remarks"></a>Uwagi

Przesłoń tę funkcję, Jeśli kontrolka potrzebuje dostępu do informacji o kluczu po jego wyzwoleniu.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a> COleControl::OnMapPropertyToPage

Wywoływane przez platformę, aby uzyskać identyfikator klasy strony właściwości, która implementuje edytowanie określonej właściwości.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parametry

*DISPID*<br/>
Identyfikator wysyłania właściwości formantu.

*lpclsid*<br/>
Wskaźnik do `CLSID` struktury, za pomocą której zostanie zwrócony identyfikator klasy.

*pbPageOptional*<br/>
Zwraca wskaźnik określający, czy użycie określonej strony właściwości jest opcjonalne.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli identyfikator klasy został zwrócony w *lpClsid*; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zastąp tę funkcję, aby umożliwić wywoływanie stron właściwości kontrolki z przeglądarki właściwości kontenera.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a> COleControl::

Wywoływane przez platformę, gdy kontener wykrył, że klawisz skrótu kontrolki OLE został naciśnięty.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parametry

*pMsg*<br/>
Wskaźnik do komunikatu systemu Windows wygenerowanego przez naciśnięcie klawisza skrótu.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a> COleControl:: onproperties

Wywoływane przez platformę, gdy czasownik właściwości kontrolki został wywołany przez kontener.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Wskaźnik do komunikatu systemu Windows, który wywołał zlecenie.

*hWndParent*<br/>
Uchwyt do okna nadrzędnego formantu.

*lpRect*<br/>
Wskaźnik do prostokąta używany przez formant w kontenerze.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja Wyświetla okno dialogowe właściwości modalnej.

Można również użyć tej funkcji, aby spowodować wyświetlenie stron właściwości kontrolki. Wykonaj wywołanie `OnProperties` funkcji, przekazując uchwyt elementu nadrzędnego kontrolki w parametrze *hWndParent* . W takim przypadku wartości parametrów *lpMsg* i *lpRect* są ignorowane.

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a> COleControl::OnQueryHitPoint

Wywoływane przez platformę w odpowiedzi na `IViewObjectEx::QueryHitPoint` żądanie kontenera.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Określa sposób reprezentowania obiektu. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2.

*pRectBounds*<br/>
Wskaźnik na `RECT` strukturę, określając prostokąt ograniczający obszar klienta kontrolki OLE.

*ptlLoc*<br/>
Wskaźnik do `POINT` struktury określającej punkt do sprawdzenia dla trafienia. Punkt jest określony we współrzędnych obszaru klienta OLE.

*lCloseHint*<br/>
Odległość, która definiuje "Close" do punktu zaznaczonego dla trafienia.

*pHitResult*<br/>
Wskaźnik do wyniku zapytania trafień. Jedna z następujących wartości:

- HITRESULT_OUTSIDE *ptlLoc* znajduje się poza obiektem OLE i nie jest zamykany.

- HITRESULT_TRANSPARENT *ptlLoc* znajduje się w granicach obiektu OLE, ale nie blisko obrazu. Na przykład, można HITRESULT_TRANSPARENT punkt w środku przezroczystego okręgu.

- HITRESULT_CLOSE *ptlLoc* znajduje się wewnątrz lub na zewnątrz obiektu OLE, ale wystarczająco blisko obiektu, który ma być brany pod uwagę. Małe, cienkie lub szczegółowe obiekty mogą używać tej wartości. Nawet wtedy, gdy punkt znajduje się poza granicami prostokątnymi obiektu, może nadal być zamknięty (jest to potrzebne do naciśnięcia małych obiektów).

- HITRESULT_HIT *ptlLoc* znajduje się w obrazie obiektu.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli wynik trafień został pomyślnie zwrócony; w przeciwnym razie 0. Trafienie pokrywa się z obszarem wyświetlania kontrolki OLE.

### <a name="remarks"></a>Uwagi

Pyta, czy prostokąt wyświetlania obiektu pokrywa się z danym punktem (trafień punktu). `QueryHitPoint` można przesłonić do trafień testowych dla nieprostokątnych obiektów.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a> COleControl::OnQueryHitRect

Wywoływane przez platformę w odpowiedzi na `IViewObjectEx::QueryHitRect` żądanie kontenera.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Określa sposób reprezentowania obiektu. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2.

*pRectBounds*<br/>
Wskaźnik na `RECT` strukturę, określając prostokąt ograniczający obszar klienta kontrolki OLE.

*prcLoc*<br/>
Wskaźnik do struktury, który `RECT` Określa prostokąt do sprawdzenia dla trafienia (pokrywa się z prostokątem obiektu) względem lewego górnego rogu obiektu.

*lCloseHint*<br/>
Nie używany.

*pHitResult*<br/>
Wskaźnik do wyniku zapytania trafień. Jedna z następujących wartości:

- HITRESULT_OUTSIDE żaden punkt w prostokącie nie jest trafiony przez obiekt OLE.

- HITRESULT_HIT co najmniej jeden punkt w prostokącie będzie trafiony na obiekcie.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli wynik trafień został pomyślnie zwrócony; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Pyta, czy prostokąt wyświetlania obiektu nakłada się na wszystkie punkty w danym prostokącie (trafi prostokąt). `QueryHitRect` można przesłonić do trafień testowych dla nieprostokątnych obiektów.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a> COleControl::OnRenderData

Wywoływane przez platformę, by pobrać dane w określonym formacie.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskazuje strukturę [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , określając format, w którym informacje są żądane.

*lpStgMedium*<br/>
Wskazuje strukturę [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , w której mają zostać zwrócone dane.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Określony format jest jednym wcześniej umieszczonym w obiekcie sterowania przy użyciu funkcji Członkowskich [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) lub [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) do opóźnionego renderowania. Domyślna implementacja tej funkcji wywołuje `OnRenderFileData` lub `OnRenderGlobalData` , odpowiednio, jeśli dostarczony nośnik magazynu jest plikiem lub pamięcią. Jeśli żądany format jest CF_METAFILEPICT lub format trwałego zestawu właściwości, domyślna implementacja renderuje odpowiednie dane i zwraca wartość różną od zera. W przeciwnym razie zwraca wartość 0 i nic nie robi.

W przypadku TYMED_NULL *lpStgMedium->TYMED* jest przydzielone i wypełniane jako określone przez *lpFormatEtc->TYMED*. Jeśli nie TYMED_NULL, STGMEDIUM powinny być wypełnione danymi.

Zastąp tę funkcję, aby zapewnić dane w żądanym formacie i średnim. W zależności od danych warto zamiast tego zastąpić jedną z innych wersji tej funkcji. Jeśli dane są małe i stały się w rozmiarze, Przesłoń `OnRenderGlobalData` . Jeśli dane są w pliku lub mają zmienny rozmiar, Przesłoń `OnRenderFileData` .

Aby uzyskać więcej informacji, zobacz `FORMATETC` `STGMEDIUM` struktury i w Windows SDK.

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a> COleControl::OnRenderFileData

Wywoływane przez platformę, by pobrać dane w określonym formacie, gdy nośnik magazynu jest plikiem.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskazuje strukturę [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , określając format, w którym informacje są żądane.

*pFile*<br/>
Wskazuje obiekt [CFile](../../mfc/reference/cfile-class.md) , w którym mają być renderowane dane.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Określony format jest jednym wcześniej umieszczonym w obiekcie sterowania przy użyciu funkcji składowej [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) do opóźnionego renderowania. Domyślna implementacja tej funkcji po prostu zwraca wartość FALSE.

Zastąp tę funkcję, aby zapewnić dane w żądanym formacie i średnim. W zależności od danych warto zamiast tego zastąpić jedną z innych wersji tej funkcji. Jeśli chcesz obsłużyć wiele nośników magazynowania, Przesłoń `OnRenderData` . Jeśli dane są w pliku lub mają zmienny rozmiar, Przesłoń `OnRenderFileData` .

Aby uzyskać więcej informacji, zobacz `FORMATETC` strukturę w Windows SDK.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a> COleControl::OnRenderGlobalData

Wywoływane przez platformę, aby pobrać dane w określonym formacie, gdy określony nośnik magazynu ma pamięć globalną.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskazuje strukturę [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , określając format, w którym informacje są żądane.

*phGlobal*<br/>
Wskazuje dojście do pamięci globalnej, w której mają zostać zwrócone dane. Jeśli żadna pamięć nie została przypisana, ten parametr może mieć wartość NULL.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Określony format jest jednym wcześniej umieszczonym w obiekcie sterowania przy użyciu funkcji składowej [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) do opóźnionego renderowania. Domyślna implementacja tej funkcji po prostu zwraca wartość FALSE.

Jeśli *phGlobal* ma wartość null, należy alokować i zwrócić nową HGLOBAL w *phGlobal*. W przeciwnym razie HGLOBAL określona przez *phGlobal* powinna być wypełniony danymi. Ilość danych umieszczonych w HGLOBAL nie może przekraczać bieżącego rozmiaru bloku pamięci. Ponadto nie można zmienić przydziału bloku na większy rozmiar.

Zastąp tę funkcję, aby zapewnić dane w żądanym formacie i średnim. W zależności od danych warto zamiast tego zastąpić jedną z innych wersji tej funkcji. Jeśli chcesz obsłużyć wiele nośników magazynowania, Przesłoń `OnRenderData` . Jeśli dane są w pliku lub mają zmienny rozmiar, Przesłoń `OnRenderFileData` .

Aby uzyskać więcej informacji, zobacz `FORMATETC` strukturę w Windows SDK.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a> COleControl:: OnResetState

Wywoływane przez platformę, gdy właściwości kontrolki powinny mieć ustawioną wartość domyślną.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Uwagi

Domyślne wywołania implementacji [DoPropExchange](#dopropexchange), przekazywanie obiektu, `CPropExchange` który powoduje, że właściwości mają ustawioną wartość domyślną.

Moduł zapisujący kontroli może wstawić kod inicjujący dla kontrolki OLE w tym obiekcie. Ta funkcja jest wywoływana, gdy [IPersistStream:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) lub [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) nie powiedzie się, lub [IPersistStreamInit:: InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) lub [IPersistStorage:: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) jest wywoływana, bez uprzedniego wywołania albo `IPersistStream::Load` `IPersistStorage::Load` .

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a> COleControl:: OnSetClientSite

Wywoływane przez platformę, gdy kontener wywołuje funkcję kontrolki `IOleControl::SetClientSite` .

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Uwagi

Domyślnie program `OnSetClientSite` sprawdza, czy właściwości ścieżki danych są załadowane i, jeśli są, wywołuje `DoDataPathPropExchange` .

Zastąp tę funkcję, aby wykonać wszelkie specjalne przetwarzanie tego powiadomienia. W szczególności zastąpienia tej funkcji powinny wywołać klasę bazową.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a> COleControl:: OnSetData

Wywoływane przez platformę, aby zastąpić dane kontrolki określonymi danymi.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) , który określa format danych.

*lpStgMedium*<br/>
Wskaźnik do struktury [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) , w której znajdują się dane.

*bRelease*<br/>
PRAWDA, jeśli formant powinien zwolnić nośnik magazynu; Wartość FALSE, jeśli formant nie powinien zwalniać nośnika magazynu.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli dane są w formacie trwałego zestawu właściwości, domyślna implementacja odpowiednio modyfikuje stan formantu. W przeciwnym razie domyślna implementacja nic nie robi. Jeśli *bRelease* ma wartość true, wywołanie `ReleaseStgMedium` jest wykonywane; w przeciwnym razie nie.

Zastąp tę funkcję, aby zastąpić dane kontrolki określonymi danymi.

Aby uzyskać więcej informacji, zobacz `FORMATETC` `STGMEDIUM` struktury i w Windows SDK.

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a> COleControl::OnSetExtent

Wywoływane przez platformę, gdy zakres kontrolki musi zostać zmieniony w wyniku wywołania [IOleObject:: setzakres](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parametry

*lpSizeL*<br/>
Wskaźnik do `SIZEL` struktury używającej długich liczb całkowitych, aby reprezentować szerokość i wysokość kontrolki wyrażoną w jednostkach HIMETRIC.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli zmiana rozmiaru została zaakceptowana; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja obsługuje zmianę rozmiaru zakresu formantu. Jeśli kontrolka znajduje się w miejscu aktywnym, wywołanie kontenera `OnPosRectChanged` zostanie wykonane.

Zastąp tę funkcję, aby zmienić domyślną zmianę rozmiarów formantu.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a> COleControl::OnSetObjectRects

Wywoływane przez platformę, by zaimplementować wywołanie [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parametry

*lpRectPos*<br/>
Wskaźnik do `RECT` struktury wskazujący nową pozycję i rozmiar kontrolki względem kontenera.

*lpRectClip*<br/>
Wskaźnik do `RECT` struktury wskazującej prostokątny obszar, do którego ma zostać przycięty formant.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli zmiana położenia została zaakceptowana; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja automatycznie obsługuje zmianę położenia i zmianę rozmiarów okna kontroli i zwraca wartość TRUE.

Zastąp tę funkcję, aby zmienić zachowanie domyślne tej funkcji.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a> COleControl::OnShowToolBars

Wywoływane przez platformę, gdy aktywowano kontrolkę interfejsu użytkownika.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja nie robi nic.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a> COleControl:: OnTextChanged.

Wywoływane przez platformę, gdy zmieniono wartość właściwości Caption lub text.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Uwagi

Domyślne wywołania implementacji `InvalidateControl` .

Zastąp tę funkcję, jeśli chcesz, aby powiadomienie działało po zmianie tej właściwości.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a> COleControl::OnWindowlessMessage

Wywoływane przez platformę w odpowiedzi na `IOleInPlaceObjectWindowless::OnWindowMessage` żądanie kontenera.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parametry

*msg*<br/>
Identyfikator komunikatu, który został przesłany przez system Windows.

*wParam*<br/>
Zgodnie z oczekiwaniami systemu Windows. Określa dodatkowe informacje dotyczące wiadomości. Zawartość tego parametru zależy od wartości parametru *MSG* .

*lParam*<br/>
Zgodnie z oczekiwaniami systemu Windows. Określa dodatkowe informacje dotyczące wiadomości. Zawartość tego parametru zależy od wartości parametru *MSG* .

*plResult*<br/>
Kod wyniku systemu Windows. Określa wynik przetwarzania komunikatów i zależy od wysyłanej wiadomości.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Przetwarza komunikaty okna dla kontrolek bez okien. `COleControl``OnWindowlessMessage`należy używać w przypadku komunikatów okna innych niż komunikaty myszy i komunikaty z klawiatury. `COleControl` udostępnia funkcję [setcapture](#setcapture) i [SetFocus](#setfocus) w celu uzyskania funkcji przechwytywania myszy i fokusu klawiatury dla obiektów OLE bez okien.

Ponieważ obiekty bez okien nie mają okna, muszą one mieć mechanizm zezwalający na wysyłanie komunikatów do kontenera. Obiekt OLE bez okien pobiera komunikaty z kontenera za pośrednictwem `OnWindowMessage` metody `IOleInPlaceObjectWindowless` interfejsu (rozszerzenie [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) do obsługi bez okien). `OnWindowMessage` nie przyjmuje `HWND` parametru.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a> COleControl::P arentToClient

Tłumaczy współrzędne *pPoint* na współrzędne klienta.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Wskaźnik do granic formantu OLE w kontenerze. Nie jest to obszar klienta, ale obszar całej kontrolki, w tym obramowania i paski przewijania.

*pPoint*<br/>
Wskaźnik do punktu nadrzędnego (kontenera) do przetłumaczenia na współrzędne obszaru klienta kontrolki.

*bHitTest*<br/>
Określa, czy testy trafień mają być wykonywane w punkcie.

### <a name="return-value"></a>Wartość zwracana

Jeśli *bHitTest* ma wartość false, zwraca HTNOWHERE. Jeśli *bHitTest* ma wartość true, zwraca lokalizację, w której punkt nadrzędny (kontenera) jest wyładowany w obszarze klienta kontrolki OLE i jest jednym z następujących trafień myszy:

- HTBORDER w obramowaniu okna, które nie ma obramowania zmieniającego rozmiar.

- HTBOTTOM w dolnym poziomie obramowania okna.

- HTBOTTOMLEFT w lewym dolnym rogu obramowania okna.

- HTBOTTOMRIGHT w prawym dolnym rogu obramowania okna.

- HTCAPTION w obszarze paska tytułu.

- HTCLIENT w obszarze klienta.

- HTERROR na tle ekranu lub w linii podziału między oknami (tak samo jak HTNOWHERE, z tą różnicą, że `DefWndProc` Funkcja systemu Windows generuje dźwięk systemu w celu wskazania błędu).

- HTGROWBOX w polu rozmiar.

- HTHSCROLL na poziomym pasku przewijania.

- HTLEFT w lewej krawędzi okna.

- HTMAXBUTTON na przycisku Maksymalizuj.

- HTMENU w obszarze menu.

- HTMINBUTTON na przycisk Minimalizuj.

- HTNOWHERE na tle ekranu lub w linii podziału między oknami.

- HTREDUCE na przycisk Minimalizuj.

- HTRIGHT w prawej krawędzi okna.

- HTSIZE w polu rozmiaru (tak samo jak HTGROWBOX).

- HTSYSMENU w menu sterowania lub przycisk Zamknij w oknie podrzędnym.

- HTTOP w górnym obramowaniu w poziomie okna.

- HTTOPLEFT w lewym górnym rogu obramowania okna.

- HTTOPRIGHT w prawym górnym rogu obramowania okna.

- HTTRANSPARENT w oknie obecnie objętym innym oknem.

- HTVSCROLL na pionowym pasku przewijania.

- HTZOOM na przycisku Maksymalizuj.

### <a name="remarks"></a>Uwagi

Na wejściu *pPoint* jest określana względem źródła elementu nadrzędnego (górnego lewego rogu kontenera). W danych wyjściowych *pPoint* jest określana względem początku obszaru klienckiego kontrolki OLE (lewy górny róg obszaru klienta kontrolki).

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a> COleControl::P ostModalDialog

Powiadamia kontener o zamknięciu modalnego okna dialogowego.

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndParent*<br/>
Dojście do okna nadrzędnego modalnego okna dialogowego.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję po wyświetleniu dowolnych modalnych okien dialogowych. Należy wywołać tę funkcję, aby umożliwić kontenerowi włączenie wszystkich okien najwyższego poziomu, które są wyłączone przez program `PreModalDialog` . Ta funkcja powinna być sparowana z wywołaniem metody `PreModalDialog` .

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a> COleControl::P reModalDialog

Powiadamia kontener, aby wyświetlić modalne okno dialogowe.

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndParent*<br/>
Dojście do okna nadrzędnego modalnego okna dialogowego.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję przed wyświetleniem dowolnego modalnego okna dialogowego. Należy wywołać tę funkcję, aby kontener mógł wyłączyć wszystkie okna najwyższego poziomu. Po wyświetleniu modalnego okna dialogowego należy wywołać polecenie `PostModalDialog` .

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a> COleControl::RecreateControlWindow

Niszczy i odtwarza okno kontrolki.

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>Uwagi

Może to być konieczne, jeśli trzeba zmienić bity stylu okna.

## <a name="colecontrolrefresh"></a><a name="refresh"></a> COleControl:: Refresh

Wymusza odświeżenie formantu OLE.

```cpp
void Refresh();
```

### <a name="remarks"></a>Uwagi

Ta funkcja jest obsługiwana przez `COleControl` klasę bazową jako metoda giełdowa o nazwie Refresh. Umożliwia to użytkownikom formantu OLE odświeżenie kontrolki w określonym czasie. Aby uzyskać więcej informacji na temat tej metody, zobacz artykuł [formanty ActiveX: metody](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a> COleControl::ReleaseCapture

Zwalnia przechwytywanie myszy.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli kontrolka ma obecnie funkcję przechwytywania myszy, przechwytywanie zostanie wydane. W przeciwnym razie ta funkcja nie ma żadnego wpływu.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a> COleControl:: ReleaseDC

Zwalnia kontekst urządzenia wyświetlania kontenera kontroli bez okien, zwalniając kontekst urządzenia do użytku przez inne aplikacje.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*Domeny*<br/>
Określa kontekst urządzenia kontenera do zwolnienia.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aplikacja musi wywołać `ReleaseDC` dla każdego wywołania do [GetDC —](#getdc).

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a> COleControl::ReparentControlWindow

Ustawia element nadrzędny formantu.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parametry

*hWndOuter*<br/>
Uchwyt okna kontrolki.

*hWndParent*<br/>
Uchwyt nowego okna nadrzędnego.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, aby zresetować element nadrzędny okna kontroli.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a> COleControl::ResetStockProps

Inicjuje stan `COleControl` właściwości podstawowych do ich wartości domyślnych.

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>Uwagi

Właściwości to: wyglądu, BackColor, obramowania, napis, Enabled, Font, ForeColor, hWnd i Text. Aby uzyskać opis właściwości podstawowych, zobacz [kontrolki ActiveX: Dodawanie właściwości podstawowych](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Można poprawić wydajność inicjacji binarnej kontrolki za pomocą `ResetStockProps` i `ResetVersion` przesłonić `COleControl::OnResetState` . Zobacz przykład poniżej. Aby uzyskać więcej informacji na temat optymalizacji inicjalizacji, zobacz [kontrolki ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a> COleControl::ResetVersion

Inicjuje numer wersji w określonej wartości.

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parametry

*dwVersionDefault*<br/>
Numer wersji, który ma zostać przypisany do kontrolki.

### <a name="remarks"></a>Uwagi

Można poprawić wydajność inicjacji binarnej kontrolki za pomocą `ResetVersion` i `ResetStockProps` przesłonić `COleControl::OnResetState` . Zobacz przykład pod adresem [ResetStockProps](#resetstockprops). Aby uzyskać więcej informacji na temat optymalizacji inicjalizacji, zobacz [kontrolki ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a> COleControl::ScrollWindow

Umożliwia niezależnym obiektom OLE przewinięcie obszaru w obrazie aktywnym na ekranie.

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*xAmount*<br/>
Określa liczbę w jednostkach urządzeń w poziomie przewijania poziomego. Ten parametr musi być wartością ujemną, aby przewijać w lewo.

*yAmount*<br/>
Określa ilość w jednostkach urządzenia, przewijanie w pionie. Ten parametr musi być wartością ujemną, aby przewijać w górę.

*lpRect*<br/>
Wskazuje na obiekt [CRect](../../atl-mfc-shared/reference/crect-class.md) lub strukturę Rect, która określa część obszaru klienckiego obiektu OLE do przewinięcia, we współrzędnych klienta okna zawierającego. Jeśli *lpRect* ma wartość null, cały obszar klienta obiektu OLE jest przewijany.

*lpClipRect*<br/>
Wskazuje `CRect` obiekt lub `RECT` strukturę, która określa prostokąt do przycinania. Przewijane są tylko piksele wewnątrz prostokąta. Nie ma to żadnego oddziaływania na bity poza prostokątem, nawet jeśli znajdują się w prostokącie *lpRect* . Jeśli *lpClipRect* ma wartość null, żadne przycinanie nie jest wykonywane w prostokącie przewijania.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a> COleControl::SelectFontObject

Wybiera czcionkę w kontekście urządzenia.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*Domeny*<br/>
Wskaźnik do obiektu kontekstu urządzenia.

*fontHolder*<br/>
Odwołanie do obiektu [CFontHolder](../../mfc/reference/cfontholder-class.md) reprezentującego czcionkę do wybrania.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do wcześniej zaznaczonej czcionki. Gdy obiekt wywołujący zakończył wszystkie operacje rysowania, które używają *fontHolder,* należy wybrać wcześniej wybraną czcionkę, przekazując ją jako parametr do [przechwytywania:: SelectObject](../../mfc/reference/cdc-class.md#selectobject).

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a> COleControl::SelectStockFont

Wybiera Właściwość "podstawowe czcionki" w kontekście urządzenia.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*Domeny*<br/>
Kontekst urządzenia, do którego zostanie wybrana czcionka.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do poprzednio wybranego `CFont` obiektu. Należy użyć funkcji [przechwytywania:: SelectObject](../../mfc/reference/cdc-class.md#selectobject) , aby wybrać tę czcionkę z powrotem do kontekstu urządzenia po zakończeniu.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a> COleControl::SerializeExtent

Deserializacji lub inicjuje stan obszaru wyświetlania przypisanego do kontrolki.

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*ty*<br/>
`CArchive`Obiekt do serializacji do lub z.

### <a name="remarks"></a>Uwagi

Można poprawić wydajność danych binarnych formantu `SerializeExtent` , używając, `SerializeStockProps` , i `SerializeVersion` Aby przesłonić `COleControl::Serialize` . Zobacz przykład poniżej. Aby uzyskać więcej informacji na temat optymalizacji inicjalizacji, zobacz [kontrolki ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a> COleControl::SerializeStockProps

Deserializacji lub inicjuje stan `COleControl` właściwości podstawowych: wygląd, kolor nieaktywny, obramowanie, napisy, włączone, czcionki, ForeColor i tekst.

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*ty*<br/>
`CArchive`Obiekt do serializacji do lub z.

### <a name="remarks"></a>Uwagi

Aby uzyskać opis właściwości podstawowych, zobacz [kontrolki ActiveX: Dodawanie właściwości podstawowych](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Można poprawić wydajność danych binarnych formantu `SerializeStockProps` , używając, `SerializeExtent` , i `SerializeVersion` Aby przesłonić `COleControl::Serialize` . Aby zapoznać się z przykładem, zobacz kod w [SerializeExtent](#serializeextent). Aby uzyskać więcej informacji na temat optymalizacji inicjalizacji, zobacz [kontrolki ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a> COleControl::SerializeVersion

Deserializacji lub inicjuje stan informacji o wersji formantu.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*ty*<br/>
`CArchive`Obiekt do serializacji do lub z.

*dwVersionDefault*<br/>
Numer bieżącej wersji formantu.

*bConvert*<br/>
Wskazuje, czy trwałe dane mają być konwertowane do najnowszego formatu podczas jego zapisywania lub obsługiwane w tym samym formacie, w jakim zostały załadowane.

### <a name="return-value"></a>Wartość zwracana

Numer wersji formantu. W przypadku ładowania określonego archiwum `SerializeVersion` Funkcja zwraca wersję załadowana z tego archiwum. W przeciwnym razie zwraca aktualnie załadowanej wersji.

### <a name="remarks"></a>Uwagi

Można poprawić wydajność danych binarnych formantu `SerializeVersion` , używając, `SerializeExtent` , i `SerializeStockProps` Aby przesłonić `COleControl::Serialize` . Aby zapoznać się z przykładem, zobacz kod w [SerializeExtent](#serializeextent). Aby uzyskać więcej informacji na temat optymalizacji inicjalizacji, zobacz [kontrolki ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a> COleControl:: setpozornie

Ustawia wartość właściwości wygląd akcji formantu.

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parametry

*sAppearance*<br/>
**`short`** Wartość (VT_I2), która ma być używana na potrzeby wyglądu kontrolki. Wartość zerowa ustawia wygląd kontrolki na płaski, a wartość 1 ustawia wygląd kontrolki na 3D.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji o właściwościach podstawowych, zobacz [kontrolki ActiveX: właściwości](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a> COleControl::SetBackColor

Ustawia wartość właściwości niekolorowego koloru formantu.

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parametry

*dwBackColor*<br/>
Wartość OLE_COLOR używana do rysowania w tle formantu.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji na temat używania tej właściwości i innych powiązanych właściwości, zobacz artykuł [formanty ActiveX: właściwości](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a> COleControl:: setborderer

Ustawia wartość właściwości Borderer dla kontrolki.

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parametry

*sBorderStyle*<br/>
Nowy styl obramowania kontrolki; wartość 0 oznacza brak obramowania i 1 oznacza normalne obramowanie.

### <a name="remarks"></a>Uwagi

Okno sterowania zostanie następnie ponownie utworzone i `OnBorderStyleChanged` wywołane.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a> COleControl:: setcapture

Powoduje, że okno kontenera kontrolki będzie miało przechwycenie myszy w imieniu formantu.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do `CWnd` obiektu okna, który otrzymał wcześniej dane wejściowe myszy.

### <a name="remarks"></a>Uwagi

Jeśli formant jest aktywowany i bez okna, ta funkcja powoduje, że okno kontenera kontrolki przechwytuje funkcję przechwycenia myszy w imieniu formantu. W przeciwnym razie ta funkcja powoduje, że sama kontrolka będzie posiadała przechwycenie myszy (tak samo jak `CWnd::SetCapture` ).

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a> COleControl::SetControlSize

Ustawia rozmiar okna formantu OLE i powiadamia kontener, który zmienia lokację sterowania.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parametry

*CX*<br/>
Określa nową szerokość formantu w pikselach.

*cy*<br/>
Określa nową wysokość formantu w pikselach.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja nie powinna być używana w konstruktorze formantu.

Należy zauważyć, że wszystkie współrzędne okna sterowania są względne w lewym górnym rogu kontrolki.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a> COleControl:: SetEnabled

Ustawia wartość właściwości z włączonymi zapasami dla kontrolki.

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parametry

*bEnabled*<br/>
Ma wartość TRUE, Jeśli kontrolka ma być włączona. w przeciwnym razie FALSE.

### <a name="remarks"></a>Uwagi

Po ustawieniu tej właściwości `OnEnabledChange` jest wywoływana.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a> COleControl:: SetFocus

Powoduje, że okno kontenera kontrolki będzie miało fokus wejścia w imieniu formantu.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do `CWnd` obiektu okna, który wcześniej miał fokus wprowadzania, lub wartość null, jeśli nie ma takiego okna.

### <a name="remarks"></a>Uwagi

Jeśli kontrolka jest aktywowana i bez okna, ta funkcja powoduje, że okno kontenera kontrolki będzie miało fokus wprowadzania danych w imieniu formantu. Fokus wejściowy kieruje dane wejściowe z klawiatury do okna kontenera, a kontener wysyła wszystkie kolejne komunikaty klawiatury do obiektu OLE, który wywołuje `SetFocus` . Każde okno, które wcześniej miało fokus wprowadzania, utraci go.

Jeśli formant nie jest bez okna, ta funkcja powoduje, że sama kontrolka będzie posiadała fokus wprowadzania (analogicznie jak `CWnd::SetFocus` ).

## <a name="colecontrolsetfont"></a><a name="setfont"></a> COleControl:: SetFont

Ustawia właściwość czcionki giełdowej formantu.

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parametry

*pFontDisp*<br/>
Wskaźnik do interfejsu wysyłania czcionki.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a> COleControl:: setforecolor

Ustawia wartość właściwości ForeColor zasobu formantu.

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parametry

*dwForeColor*<br/>
Wartość OLE_COLOR, która będzie używana dla rysowania pierwszego planu formantu.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji na temat używania tej właściwości i innych powiązanych właściwości, zobacz artykuł [formanty ActiveX: właściwości](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a> COleControl::SetInitialDataFormats

Wywoływane przez platformę, aby zainicjować listę formatów danych obsługiwanych przez formant.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja określa dwa formaty: CF_METAFILEPICT i trwały zestaw właściwości.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a> COleControl::SetInitialSize

Ustawia rozmiar kontrolki OLE podczas pierwszego wyświetlania w kontenerze.

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parametry

*CX*<br/>
Początkowa szerokość kontrolki OLE w pikselach.

*cy*<br/>
Początkowa wysokość formantu OLE w pikselach.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję w konstruktorze, aby ustawić początkowy rozmiar kontrolki. Początkowy rozmiar jest mierzony w jednostkach urządzeń lub w pikselach. Zaleca się, aby to wywołanie zostało wykonane w konstruktorze kontrolki.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a> COleControl::SetModifiedFlag

Zmienia zmodyfikowany stan kontrolki.

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parametry

*bModified*<br/>
Nowa wartość flagi zmodyfikowanej kontrolki. Wartość TRUE wskazuje, że stan kontrolki został zmodyfikowany; Wartość FALSE wskazuje, że stan formantu został właśnie zapisany.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, gdy nastąpi zmiana, która wpłynie na trwały stan kontrolki. Na przykład jeśli wartość trwałej zmiany właściwości, Wywołaj tę funkcję z *bModified* **true**.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a> COleControl::SetNotPermitted

Wskazuje, że żądanie edycji nie powiodło się.

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję w przypadku `BoundPropertyRequestEdit` niepowodzenia. Ta funkcja zgłasza wyjątek typu `COleDispScodeException` w celu wskazania, że operacja ustawiania jest niedozwolona.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a> COleControl::SetNotSupported

Zapobiega modyfikacji wartości właściwości kontrolki przez użytkownika.

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję zamiast funkcji set właściwości, gdzie modyfikacja wartości właściwości przez użytkownika kontrolki nie jest obsługiwana. Przykładem może być właściwość, która jest tylko do odczytu.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a> COleControl::SetRectInContainer

Ustawia współrzędne prostokąta kontrolki względem kontenera wyrażone w jednostkach urządzeń.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpRect*<br/>
Wskaźnik do prostokąta zawierający nowe współrzędne kontrolki względem kontenera.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli kontrolka jest otwarta, rozmiar jest zmieniany; w przeciwnym razie `OnPosRectChanged` wywoływana jest funkcja kontenera.

## <a name="colecontrolsettext"></a><a name="settext"></a> COleControl::SetText

Ustawia wartość napisu lub właściwości text kontrolki.

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parametry

*pszText*<br/>
Wskaźnik do ciągu znaków.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że podpisy giełdowe i właściwości tekstu są zamapowane na tę samą wartość. Oznacza to, że wszelkie zmiany wprowadzone w każdej z tych właściwości będą automatycznie zmieniać obie właściwości. Ogólnie rzecz biorąc formant powinien obsługiwać podpis lub właściwość text, ale nie oba jednocześnie.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a> COleControl:: ThrowError

Sygnalizuje wystąpienie błędu w kontrolce.

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*polecenia*<br/>
Wartość kodu stanu do zgłoszenia. Aby uzyskać pełną listę możliwych kodów, zobacz artykuł [formanty ActiveX: Tematy zaawansowane](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
Identyfikator zasobu ciągu wyjątku, który ma zostać zgłoszony.

*nHelpID*<br/>
Identyfikator pomocy tematu do zgłoszenia.

*pszDescription*<br/>
Ciąg zawierający wyjaśnienie wyjątku, który ma zostać zgłoszony.

### <a name="remarks"></a>Uwagi

Ta funkcja powinna być wywoływana tylko z poziomu funkcji get lub Set dla właściwości OLE albo implementacja metody automatyzacji OLE. Jeśli trzeba będzie sygnalizować błędy występujące w innym czasie, należy uruchomić wydarzenie błędu giełdowego.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a> COleControl::TransformCoords

Transformuje wartości współrzędnych między jednostkami HIMETRIC i natywnymi jednostkami kontenera.

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parametry

*lpptlHimetric*<br/>
Wskaźnik do `POINTL` struktury zawierającej współrzędne w jednostkach HIMETRIC.

*lpptfContainer*<br/>
Wskaźnik do `POINTF` struktury zawierającej współrzędne w rozmiarze jednostki kontenera.

*flagi*<br/>
Kombinacja następujących wartości:

- XFORMCOORDS_POSITION pozycji w kontenerze.

- XFORMCOORDS_SIZE rozmiar w kontenerze.

- XFORMCOORDS_HIMETRICTOCONTAINER Przekształć jednostki HIMETRIC na jednostki kontenera.

- XFORMCOORDS_CONTAINERTOHIMETRIC Przekształć jednostki kontenera na jednostki HIMETRIC.

### <a name="remarks"></a>Uwagi

Pierwsze dwie flagi, XFORMCOORDS_POSITION i XFORMCOORDS_SIZE, wskazują, czy współrzędne powinny być traktowane jako położenie czy rozmiar. Pozostałe dwie flagi wskazują kierunek transformacji.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a> COleControl::TranslateColor

Konwertuje wartość koloru z typu danych OLE_COLOR na typ danych [COLORREF](/windows/win32/gdi/colorref) .

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parametry

*clrColor*<br/>
Typ danych OLE_COLOR. Aby uzyskać więcej informacji, zobacz Funkcja [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) systemu Windows.

*hpal*<br/>
Dojście do opcjonalnej palety; może mieć wartość NULL.

### <a name="return-value"></a>Wartość zwracana

Kolor RGB (czerwony, zielony, niebieski) 32-bitowy, który definiuje pełny kolor zbliżony do wartości *clrColor* , którą urządzenie może reprezentować.

### <a name="remarks"></a>Uwagi

Ta funkcja przydaje się do tłumaczenia właściwości ForeColor i BackColor magazynu na typy COLORREF używane przez funkcje Członkowskie funkcji [przechwytywania](../../mfc/reference/cdc-class.md) .

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a> COleControl::WillAmbientsBeValidDuringLoad

Określa, czy kontrolka ma używać wartości właściwości otoczenia jako wartości domyślnych, gdy zostanie następnie załadowana ze stanu trwałego.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różna od zera wskazuje, że właściwości otoczenia będą prawidłowe. właściwości otoczenia w przeciwnym razie nie będą prawidłowe.

### <a name="remarks"></a>Uwagi

W niektórych kontenerach formant może nie mieć dostępu do właściwości otoczenia podczas początkowego wywołania do zastąpienia `COleControl::DoPropExchange` . Jest tak w przypadku, gdy kontener wywołuje [IPersistStreamInit:: Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) lub [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) przed wywołaniem [IOleObject:: SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (to oznacza, że nie będzie on uznawany za bit stanu OLEMISC_SETCLIENTSITEFIRST).

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a> COleControl::WindowProc

Zawiera procedurę systemu Windows dla `COleControl` obiektu.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametry

*Komunikat*<br/>
Określa komunikat systemu Windows, który ma zostać przetworzony.

*wParam*<br/>
Zawiera dodatkowe informacje używane podczas przetwarzania komunikatu. Wartość parametru zależy od komunikatu.

*lParam*<br/>
Zawiera dodatkowe informacje używane podczas przetwarzania komunikatu. Wartość parametru zależy od komunikatu.

### <a name="return-value"></a>Wartość zwracana

Wartość zwrotna wysłanej wiadomości.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, aby wysyłać określone wiadomości za pomocą mapy komunikatów kontrolki.

## <a name="see-also"></a>Zobacz też

[Przykład CIRC3 MFC](../../overview/visual-cpp-samples.md)<br/>
[Przykład TESTHELP MFC](../../overview/visual-cpp-samples.md)<br/>
[Klasa COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Klasa CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Wykres hierarchii](../../mfc/hierarchy-chart.md)<br/>
[Klasa CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Klasa CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
