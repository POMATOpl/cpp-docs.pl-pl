---
title: Colecontrol — klasa | Dokumentacja firmy Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 0b2a9f7a506c5ebc1d6fdf1a37960a9322fde131
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/04/2018
---
# <a name="colecontrol-class"></a>Colecontrol — klasa
Zaawansowane klasę podstawową dla Programowanie formantów OLE.  
  
## <a name="syntax"></a>Składnia  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>Elementy członkowskie  
  
### <a name="public-constructors"></a>Konstruktory publiczne  
  
|Nazwa|Opis|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|Tworzy `COleControl` obiektu.|  
  
### <a name="public-methods"></a>Metody publiczne  
  
|Nazwa|Opis|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|Pobiera bieżący wygląd formantu.|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|Zwraca wartość właściwości BackColor otoczenia.|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Zwraca nazwę formantu określony przez kontener.|  
|[COleControl::AmbientFont](#ambientfont)|Zwraca wartość właściwości Font otoczenia.|  
|[COleControl::AmbientForeColor](#ambientforecolor)|Zwraca wartość właściwości ForeColor w otaczającym.|  
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Zwraca identyfikator kontenera ustawień regionalnych.|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Zwraca typ jednostek używanych przez kontener.|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Określa, czy powinny być wyświetlane uchwytów.|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Określa, czy powinny być wyświetlane kreskowaniu.|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|Zwraca typ określony przez kontener wyrównania tekstu.|  
|[COleControl::AmbientUIDead](#ambientuidead)|Określa, jeśli formant powinno odpowiedzieć na działania interfejsu użytkownika.|  
|[COleControl::AmbientUserMode](#ambientusermode)|Określa tryb kontenera.|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Powiadamia kontenera zmieniono właściwości powiązania.|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Żądania uprawnień do edycji jej wartości.|  
|[COleControl::ClientToParent](#clienttoparent)|Wykonuje translację punktu względem źródła formantu do punktu względem źródła swojego kontenera.|  
|[COleControl::ClipCaretRect](#clipcaretrect)|Dopasowuje prostokąt karetki, jeśli zachodzi się przez formant.|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|Wywołanie tej funkcji po zmianie zestaw klawiszy skrótu obsługiwane przez formant.|  
|[COleControl::DisplayError](#displayerror)|Wyświetla zdarzenia błędów standardowych do kontrolki użytkownika.|  
|[COleControl::DoClick](#doclick)|Implementacja zasobów `DoClick` metody.|  
|[COleControl::DoPropExchange](#dopropexchange)|Serializuje właściwości `COleControl` obiektu.|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Ponownie rysuje kontrolkę OLE, która została podklasą klasy z kontrolki systemu Windows.|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Umożliwia obsługę prostych ramki formantu.|  
|[COleControl::ExchangeExtent](#exchangeextent)|Serializuje szerokość i wysokość formantu.|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializuje standardowych właściwości formantu.|  
|[COleControl::ExchangeVersion](#exchangeversion)|Serializuje numer wersji formantu.|  
|[COleControl::FireClick](#fireclick)|Zasoby generowane `Click` zdarzeń.|  
|[COleControl::FireDblClick](#firedblclick)|Zasoby generowane `DblClick` zdarzeń.|  
|[COleControl::FireError](#fireerror)|Zasoby generowane `Error` zdarzeń.|  
|[COleControl::FireEvent](#fireevent)|Wyzwala zdarzenie niestandardowe.|  
|[COleControl::FireKeyDown](#firekeydown)|Zasoby generowane `KeyDown` zdarzeń.|  
|[COleControl::FireKeyPress](#firekeypress)|Zasoby generowane `KeyPress` zdarzeń.|  
|[COleControl::FireKeyUp](#firekeyup)|Zasoby generowane `KeyUp` zdarzeń.|  
|[COleControl::FireMouseDown](#firemousedown)|Zasoby generowane `MouseDown` zdarzeń.|  
|[COleControl::FireMouseMove](#firemousemove)|Zasoby generowane `MouseMove` zdarzeń.|  
|[COleControl::FireMouseUp](#firemouseup)|Zasoby generowane `MouseUp` zdarzeń.|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|Wyzwala zdarzenie po zmianie stanu gotowości formantu.|  
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Zmienia domyślne zachowanie aktywacji formant, który obsługuje `IPointerInactive` interfejsu.|  
|[COleControl::GetAmbientProperty](#getambientproperty)|Zwraca wartość określonej właściwości otoczenia.|  
|[COleControl::GetAppearance](#getappearance)|Zwraca wartość właściwości Appearance standardowych.|  
|[COleControl::GetBackColor](#getbackcolor)|Zwraca wartość właściwości BackColor standardowych.|  
|[COleControl::GetBorderStyle](#getborderstyle)|Zwraca wartość właściwości BorderStyle standardowych.|  
|[COleControl::GetCapture](#getcapture)|Określa, czy obiekt bez okien, aktywowanego formantu ma przechwytywanie myszy.|  
|[COleControl::GetClassID](#getclassid)|Pobiera identyfikator OLE klasy formantu.|  
|[COleControl::GetClientOffset](#getclientoffset)|Pobiera różnica między lewym górnym rogu formantu prostokątny obszar i lewego górnego rogu obszaru klienckiego.|  
|[COleControl::GetClientRect](#getclientrect)|Pobiera rozmiar obszaru klienckiego formantu.|  
|[COleControl::GetClientSite](#getclientsite)|Wysyła zapytanie do obiektu dla wskaźnika do bieżącej lokacji klienta, w ramach swojego kontenera.|  
|[COleControl::GetControlFlags](#getcontrolflags)|Pobiera ustawienia flagi kontroli.|  
|[COleControl::GetControlSize](#getcontrolsize)|Zwraca położenie i rozmiar formantu OLE.|  
|[COleControl::GetDC](#getdc)|Zapewnia to bez okien formantu można pobrać kontekstu urządzenia z jego kontenera.|  
|[COleControl::GetEnabled](#getenabled)|Zwraca wartość właściwości Enabled zasobów.|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|Pobiera wskaźnik do obiektu rozszerzonej kontroli do kontenera.|  
|[COleControl::GetFocus](#getfocus)|Określa, czy formant ma fokus.|  
|[COleControl::GetFont](#getfont)|Zwraca wartość właściwości Font standardowych.|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Zwraca metryki `CFontHolder` obiektu.|  
|[COleControl::GetForeColor](#getforecolor)|Zwraca wartość właściwości ForeColor standardowych.|  
|[COleControl::GetHwnd](#gethwnd)|Zwraca wartość właściwości hWnd standardowych.|  
|[COleControl::GetMessageString](#getmessagestring)|Zawiera tekst paska stanu dla elementu menu.|  
|[COleControl::GetNotSupported](#getnotsupported)|Uniemożliwia dostęp do wartości właściwości formantu przez użytkownika.|  
|[COleControl::GetReadyState](#getreadystate)|Zwraca stan gotowości formantu.|  
|[COleControl::GetRectInContainer](#getrectincontainer)|Zwraca prostokąt formantu względem jego kontenera.|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Zwraca metryki standardowych właściwość czcionki.|  
|[COleControl::GetText](#gettext)|Zwraca wartość właściwości Text lub Caption standardowych.|  
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Należy przesłonić, aby umożliwić formantem bez okien element docelowy przeciągania i upuszczania operacji.|  
|[COleControl::InitializeIIDs](#initializeiids)|Informuje o klasie podstawowej IID w formancie będzie używana.|  
|[COleControl::InternalGetFont](#internalgetfont)|Zwraca `CFontHolder` obiektu dla standardowych właściwość czcionki.|  
|[COleControl::InternalGetText](#internalgettext)|Pobiera właściwości standardowych podpis lub tekst.|  
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Ustawia stan gotowości formantu i generowane zdarzenie zmiany w przypadku stanu gotowości.|  
|[COleControl::InvalidateControl](#invalidatecontrol)|Unieważnia obszar wyświetlanych formantu, co powoduje narysowania.|  
|[COleControl::InvalidateRgn](#invalidatergn)|Unieważnia obszaru klienckiego okna kontenera w danym regionie. Można odświeżyć kontrolek bez okien w regionie.|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Umożliwia ładowanie specjalne kontrolkę OLE.|  
|[COleControl::IsModified](#ismodified)|Określa, czy stan formantu został zmieniony.|  
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Wskazuje, czy kontener obsługuje zoptymalizowanego rysowania dla bieżącej operacji rysowania.|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Wywołuje się, by określić czy kontrolka jest podklasą Windows kontroli.|  
|[COleControl::Load](#load)|Resetuje wszelkich wcześniejszych danych asynchronicznych i inicjuje nowego załadowania właściwości asynchronicznej formantu.|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Określa, czy formant będzie możliwa ich dezaktywacja przez kontener.|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Wywoływane, gdy zmieniono właściwość zostanie zmieniona.|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Wywoływane, gdy standardowych właściwości zostanie zmieniona.|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Wywoływane, gdy standardowych właściwości BackColor zostanie zmieniona.|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Wywoływane, gdy standardowych właściwości BorderStyle zostanie zmieniona.|  
|[COleControl::OnClick](#onclick)|Wywołuje się, by wyzwalać giełdowych kliknij zdarzenie.|  
|[COleControl::OnClose](#onclose)|Powiadamia kontrolkę, która `IOleControl::Close` została wywołana.|  
|[COleControl::OnDoVerb](#ondoverb)|Wywoływana po wykonaniu zlecenie formantu.|  
|[COleControl::OnDraw](#ondraw)|Wywoływane, gdy kontrolka zażądała ponownego narysowania.|  
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Wywołanie przez kontener, gdy kontrolka zażądała ponownego narysowania przy użyciu kontekstu urządzenia metaplik.|  
|[COleControl::OnEdit](#onedit)|Wywołanie przez kontener, aby aktywować interfejsu użytkownika kontrolkę OLE.|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|Wywoływane, gdy zostanie zmieniona właściwość Enabled zasobów.|  
|[COleControl::OnEnumVerbs](#onenumverbs)|Wywoływana przez kontener, by wyliczyć zlecenia kontrolki.|  
|[COleControl::OnEventAdvise](#oneventadvise)|Wywoływane, gdy programy obsługi zdarzeń są połączone lub rozłączone z formantu.|  
|[COleControl::OnFontChanged](#onfontchanged)|Wywoływane po zmianie właściwości standardowych czcionki.|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Wywoływane po zmianie właściwości ForeColor standardowych.|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|Wywoływane, gdy zdarzeń formantu są zablokowane lub odblokowany.|  
|[COleControl::OnGetColorSet](#ongetcolorset)|Powiadamia kontrolkę, która `IOleObject::GetColorSet` została wywołana.|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Zawiera informacje skrótu do kontenera.|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Wywołuje się, by uzyskać ciąg reprezentujący wartość właściwości.|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Żąda dojścia kontrolki menu, które zostaną scalone z menu kontenera.|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Należy przesłonić, aby pobrać rozmiar wyświetlania formantu najbliżej proponowanych Tryb rozmiaru i zakresu.|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Zwraca ciągów reprezentujących możliwe wartości dla właściwości.|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Zwraca wartość odpowiadająca ciągowi wstępnie zdefiniowane.|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|Należy przesłonić, aby pobrać rozmiar formantu wyświetlania obszarów (można włączyć dwa przebiegu rysunku).|  
|[COleControl::OnGetViewRect](#ongetviewrect)|Należy przesłonić, aby przekonwertować rozmiar formantu prostokąt, zaczynając od określonej pozycji.|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Należy przesłonić, aby pobrać stan widoku formantu.|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|Wywołanie przez kontener, gdy formant interfejsu użytkownika jest dezaktywowana.|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Należy przesłonić, aby mieć kontener dla nieaktywnych formantu w obszarze wysyłania wskaźnika myszy `WM_MOUSEMOVE` wiadomości do formantu.|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Należy przesłonić, aby mieć kontener dla nieaktywnych formantu w obszarze wysyłania wskaźnika myszy `WM_SETCURSOR` wiadomości do formantu.|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Metoda wywoływana po standardowych zdarzenie KeyDown zostały uruchamiane.|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Metoda wywoływana po standardowych zdarzenia KeyPress zostały uruchamiany.|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Metoda wywoływana po standardowych zdarzenie KeyUp zostały uruchamiane.|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Wskazuje stronę właściwości, która ma być używane do edycji właściwości.|  
|[COleControl::OnMnemonic](#onmnemonic)|Wywoływane, gdy został naciśnięty klawisz skrótu formantu.|  
|[COleControl::OnProperties](#onproperties)|Wywoływane, gdy została wywołana zlecenie "Właściwości" formantu.|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Należy przesłonić, aby zapytanie czy wyświetlanie formantu nakłada danego punktu.|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Należy przesłonić, aby zapytanie czy wyświetlanie formantu nakłada się na dowolnym momencie w danym prostokąta.|  
|[COleControl::OnRenderData](#onrenderdata)|Wywoływane przez platformę, by pobrać dane w określonym formacie.|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|Wywoływane przez platformę, by pobrać dane z pliku w określonym formacie.|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Wywoływane przez platformę, by pobrać dane z pamięci globalnej w określonym formacie.|  
|[COleControl::OnResetState](#onresetstate)|Resetuje właściwości formantu do wartości domyślnych.|  
|[COleControl::OnSetClientSite](#onsetclientsite)|Powiadamia kontrolkę, która `IOleControl::SetClientSite` została wywołana.|  
|[COleControl::OnSetData](#onsetdata)|Zamienia danych formantu inną wartość.|  
|[COleControl::OnSetExtent](#onsetextent)|Wywołuje się po zmianie zakresu formantu.|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Wywołuje się po zmianie wymiarów formantu.|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|Wywoływane, gdy kontrolka została aktywowana w interfejsie użytkownika.|  
|[COleControl::OnTextChanged](#ontextchanged)|Wywoływane po zmianie zasobu tekstu lub właściwości podpisu.|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Przetwarza komunikatów okien (inne niż komunikatów myszy i klawiatury) kontrolek bez okien.|  
|[COleControl::ParentToClient](#parenttoclient)|Wykonuje translację punktu względem źródła kontenera do punktu względem źródła formantu.|  
|[COleControl::PostModalDialog](#postmodaldialog)|Powiadamia kontenera, że modalne okno dialogowe zostało zamknięte.|  
|[COleControl::PreModalDialog](#premodaldialog)|Powiadamia kontener, który ma być wyświetlany modalne okno dialogowe.|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Niszczy i ponownie tworzy okno formantu.|  
|[COleControl::Refresh](#refresh)|Wymusza odświeżenia wygląd formantu.|  
|[COleControl::ReleaseCapture](#releasecapture)|Zwalnia przechwytywanie myszy.|  
|[COleControl::ReleaseDC](#releasedc)|Udostępnia kontekst urządzenia wyświetlania kontenera formantem bez okien.|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Resetuje nadrzędnego okna formantu.|  
|[COleControl::ResetStockProps](#resetstockprops)|Inicjuje `COleControl` podstawowy właściwości do wartości domyślnych.|  
|[COleControl::ResetVersion](#resetversion)|Inicjuje numer wersji do podanej wartości.|  
|[COleControl::ScrollWindow](#scrollwindow)|Umożliwi kontrolce bezokienkowej przewijanie obszar wewnątrz jej w miejscu aktywnego obrazu na ekran.|  
|[COleControl::SelectFontObject](#selectfontobject)|Wybrana właściwość czcionki do kontekstu urządzenia.|  
|[COleControl::SelectStockFont](#selectstockfont)|Wybiera standardowych właściwość czcionki do kontekstu urządzenia.|  
|[COleControl::SerializeExtent](#serializeextent)|Serializuje lub inicjuje obszar wyświetlania formantu.|  
|[COleControl::SerializeStockProps](#serializestockprops)|Serializuje lub inicjuje `COleControl` podstawowy właściwości.|  
|[COleControl::SerializeVersion](#serializeversion)|Serializuje lub inicjuje informacje o wersji formantu.|  
|[COleControl::SetAppearance](#setappearance)|Ustawia wartość właściwości Appearance standardowych.|  
|[COleControl::SetBackColor](#setbackcolor)|Ustawia wartość właściwości BackColor standardowych.|  
|[COleControl::SetBorderStyle](#setborderstyle)|Ustawia wartość właściwości BorderStyle standardowych.|  
|[COleControl::SetCapture](#setcapture)|Powoduje, że okno kontenera formantu podjęcie posiadania przechwytywanie myszy w imieniu formantu.|  
|[COleControl::SetControlSize](#setcontrolsize)|Ustawia położenie i rozmiar formantu OLE.|  
|[COleControl::SetEnabled](#setenabled)|Ustawia wartość właściwości Enabled zasobów.|  
|[COleControl::SetFocus](#setfocus)|Powoduje, że okno kontenera formantu podjęcie posiada fokus wprowadzania w imieniu formantu.|  
|[COleControl::SetFont](#setfont)|Ustawia wartość właściwości Font standardowych.|  
|[COleControl::SetForeColor](#setforecolor)|Ustawia wartość właściwości ForeColor standardowych.|  
|[COleControl::SetInitialSize](#setinitialsize)|Określa rozmiar formantu OLE, gdy po raz pierwszy jest wyświetlany w kontenerze.|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Zmiany stanu modyfikacji obiektu formantu.|  
|[COleControl::SetNotPermitted](#setnotpermitted)|Wskazuje, że żądania edycji nie powiodło się.|  
|[COleControl::SetNotSupported](#setnotsupported)|Modyfikację wartości właściwości formantu przez użytkownika.|  
|[COleControl::SetRectInContainer](#setrectincontainer)|Ustawia prostokącie kontrolki względem jego kontenera.|  
|[COleControl::SetText](#settext)|Ustawia wartość właściwości Text lub Caption standardowych.|  
|[COleControl::ThrowError](#throwerror)|Sygnalizuje, że wystąpił błąd w formancie OLE.|  
|[COleControl::TransformCoords](#transformcoords)|Transformacje koordynować wartości między kontenerem i formantu.|  
|[COleControl::TranslateColor](#translatecolor)|Konwertuje **OLE_COLOR** do wartości **COLORREF** wartości.|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Określa, czy właściwości otaczających będą dostępne podczas następnego formantu jest załadowany.|  
|[COleControl::WindowProc](#windowproc)|Udostępnia procedurę Windows `COleControl` obiektu.|  
  
### <a name="protected-methods"></a>Metody chronione  
  
|Nazwa|Opis|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|Wywoływane przez platformę, gdy wygląd formantu, musi zostać zaktualizowany.|  
|[COleControl::DrawMetafile](#drawmetafile)|Wywoływane przez platformę, gdy używany jest kontekst urządzenia metaplik.|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Umożliwia wywołanie metody automatyzacji.|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Wywoływane przez platformę, by zainicjować listy format danych obsługiwanych przez formant.|  
  
## <a name="remarks"></a>Uwagi  
 Pochodną `CWnd`, ta klasa dziedziczy wszystkie funkcje obiektu okna systemu Windows oraz dodatkowe funkcje specyficzne dla OLE, takich jak inicjowanie zdarzeń i możliwość obsługi metody i właściwości.  
  
 Formanty OLE można wstawiać do aplikacji kontenera OLE i komunikować się z kontenerem przy użyciu systemu dwukierunkowe inicjowanie zdarzeń i uwidaczniającą metod i właściwości do kontenera. Należy pamiętać, że standardowa kontenery OLE obsługują tylko podstawowych funkcji kontrolkę OLE. Są one nie obsługuje rozszerzonych funkcji kontrolkę OLE. Inicjowanie zdarzeń występuje, gdy zdarzenia są wysyłane do kontenera wyniku pewne akcje miejsce w formancie. Z kolei kontenera komunikuje się za pomocą formantu za pomocą dostępnego zestawu metod i właściwości analogiczne do funkcji Członkowskich i element członkowski danych klasy C++. Takie podejście umożliwia deweloperowi sterować wyglądem formantu i powiadom kontenera, gdy występują pewne akcje.  
  
## <a name="windowless-controls"></a>Formanty bez okien  
 Formanty OLE mogą być używane aktywny w miejscu bez okna. Formanty bez okien są istotne korzyści:  
  
-   Formanty bez okien może być przezroczysty i innych niż prostokątne  
  
-   Formanty bez okien skrócić czas rozmiaru i tworzenia wystąpienia obiektu  
  
 Formanty okna nie jest konieczne. Łatwo można podać usług, które oferuje okna za pomocą jednego okna udostępnionych (zazwyczaj kontenera) i wysyłania kodu. Okno jest przeważnie niepotrzebnych complication obiektu.  
  
 W przypadku aktywacji niepowiązanej z oknami kontenera (która ma okna) jest odpowiedzialny za świadczenia usług, czy zostały dostarczone przez okna dla formantu. Na przykład jeśli formant musi zapytania fokus klawiatury, zapytania przechwytywanie myszy lub uzyskać kontekstu urządzenia, te operacje są zarządzane przez kontener. `COleControl` [Funkcje Członkowskie niepowiązane z oknami operacji](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) wywoływać te operacje w kontenerze.  
  
 Po włączeniu aktywacji niepowiązanej z oknami delegatów kontenera wejściowych wiadomości do kontrolki `IOleInPlaceObjectWindowless` interfejsu (rozszerzenie [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) niepowiązane z oknami obsługi). `COleControl`przez implementację tego interfejsu wyśle te komunikaty za pomocą formantu mapy komunikatów, po dostosowanie myszy koordynuje odpowiednio. Można przetwarzać te komunikaty, takie jak komunikaty okna zwykłej, dodając odpowiednie wpisy mapy wiadomości.  
  
 W kontrolce bezokienkowej zawsze należy używać `COleControl` funkcje Członkowskie zamiast odpowiadającego `CWnd` funkcji Członkowskich lub ich powiązanych funkcji interfejsu API systemu Windows.  
  
 Obiekty OLE kontroli można również utworzyć okno tylko wtedy, gdy staną się aktywne, ale rośnie ilość pracy wymaganej przejścia nieaktywne aktywny i szybkości przejścia ulegnie awarii. Istnieją przypadki, gdy jest to problem: na przykład należy wziąć pod uwagę siatki pól tekstowych. Gdy ów w górę i w dół przez kolumnę, każdego formantu musi być w miejscu aktywowana, a następnie nieaktywne. Szybkość przejścia aktywny/nieaktywny bezpośrednio wpływać na szybkość przewijania.  
  
 Aby uzyskać więcej informacji na temat tworzenia framework formantu OLE, zobacz artykuły [kontrolki ActiveX MFC](../../mfc/mfc-activex-controls.md) i [omówienie: tworzenie programu kontrolki ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Aby uzyskać informacje dotyczące optymalizacji formantów OLE, w tym formanty bez okien i pozbawione migotania, zobacz [kontrolki ActiveX MFC: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).  
  
## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>Wymagania  
 **Nagłówek:** afxctl.h  
  
##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor  
 Zwraca wartość właściwości BackColor otoczenia.  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Bieżąca wartość kontenera otoczenia właściwości BackColor, jeśli istnieje. Jeśli ta właściwość nie jest obsługiwana, funkcja zwraca kolor tła zdefiniowana w systemie Windows.  
  
### <a name="remarks"></a>Uwagi  
 Właściwości BackColor w otaczającym jest dostępny dla wszystkich kontrolek i jest definiowana za pomocą kontenera. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.  
  
##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName  
 Nazwa kontenera jest przypisany do kontrolki może służyć do komunikatów o błędach wyświetlana użytkownikowi.  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Nazwa formantu OLE. Wartość domyślna to ciąg o zerowej długości.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.  
  
##  <a name="ambientfont"></a>  COleControl::AmbientFont  
 Zwraca wartość właściwości Font otoczenia.  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do kontenera otoczenia interfejs wysyłania czcionki. Wartość domyślna to **NULL**. Jeśli nie jest taki sam zwracany **NULL**, przydadzą się osobom odpowiedzialnym za zwolnienie czcionki przez wywołanie jego [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) funkcji członkowskiej.  
  
### <a name="remarks"></a>Uwagi  
 Właściwość czcionki otoczenia jest zdefiniowane przez kontener i dostępne dla wszystkich kontrolek. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.  
  
##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor  
 Zwraca wartość właściwości ForeColor w otaczającym.  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Bieżąca wartość kontenera otoczenia ForeColor właściwość, jeśli istnieje. Jeśli nie jest obsługiwana, funkcja zwraca kolor tekstu zdefiniowana w systemie Windows.  
  
### <a name="remarks"></a>Uwagi  
 Właściwości ForeColor w otaczającym jest dostępny dla wszystkich kontrolek i jest definiowana za pomocą kontenera. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.  
  
##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID  
 Zwraca identyfikator kontenera ustawień regionalnych.  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wartość właściwości identyfikator ustawień regionalnych kontenera, jeśli istnieje. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość 0.  
  
### <a name="remarks"></a>Uwagi  
 Formant umożliwia dostosowanie interfejs użytkownika dla określonych regionów identyfikator ustawień regionalnych. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.  
  
##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance  
 Pobiera bieżące ustawienia wyglądu dla obiekt formantu.  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wygląd formantu:  
  
- **0** płaskim wyglądu  
  
- **1** wygląd 3D  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji można pobrać bieżącą wartość **DISPID_AMBIENT_APPEARANCE** właściwości formantu.  
  
##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits  
 Zwraca typ jednostek używanych przez kontener.  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Ciąg zawierający otoczenia ScaleUnits kontenera. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca ciąg o zerowej długości.  
  
### <a name="remarks"></a>Uwagi  
 Zmieniono właściwość ScaleUnits kontenera można wyświetlić pozycji lub wymiarów z wybranej jednostki, takich jak twipach lub cm. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.  
  
##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles  
 Określa, czy kontener zezwala kontrolka do wyświetlenia uchwytów dla siebie, gdy jest aktywny.  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli powinien być wyświetlany uchwytów; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość różna od zera.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.  
  
##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching  
 Określa, czy kontener zezwala formantu, aby wyświetlić się z kreskowanym wzorca kiedy aktywny interfejsu użytkownika.  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli mają być pokazywane kreskowanym wzorzec; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość różna od zera.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.  
  
##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign  
 Określa wyrównanie tekstu otoczenia preferowany przez kontener formantu.  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Stan otoczenia właściwości TextAlign kontenera. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość 0.  
  
 Oto lista prawidłowych wartości zwracanych:  
  
|Wartość zwracana|Znaczenie|  
|------------------|-------------|  
|0|Wyrównanie ogólne (numery do prawej stronie tekstu z lewej strony).|  
|1|Wyrównaj do lewej|  
|2|Wyśrodkuj|  
|3|Wyrównanie do prawej|  
  
### <a name="remarks"></a>Uwagi  
 Ta właściwość jest dostępna dla wszystkich kontrolek osadzonych i jest definiowana za pomocą kontenera. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.  
  
##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead  
 Określa, czy kontener chce kontroli odpowiada na działania interfejsu użytkownika.  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli formant powinno odpowiedzieć na działania interfejsu użytkownika; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość 0.  
  
### <a name="remarks"></a>Uwagi  
 Na przykład kontener może Ustaw tę wartość na **TRUE** w trybie projektowania.  
  
##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode  
 Określa, czy kontener jest w trybie projektowania lub w trybie użytkownika.  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli kontener jest w trybie użytkownika; w przeciwnym razie 0 (w trybie projektowania). Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość TRUE.  
  
### <a name="remarks"></a>Uwagi  
 Na przykład kontener może Ustaw tę wartość na **FALSE** w trybie projektowania.  
  
##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged  
 Sygnalizuje, że zmieniono wartość właściwości powiązania.  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>Parametry  
 `dispid`  
 Identyfikator wysyłania powiązane właściwości formantu.  
  
### <a name="remarks"></a>Uwagi  
 Musi być wywoływana za każdym razem, gdy wartość zmiany właściwości, nawet w przypadkach, w którym nie dokonano zmian za pomocą właściwości — metoda. Mieć świadomość powiązane właściwości, które są mapowane na zmiennych Członkowskich. Każdej zmianie takiego elementu członkowskiego zmiennej, `BoundPropertyChanged` musi zostać wywołana.  
  
##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit  
 Żąda uprawnienia z `IPropertyNotifySink` interfejsu, aby zmienić wartość właściwości powiązania dostarczane przez formant.  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>Parametry  
 `dispid`  
 Identyfikator wysyłania powiązane właściwości formantu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli zmiana jest dozwolona; w przeciwnym razie 0. Wartością domyślną jest różna od zera.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli odmówiono uprawnienia kontroli musi nie zezwala na wartość zmiany właściwości. Można to zrobić przez ignorowanie lub niepowodzeniem akcji, którą próbowano zmienić wartość właściwości.  
  
##  <a name="clienttoparent"></a>  COleControl::ClientToParent  
 Wykonuje translację współrzędne `pPoint` do współrzędnych nadrzędnych.  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `lprcBounds`  
 Wskaźnik do granice formantu OLE w kontenerze. Ale nie obszaru klienckiego obszaru całego kontrolki, w tym obramowania i paski przewijania.  
  
 `pPoint`  
 Wskaźnik do punktu obszaru klienta OLE na współrzędne elementu nadrzędnego (kontener).  
  
### <a name="remarks"></a>Uwagi  
 W danych wejściowych `pPoint` jest określana względem źródła obszaru klienckiego formantu OLE (lewym górnym rogu obszaru klienckiego formantu). W danych wyjściowych `pPoint` jest określana względem źródła elementu nadrzędnego (lewego górnego rogu kontenera).  
  
##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect  
 Jeśli jest ona całości lub częściowo objęta nakładające się obiekty nieprzezroczyste, można dostosować prostokąt karetki.  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Parametry  
 `lpRect`  
 W danych wejściowych, na wskaźnik do [RECT](../../mfc/reference/rect-structure1.md) strukturę, która zawiera obszar karetkę do skorygowania. W danych wyjściowych, obszar skorygowaną karetki lub **NULL** Jeżeli prostokąt karetkę jest całkowicie.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Daszek jest miga linii, bloku lub mapy bitowej, który zwykle wskazuje, gdzie zostanie wstawiony tekstowych lub graficznych.  
  
 Bez okien obiektu bezpiecznie nie można wyświetlić daszek bez wcześniejszego sprawdzenia, czy karetkę częściowo lub całkowicie ukryte przy nakładających się obiektów. Aby umożliwić który, można użyć obiektu `ClipCaretRect` uzyskać karetkę dostosowana (zmniejszona) zapewniające mieści się w regionie wycinka.  
  
 Obiekty tworzenie daszek powinien przesłać prostokąt karetkę `ClipCaretRect` używanie skorygowaną prostokąt karetki. Jeśli karetkę całkowicie jest ukryty, ta metoda zwróci **FALSE** i karetkę mają nie być wyświetlane na wszystkich w takim przypadku.  
  
##  <a name="colecontrol"></a>  COleControl::COleControl  
 Konstruuje `COleControl` obiektu.  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>Uwagi  
 Ta funkcja nie jest wywoływana bezpośrednio. Zamiast tego formantu OLE jest zazwyczaj tworzony przez jego fabryki klasy.  
  
##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged  
 Wywołania tej funkcji, gdy zestaw klawiszy skrótu obsługiwane przez formant został zmieniony.  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>Uwagi  
 Po odebraniu tego powiadomienia, formantu kontenera uzyskuje nowy zestaw klawiszy skrótu poprzez wywołanie [IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730). Należy pamiętać, że kontener nie jest wymagane do tego powiadomienia.  
  
##  <a name="displayerror"></a>  COleControl::DisplayError  
 Wywoływane przez platformę po standardowych zdarzenie błędu został obsłużony (chyba że obsługi zdarzeń został pominięty wyświetlania błędu).  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>Parametry  
 *scode*  
 Należy podać wartość Kod stanu. Pełną listę możliwych kodów, zobacz artykuł [formantów ActiveX: Tematy zaawansowane](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 Opis zostanie zgłoszony błąd.  
  
 *lpszSource*  
 Nazwa modułu generowanie błędu (zazwyczaj nazwa modułu formantu OLE).  
  
 `lpszHelpFile`  
 Nazwa pliku Pomocy zawierającego opis błędu.  
  
 `nHelpID`  
 Pomoc kontekstu identyfikator zostanie zgłoszony błąd.  
  
### <a name="remarks"></a>Uwagi  
 Domyślne zachowanie wyświetla komunikat zawierający opis błędu zawarte w `lpszDescription`.  
  
 Należy przesłonić tę funkcję, aby dostosować sposób wyświetlania błędów.  
  
##  <a name="doclick"></a>  COleControl::DoClick  
 Symuluje myszy kliknij akcję w formancie.  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>Uwagi  
 Overridable `COleControl::OnClick` funkcja członkowska zostanie wywołana i zasobów kliknij zdarzenie zostanie wyzwolone, jeśli jest to obsługiwane przez formant.  
  
 Ta funkcja jest obsługiwana przez `COleControl` klasy podstawowej jako metody akcji, o nazwie DoClick. Aby uzyskać więcej informacji, zobacz artykuł [formantów ActiveX: metody](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="dopropexchange"></a>  COleControl::DoPropExchange  
 Wywoływane przez platformę, gdy ładowania lub zapisywania kontrolki z magazynu trwałego reprezentacja, takiego jak zestaw strumienia lub właściwości.  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parametry  
 `pPX`  
 Wskaźnik do `CPropExchange` obiektu. Platformę dostarcza tego obiektu w celu ustanowienia kontekście wymiany właściwości, w tym kierunku.  
  
### <a name="remarks"></a>Uwagi  
 Ta funkcja jest zwykle wykonywania wywołań do **PX_** rodziny funkcji ładowania lub przechowywania określonych właściwości formantu OLE zdefiniowane przez użytkownika.  
  
 Jeśli Kreator formantów został użyty do utworzenia projektu kontroli OLE, zastąpiona wersja tej funkcji będzie serializować właściwości podstawowe obsługiwane przez `COleControl` z wywołania funkcji klasy podstawowej `COleControl::DoPropExchange`. Właściwości zdefiniowane przez użytkownika podczas dodawania do formantu OLE należy zmodyfikować tej funkcji do serializacji nowej właściwości. Aby uzyskać więcej informacji na serializacji, zobacz artykuł [formantów ActiveX: serializacja](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint  
 Ponownie rysuje kontrolkę OLE, która została podklasą klasy z kontrolki systemu Windows.  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Parametry  
 `pDC`  
 Wskaźnik do kontekstu urządzenia formantu kontenera.  
  
 `rcBounds`  
 Obszar, w którym ma być rysowany formantu.  
  
### <a name="remarks"></a>Uwagi  
 Wywołaj tę funkcję, aby poprawnie obsługiwać rysowania nieaktywnego formantu OLE. Tej funkcji należy używać tylko, jeśli OLE kontroli podklasy kontrolki okna i powinna być wywoływana `OnDraw` funkcja formantu.  
  
 Aby uzyskać więcej informacji dotyczących tej funkcji i Tworzenie podklasy kontrolki systemu Windows, zobacz artykuł [formantów ActiveX: Tworzenie podklasy kontrolki okna](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).  
  
##  <a name="drawcontent"></a>  COleControl::DrawContent  
 Wywoływane przez platformę, gdy wygląd formantu, musi zostać zaktualizowany.  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Parametry  
 `pDC`  
 Wskaźnik do kontekstu urządzenia.  
  
 `rc`  
 Prostokątny obszar mają znajdować się środku.  
  
### <a name="remarks"></a>Uwagi  
 Ta funkcja bezpośrednio wywołuje możliwym do zastąpienia `OnDraw` funkcji.  
  
##  <a name="drawmetafile"></a>  COleControl::DrawMetafile  
 Wywoływane przez platformę, gdy używany jest kontekst urządzenia metaplik.  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Parametry  
 `pDC`  
 Wskaźnik do kontekstu urządzenia metaplik.  
  
 `rc`  
 Prostokątny obszar mają znajdować się środku.  
  
##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame  
 Umożliwia cech ramki prostego formantu OLE.  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>Uwagi  
 Tej właściwości umożliwia kontrolce obsługuje zawierania visual innych kontrolek, ale nie true zawierania OLE. Przykładem może być pole grupy z kilku formanty. Zastosowanie tych zabezpieczeń nie są zawarte OLE, ale znajdują się w tej samej pole grupy.  
  
##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent  
 Serializuje lub Inicjuje stan rozszerzenie kontrolki (wymiary w **HIMETRIC** jednostek).  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parametry  
 `pPX`  
 Wskaźnik do [CPropExchange](../../mfc/reference/cpropexchange-class.md) obiektu. Platformę dostarcza tego obiektu w celu ustanowienia kontekście wymiany właściwości, w tym kierunku.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli funkcja zakończyło się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Ta funkcja jest zazwyczaj wywoływana przez domyślną implementację elementu `COleControl::DoPropExchange`.  
  
##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps  
 Serializuje lub inicjuje stanu zapasów właściwości formantu.  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parametry  
 `pPX`  
 Wskaźnik do [CPropExchange](../../mfc/reference/cpropexchange-class.md) obiektu. Platformę dostarcza tego obiektu w celu ustanowienia kontekście wymiany właściwości, w tym kierunku.  
  
### <a name="remarks"></a>Uwagi  
 Ta funkcja jest zazwyczaj wywoływana przez domyślną implementację elementu `COleControl::DoPropExchange`.  
  
##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion  
 Serializuje lub Inicjuje stan formantu informacje o wersji.  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Parametry  
 `pPX`  
 Wskaźnik do `CPropExchange` obiektu. Platformę dostarcza tego obiektu w celu ustanowienia kontekście wymiany właściwości, w tym kierunku.  
  
 `dwVersionDefault`  
 Bieżący numer wersji formantu.  
  
 `bConvert`  
 Wskazuje, czy trwałych danych powinny być konwertowane na najnowszy format, gdy zapisywane ani przechowywane w tym samym formacie, który został załadowany.  
  
### <a name="return-value"></a>Wartość zwracana  
 Niezerowe funkcji zakończyło się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Zazwyczaj jest to pierwsza funkcja wywoływana przez zastąpienie formantu z `COleControl::DoPropExchange`. Podczas ładowania, ta funkcja odczytuje numer wersji trwałych danych i ustawia atrybut wersji [CPropExchange](../../mfc/reference/cpropexchange-class.md) odpowiednio obiektu. Podczas zapisywania, funkcja ta zapisuje numer wersji trwałych danych.  
  
 Aby uzyskać więcej informacji na trwałość i przechowywania wersji, zobacz artykuł [formantów ActiveX: serializacja](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="fireclick"></a>  COleControl::FireClick  
 Wywoływane przez platformę, po kliknięciu przycisku myszy nad aktywny formant.  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>Uwagi  
 Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest wywoływane.  
  
 Do automatycznego uruchamiania wystąpić zdarzenie Click, mapa zdarzeń formantu musi mieć zasobu kliknij zdarzenie zdefiniowane.  
  
##  <a name="firedblclick"></a>  COleControl::FireDblClick  
 Wywoływane przez platformę, gdy wskaźnik myszy zostanie dwukrotnie kliknięty za pośrednictwem aktywny formant.  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>Uwagi  
 Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest wywoływane.  
  
 Do automatycznego uruchamiania zdarzenia DblClick, mapa zdarzeń formantu musi mieć standardowych zdarzeń DblClick zdefiniowane.  
  
##  <a name="fireerror"></a>  COleControl::FireError  
 Wyzwala zdarzenie błędu.  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Parametry  
 *scode*  
 Należy podać wartość Kod stanu. Pełną listę możliwych kodów, zobacz artykuł [formantów ActiveX: Tematy zaawansowane](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 Opis zostanie zgłoszony błąd.  
  
 `nHelpID`  
 Identyfikator pomocy zostanie zgłoszony błąd.  
  
### <a name="remarks"></a>Uwagi  
 To zdarzenie umożliwia sygnalizacji w odpowiednich miejscach w kodzie, wystąpił błąd w obrębie formantu. W przeciwieństwie do innych standardowych zdarzeń, takich jak MouseMove, lub kliknij błąd nigdy nie jest wywoływane przez platformę.  
  
 Aby zgłosić błąd występujący podczas funkcji get właściwości, funkcja zestaw właściwości lub metody automatyzacji, wywołaj [COleControl::ThrowError](#throwerror).  
  
 Implementacja używa zdarzenie błędu giełdowych kontrolkę OLE `SCODE` wartość. Jeśli formantu używa tego zdarzenia i jest przeznaczona do użycia w języku Visual Basic w wersji 4.0, zostanie wyświetlony błędy, ponieważ `SCODE` wartość nie jest obsługiwana w języku Visual Basic.  
  
 Aby rozwiązać ten problem, należy ręcznie zmienić `SCODE` parametru w formancie. ODL pliku **długi**. Ponadto wszelkie niestandardowe zdarzenie, metody lub właściwości używającej `SCODE` parametru powoduje także, że ten sam problem.  
  
##  <a name="fireevent"></a>  COleControl::FireEvent  
 Wyzwala zdarzenie zdefiniowane przez użytkownika z formantu z dowolnej liczby argumentów opcjonalnych.  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>Parametry  
 `dispid`  
 Identyfikator wysyłania zdarzeń do uruchomienia.  
  
 `pbParams`  
 Deskryptor dla typów parametrów zdarzenia.  
  
### <a name="remarks"></a>Uwagi  
 Zwykle ta funkcja nie należy wywoływać bezpośrednio. Zamiast tego będzie wywoływać funkcje inicjowanie zdarzeń w sekcji mapy zdarzeń deklaracja klasy formantu.  
  
 `pbParams` Argument jest rozdzieloną spacjami listę **VTS_**. Co najmniej jeden z tych wartości, rozdzielając je spacjami (nie przecinkami), określa listę parametrów funkcji. Dopuszczalne są następujące wartości:  
  
|Symbol|Typ parametru|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE —**|**IPictureDisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE —**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  Dodatkowe stałe variant zostały zdefiniowane dla wszystkich typów variant, z wyjątkiem produktów **vts_font —** i **vts_picture —**, które zapewniają wskaźnik do stała danych variant. Stałe te są nazywane przy użyciu **VTS_P** `constantname` Konwencji. Na przykład **VTS_PCOLOR** jest wskaźnikiem do **vts_color —** stałej.  
  
##  <a name="firekeydown"></a>  COleControl::FireKeyDown  
 Wywoływane przez platformę po naciśnięciu klawisza, gdy formant jest aktywny w interfejsie użytkownika.  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Parametry  
 `pnChar`  
 Wskaźnik do wartości wirtualnego kod klucza naciśnięty klawisz. Listę standardowych wirtualnego kodów klucza Zobacz Winuser.h  
  
 `nShiftState`  
 Zawiera kombinację następujących flag:  
  
- **SHIFT_MASK** naciśnięto klawisz SHIFT podczas akcji.  
  
- **CTRL_MASK** naciśnięto klawisz CTRL podczas akcji.  
  
- **ALT_MASK** w trakcie akcji został naciśnięty klawisz ALT.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest wywoływane.  
  
 Do automatycznego uruchamiania zdarzenia KeyDown, mapa zdarzeń formantu muszą mieć podstawowe zdarzenia KeyDown zdefiniowane.  
  
##  <a name="firekeypress"></a>  COleControl::FireKeyPress  
 Wywoływane przez platformę, gdy klucz jest naciśnięty i zwolnieniu, gdy formant niestandardowy jest aktywna interfejsu użytkownika w kontenerze.  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>Parametry  
 `pnChar`  
 Wskaźnik do wartości znak naciśnięto klawisz.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest wywoływane.  
  
 Odbiorcy zdarzeń mogą być modyfikowane `pnChar`, na przykład konwertowanie wszystkie małe znaki na wielkie litery. Jeśli chcesz sprawdzić zmodyfikowane znak, Zastąp `OnKeyPressEvent`.  
  
 Do automatycznego uruchamiania zdarzenia KeyPress, mapa zdarzeń formantu muszą mieć podstawowe zdarzenia KeyPress zdefiniowane.  
  
##  <a name="firekeyup"></a>  COleControl::FireKeyUp  
 Wywoływane przez platformę po zwolnieniu klawisza, gdy formant niestandardowy jest aktywna interfejsu użytkownika w kontenerze.  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Parametry  
 `pnChar`  
 Wskaźnik do wartości wirtualnego kod klucza key wydaną. Listę standardowych wirtualnego kodów klucza Zobacz Winuser.h  
  
 `nShiftState`  
 Zawiera kombinację następujących flag:  
  
- **SHIFT_MASK** naciśnięto klawisz SHIFT podczas akcji.  
  
- **CTRL_MASK** naciśnięto klawisz CTRL podczas akcji.  
  
- **ALT_MASK** w trakcie akcji został naciśnięty klawisz ALT.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest wywoływane.  
  
 Do automatycznego uruchamiania zdarzenia KeyUp, mapa zdarzeń formantu musi mieć standardowych zdarzenie KeyUp zdefiniowane.  
  
##  <a name="firemousedown"></a>  COleControl::FireMouseDown  
 Wywoływane przez platformę po naciśnięciu przycisku myszy nad aktywny formant niestandardowy.  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parametry  
 `nButton`  
 Wartość numeryczna przycisk myszy jest wciśnięty. Nazwa może zawierać jedną z następujących wartości:  
  
- **LEFT_BUTTON** naciśnięto lewy przycisk myszy w dół.  
  
- **MIDDLE_BUTTON** naciśnięto środkowego przycisku myszy w dół.  
  
- **RIGHT_BUTTON** naciśnięto prawy przycisk myszy w dół.  
  
 `nShiftState`  
 Zawiera kombinację następujących flag:  
  
- **SHIFT_MASK** naciśnięto klawisz SHIFT podczas akcji.  
  
- **CTRL_MASK** naciśnięto klawisz CTRL podczas akcji.  
  
- **ALT_MASK** w trakcie akcji został naciśnięty klawisz ALT.  
  
 *x*  
 Współrzędna x kursora, gdy został naciśnięty przycisk myszy w dół. Współrzędna jest określana względem lewego górnego rogu okna formantu.  
  
 *y*  
 Współrzędna y kursora, gdy został naciśnięty przycisk myszy w dół. Współrzędna jest określana względem lewego górnego rogu okna formantu.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest wywoływane.  
  
 Do automatycznego uruchamiania MouseDown — zdarzenie występuje, mapa zdarzeń formantu musi mieć standardowych MouseDown — zdarzenie zdefiniowane.  
  
##  <a name="firemousemove"></a>  COleControl::FireMouseMove  
 Wywoływane przez platformę, gdy kursor jest przesuwany nad aktywny formant niestandardowy.  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parametry  
 `nButton`  
 Wartość liczbowa przycisku myszy jest wciśnięty. Zawiera kombinację następujących wartości:  
  
- **LEFT_BUTTON** naciśnięto lewy przycisk myszy w dół w trakcie akcji.  
  
- **MIDDLE_BUTTON** został naciśnięty klawisz środkowego przycisku myszy w trakcie akcji.  
  
- **RIGHT_BUTTON** naciśnięto prawy przycisk myszy w dół w trakcie akcji.  
  
 `nShiftState`  
 Zawiera kombinację następujących flag:  
  
- **SHIFT_MASK** naciśnięto klawisz SHIFT podczas akcji.  
  
- **CTRL_MASK** naciśnięto klawisz CTRL podczas akcji.  
  
- **ALT_MASK** w trakcie akcji został naciśnięty klawisz ALT.  
  
 *x*  
 Współrzędna x kursora. Współrzędna jest określana względem lewego górnego rogu okna formantu.  
  
 *y*  
 Współrzędna y kursora. Współrzędna jest określana względem lewego górnego rogu okna formantu.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest wywoływane.  
  
 Do automatycznego uruchamiania zdarzenia MouseMove, mapa zdarzeń formantu musi mieć standardowych MouseMove — zdarzenie zdefiniowane.  
  
##  <a name="firemouseup"></a>  COleControl::FireMouseUp  
 Wywoływane przez platformę po zwolnieniu przycisku myszy nad aktywny formant niestandardowy.  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parametry  
 `nButton`  
 Wartość liczbowa wydane przycisk myszy. Może mieć jedną z następujących wartości:  
  
- **LEFT_BUTTON** wydanej lewego przycisku myszy.  
  
- **MIDDLE_BUTTON** środkowego przycisku myszy został zwolniony.  
  
- **RIGHT_BUTTON** prawym przyciskiem myszy został zwolniony.  
  
 `nShiftState`  
 Zawiera kombinację następujących flag:  
  
- **SHIFT_MASK** naciśnięto klawisz SHIFT podczas akcji.  
  
- **CTRL_MASK** naciśnięto klawisz CTRL podczas akcji.  
  
- **ALT_MASK** w trakcie akcji został naciśnięty klawisz ALT.  
  
 *x*  
 Współrzędna x kursora zwolnionych przycisk myszy. Współrzędna jest określana względem lewego górnego rogu okna formantu.  
  
 *y*  
 Współrzędna y kursora, gdy przycisk myszy został zwolniony. Współrzędna jest określana względem lewego górnego rogu okna formantu.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest wywoływane.  
  
 Do automatycznego uruchamiania zdarzenia MouseUp, mapa zdarzeń formantu musi mieć standardowych zdarzeń MouseUp zdefiniowane.  
  
##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange  
 Wyzwala zdarzenie z bieżącą wartością gotowy stan formantu.  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>Uwagi  
 Stan gotowości może być jedną z następujących wartości:  
  
 **READYSTATE_UNINITIALIZED**  
 Stan inicjowania domyślny  
  
 **READYSTATE_LOADING**  
 Obecnie ładowania właściwości formantu  
  
 **READYSTATE_LOADED**  
 Formant został zainicjowany  
  
 **READYSTATE_INTERACTIVE**  
 Kontrolka ma za mało danych interaktywne, ale jeszcze ładowania danych nie wszystkie asynchroniczne  
  
 `READYSTATE_COMPLETE`  
 Formant ma wszystkie jej dane  
  
 Użyj [GetReadyState](#getreadystate) ustalenie bieżącej gotowości formantu.  
  
 [InternalSetReadyState](#internalsetreadystate) zmiany stanu gotowości dostarczona wartość, a następnie wywołuje `FireReadyStateChange`.  
  
##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy  
 Zmienia domyślne zachowanie aktywacji formant, który obsługuje `IPointerInactive` interfejsu.  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Kombinacja flag z **POINTERINACTIVE** wyliczenia. Możliwe flagi są:  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 Obiekt powinien być aktywowany, gdy mysz przejdzie on podczas operacji przenoszenia myszy w miejscu.  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 Obiekt należy dezaktywować, gdy mysz opuści obiektu podczas operacji przenoszenia myszy.  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 Obiekt powinien zostać aktywowany, gdy wskaźnik myszy zostanie przeciągnięty nad nim podczas przeciągania w miejscu i upuść operacji.  
  
### <a name="remarks"></a>Uwagi  
 Gdy `IPointerInactive` interfejsu jest włączone, będzie delegowane kontenera `WM_SETCURSOR` i `WM_MOUSEMOVE` wiadomości do niej. `COleControl`przez implementację tego interfejsu wyśle te komunikaty za pomocą formantu mapy komunikatów, po dostosowanie myszy koordynuje odpowiednio.  
  
 Zawsze, gdy odbiera kontenera `WM_SETCURSOR` lub `WM_MOUSEMOVE` komunikat o wskaźnik myszy nad nieaktywnym obiektem obsługi `IPointerInactive`, powinna wywołać `GetActivationPolicy` na flag interfejsu i powrót z **POINTERINACTIVE** wyliczenia.  
  
 Można przetwarzać tych wiadomości, podobnie jak komunikaty okna zwykłej, dodając odpowiednie wpisy mapy wiadomości. W Twojej obsługi należy unikać `m_hWnd` zmiennej członkowskiej (lub wszystkie funkcje Członkowskie, które korzysta z niego) bez uprzedniego sprawdzanie, czy ma wartość inną niż **NULL**.  
  
 Dowolny obiekt przeznaczony do więcej niż Ustaw kursor myszy i/lub wyzwalać zdarzenie przesunięcia kursora myszy, takie jak specjalne visual opinii, powinien zwrócić **POINTERINACTIVE_ACTIVATEONENTRY** Flaga i rysowanie opinii tylko wtedy, gdy jest aktywny. Jeśli obiekt zwraca tej flagi, kontenera należy aktywować go w miejscu bezpośrednio i następnie przesyła je tę samą wiadomość, która wyzwoliła wywołanie `GetActivationPolicy`.  
  
 Jeśli oba **POINTERINACTIVE_ACTIVATEONENTRY** i **POINTERINACTIVE_DEACTIVATEONLEAVE** flagi są zwracane, a następnie obiekt będzie można uaktywnić tylko wtedy, gdy wskaźnik myszy znajduje się nad obiektu. Jeśli tylko **POINTERINACTIVE_ACTIVATEONENTRY** flaga jest zwracany, a następnie obiekt tylko zostanie aktywowany, po, gdy wskaźnik myszy po raz pierwszy najedzie obiektu.  
  
 Można również kontrolkę nieaktywne być elementem docelowym OLE przeciągania i upuszczania operacji. Wymaga to aktywowanie formantu w tej chwili użytkownik przeciąga obiektu nad nim, tak aby formantu okna może być zarejestrowany jako miejsca docelowego. Aby spowodować aktywacji podczas przeciągania, zwróć **POINTERINACTIVE_ACTIVATEONDRAG** flagi:  
  
 [!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 Informacje przekazywane przez `GetActivationPolicy` nie powinno być buforowane przez kontener. Jednak ta metoda powinna być wywoływana za każdym razem, gdy mysz przejdzie nieaktywnym obiektem.  
  
 Jeśli nieaktywnym obiektem żądanie nie być aktywowany, gdy mysz przejdzie on w miejscu, jego kontenera należy wysłać kolejnych `WM_SETCURSOR` komunikaty do tego obiektu, wywołując [OnInactiveSetCursor](#oninactivesetcursor) tak długo, jak wskaźnika myszy pozostaje na obiekcie.  
  
 Włączanie `IPointerInactive` interfejsu zazwyczaj oznacza to, że chcesz formantu ma być może przetwarzać komunikatów myszy przez cały czas. Aby uzyskać tego zachowania w kontenerze, który nie obsługuje `IPointerInactive` interfejsu, musisz mieć formant zawsze aktywowany, gdy jest widoczne, co oznacza, że formant powinien mieć **OLEMISC_ACTIVATEWHENVISIBLE** flagi wśród dodatkowych flag. Aby zapobiec tej flagi z dają efektu w kontenerze, który obsługuje jednak `IPointerInactive`, można również określić **OLEMISC_IGNOREACTIVATEWHENVISIBLE** flagi:  
  
 [!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty  
 Pobiera wartość zmieniono właściwość środowiska kontenera.  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>Parametry  
 *dwDispid*  
 Identyfikator wysyłania żądanej właściwości otoczenia.  
  
 `vtProp`  
 Tag typu variant, który określa typ wartości zwracanej w `pvProp`.  
  
 `pvProp`  
 Wskaźnik do adresu zmiennej, która będzie odbierać wartość właściwości ani zwracanej wartości. Rzeczywisty typ wskaźnika this musi być zgodna z typem określonym przez `vtProp`.  
  
|vtProp|Typ pvProp|  
|------------|--------------------|  
|`VT_BOOL`|**WARTOŚĆ LOGICZNA\***|  
|`VT_BSTR`|**Cstring —\***|  
|`VT_I2`|**krótki\***|  
|`VT_I4`|**długa\***|  
|`VT_R4`|**Float\***|  
|`VT_R8`|**O podwójnej precyzji\***|  
|`VT_CY`|**CY\***|  
|**VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli właściwość otoczenia jest obsługiwana; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli używasz `GetAmbientProperty` Aby uzyskać dostęp do właściwości otaczających DisplayName i ScaleUnits, ustaw `vtProp` do `VT_BSTR` i `pvProp` do **cstring —\***. Jeśli są pobierane otoczenia właściwość czcionki, ustaw `vtProp` do **VT_FONT** i `pvProp` do **LPFONTDISP\***.  
  
 Należy pamiętać, że funkcje zostały już przewidziane wspólne właściwości otoczenia, takich jak [AmbientBackColor](#ambientbackcolor) i [AmbientFont](#ambientfont).  
  
##  <a name="getappearance"></a>  COleControl::GetAppearance  
 Implementuje funkcję Get właściwości standardowych wygląd formantu.  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wartość zwracana określa bieżące ustawienie wygląd jako **krótki** ( `VT_I2`) wartości w przypadku powodzenia. Ta wartość wynosi zero, jeśli wygląd formantu jest płaski i 1, jeśli wygląd formantu jest 3W.  
  
##  <a name="getbackcolor"></a>  COleControl::GetBackColor  
 Implementuje funkcję Get właściwości standardowych kolor tła formantu.  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wartość zwracana określa bieżący kolor tła jako **OLE_COLOR** wartość, jeśli to się powiedzie. Ta wartość może być przekonwertowana na **COLORREF** wartości z wywołania `TranslateColor`.  
  
##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle  
 Implementuje funkcję Get właściwości BorderStyle standardowych spod kontroli.  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 1, jeśli formant ma obramowanie normalnej; 0, jeśli formant ma obramowanie.  
  
##  <a name="getcapture"></a>  COleControl::GetCapture  
 Określa, czy `COleControl` obiekt ma przechwytywanie myszy.  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Jeśli formant jest aktywowana i bez okien, zwraca **to** Jeśli formant ma obecnie przechwytywanie myszy (zgodnie z ustaleniami formantu kontenera) lub **NULL** Jeśli nie ma przechwytywania.  
  
 W przeciwnym razie zwraca `CWnd` obiektu, który ma przechwytywanie myszy (taki sam jak `CWnd::GetCapture`).  
  
### <a name="remarks"></a>Uwagi  
 Aktywowany bez okien formant uzyskuje myszy podczas przechwytywania [SetCapture](#setcapture) jest wywoływana.  
  
##  <a name="getclassid"></a>  COleControl::GetClassID  
 Wywoływane przez platformę, by pobrać identyfikator OLE klasy formantu.  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>Parametry  
 *pclsid*  
 Wskaźnik do lokalizacji identyfikator klasy.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli połączenie nie zakończyła się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Zwykle implementowany przez [implement_olecreate_ex —](class-factories-and-licensing.md#implement_olecreate_ex).  
  
##  <a name="getclientoffset"></a>  COleControl::GetClientOffset  
 Pobiera różnica między lewym górnym rogu formantu prostokątny obszar i lewego górnego rogu obszaru klienckiego.  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>Parametry  
 *pdxOffset*  
 Wskaźnik do obszaru klienckiego formantu OLE przesunięcie w poziomie.  
  
 *pdyOffset*  
 Wskaźnik do obszaru klienckiego formantu OLE przesunięcie w pionie.  
  
### <a name="remarks"></a>Uwagi  
 Formant OLE ma prostokątny obszar wewnątrz jej kontenera. Obszaru klienckiego formantu jest obszar formantu, z wyłączeniem obramowania i paski przewijania. Przesunięcie pobierane przez `GetClientOffset` różni się od lewego górnego rogu formantu prostokątny obszar i lewego górnego rogu obszaru klienckiego. Jeśli formant ma klienta z systemem innym niż elementów innych niż standardowe obramowania i pasków przewijania, przesłonić tę funkcję elementu członkowskiego, aby określić przesunięcie.  
  
##  <a name="getclientrect"></a>  COleControl::GetClientRect  
 Pobiera rozmiar obszaru klienckiego formantu.  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `lpRect`  
 Wskaźnik do `RECT` struktury zawierającej wymiary obszaru klienckiego formantu bez okien; oznacza to, że rozmiar formantu minus obramowań okien, ramki, paski przewijania i tak dalej. `lpRect` Parametr wskazuje rozmiar formantu prostokąt klienta, nie położenia.  
  
##  <a name="getclientsite"></a>  COleControl::GetClientSite  
 Wysyła zapytanie do obiektu dla wskaźnika do bieżącej lokacji klienta, w ramach swojego kontenera.  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do bieżącej lokacji klienta formantu w jego kontenera.  
  
### <a name="remarks"></a>Uwagi  
 Zwrócony wskaźnik wskazuje na wystąpienie `IOleClientSite`. `IOleClientSite` Interfejs implementowany przez kontenery, jest widok obiektu jego kontekstu: której jest zakotwiczona w dokumencie, jeżeli pobiera jej magazynem, interfejs użytkownika i innych zasobów.  
  
##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags  
 Pobiera ustawienia flagi kontroli.  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 ORed kombinacją flag w wyliczeniu ControlFlags:  
  
```  
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };  
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślnie `GetControlFlags` zwraca `fastBeginPaint | clipPaintDC`.  
  
 `fastBeginPaint`  
 Jeśli ustawiona, funkcja używa begin-paint dostosowane dla formantów OLE zamiast [BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) interfejsu API (domyślnie).  
  
 `clipPaintDC`  
 Jeśli nie jest ustawiona, wyłącza wywoływanie `IntersectClipRect` przez `COleControl` i uzyska korzyści małej szybkości. Jeśli korzystasz z aktywacji niepowiązanej z oknami, flaga nie ma znaczenia.  
  
 `pointerInactive`  
 Jeśli ustawiona, zapewnia interakcji z myszą, gdy formant jest nieaktywny przez włączenie `COleControl`w implementacji `IPointerInactive` interfejs, który jest domyślnie wyłączona.  
  
 `noFlickerActivate`  
 Jeśli jest ustawiona, eliminuje operacje bardzo rysowania i towarzyszące im migotanie. Używania formantu rysuje się tak samo w Stanach stanem nieaktywnym i aktywnym. Jeśli korzystasz z aktywacji niepowiązanej z oknami, flaga nie ma znaczenia.  
  
 `windowlessActivate`  
 Jeśli ustawione, oznacza formantu używa aktywacji niepowiązanej z oknami.  
  
 `canOptimizeDraw`  
 Jeśli ustawiona, wskazuje, że kontrolka będzie wykonywać zoptymalizowanego rysowania, jeśli obsługuje kontenera.  
  
 Aby uzyskać więcej informacji na temat `GetControlFlags` i inne optymalizacje formantów OLE, zobacz [formantów ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="getcontrolsize"></a>  COleControl::GetControlSize  
 Pobiera rozmiar okna formantu OLE.  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>Parametry  
 *pcx*  
 Określa szerokość formantu w pikselach.  
  
 *pcy*  
 Określa wysokość formantu w pikselach.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że wszystkie współrzędne kontrolki systemu windows są względem lewego górnego rogu formantu.  
  
##  <a name="getdc"></a>  COleControl::GetDC  
 Zapewnia bez okien obiektu do kontekstu urządzenia get ekranu (lub zgodne) z jego kontenera.  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>Parametry  
 *lprcRect*  
 Wskaźnik do prostokąta kontroli bez okien chce, aby odświeżyć we współrzędnych klienta formantu. **Wartość NULL** oznacza pełne obiektu zakresu.  
  
 `dwFlags`  
 Atrybuty rysowania kontekst urządzenia. Dostępne są następujące opcje:  
  
- **OLEDC_NODRAW** oznacza, że obiekt nie będzie używać kontekstu urządzenia do wykonywania żadnych rysowania ale jedynie, aby uzyskać informacje na temat urządzenia wyświetlającego. Kontener należy po prostu Przekaż kontrolera domeny w oknie bez dalszego przetwarzania.  
  
- **OLEDC_PAINTBKGND** żądań, że kontener rysowania tła przed powrotem do kontrolera domeny. Obiekt powinni używać tej flagi, jeśli kontroler domeny żąda dla ponownego narysowania obszar o przezroczyste tło.  
  
- **OLEDC_OFFSCREEN** informuje kontenera, który chce obiektu do renderowania w ukrytej bitmapy, który następnie powinien zostać skopiowany do ekranu. Obiekt powinni używać tej flagi, gdy jest próba wykonania operacji rysowania generuje wiele migotania. Kontener jest bezpłatna przestrzegać tego żądania, czy nie. Jednak jeśli ta flaga nie jest ustawiona, kontener musi ponownie przekazanie na ekranie kontrolera domeny. Pozwala to na wykonywanie operacji bezpośredniego ekranu, takich jak wyświetlanie zaznaczenia obiektów (za pośrednictwem **XOR** operacji).  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do kontekstu urządzenia wyświetlania kontenera `CWnd` obszaru klienckiego Jeśli pomyślnie; w przeciwnym razie jest zwracana wartość **NULL**. Kontekst urządzenia wyświetlania można w kolejnych funkcje interfejsu GDI do rysowania w klienckim obszarze okna kontenera.  
  
### <a name="remarks"></a>Uwagi  
 [ReleaseDC](#releasedc) należy wywołać funkcję elementu członkowskiego do zwolnienia kontekście po malowania. Podczas wywoływania metody `GetDC`, obiekty przekazać prostokąt chcą Rysuj do we własnych współrzędnych klienta. `GetDC` tłumaczy je na współrzędne obszaru klienckiego kontenera. Obiekt nie będą wymagać żądaną prostokąt rysowania większych niż własny prostokąta obszaru klienta, rozmiar, który można pobrać z [GetClientRect](#getclientrect). Zapobiega to przypadkowo rysowania, których nie mają obiektów.  
  
##  <a name="getenabled"></a>  COleControl::GetEnabled  
 Implementuje funkcję Get zasobów formantu właściwości Enabled.  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli formant jest włączony; w przeciwnym razie 0.  
  
##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl  
 Uzyskuje wskaźnik do obiektu obsługiwanego przez kontener, który reprezentuje kontrolki z rozszerzonego zestawu właściwości.  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do kontenera obiektu rozszerzony obiektu formantu. Jeśli nie ma żadnego obiektu, wartość jest **NULL**.  
  
 Ten obiekt może być modyfikowany w zakresie za pomocą jego `IDispatch` interfejsu. Można również użyć `QueryInterface` uzyskanie innych dostępnych interfejsów dostarczony przez obiekt. Obiekt nie jest wymagane do obsługi określonego zestawu interfejsów. Należy pamiętać, że polegania na konkretne funkcje obiektu rozszerzonej formantu kontenera ogranicza możliwość przenoszenia formantu do innych dowolnego kontenerów.  
  
### <a name="remarks"></a>Uwagi  
 Funkcja wywołująca tej funkcji jest odpowiedzialny za wskaźnika po zakończeniu pracy z obiektem. Należy pamiętać, że kontener nie jest wymagany do obsługi tego obiektu.  
  
##  <a name="getfocus"></a>  COleControl::GetFocus  
 Określa, czy `COleControl` obiekt ma fokus.  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Jeśli formant jest aktywowana i bez okien, zwraca **to** Jeśli formant aktualnie ma fokus klawiatury (zgodnie z ustaleniami formantu kontenera) lub **NULL** Jeśli nie ma fokusu.  
  
 W przeciwnym razie zwraca `CWnd` obiekt, który ma fokus (taki sam jak `CWnd::GetFocus`).  
  
### <a name="remarks"></a>Uwagi  
 Aktywowany bez okien formant uzyskuje fokus podczas [SetFocus](#setfocus) jest wywoływana.  
  
##  <a name="getfont"></a>  COleControl::GetFont  
 Implementuje funkcję Get właściwości standardowych czcionki.  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do interfejsu wysyłania czcionki formantu zasobów właściwość czcionki.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że obiekt wywołujący musi zwolnić ten obiekt po zakończeniu. W implementacji formantu, należy użyć `InternalGetFont` dostępu do podstawowego obiektu czcionki formantu. Aby uzyskać więcej informacji na temat używania czcionki formantu, zobacz artykuł [formantów ActiveX: przy użyciu czcionek w formancie ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).  
  
##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics  
 Mierzy metryki tekstu dla każdego `CFontHolder` obiektu formantu.  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Parametry  
 `lptm`  
 Wskaźnik do [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) struktury.  
  
 `fontHolder`  
 Odwołanie do [CFontHolder](../../mfc/reference/cfontholder-class.md) obiektu.  
  
### <a name="remarks"></a>Uwagi  
 Można wybrać takiej czcionki z [COleControl::SelectFontObject](#selectfontobject) funkcji. `GetFontTextMetrics` zainicjuje `TEXTMETRIC` wskazywanej przez `lptm` metryki prawidłowe informacje o `fontHolder`obiektu czcionki w przypadku powodzenia lub wypełnienia struktury zerami, jeśli nie powiodło się. Należy używać tej funkcji, zamiast [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) po malowanie formantu, ponieważ formanty, takie jak dowolne osadzonych obiektów OLE mogą być wymagane do renderowania samodzielnie w metaplik.  
  
 `TEXTMETRIC` Struktury dla domyślnej czcionki jest odświeżany, kiedy [SelectFontObject](#selectfontobject) funkcja jest wywoływana. Należy wywołać `GetFontTextMetrics` wyłącznie po wybranie właściwości standardowych czcionki do zapewnienia informacji zapewnia jest nieprawidłowy.  
  
##  <a name="getforecolor"></a>  COleControl::GetForeColor  
 Implementuje funkcję Get właściwości ForeColor w standardowych.  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wartość zwracana określa bieżący kolor pierwszego planu jako **OLE_COLOR** wartość, jeśli to się powiedzie. Ta wartość może być przekonwertowana na [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) wartości z wywołania `TranslateColor`.  
  
##  <a name="gethwnd"></a>  COleControl::GetHwnd  
 Implementuje funkcję Get właściwości hWnd standardowych.  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Uchwyt okna formantu OLE, jeśli występuje; w przeciwnym razie **NULL**.  
  
##  <a name="getmessagestring"></a>  COleControl::GetMessageString  
 Wywoływane przez platformę, by uzyskać krótki ciąg opisujący cel identyfikowane przez element menu `nID`.  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `nID`  
 Identyfikator elementu menu.  
  
 `rMessage`  
 Odwołanie do [cstring —](../../atl-mfc-shared/reference/cstringt-class.md) obiektu za pomocą którego zostanie zwrócony ciąg.  
  
### <a name="remarks"></a>Uwagi  
 Może być używany do uzyskiwania wiadomości do wyświetlania na pasku stanu, gdy element menu zostanie wyróżniona. Domyślna implementacja próbuje załadować ciągu zasobu identyfikowanego przez `nID`.  
  
##  <a name="getnotsupported"></a>  COleControl::GetNotSupported  
 Uniemożliwia dostęp do wartości właściwości formantu przez użytkownika.  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji, zamiast funkcji Get dowolnej właściwości, w którym pobieranie właściwości przez kontrolki użytkownika nie jest obsługiwane. Przykładem jest właściwością tylko do zapisu.  
  
##  <a name="getreadystate"></a>  COleControl::GetReadyState  
 Zwraca stan gotowości formantu.  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Stan gotowości formantu, jeden z następujących wartości:  
  
 **READYSTATE_UNINITIALIZED**  
 Stan inicjowania domyślny  
  
 **READYSTATE_LOADING**  
 Obecnie ładowania właściwości formantu  
  
 **READYSTATE_LOADED**  
 Formant został zainicjowany  
  
 **READYSTATE_INTERACTIVE**  
 Kontrolka ma za mało danych interaktywne, ale jeszcze ładowania danych nie wszystkie asynchroniczne  
  
 `READYSTATE_COMPLETE`  
 Formant ma wszystkie jej dane  
  
### <a name="remarks"></a>Uwagi  
 Większość proste kontrolki nigdy nie należy do rozróżniania **LOADED** i `INTERACTIVE`. Jednak formantów, które obsługują właściwości ścieżki danych nie może być gotowe do przeniesienia interakcyjne do momentu otrzymania co najmniej niektóre dane asynchronicznie. Formant powinien próbować stać się interakcyjne tak szybko, jak to możliwe.  
  
##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer  
 Uzyskuje współrzędne prostokąt kontroli względem kontenera, w jednostkach urządzenia.  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Parametry  
 `lpRect`  
 Wskaźnik do struktury prostokąt, do którego zostaną skopiowane współrzędne formantu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli formant jest aktywny w miejscu; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Prostokąt jest tylko wtedy, gdy formant jest aktywny w miejscu.  
  
##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics  
 Mierzy metryki tekst formantu czcionki właściwości podstawowych, które można wybrać z [SelectStockFont](#selectstockfont) funkcji.  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>Parametry  
 `lptm`  
 Wskaźnik do [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) struktury.  
  
### <a name="remarks"></a>Uwagi  
 `GetStockTextMetrics` Zainicjuje funkcja `TEXTMETRIC` wskazywanej przez `lptm` z prawidłową metryki informacji w przypadku powodzenia lub wypełnienia struktury zerami, jeśli nie powiodło się. Aby użyć tej funkcji, zamiast [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) po malowanie formantu, ponieważ formanty, takie jak dowolne osadzonych obiektów OLE mogą być wymagane do renderowania samodzielnie w metaplik.  
  
 `TEXTMETRIC` Struktury dla domyślnej czcionki jest odświeżany, kiedy `SelectStockFont` funkcja jest wywoływana. Tej funkcji należy wywołać tylko po wybranie standardowych czcionkę, aby upewnić się, że informacje, które zapewnia jest nieprawidłowy.  
  
##  <a name="gettext"></a>  COleControl::GetText  
 Implementuje funkcję Get właściwości Text lub Caption standardowych.  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Bieżąca wartość formantu ciąg tekstowy lub ciągiem o zerowej długości, jeśli ciąg nie jest obecny.  
  
> [!NOTE]
>  Aby uzyskać więcej informacji na temat `BSTR` typ danych, zobacz [typy danych](../../mfc/reference/data-types-mfc.md) w sekcji makra i funkcje globalne.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że element wywołujący tej funkcji należy wywołać `SysFreeString` na ciąg zwrócony w celu bezpłatnych zasobów. W implementacji formantu, należy użyć `InternalGetText` do standardowych właściwości Text lub Caption formantu.  
  
##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget  
 Zastąpienie `GetWindowlessDropTarget` kiedy ma być elementem docelowym OLE kontrolce bezokienkowej przeciągnij i upuść operacji.  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do obiektu `IDropTarget` interfejsu. Ponieważ nie ma okna, nie można zarejestrować obiektu bez okien `IDropTarget` interfejsu. Jednak aby uczestniczyć w operacji przeciągania i upuszczania, bez okien obiektu można nadal implementować interfejs i przywrócić go w `GetWindowlessDropTarget`.  
  
### <a name="remarks"></a>Uwagi  
 To zwykle wymaga zarejestrowania formantu okna jako miejsca docelowego. Jednak ponieważ kontrolka nie ma żadnego okna własnych, kontener użyje osobnym oknie jako miejsca docelowego. Kontrolka musi zapewniać implementację elementu `IDropTarget` interfejsu, do którego kontenera można delegować wywołań w odpowiednim czasie. Na przykład:  
  
 [!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>  COleControl::InitializeIIDs  
 Informuje o klasie podstawowej IID w formancie będzie używana.  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>Parametry  
 *piidPrimary*  
 Wskaźnik do Identyfikatora interfejsu formantu podstawowy interfejs wysyłania.  
  
 *piidEvents*  
 Wskaźnik do interfejsu identyfikator formantu interfejsu zdarzenia.  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji w Konstruktorze formantu informują klasy podstawowej interfejsu identyfikatorów formantu, który będzie używany.  
  
##  <a name="internalgetfont"></a>  COleControl::InternalGetFont  
 Uzyskuje dostęp do właściwości standardowych czcionki formantu  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Odwołanie do [CFontHolder](../../mfc/reference/cfontholder-class.md) obiekt, który zawiera podstawowe obiektu czcionki.  
  
##  <a name="internalgettext"></a>  COleControl::InternalGetText  
 Uzyskuje dostęp do właściwości Text lub Caption standardowych formantu.  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Odwołanie do ciągu tekstowego kontrolki.  
  
##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState  
 Ustawia stan gotowości formantu.  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>Parametry  
 *lNewReadyState*  
 Stan gotowości do formantu, jeden z następujących wartości:  
  
 **READYSTATE_UNINITIALIZED**  
 Stan inicjowania domyślny  
  
 **READYSTATE_LOADING**  
 Obecnie ładowania właściwości formantu  
  
 **READYSTATE_LOADED**  
 Formant został zainicjowany  
  
 **READYSTATE_INTERACTIVE**  
 Kontrolka ma za mało danych interaktywne, ale jeszcze ładowania danych nie wszystkie asynchroniczne  
  
 `READYSTATE_COMPLETE`  
 Formant ma wszystkie jej dane  
  
### <a name="remarks"></a>Uwagi  
 Większość proste kontrolki nigdy nie należy do rozróżniania **LOADED** i `INTERACTIVE`. Jednak formantów, które obsługują właściwości ścieżki danych nie może być gotowe do przeniesienia interakcyjne do momentu otrzymania co najmniej niektóre dane asynchronicznie. Formant powinien próbować stać się interakcyjne tak szybko, jak to możliwe.  
  
##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl  
 Wymusza kontroli ponownego narysowania.  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Parametry  
 `lpRect`  
 Wskaźnik do regionu formantu unieważnione.  
  
 `bErase`  
 Określa, czy tło w obrębie regionu aktualizacji usunięte podczas przetwarzania aktualizacji regionu.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli `lpRect` ma **NULL** wartość, zostanie narysowany ponownie cały formantu. Jeśli `lpRect` nie jest **NULL**, oznacza to część prostokącie kontrolki, która jest nieprawidłowa. W przypadku formantu nie oknem lub nie jest obecnie aktywny, prostokąt jest ignorowana, połączenie jest nawiązywane w lokacji klienta [IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337) funkcję elementu członkowskiego. Aby użyć tej funkcji, zamiast `CWnd::InvalidateRect` lub `InvalidateRect`.  
  
##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn  
 Unieważnia obszaru klienckiego okna kontenera w danym regionie.  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Parametry  
 `pRgn`  
 Wskaźnik do [CRgn](../../mfc/reference/crgn-class.md) obiekt, który identyfikuje obszaru wyświetlania obiektu OLE, zanim unieważni we współrzędnych klienta okna nadrzędnego. Jeśli ten parametr ma **NULL**, zakres jest całego obiektu.  
  
 `bErase`  
 Określa, czy tła w regionie nieważne ma zostać wymazane. Jeśli **TRUE**, tło jest usunięte. Jeśli **FALSE**, tło pozostaje niezmieniona.  
  
### <a name="remarks"></a>Uwagi  
 Można to ponowne kontrolek bez okien w kontenerze. Nieważne regionu, oraz wszystkie obszary w regionie aktualizacji jest oznaczony do malowania podczas następnego [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) jest wysyłany komunikat.  
  
 Jeśli `bErase` jest **TRUE** części obszaru aktualizacji wymazaniu tła w regionie całego, nie tylko w danej części.  
  
##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX  
 Umożliwia ładowanie specjalne kontrolkę OLE.  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli formant jest przekształcany; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Podczas konwertowania formularza korzystającego z VBX kontrolki na taki, który używa formantów OLE, kod ładujący specjalne dla formantów OLE mogą być wymagane. Na przykład, jeśli czy ładowanie wystąpienia formantu OLE, może być wywołanie [px_font —](persistence-of-ole-controls.md#px_font) w Twojej `DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 Jednak formantów VBX nie miał obiekt czcionki; Każda właściwość czcionki zapisano pojedynczo. W takim przypadku należy użyć `IsConvertingVBX` odróżnienie tych dwóch przypadkach:  
  
 [!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 Innym przypadku będzie, jeśli formant VBX zapisane zastrzeżonych danych binarnych (w jego **VBM_SAVEPROPERTY** program obsługi komunikatów), a formantu OLE zapisuje dane binarne w innym formacie. Jeśli chcesz, aby być formantu OLE starszymi wersjami z formantem VBX można odczytać zarówno stary i nowy formatów przy użyciu `IsConvertingVBX` funkcja poprzez rozróżnienie, czy formant VBX lub formant OLE był ładowany.  
  
 W przypadku formantu `DoPropExchange` funkcji, można sprawdzić tego warunku i jeśli ma wartość true, wykonanie kodu obciążenia specyficzne dla tej konwersji (na przykład w poprzednich przykładach). Jeśli formant nie jest przekształcany, może uruchomić kod normalnego obciążenia. Ta możliwość ma zastosowanie tylko do formantów konwertowanej od odpowiedników VBX.  
  
##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed  
 Umożliwia wywołanie metody automatyzacji.  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli formant został zainicjowany; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 W ramach stosowania **IDispatch::Invoke** wywołania **IsInvokeAllowed** można określić, czy daną funkcję (identyfikowane przez `dispid`) mogą być przywoływane. Domyślne zachowanie dla formantu OLE jest umożliwienie automatyzacji metody można wywołać tylko wtedy, gdy formant został zainicjowany; jednak **IsInvokeAllowed** jest funkcją wirtualną i może zostać zastąpiona w razie potrzeby (na przykład, gdy formant jest używany jako serwer automatyzacji). Aby uzyskać więcej informacji, zobacz artykuł bazy wiedzy Knowledge Base Q166472, "Porada: formant jako serwer automatyzacji OLE." Artykuły bazy wiedzy są dostępne pod adresem [ http://support.microsoft.com ](http://support.microsoft.com/).  
  
##  <a name="ismodified"></a>  COleControl::IsModified  
 Określa, czy stan formantu został zmodyfikowany.  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli stan formantu został zmodyfikowany od czasu ostatniego zapisu; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Stan formantu są modyfikowane, gdy zmienia się wartość właściwości.  
  
##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw  
 Określa, czy kontener obsługuje zoptymalizowanego rysowania dla bieżącej operacji rysowania.  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 **Wartość TRUE,** , gdy kontener obsługuje zoptymalizowanego rysowania dla bieżącej operacji rysowania; w przeciwnym razie **FALSE**.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli zoptymalizowanego rysowania jest obsługiwany, następnie formantu nie wybrać stare obiekty (pióra, pędzle, czcionki itp.) w kontekście urządzenia po zakończeniu operacji rysowania.  
  
##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl  
 Wywoływane przez platformę, by określić czy kontrolka jest podklasą Windows kontroli.  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli kontrolka jest podklasą klasy; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję i zwracać **TRUE** Jeśli Twoje OLE kontrolować podklasy kontrolki okna.  
  
##  <a name="load"></a>  COleControl::Load  
 Resetuje wszystkie poprzednie dane ładowany asynchronicznie i inicjuje nowy ładowanie właściwości asynchronicznej formantu.  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>Parametry  
 *strNewPath*  
 Wskaźnik do ciąg zawierający ścieżkę, która odwołuje się do lokalizacji bezwzględnej właściwości asynchronicznej formantu.  
  
 *Prop*  
 A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) obiekt implementujący właściwości asynchronicznej formantu.  
  
##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive  
 Zapobiega dezaktywowanie formantu kontenera.  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>Parametry  
 `bLock`  
 **Wartość TRUE,** Jeśli stan aktywny w miejscu formantu jest zablokowany; **FALSE** jeśli ma zostać odblokowane.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli blokada zakończyło się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że każdy blokowania formantu muszą łączyć się z odblokowywania formantu po zakończeniu. Powinna tylko zablokować formantu w krótkich okresach, takich jak podczas zdarzenie.  
  
##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange  
 Wywoływane przez platformę, gdy zmieniono właściwość środowiska kontenera zmieniono wartość.  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>Parametry  
 *dispID*  
 Identyfikator wysyłania właściwości otoczenia zmiany, lub **DISPID_UNKNOWN** Jeśli wiele właściwości zostały zmienione.  
  
##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged  
 Wywoływane przez platformę, gdy zmieniono wartość właściwości Appearance standardowych.  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości. Domyślna implementacja wywołuje `InvalidateControl`.  
  
##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged  
 Wywoływane przez platformę, gdy wartość właściwości BackColor zostanie zmieniona.  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości. Domyślna implementacja wywołuje `InvalidateControl`.  
  
##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged  
 Wywoływane przez platformę, gdy wartość właściwości BorderStyle zostanie zmieniona.  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja wywołuje `InvalidateControl`.  
  
 Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości.  
  
##  <a name="onclick"></a>  COleControl::OnClick  
 Wywoływane przez platformę, gdy kliknięto przycisk myszy lub wywołano zapasową metodę DoClick została wywołana.  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>Parametry  
 *iButton*  
 Indeks przycisk myszy. Może mieć jeden z następujących wartości:  
  
- **LEFT_BUTTON** kliknął lewym przyciskiem myszy.  
  
- **MIDDLE_BUTTON** kliknięto środkowego przycisku myszy.  
  
- **RIGHT_BUTTON** kliknął prawym przyciskiem myszy.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja wywołuje `COleControl::FireClick`.  
  
 Przesłonić tę funkcję elementu członkowskiego, modyfikacji lub rozszerzenia obsługi domyślne.  
  
##  <a name="onclose"></a>  COleControl::OnClose  
 Wywoływane przez platformę, gdy kontener została wywołana formantu **IOleControl::Close** funkcji.  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>Parametry  
 `dwSaveOption`  
 Flaga wskazująca, czy obiekt ma zostać zapisany przed załadowaniem. Prawidłowe wartości to:  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>Uwagi  
 Domyślnie `OnClose` zapisuje obiekt formantu, jeśli został on zmodyfikowany i `dwSaveOption` jest `OLECLOSE_SAVEIFDIRTY` lub `OLECLOSE_PROMPTSAVE`.  
  
##  <a name="ondoverb"></a>  COleControl::OnDoVerb  
 Wywoływane przez platformę, gdy kontener wywoła **IOleObject::DoVerb** funkcję elementu członkowskiego.  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parametry  
 `iVerb`  
 Indeks zlecenie formantu do wywołania.  
  
 `lpMsg`  
 Wskaźnik do komunikatów systemu Windows, który spowodował zlecenie do wywołania.  
  
 `hWndParent`  
 Dojście do nadrzędnego okna formantu. Jeśli wykonanie zlecenia tworzy okno (lub systemu windows), `hWndParent` powinien być używany jako element nadrzędny.  
  
 `lpRect`  
 Wskaźnik do struktury RECT, do którego zostaną skopiowane współrzędne kontroli względem kontenera.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja używa `ON_OLEVERB` i `ON_STDOLEVERB` komunikatu wpisów map, aby ustalić prawidłowego funkcji do wywołania.  
  
 Należy przesłonić tę funkcję, aby zmienić domyślna obsługa żądań.  
  
##  <a name="ondraw"></a>  COleControl::OnDraw  
 Wywoływane przez platformę, by narysować kontrolkę OLE w zaznaczenia prostokącie określonego w kontekście określonego urządzenia.  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>Parametry  
 `pDC`  
 Kontekst urządzenia, w którym występuje rysunku.  
  
 `rcBounds`  
 Prostokątny obszar formantu, łącznie z obramowania.  
  
 `rcInvalid`  
 Prostokątny obszar formant, który jest nieprawidłowy.  
  
### <a name="remarks"></a>Uwagi  
 `OnDraw` nazywa się zwykle do wyświetlania na ekranie, przekazywanie kontekstu ekranu urządzenia jako `pDC`. `rcBounds` Parametr identyfikuje prostokąt w kontekście urządzenia docelowego (względem bieżącego trybu mapowanie). `rcInvalid` Parametr jest rzeczywista prostokąt, który jest nieprawidłowy. W niektórych przypadkach będzie mniejszy obszar niż `rcBounds`.  
  
##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile  
 Wywoływane przez platformę, by narysować kontrolkę OLE w zaznaczenia prostokącie określonego za pomocą kontekstu urządzenia określonego meta pliku.  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Parametry  
 `pDC`  
 Kontekst urządzenia, w którym występuje rysunku.  
  
 `rcBounds`  
 Prostokątny obszar formantu, łącznie z obramowania.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja wywołuje [OnDraw](#ondraw) funkcji.  
  
##  <a name="onedit"></a>  COleControl::OnEdit  
 Powoduje, że formantu ma być aktywowana w interfejsie użytkownika.  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parametry  
 `lpMsg`  
 Wskaźnik do komunikatów systemu Windows, który wywołał zlecenia.  
  
 `hWndParent`  
 Dojście do nadrzędnego okna formantu.  
  
 `lpRect`  
 Wskaźnik do prostokąta używany przez formant w kontenerze.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli wywołanie zakończy się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Jest to ten sam efekt co wywoływanie formantu `OLEIVERB_UIACTIVATE` zlecenia.  
  
 Ta funkcja jest zwykle używana jako funkcji obsługi dla `ON_OLEVERB` komunikatu wpisu mapy. Dzięki temu zlecenie "Edit" dostępne w menu "Obiektu" formantu. Na przykład:  
  
 [!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged  
 Wywoływane przez platformę, gdy zmieniono wartość właściwości Enabled zasobów.  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości. Domyślna implementacja wywołuje [InvalidateControl](#invalidatecontrol).  
  
##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs  
 Wywoływane przez platformę, gdy kontener wywoła **IOleObject::EnumVerbs** funkcję elementu członkowskiego.  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>Parametry  
 `ppenumOleVerb`  
 Wskaźnik do **IEnumOLEVERB** obiektu, który wylicza zlecenia kontrolki.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli są dostępne; zlecenia w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja wylicza `ON_OLEVERB` wpisy mapy wiadomości.  
  
 Przesłonić tę funkcję, aby zmienić domyślną metodą Wylicz zleceń.  
  
##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise  
 Wywoływane przez platformę, gdy program obsługi zdarzeń jest podłączony do lub odłączony od kontrolkę OLE.  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>Parametry  
 `bAdvise`  
 **Wartość TRUE,** wskazuje, czy program obsługi zdarzeń został połączony z formantu. **FALSE** wskazuje, czy program obsługi zdarzeń został odłączony od formantu.  
  
##  <a name="onfontchanged"></a>  COleControl::OnFontChanged  
 Wywoływane przez platformę, gdy zmieniono wartość właściwości czcionki.  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja wywołuje `COleControl::InvalidateControl`. Jeśli formant jest tworzenie podklasy kontrolki systemu Windows, domyślną implementację wysyła również **WM_SETFONT** wiadomości do okna formantu.  
  
 Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged  
 Wywoływane przez platformę, gdy zmieniono wartość właściwości ForeColor standardowych.  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja wywołuje `InvalidateControl`.  
  
 Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości.  
  
##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents  
 Wywoływane przez platformę po wywołania kontenera **IOleControl::FreezeEvents**.  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>Parametry  
 `bFreeze`  
 **Wartość TRUE,** Jeśli formantu obsługi zdarzeń jest zablokowane; w przeciwnym razie **FALSE**.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja nie działa.  
  
 Należy przesłonić tę funkcję, jeśli chcesz, dodatkowe zachowanie podczas obsługi zdarzeń jest zablokowany lub odblokowany.  
  
##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet  
 Wywoływane przez platformę, gdy kontener wywoła **IViewObject::GetColorSet** funkcję elementu członkowskiego.  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>Parametry  
 `ptd`  
 Wskazuje urządzenie docelowe, dla której ma być renderowany obraz. Jeśli ta wartość jest **NULL**, powinien być renderowany obraz dla domyślnego urządzenia, zwykle ekranu urządzenia.  
  
 `hicTargetDev`  
 Określa kontekst informacje na urządzeniu docelowym wskazaniem `ptd`. Ten parametr może być kontekst urządzenia, ale nie jest jedną. Jeśli `ptd` jest **NULL**, `hicTargetDev` należy również **NULL**.  
  
 *ppColorSet*  
 Wskaźnik do lokalizacji, do którego powinien zostać skopiowany zestaw kolorów, które mają być używane. Jeśli funkcja nie zwraca zestaw kolorów **NULL** jest zwracany.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli zostanie zwrócony prawidłowy kolor zestaw; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Kontener wywołuje tę funkcję, aby uzyskać wszystkie kolory potrzebne do rysowania formantu OLE. Kontener można użyć Ustawia kolor uzyskane w połączeniu z kolorami, należy ją ustawić ogólną paletę kolorów. Domyślna implementacja zwraca **FALSE**.  
  
 Zastąp tę funkcję, aby wykonać wszelkie specjalne przetwarzania tego żądania.  
  
##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo  
 Wywoływane przez platformę, gdy formantu kontenera zażądał informacji na temat kontroli.  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>Parametry  
 `pControlInfo`  
 Wskaźnik do [CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734) struktury zostać wypełnione.  
  
### <a name="remarks"></a>Uwagi  
 Te informacje obejmuje głównie opis klawiszami mnemoników formantu. Wypełnienia implementacji domyślnej `pControlInfo` przy użyciu informacji domyślnych.  
  
 Należy przesłonić tę funkcję, jeśli formant musi przetworzyć klawiszy skrótu.  
  
##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString  
 Wywoływane przez platformę, by uzyskać ciąg reprezentujący bieżącą wartość właściwości określonej przez `dispid`.  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>Parametry  
 `dispid`  
 Identyfikator wysyłania właściwości formantu.  
  
 `strValue`  
 Odwołanie do [cstring —](../../atl-mfc-shared/reference/cstringt-class.md) obiektu za pomocą którego zostanie zwrócony ciąg.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli został zwrócony ciąg w *strValue;* w przeciwnym razie wartość 0.  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję, jeśli formantu ma właściwość, której wartość nie może zostać bezpośrednio przekonwertowany na ciąg, wartość właściwości do wyświetlenia w przeglądarce właściwości dostarczony kontenera.  
  
##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu  
 Wywoływane przez platformę, gdy formant jest aktywowana uzyskać menu do scalenia do istniejącego menu kontenera w interfejsie użytkownika.  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Dojście menu kontrolki lub **NULL** Jeśli formant ma wartość none. Domyślna implementacja zwraca **NULL**.  
  
### <a name="remarks"></a>Uwagi  
 Aby uzyskać więcej informacji o scalaniu OLE zasobów, zobacz artykuł [menu i zasoby (OLE)](../../mfc/menus-and-resources-ole.md).  
  
##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent  
 Metoda wywoływana przez platformę w odpowiedzi na kontenera **IViewObjectEx::GetNaturalExtent** żądania.  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>Parametry  
 `dwAspect`  
 Określa, jak ma być reprezentowane obiektu. Reprezentacje obejmują zawartość, ikona, miniaturę lub wydrukować dokument. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) lub **DVASPECT2**.  
  
 *lindex*  
 Część obiektu, który ma znaczenie. Obecnie tylko wartość -1 jest nieprawidłowy.  
  
 `ptd`  
 Wskazuje [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) struktury Definiowanie urządzenie docelowe, dla którego ma zostać zwrócony rozmiar obiektu.  
  
 `hicTargetDev`  
 Określa kontekst informacji dla urządzenia wskazywanym przez `ptd` parametru, z której obiekt można wyodrębnić metryki urządzenia i testowanie możliwości urządzenia. Jeśli `ptd` jest **NULL**, obiekt ignorować wartość `hicTargetDev` parametru.  
  
 *pExtentInfo*  
 Wskazuje **DVEXTENTINFO** strukturę, która określa rozmiar danych. **DVEXTENTINFO** struktura jest:  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 Element członkowski struktury `dwExtentMode` można wykonać jedną z dwóch wartości:  
  
- **DVEXTENT_CONTENT** zapytanie, jak duże formant powinien być dokładnie dopasowana do zawartości (przystawki — rozmiar)  
  
- **DVEXTENT_INTEGRAL** podczas zmiany rozmiaru, przekazać proponowanych rozmiar do formantu  
  
 `psizel`  
 Wskazuje zmiany rozmiaru danych zwróconych przez formant. Dane zwrócone zmiany rozmiaru ma ustawioną wartość -1 dla każdego wymiaru, która nie została dostosowana.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli pomyślnie zwraca lub ustawia rozmiar; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Przesłonić tę funkcję, aby zwrócić rozmiar wyświetlania obiektu najbliżej proponowanych Tryb rozmiaru i zakres, w **DVEXTENTINFO** struktury. Domyślna implementacja zwraca **FALSE** i sprawia, że nie zmiany rozmiaru.  
  
##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings  
 Wywoływane przez platformę, by uzyskać zestaw wstępnie zdefiniowanych ciągów reprezentujących możliwe wartości dla właściwości.  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>Parametry  
 `dispid`  
 Identyfikator wysyłania właściwości formantu.  
  
 `pStringArray`  
 Wartości zwracane należy podać w tablicy ciągów.  
  
 `pCookieArray`  
 A `DWORD` tablicy w celu wprowadzenia wartości zwracanych.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli elementy zostały dodane do `pStringArray` i `pCookieArray`.  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję, jeśli formant ma właściwość zestaw możliwych wartości, które mogą być reprezentowane przez parametry. Dla każdego elementu dodane do `pStringArray`, należy dodać do odpowiedniego elementu "plik cookie" *pCookieArray.* Te wartości "plików cookie" później mogą być przekazywane przez platformę, by `COleControl::OnGetPredefinedValue` funkcji.  
  
##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue  
 Wywoływane przez platformę, by uzyskać wartości jednego z wstępnie zdefiniowanych ciągów, które wcześniej zostały zwrócone przez nadpisanie `COleControl::OnGetPredefinedStrings`.  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>Parametry  
 `dispid`  
 Identyfikator wysyłania właściwości formantu.  
  
 `dwCookie`  
 Wartość pliku cookie wcześniej zostały zwrócone przez nadpisanie `COleControl::OnGetPredefinedStrings`.  
  
 `lpvarOut`  
 Wskaźnik do **VARIANT** struktury za pomocą której będą zwracane wartości właściwości.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli wartość została zwrócona w `lpvarOut`; w przeciwnym razie wartość 0.  
  
##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent  
 Metoda wywoływana przez platformę w odpowiedzi na kontenera [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) żądania.  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>Parametry  
 *dwDrawAspect*  
 `DWORD` opisujące, które tworzą lub aspekt, obiektu ma być wyświetlany. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) lub **DVASPECT2**.  
  
 *lindex*  
 Część obiektu, który ma znaczenie. Obecnie tylko wartość -1 jest nieprawidłowy.  
  
 `ptd`  
 Wskazuje [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) struktury Definiowanie urządzenie docelowe, dla którego ma zostać zwrócony rozmiar obiektu.  
  
 *lpsizel*  
 Wskazuje lokalizację, w której jest zwracana rozmiar obiektu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli informacje o zakresie pomyślnie zostanie zwrócony; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję, jeśli formantu używa dwóch przebiegu rysunku, a jego części nieprzezroczystych i przezroczysty mają różne wymiary.  
  
##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect  
 Metoda wywoływana przez platformę w odpowiedzi na kontenera **IViewObjectEx::GetRect** żądania.  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>Parametry  
 `dwAspect`  
 `DWORD` opisujące, które tworzą lub aspekt, obiektu ma być wyświetlany. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) lub **DVASPECT2**:  
  
- `DVASPECT_CONTENT` Prostokąt ograniczający całego obiektu. Lewego górnego narożnika w pochodzenia i rozmiarze równym stopniu zwrócona przez obiekt **GetViewExtent ***.*  
  
- **DVASPECT_OPAQUE** obiekty o prostokątny obszar nieprzezroczyste zwrócić tego prostokąta. Inne zakończyć się niepowodzeniem.  
  
- **DVASPECT_TRANSPARENT** prostokąt obejmujące wszystkie części przezroczysty lub nieprawidłowo.  
  
 `pRect`  
 Wskazuje [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) struktury Określanie prostokąt, w którym ma być rysowany obiektu. Ten parametr określa pozycjonowanie i rozciąganie obiektu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli pomyślnie zwracany jest prostokąt o rozmiarze do obiektu; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Rozmiar obiektu jest konwertowany przez `OnGetViewRect` do prostokąta, zaczynając od określonej pozycji (wartość domyślna to lewym górnym rogu ekranu). Należy przesłonić tę funkcję, jeśli formantu używa dwóch przebiegu rysunku, a jego części nieprzezroczystych i przezroczysty mają różne wymiary.  
  
##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus  
 Metoda wywoływana przez platformę w odpowiedzi na kontenera **IViewObjectEx::GetViewStatus** żądania.  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Jedna z wartości z **podwójne** wyliczenia w przypadku powodzenia; w przeciwnym razie wartość 0. Możliwe wartości to dowolne z następujących czynności:  
  
 **VIEWSTATUS_OPAQUE**  
 Obiekt jest całkowicie przezroczystości. Jeśli nie ustawiono tej bit, obiekt zawiera części przezroczysty. Ten bit ma zastosowanie tylko aspektów zawartości, a nie do `DVASPECT_ICON` lub `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_SOLIDBKGND**  
 Obiekt ma jednolite tło (składające się pełnego koloru, nie zaś wzoru pędzla). Ten bit ma znaczenie tylko wtedy, gdy **VIEWSTATUS_OPAQUE** jest ustawiona i ma zastosowanie tylko do aspektów zawartości, a nie do `DVASPECT_ICON` lub `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 Obiekt obsługuje **DVASPECT_OPAQUE**. Wszystkie **IViewObjectEx** metody przyjmujących aspekt rysowania parametru może być wywołany z tym aspektem.  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 Obiekt obsługuje **DVASPECT_TRANSPARENT**. Wszystkie **IViewObjectEx** metody przyjmujących aspekt rysowania parametru może być wywołany z tym aspektem.  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję, jeśli formantu używa dwóch przebiegu rysunku. Domyślna implementacja zwraca **VIEWSTATUS_OPAQUE**.  
  
##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars  
 Wywoływane przez platformę, gdy formant interfejsu użytkownika jest dezaktywowana.  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>Uwagi  
 Implementacja powinna ukrywanie wszystkich pasków narzędzi wyświetlanych przez `OnShowToolbars`.  
  
##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove  
 Wywołanie przez kontener dla nieaktywnych obiektu pod kursorem myszy po otrzymaniu `WM_MOUSEMOVE` wiadomości.  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>Parametry  
 `lprcBounds`  
 Obiekt ograniczenia prostokąt we współrzędnych klienta okna nadrzędnego. Określa, że obiekt jego dokładne położenie i rozmiar na ekranie podczas `WM_MOUSEMOVE` wiadomość została odebrana.  
  
 *x*  
 Współrzędna x lokalizacji myszy we współrzędnych klienta okna nadrzędnego.  
  
 *y*  
 Współrzędna y lokalizacji myszy we współrzędnych klienta okna nadrzędnego.  
  
 `dwKeyState`  
 Określa bieżący stan klawisze modyfikujące klawiatury na klawiaturze. Prawidłowe wartości może być kombinacją dowolnych flagi **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_BUTTON**, **MK_ LBUTTON**, **MK_MBUTTON**, i **MK_RBUTTON**.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że współrzędne klienta okna (w pikselach) są używane do przekazywania pozycji kursora myszy. Jest to możliwe również przekazując prostokątem obiektu w tym samym współrzędnych.  
  
##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor  
 Wywołanie przez kontener dla nieaktywnych obiektu pod kursorem myszy po otrzymaniu `WM_SETCURSOR` wiadomości.  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>Parametry  
 `lprcBounds`  
 Obiekt ograniczenia prostokąt we współrzędnych klienta okna nadrzędnego. Określa, że obiekt jego dokładne położenie i rozmiar na ekranie podczas `WM_SETCURSOR` wiadomość została odebrana.  
  
 *x*  
 Współrzędna x lokalizacji myszy we współrzędnych klienta okna nadrzędnego.  
  
 *y*  
 Współrzędna y lokalizacji myszy we współrzędnych klienta okna nadrzędnego.  
  
 *dwMouseMsg*  
 Identyfikator komunikatu myszy, dla którego `WM_SETCURSOR` wystąpił.  
  
 *bSetAlways*  
 Określa, czy obiekt musi ustawić kursor. Jeśli **TRUE**, obiekt musi ustawić kursor; Jeśli **FALSE**, kursor nie ma obowiązku Ustaw kursor i powinien zwrócić **S_FALSE** w takim przypadku.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że współrzędne klienta okna (w pikselach) są używane do przekazywania pozycji kursora myszy. Jest to możliwe również przekazując prostokątem obiektu w tym samym współrzędnych.  
  
##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent  
 Wywoływane przez platformę po przetworzeniu zdarzenia KeyDown standardowych.  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Parametry  
 `nChar`  
 Wartość kodu klucza wirtualnego naciśnięty klawisz. Listę standardowych wirtualnego kodów klucza Zobacz Winuser.h  
  
 `nShiftState`  
 Zawiera kombinację następujących flag:  
  
- **SHIFT_MASK** naciśnięto klawisz SHIFT podczas akcji.  
  
- **CTRL_MASK** naciśnięto klawisz CTRL podczas akcji.  
  
- **ALT_MASK** w trakcie akcji został naciśnięty klawisz ALT.  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję, jeśli formant musi mieć dostęp do kluczowych informacji po zdarzenie zostało wyzwolone.  
  
##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent  
 Wywoływane przez platformę po zasobów, które zdarzenia KeyPress zostały uruchamiany.  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>Parametry  
 `nChar`  
 Zawiera wartość wirtualnego kod klucza naciśnięto klawisz. Listę standardowych wirtualnego kodów klucza Zobacz Winuser.h  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że `nChar` wartość została zmodyfikowana przez kontener.  
  
 Należy przesłonić tę funkcję, jeśli chcesz powiadomienie po wystąpieniu tego zdarzenia.  
  
##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent  
 Wywoływane przez platformę po przetworzeniu zdarzenia KeyDown standardowych.  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Parametry  
 `nChar`  
 Wartość kodu klucza wirtualnego naciśnięty klawisz. Listę standardowych wirtualnego kodów klucza Zobacz Winuser.h  
  
 `nShiftState`  
 Zawiera kombinację następujących flag:  
  
- **SHIFT_MASK** naciśnięto klawisz SHIFT podczas akcji.  
  
- **CTRL_MASK** naciśnięto klawisz CTRL podczas akcji.  
  
- **ALT_MASK** w trakcie akcji został naciśnięty klawisz ALT.  
  
### <a name="remarks"></a>Uwagi  
 Należy przesłonić tę funkcję, jeśli formant musi mieć dostęp do kluczowych informacji po zdarzenie zostało wyzwolone.  
  
##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage  
 Wywoływane przez platformę, by uzyskać identyfikator klasy strony właściwości, która implementuje edytowanie określonej właściwości.  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>Parametry  
 `dispid`  
 Identyfikator wysyłania właściwości formantu.  
  
 `lpclsid`  
 Wskaźnik do **CLSID** struktury za pomocą której będą zwracane Identyfikatora klasy.  
  
 *pbPageOptional*  
 Zwraca wskaźnik czy Użyj strony określona właściwość jest opcjonalna.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli identyfikator klasy została zwrócona w `lpclsid`; w przeciwnym razie wartość 0.  
  
### <a name="remarks"></a>Uwagi  
 Zastąp tę funkcję, aby zapewnić sposób wywołania strony właściwości formantu w przeglądarce właściwości kontenera.  
  
##  <a name="onmnemonic"></a>  COleControl::OnMnemonic  
 Wywoływane przez platformę, gdy kontener wykrył, że naciśnięto klawisz skrótu formantu OLE.  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>Parametry  
 `pMsg`  
 Wskaźnik do komunikatów systemu Windows, generowane przez naciśnięcie klawisza skrótu.  
  
##  <a name="onproperties"></a>  COleControl::OnProperties  
 Wywoływane przez platformę, gdy zlecenie właściwości formantu została wywołana przez kontener.  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parametry  
 `lpMsg`  
 Wskaźnik do komunikatów systemu Windows, który wywołał zlecenia.  
  
 `hWndParent`  
 Dojście do nadrzędnego okna formantu.  
  
 `lpRect`  
 Wskaźnik do prostokąta używany przez formant w kontenerze.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli wywołanie zakończy się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja Wyświetla okno dialogowe właściwości modalne.  
  
 Ta funkcja umożliwia także spowodować wyświetlenie strony właściwości formantu. Wywoływania `OnProperties` funkcja przekazywanie uchwyt formantu nadrzędnego `hWndParent` parametru. W tym przypadku wartości `lpMsg` i `lpRect` parametry są ignorowane.  
  
##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint  
 Metoda wywoływana przez platformę w odpowiedzi na kontenera **IViewObjectEx::QueryHitPoint** żądania.  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Parametry  
 `dwAspect`  
 Określa, jak są reprezentowane obiektu. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) lub **DVASPECT2**.  
  
 `pRectBounds`  
 Wskaźnik do `RECT` struktury Określanie prostokąt ograniczający obszaru klienckiego formantu OLE.  
  
 `ptlLoc`  
 Wskaźnik do **punktu** określenie punktu mają być sprawdzane trafienie struktury. Punkt jest określony we współrzędnych obszaru klienta OLE.  
  
 `lCloseHint`  
 Odległość, który definiuje "Zamknij" do punktu sprawdzane pod kątem trafienie.  
  
 `pHitResult`  
 Wskaźnik do wyników zapytania trafień. Jedna z następujących wartości:  
  
- **HITRESULT_OUTSIDE** `ptlLoc` jest poza OLE obiektu i zamknięcia.  
  
- **HITRESULT_TRANSPARENT** *ptlLoc* znajduje się w granicach obiektu OLE, ale nie w pobliżu obrazu. Na przykład może być punkt środku przezroczysty koło **HITRESULT_TRANSPARENT**.  
  
- **HITRESULT_CLOSE** `ptlLoc` jest wewnątrz lub na zewnątrz obiektu OLE, ale tyle do obiektu, aby można je było uważać wewnątrz. Mała, elastyczne lub szczegółowych obiektów może użyć tej wartości. Nawet jeśli dany punkt znajduje się poza ograniczenia prostokąt obiektu wciąż może być Zamknij (wymagane dla naciśnięcie małych obiektów).  
  
- **HITRESULT_HIT** `ptlLoc` jest w obrębie obrazu obiektu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli pomyślnie zostanie zwrócony wynik trafień; w przeciwnym razie 0. Trafienie jest pokrywają się obszar wyświetlania formantu OLE.  
  
### <a name="remarks"></a>Uwagi  
 Zapytanie, czy obiekt prostokątny obszar wyświetlania nakłada danego punktu (trafienia punktu). `QueryHitPoint` może zostać zastąpiona w celu testowania trafień nieregularnych obiektów.  
  
##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect  
 Metoda wywoływana przez platformę w odpowiedzi na kontenera **IViewObjectEx::QueryHitRect** żądania.  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Parametry  
 `dwAspect`  
 Określa, jak ma być reprezentowane obiektu. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) lub **DVASPECT2**.  
  
 `pRectBounds`  
 Wskaźnik do `RECT` struktury Określanie prostokąt ograniczający obszaru klienckiego formantu OLE.  
  
 *prcLoc*  
 Wskaźnik do `RECT` struktury Określanie prostokąt mają być sprawdzane trafień (nakładają się na prostokąt obiektu), względem lewym górnym rogu obiektu.  
  
 `lCloseHint`  
 Nie używany.  
  
 `pHitResult`  
 Wskaźnik do wyników zapytania trafień. Jedna z następujących wartości:  
  
- **HITRESULT_OUTSIDE** żaden punkt w prostokącie zostaje trafiony przez obiekt OLE.  
  
- **HITRESULT_HIT** co najmniej jeden punkt w prostokącie byłoby trafień dla obiektu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli pomyślnie zostanie zwrócony wynik trafień; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Pyta, czy prostokątny obszar wyświetlania obiektu nakłada dowolnego punktu w danym prostokąt (trafienia prostokąt). `QueryHitRect` może zostać zastąpiona w celu testowania trafień nieregularnych obiektów.  
  
##  <a name="onrenderdata"></a>  COleControl::OnRenderData  
 Wywoływane przez platformę, by pobrać dane w określonym formacie.  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>Parametry  
 `lpFormatEtc`  
 Wskazuje [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struktury, określając format, w którym jest wymagane informacje.  
  
 `lpStgMedium`  
 Wskazuje [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) struktury, w którym ma zostać zwrócone dane.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Określony format jest jednym umieszczone wcześniej za pomocą obiektu kontroli [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) lub [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) funkcje Członkowskie dla opóźnione renderowanie. Domyślna implementacja ta funkcja wymaga `OnRenderFileData` lub `OnRenderGlobalData`, jeśli podany nośnik jest pliku lub pamięci. Jeśli żądany format jest `CF_METAFILEPICT` lub ustawić właściwość trwały formatu, domyślna implementacja renderuje odpowiednie dane i zwraca różną od zera. W przeciwnym razie zwraca wartość 0 i nie działają.  
  
 Jeśli *lpStgMedium -> tymed* jest **TYMED_NULL**, **STGMEDIUM** powinny być przydzielone i wypełnione określony przez *lpFormatEtc -> tymed*. Jeśli nie **TYMED_NULL**, **STGMEDIUM** powinno być wypełnione w miejscu z danymi.  
  
 Należy przesłonić tę funkcję, aby zapewnić dane w formacie żądanego i średnia liczba godzin. W zależności od danych warto override jednego z innych wersji tej funkcji. Jeśli dane są małe i stały rozmiar, Zastąp `OnRenderGlobalData`. Jeśli znajduje się w pliku danych lub o rozmiarze zmiennej, Zastąp `OnRenderFileData`.  
  
 Aby uzyskać więcej informacji, zobacz **FORMATETC** i **STGMEDIUM** struktury w zestawie Windows SDK.  
  
##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData  
 Wywoływane przez platformę, by pobrać dane w określonym formacie, gdy nośnik to plik.  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>Parametry  
 `lpFormatEtc`  
 Wskazuje [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struktury, określając format, w którym jest wymagane informacje.  
  
 `pFile`  
 Wskazuje [cfile —](../../mfc/reference/cfile-class.md) obiektu, w którym ma być renderowany danych.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Określony format jest jednym umieszczone wcześniej za pomocą obiektu kontroli [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) funkcji członkowskiej do renderowania opóźnione. Domyślna implementacja tej funkcji po prostu zwraca **FALSE**.  
  
 Należy przesłonić tę funkcję, aby zapewnić dane w formacie żądanego i średnia liczba godzin. W zależności od danych warto override jednego z innych wersji tej funkcji. Jeśli chcesz obsługiwać wiele nośników magazynowania, należy zastąpić `OnRenderData`. Jeśli znajduje się w pliku danych lub o rozmiarze zmiennej, Zastąp `OnRenderFileData`.  
  
 Aby uzyskać więcej informacji, zobacz **FORMATETC** struktury w zestawie Windows SDK.  
  
##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData  
 Wywoływane przez platformę, by pobrać dane w określonym formacie po określonym nośnik pamięci globalnej.  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>Parametry  
 `lpFormatEtc`  
 Wskazuje [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struktury, określając format, w którym jest wymagane informacje.  
  
 `phGlobal`  
 Wskazuje dojścia do globalnej pamięci, w którym ma zostać zwrócone dane. Jeśli brak pamięci została przydzielona, ten parametr może być **NULL**.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Określony format jest jednym umieszczone wcześniej za pomocą obiektu kontroli [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) funkcji członkowskiej do renderowania opóźnione. Domyślna implementacja tej funkcji po prostu zwraca **FALSE**.  
  
 Jeśli `phGlobal` jest **NULL**, następnie nowy `HGLOBAL` powinny być przydzielone i zwracany w `phGlobal`. W przeciwnym razie `HGLOBAL` określonego przez `phGlobal` powinno być wypełnione z danymi. Ilość danych umieszczone w `HGLOBAL` nie może przekraczać bieżący rozmiar bloku pamięci. Ponadto nie można przydzielić bloku, aby większy rozmiar.  
  
 Należy przesłonić tę funkcję, aby zapewnić dane w formacie żądanego i średnia liczba godzin. W zależności od danych warto override jednego z innych wersji tej funkcji. Jeśli chcesz obsługiwać wiele nośników magazynowania, należy zastąpić `OnRenderData`. Jeśli znajduje się w pliku danych lub o rozmiarze zmiennej, Zastąp `OnRenderFileData`.  
  
 Aby uzyskać więcej informacji, zobacz **FORMATETC** struktury w zestawie Windows SDK.  
  
##  <a name="onresetstate"></a>  COleControl::OnResetState  
 Wywoływane przez platformę, gdy właściwości formantu powinna być równa wartości domyślnych.  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja wywołuje [DoPropExchange](#dopropexchange), przechodzącą `CPropExchange` obiekt, który powoduje, że właściwości można ustawić wartości domyślne.  
  
 Moduł zapisujący formantu można wstawić kod inicjujący formantu OLE w tym możliwym do zastąpienia. Ta funkcja jest wywoływana, gdy [IPersistStream::Load](http://msdn.microsoft.com/library/windows/desktop/ms680568) lub [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) nie powiedzie się, lub [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) lub [IPersistStorage: : InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) jest wywoływana bez wywoływania albo **IPersistStream::Load** lub **IPersistStorage::Load**.  
  
##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite  
 Wywoływane przez platformę, gdy kontener została wywołana formantu **IOleControl::SetClientSite** funkcji.  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślnie `OnSetClientSite` sprawdza, czy załadowano właściwości ścieżki danych i, jeśli są one wywołuje `DoDataPathPropExchange`.  
  
 Zastąp tę funkcję, aby wykonać wszelkie specjalne przetwarzania tego powiadomienia. W szczególności zastąpienia tej funkcji powinny wywoływać klasy podstawowej.  
  
##  <a name="onsetdata"></a>  COleControl::OnSetData  
 Wywoływane przez platformę, aby zamienić dane formantu z określonymi danymi.  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>Parametry  
 `lpFormatEtc`  
 Wskaźnik do [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Struktura określająca format danych.  
  
 `lpStgMedium`  
 Wskaźnik do [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) struktury, w którym znajdują się dane.  
  
 `bRelease`  
 **Wartość TRUE,** Jeśli formant powinna zwolnić nośniku; **FALSE** Jeśli formant nie powinna zwolnić nośnika magazynowania.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli we właściwości trwałych danych ustawiono format, domyślna implementacja odpowiednio modyfikuje stan formantu. W przeciwnym razie wartość domyślna implementacja nie działa. Jeśli `bRelease` jest **TRUE**, następnie wywołania **ReleaseStgMedium** staje się; w przeciwnym razie nie.  
  
 Należy przesłonić tę funkcję, aby zamienić dane formantu z określonymi danymi.  
  
 Aby uzyskać więcej informacji, zobacz **FORMATETC** i **STGMEDIUM** struktury w zestawie Windows SDK.  
  
##  <a name="onsetextent"></a>  COleControl::OnSetExtent  
 Wywoływane przez platformę, gdy rozszerzenie kontrolki musi zostać zmienione w wyniku wywołania [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330).  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>Parametry  
 `lpSizeL`  
 Wskaźnik do **skali** strukturę, która używa długich liczb całkowitych do reprezentowania szerokość i wysokość formantu, wyrażone w **HIMETRIC** jednostki.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli zmiana rozmiaru został zaakceptowany, w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja obsługuje zmienianie rozmiaru formantu zakresu. Jeśli formant jest aktywny w miejscu, wywołanie kontenera **OnPosRectChanged** jest przeprowadzane.  
  
 Należy przesłonić tę funkcję, aby zmienić domyślne zmianę rozmiaru formantu.  
  
##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects  
 Wywoływane przez platformę, by zaimplementować wywołanie [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767).  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>Parametry  
 *lpRectPos*  
 Wskaźnik do struktury RECT wskazujący nowe położenie i rozmiar względem kontenera formantu.  
  
 `lpRectClip`  
 Wskaźnik do `RECT` struktury wskazujący prostokątny obszar, w którym ma zostać obcięty formantu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli zmiana położenia został zaakceptowany, w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja automatycznie obsługuje zmiany położenia i rozmiaru okna formantu i zwraca **TRUE**.  
  
 Należy przesłonić tę funkcję, aby zmienić domyślne zachowanie tej funkcji.  
  
##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars  
 Wywoływane przez platformę, gdy kontrolka została aktywowana w interfejsie użytkownika.  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja nie działa.  
  
##  <a name="ontextchanged"></a>  COleControl::OnTextChanged  
 Wywoływane przez platformę, gdy zmieniono wartość standardowych właściwości podpisu lub tekst.  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja wywołuje `InvalidateControl`.  
  
 Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości.  
  
##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage  
 Metoda wywoływana przez platformę w odpowiedzi na kontenera **IOleInPlaceObjectWindowless::OnWindowMessage** żądania.  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>Parametry  
 `msg`  
 Identyfikator wiadomości przekazany przez system Windows.  
  
 `wParam`  
 Jak przekazany przez system Windows. Określa dodatkowe informacje specyficzne dla wiadomości. Zawartość tego parametru zależy od wartości `msg` parametru.  
  
 `lParam`  
 Jak przekazany przez system Windows. Określa dodatkowe informacje specyficzne dla wiadomości. Zawartość tego parametru zależy od wartości `msg` parametru.  
  
 *plResult*  
 Kod wyniku systemu Windows. Określa wynik przetwarzania komunikatów i jest zależna od wiadomość została wysłana.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Przetwarza komunikatów okien kontrolek bez okien. `COleControl`w `OnWindowlessMessage` powinna być używana do komunikatów okien innych niż komunikatów myszy i klawiatury komunikatów. `COleControl` udostępnia [SetCapture](#setcapture) i [SetFocus](#setfocus) specjalnie, aby uzyskać fokusu myszą przechwytywania i klawiatury dla obiektów OLE bez okien.  
  
 Ponieważ obiekty niepowiązane z oknami nie ma okna, muszą one mechanizm let do nich wiadomości wysyłania kontenera. Bez okien obiektu OLE pobiera komunikaty z jego kontenera za pomocą `OnWindowMessage` metoda `IOleInPlaceObjectWindowless` interfejsu (rozszerzenie [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) niepowiązane z oknami obsługi). `OnWindowMessage` nie przyjmuje `HWND` parametru.  
  
##  <a name="parenttoclient"></a>  COleControl::ParentToClient  
 Wykonuje translację współrzędne `pPoint` na współrzędne klienta.  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `lprcBounds`  
 Wskaźnik do granice formantu OLE w kontenerze. Ale nie obszaru klienckiego obszaru całego kontrolki, w tym obramowania i paski przewijania.  
  
 `pPoint`  
 Wskaźnik do elementu nadrzędnego (kontener) wskaż można przetłumaczyć jej na współrzędne obszaru klienckiego formantu.  
  
 `bHitTest`  
 Określa, czy testowania trafień ma zostać wykonane w punkcie.  
  
### <a name="return-value"></a>Wartość zwracana  
 Jeśli `bHitTest` jest **FALSE**, zwraca **HTNOWHERE**. Jeśli `bHitTest` jest **TRUE**, zwraca lokalizacji, w której punkt nadrzędnego (kontener) jest obszaru klienckiego formantu OLE i jest jednym z następujących myszy trafień testowania:  
  
- **HTBORDER** na krawędzi, który nie ma obramowanie zmiany rozmiaru okna.  
  
- **HTBOTTOM** w poziomie dolną krawędź okna.  
  
- **HTBOTTOMLEFT** w lewym dolnym rogu krawędź okna.  
  
- **HTBOTTOMRIGHT** w prawym dolnym rogu krawędź okna.  
  
- **HTCAPTION** obszar paska tytułu.  
  
- **HTCLIENT** w obszarze klienta.  
  
- **HTERROR** tła ekranu lub linię podziału między systemem windows (taka sama jak **HTNOWHERE** z tą różnicą, że **DefWndProc** funkcji systemu Windows daje sygnał dźwiękowy systemu wystąpił błąd).  
  
- **HTGROWBOX** w polu rozmiar.  
  
- **HTHSCROLL** na pasku przewijania w poziomie.  
  
- **HTLEFT** w lewej krawędzi okna.  
  
- **HTMAXBUTTON** w zmaksymalizować przycisku.  
  
- **HTMENU** obszar menu.  
  
- **HTMINBUTTON** w zminimalizować przycisku.  
  
- **HTNOWHERE** tła ekranu lub linię podziału między systemem windows.  
  
- **HTREDUCE** w zminimalizować przycisku.  
  
- **HTRIGHT** w prawej krawędzi okna.  
  
- **HTSIZE** w polu Rozmiar (taki sam jak **HTGROWBOX**).  
  
- **HTSYSMENU** w menu kontroli lub przycisk Zamknij okno podrzędne.  
  
- **HTTOP** na poziomy górnej krawędzi okna.  
  
- **HTTOPLEFT** w lewym górnym rogu krawędź okna.  
  
- **HTTOPRIGHT** w prawym górnym rogu krawędź okna.  
  
- **HTTRANSPARENT** w oknie obecnie pasuje do żadnego innego okna.  
  
- **HTVSCROLL** w pionowy pasek przewijania.  
  
- **HTZOOM** w zmaksymalizować przycisku.  
  
### <a name="remarks"></a>Uwagi  
 W danych wejściowych `pPoint` jest określana względem źródła elementu nadrzędnego (lewego górnego rogu kontenera). W danych wyjściowych `pPoint` jest określana względem źródła obszaru klienckiego formantu OLE (lewym górnym rogu obszaru klienckiego formantu).  
  
##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog  
 Powiadamia kontenera, że modalne okno dialogowe zostało zamknięte.  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Parametry  
 `hWndParent`  
 Obsługa do nadrzędnego okna modalnego okna dialogowego.  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji po wyświetleniu modalnego okna dialogowego. Należy wywołanie tej funkcji, dzięki czemu kontenera można włączyć wszystkich okien najwyższego poziomu wyłączone przez `PreModalDialog`. Ta funkcja musi być taka sama w wyniku wywołania `PreModalDialog`.  
  
##  <a name="premodaldialog"></a>  COleControl::PreModalDialog  
 Powiadamia kontener, który ma być wyświetlany modalne okno dialogowe.  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Parametry  
 `hWndParent`  
 Obsługa do nadrzędnego okna modalnego okna dialogowego.  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji, przed wyświetleniem modalnego okna dialogowego. Tej funkcji należy wywołać, aby kontenera można wyłączyć jego okien najwyższego poziomu. Po wyświetleniu modalnego okna dialogowego należy wywołać `PostModalDialog`.  
  
##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow  
 Niszczy i ponownie tworzy okno formantu.  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>Uwagi  
 Może to być konieczne, jeśli chcesz zmienić bity styl okna.  
  
##  <a name="refresh"></a>  COleControl::Refresh  
 Wymusza odświeżenia formantu OLE.  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>Uwagi  
 Ta funkcja jest obsługiwana przez `COleControl` klasy podstawowej jako metody akcji, o nazwie odświeżania. Pozwala to użytkownikom formantu OLE odświeżenia formantu w określonym czasie. Aby uzyskać więcej informacji na tej metody, zobacz artykuł [formantów ActiveX: metody](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="releasecapture"></a>  COleControl::ReleaseCapture  
 Zwalnia przechwytywanie myszy.  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli formant ma obecnie przechwytywanie myszy, zwolnieniu przechwytywania. W przeciwnym razie ta funkcja nie ma znaczenia.  
  
##  <a name="releasedc"></a>  COleControl::ReleaseDC  
 Udostępnia kontekst urządzenia wyświetlania kontenera formantem bez okien zwalnianie kontekst urządzenia do użytku przez inne aplikacje.  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>Parametry  
 `pDC`  
 Identyfikuje kontekst urządzenia kontenera do zwolnienia.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Aplikacja musi wywołać `ReleaseDC` dla każdego wywołania [GetDC](#getdc).  
  
##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow  
 Ustawia element nadrzędny kontrolki.  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>Parametry  
 *hWndOuter*  
 Uchwyt okna formantu.  
  
 `hWndParent`  
 Dojście nowe okno nadrzędne.  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji można zresetować nadrzędnego okna formantu.  
  
##  <a name="resetstockprops"></a>  COleControl::ResetStockProps  
 Inicjuje stan `COleControl` podstawowy właściwości do wartości domyślnych.  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>Uwagi  
 Właściwości są: wygląd, BackColor BorderStyle, podpisu, włączone, czcionki, ForeColor, hWnd i tekst. Opis właściwości podstawowych, zobacz [formantów ActiveX: Dodawanie właściwości zasobu](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Można zwiększyć wydajność binarne inicjowania formantu przy użyciu `ResetStockProps` i `ResetVersion` do przesłonięcia `COleControl::OnResetState`. Zobacz poniższy przykład. Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [formantów ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>  COleControl::ResetVersion  
 Inicjuje numer wersji do określonej wartości.  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>Parametry  
 `dwVersionDefault`  
 Numer wersji, który ma być przypisany do formantu.  
  
### <a name="remarks"></a>Uwagi  
 Można zwiększyć wydajność binarne inicjowania formantu przy użyciu `ResetVersion` i `ResetStockProps` do przesłonięcia `COleControl::OnResetState`. Zapoznaj się z przykładem w [ResetStockProps](#resetstockprops). Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [formantów ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="scrollwindow"></a>  COleControl::ScrollWindow  
 Umożliwia bez okien obiektu OLE przewijanie obszarze w miejscu jej aktywnego obrazu na ekranie.  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>Parametry  
 `xAmount`  
 Określa, w urządzeniu jednostek przewijanie w poziomie. Ten parametr musi być wartością ujemną przewinięcia w lewo.  
  
 `yAmount`  
 Określa, w urządzeniu jednostek przewijanie w pionie. Ten parametr musi być wartością ujemną, przewiń w górę.  
  
 `lpRect`  
 Wskazuje [CRect](../../atl-mfc-shared/reference/crect-class.md) obiektu lub struktura RECT, który określa część obiektu OLE obszaru klienta przewijanie, we współrzędnych klienta okna nadrzędnego. Jeśli `lpRect` jest **NULL**, jest przewijane obszaru klienckiego cały obiekt OLE.  
  
 `lpClipRect`  
 Wskazuje `CRect` obiektu lub `RECT` strukturę, która określa prostokąt klip. Przewijane są tylko następującą liczbę pikseli wewnątrz prostokąta. Usługi BITS poza prostokątem pozostają niezmienione, nawet jeśli są one `lpRect` prostokąta. Jeśli `lpClipRect` jest **NULL**, wycinka nie jest wykonywana na prostokąt przewijania.  
  
##  <a name="selectfontobject"></a>  COleControl::SelectFontObject  
 Wybiera czcionkę do kontekstu urządzenia.  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Parametry  
 `pDC`  
 Wskaźnik do obiektu kontekstu urządzenia.  
  
 `fontHolder`  
 Odwołanie do [CFontHolder](../../mfc/reference/cfontholder-class.md) obiekt reprezentujący czcionki do wybrania.  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do wcześniej wybranej czcionki. Gdy obiekt wywołujący zakończył wszystkie operacje rysowania, które używają *fontHolder,* należy go ponownie wcześniej wybranej czcionki przekazując go jako parametr [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).  
  
##  <a name="selectstockfont"></a>  COleControl::SelectStockFont  
 Wybiera standardowych właściwość czcionki do kontekstu urządzenia.  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>Parametry  
 `pDC`  
 Kontekst urządzenia, do którego zostanie wybrany czcionki.  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do poprzednio wybranego `CFont` obiektu. Należy używać [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) aby zaznaczyć tę czcionkę do kontekstu urządzenia, po zakończeniu.  
  
##  <a name="serializeextent"></a>  COleControl::SerializeExtent  
 Serializuje lub Inicjuje stan obszaru wyświetlania przydzielony do formantu.  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>Parametry  
 `ar`  
 A `CArchive` obiektu do zserializowania do lub z.  
  
### <a name="remarks"></a>Uwagi  
 Można zwiększyć wydajność binarne trwałości formantu przy użyciu `SerializeExtent`, `SerializeStockProps`, i `SerializeVersion` do przesłonięcia **COleControl::Serialize**. Zobacz poniższy przykład. Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [formantów ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps  
 Serializuje lub Inicjuje stan `COleControl` podstawowy właściwości: wygląd, BackColor BorderStyle, podpisu, włączone, czcionki, ForeColor i tekst.  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>Parametry  
 `ar`  
 A `CArchive` obiektu do zserializowania do lub z.  
  
### <a name="remarks"></a>Uwagi  
 Opis właściwości podstawowych, zobacz [formantów ActiveX: Dodawanie właściwości zasobu](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Można zwiększyć wydajność binarne trwałości formantu przy użyciu `SerializeStockProps`, `SerializeExtent`, i `SerializeVersion` do przesłonięcia **COleControl::Serialize**. Na przykład, zobacz kod na [SerializeExtent](#serializeextent). Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [formantów ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="serializeversion"></a>  COleControl::SerializeVersion  
 Serializuje lub Inicjuje stan formantu informacje o wersji.  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Parametry  
 `ar`  
 A `CArchive` obiektu do zserializowania do lub z.  
  
 `dwVersionDefault`  
 Bieżący numer wersji formantu.  
  
 `bConvert`  
 Wskazuje, czy trwałych danych powinny być konwertowane na najnowszy format, gdy są zapisywane ani przechowywane w tym samym formacie, że znajdował się, gdy została załadowana.  
  
### <a name="return-value"></a>Wartość zwracana  
 Numer wersji formantu. Jeśli ładuje określonego archiwum `SerializeVersion` zwraca informacje o wersji załadowanego z tego archiwum. W przeciwnym wypadku zwraca aktualnie załadowanych wersji.  
  
### <a name="remarks"></a>Uwagi  
 Można zwiększyć wydajność binarne trwałości formantu przy użyciu `SerializeVersion`, `SerializeExtent`, i `SerializeStockProps` do przesłonięcia **COleControl::Serialize**. Na przykład, zobacz kod na [SerializeExtent](#serializeextent). Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [formantów ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="setappearance"></a>  COleControl::SetAppearance  
 Ustawia wartość właściwości Appearance standardowych formantu.  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>Parametry  
 *sAppearance*  
 A **krótki** ( `VT_I2`) wartość będzie używana do wyglądu formantu. Wartość zero Ustawia wygląd formantu płaski i ustawia wartość 1 wygląd formantu 3D.  
  
### <a name="remarks"></a>Uwagi  
 Aby uzyskać więcej informacji o właściwościach standardowych, zobacz [formantów ActiveX: właściwości](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setbackcolor"></a>  COleControl::SetBackColor  
 Ustawia wartość właściwości BackColor standardowych formantu.  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>Parametry  
 *dwBackColor*  
 **OLE_COLOR** wartości do użycia w tle rysunek formantu.  
  
### <a name="remarks"></a>Uwagi  
 Więcej informacji na temat używania tej właściwości oraz innych związanych z właściwości, zobacz artykuł [formantów ActiveX: właściwości](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle  
 Ustawia wartość właściwości BorderStyle standardowych formantu.  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>Parametry  
 *sBorderStyle*  
 Nowy styl obramowania formantu; 0 oznacza brak obramowania, a wartość 1 oznacza normalne obramowanie.  
  
### <a name="remarks"></a>Uwagi  
 Okno kontrolki następnie zostanie ponownie utworzony i `OnBorderStyleChanged` o nazwie.  
  
##  <a name="setcapture"></a>  COleControl::SetCapture  
 Powoduje, że okno kontenera formantu podjęcie posiadania przechwytywanie myszy w imieniu formantu.  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do **CWnd** okna obiekt, który wcześniej otrzymały myszą.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli formant jest aktywowana i bez okien, ta funkcja powoduje, że formantu kontenera okna podjęcie posiadania przechwytywanie myszy w imieniu formantu. W przeciwnym razie ta funkcja powoduje, że formancie podjęcie posiadania przechwytywanie myszy (taki sam jak `CWnd::SetCapture`).  
  
##  <a name="setcontrolsize"></a>  COleControl::SetControlSize  
 Ustawia rozmiar okna formantu OLE i powiadamia kontenera, w którym jest zmiana kontroli lokacji.  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>Parametry  
 `cx`  
 Określa nową szerokość formantu w pikselach.  
  
 `cy`  
 Określa nową wysokość formantu w pikselach.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Nie należy użyć tej funkcji w Konstruktorze spod kontroli.  
  
 Należy pamiętać, że wszystkie współrzędne kontrolki systemu windows są względem lewego górnego rogu formantu.  
  
##  <a name="setenabled"></a>  COleControl::SetEnabled  
 Ustawia wartość właściwości Enabled formantu zasobów.  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>Parametry  
 `bEnabled`  
 **Wartość TRUE,** Jeśli formant ma być włączone; w przeciwnym razie **FALSE**.  
  
### <a name="remarks"></a>Uwagi  
 Po ustawieniu tej właściwości **OnEnabledChange** jest wywoływana.  
  
##  <a name="setfocus"></a>  COleControl::SetFocus  
 Powoduje, że okno kontenera formantu podjęcie posiada fokus wprowadzania w imieniu formantu.  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do **CWnd** okna obiekt, który poprzednio fokus wprowadzania lub **NULL** przypadku żadnego takie okna.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli formant jest aktywowana i bez okien, ta funkcja powoduje, że formantu kontenera okna podjęcie posiada fokus wprowadzania, w imieniu formantu. Wprowadzanie z klawiatury do okna kontenera kieruje fokus wprowadzania i kontener wywołuje wszystkie komunikaty klawiatury kolejnych do obiektu OLE, który wywołuje `SetFocus`. Dowolne okno z poprzednio fokus wprowadzania traci go.  
  
 Jeśli formant nie jest bez okien, ta funkcja powoduje, że formancie podjęcie posiada fokus wprowadzania (taki sam jak `CWnd::SetFocus`).  
  
##  <a name="setfont"></a>  COleControl::SetFont  
 Ustawia właściwości standardowych czcionki formantu.  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>Parametry  
 *pFontDisp*  
 Wskaźnik do interfejsu wysyłania czcionki.  
  
##  <a name="setforecolor"></a>  COleControl::SetForeColor  
 Ustawia wartość właściwości ForeColor standardowych formantu.  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>Parametry  
 *dwForeColor*  
 **OLE_COLOR** wartość ma być używana dla pierwszego planu rysunek formantu.  
  
### <a name="remarks"></a>Uwagi  
 Więcej informacji na temat używania tej właściwości oraz innych związanych z właściwości, zobacz artykuł [formantów ActiveX: właściwości](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats  
 Wywoływane przez platformę, by zainicjować listy format danych obsługiwanych przez formant.  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja określa dwa formaty: `CF_METAFILEPICT` i zestaw właściwości trwałych.  
  
##  <a name="setinitialsize"></a>  COleControl::SetInitialSize  
 Określa rozmiar formantu OLE, gdy po raz pierwszy jest wyświetlany w kontenerze.  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>Parametry  
 `cx`  
 Szerokość początkowa OLE formantu w pikselach.  
  
 `cy`  
 Początkowa wysokość formantu OLE w pikselach.  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji w Konstruktorze użytkownika można ustawić początkowy rozmiar formantu. Początkowy rozmiar jest mierzony w jednostki urządzenia lub pikselach. Zaleca się, że to wywołanie dokonywane w Konstruktorze spod kontroli.  
  
##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag  
 Zmiany stanu modyfikacji obiektu formantu.  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>Parametry  
 `bModified`  
 Nowa wartość dla formantu zmodyfikowana flagi. **Wartość TRUE,** wskazuje, że stan formantu został zmodyfikowany; **FALSE** wskazuje, że właśnie został zapisany stan formantu.  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie, że ta funkcja zawsze, gdy nastąpi zmiana mających wpływ na trwały stan formantu. Na przykład w przypadku zmiany wartości właściwości trwałe, wywołania tej funkcji z `bModified` **TRUE**.  
  
##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted  
 Wskazuje, że żądania edycji nie powiodło się.  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji po `BoundPropertyRequestEdit` zakończy się niepowodzeniem. Ta funkcja zwraca wyjątek typu **COleDispScodeException** wskazująca operacji set było niedozwolone.  
  
##  <a name="setnotsupported"></a>  COleControl::SetNotSupported  
 Modyfikację wartości właściwości formantu przez użytkownika.  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji, zamiast zestawu funkcji dowolnej właściwości, w których nie jest obsługiwana zmiana wartości właściwości przez kontrolki użytkownika. Przykładem jest właściwość, która jest tylko do odczytu.  
  
##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer  
 Ustawia współrzędne prostokąt kontroli względem kontenera, w jednostkach urządzenia.  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parametry  
 `lpRect`  
 Wskaźnik do prostokąta, zawierający nowe współrzędne kontroli względem kontenera.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli formant jest otwarty, jego rozmiar jest zmieniany; w przeciwnym razie kontenera **OnPosRectChanged** funkcja jest wywoływana.  
  
##  <a name="settext"></a>  COleControl::SetText  
 Ustawia wartości właściwości formantu standardowych podpis lub tekst.  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>Parametry  
 `pszText`  
 Wskaźnik do ciągu znaków.  
  
### <a name="remarks"></a>Uwagi  
 Należy pamiętać, że właściwości podstawowe podpisu i tekst są zamapowane na tę samą wartość. Oznacza to, wszelkie zmiany wprowadzone w jednej właściwości automatycznie zmieni obu właściwości. Ogólnie rzecz biorąc formantu powinien obsługiwać giełdowych podpis lub właściwość Text, ale nie oba.  
  
##  <a name="throwerror"></a>  COleControl::ThrowError  
 Sygnalizuje wystąpienie błędu formantu.  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Parametry  
 `sc`  
 Należy podać wartość Kod stanu. Pełną listę możliwych kodów, zobacz artykuł [formantów ActiveX: Tematy zaawansowane](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `nDescriptionID`  
 Ciąg zasobu identyfikator wyjątku, należy podać.  
  
 `nHelpID`  
 Identyfikator pomocy tematu zgłaszana w.  
  
 `pszDescription`  
 Ciąg zawierający wyjaśnienie wyjątku, który ma zostać podana.  
  
### <a name="remarks"></a>Uwagi  
 Ta funkcja powinna być wywoływana tylko z w funkcji Get lub Set dla właściwości OLE lub implementacja metody automatyzacji OLE. Jeśli potrzebujesz sygnału błędy występujące w pozostałych godzinach, należy wywołać standardowych zdarzenia błędu.  
  
##  <a name="transformcoords"></a>  COleControl::TransformCoords  
 Transformacje koordynować wartości między **HIMETRIC** i kontenera jednostek macierzystego.  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>Parametry  
 *lpptlHimetric*  
 Wskaźnik do **POINTL** struktury zawierającej współrzędnych w **HIMETRIC** jednostki.  
  
 *lpptfContainer*  
 Wskaźnik do **POINTF** struktury zawierającej współrzędnych kontenera, rozmiar jednostki.  
  
 `flags`  
 Połączenie z następujących wartości:  
  
- **XFORMCOORDS_POSITION** pozycji w kontenerze.  
  
- **XFORMCOORDS_SIZE** rozmiar w kontenerze.  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER** przekształcenie **HIMETRIC** jednostki do kontenera jednostek.  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC** przekształcenie kontenera jednostek **HIMETRIC** jednostki.  
  
### <a name="remarks"></a>Uwagi  
 Pierwsze dwie flagi **XFORMCOORDS_POSITION** i **XFORMCOORDS_SIZE**, wskazuje, czy współrzędne powinny być traktowane jako pozycji lub rozmiar. Pozostałe dwie flagi wskazują kierunek transformacji.  
  
##  <a name="translatecolor"></a>  COleControl::TranslateColor  
 Konwertuje wartości koloru z **OLE_COLOR** typ danych [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) typu danych.  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>Parametry  
 `clrColor`  
 A **OLE_COLOR** typu danych. Aby uzyskać więcej informacji, zobacz Windows [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353) funkcji.  
  
 `hpal`  
 Dojście do palety opcjonalne; może być **NULL**.  
  
### <a name="return-value"></a>Wartość zwracana  
 Wartość koloru 32-bitowe RGB (czerwony, zielony, niebieski), który definiuje stałą koloru znajdujący się najbliżej `clrColor` wartości reprezentujące urządzenia.  
  
### <a name="remarks"></a>Uwagi  
 Ta funkcja jest przydatna do tłumaczenia standardowych właściwości ForeColor i kolor tła w celu **COLORREF** typy używane przez [CDC](../../mfc/reference/cdc-class.md) funkcji elementów członkowskich.  
  
##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad  
 Określa, czy formant powinien używać wartości właściwości otoczenia jako wartości domyślne, gdy jest ładowane następnie ze stanu trwałego.  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 NonZero wskazuje, że właściwości otaczających będzie nieprawidłowy; w przeciwnym razie wartość właściwości otoczenia nie będą prawidłowe.  
  
### <a name="remarks"></a>Uwagi  
 W niektórych kontenery formantu mogą utracić dostęp do jej otoczeniu właściwości podczas początkowego połączenia zastąpienia z `COleControl::DoPropExchange`. Dotyczy to sytuacji, gdy kontener wywoła [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) lub [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) przed wywołaniem [IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (Jeśli nie uznawać **OLEMISC_SETCLIENTSITEFIRST** bit stanu).  
  
##  <a name="windowproc"></a>  COleControl::WindowProc  
 Udostępnia procedurę Windows `COleControl` obiektu.  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>Parametry  
 `message`  
 Określa komunikatów systemu Windows, aby można było przetworzyć.  
  
 `wParam`  
 Zawiera dodatkowe informacje używane podczas przetwarzania wiadomości. Wartość parametru jest zależny od wiadomości.  
  
 `lParam`  
 Zawiera dodatkowe informacje używane podczas przetwarzania wiadomości. Wartość parametru jest zależny od wiadomości.  
  
### <a name="return-value"></a>Wartość zwracana  
 Wartość zwracana wysłanych komunikatów.  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji do wysyłania komunikatów określonego za pomocą formantu mapy komunikatów.  
  
## <a name="see-also"></a>Zobacz też  
 [CIRC3 próbki MFC](../../visual-cpp-samples.md)   
 [Przykładowe MFC TESTHELP](../../visual-cpp-samples.md)   
 [COlePropertyPage — klasa](../../mfc/reference/colepropertypage-class.md)   
 [Klasa CWnd](../../mfc/reference/cwnd-class.md)   
 [Diagram hierarchii](../../mfc/hierarchy-chart.md)   
 [Klasa CFontHolder](../../mfc/reference/cfontholder-class.md)   
 [Klasa CPictureHolder](../../mfc/reference/cpictureholder-class.md)
