---
title: Klasa COleControl
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 8e931b03dc09926d44fa5cb4125dd2ffa41c5813
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/14/2020
ms.locfileid: "81366195"
---
# <a name="colecontrol-class"></a>Klasa COleControl

Potężna klasa podstawowa do tworzenia formantów OLE.

## <a name="syntax"></a>Składnia

```
class COleControl : public CWnd
```

## <a name="members"></a>Elementy członkowskie

### <a name="public-constructors"></a>Konstruktory publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Tworzy obiekt `COleControl`.|

### <a name="public-methods"></a>Metody publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Pobiera bieżący wygląd formantu.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Zwraca wartość właściwość otaczającego backcolor.|
|[COleControl::Nazwa funkcji AmbientDisplay](#ambientdisplayname)|Zwraca nazwę formantu określoną przez kontener.|
|[COleControl::AmbientFont](#ambientfont)|Zwraca wartość właściwość otoczenia Font.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Zwraca wartość właściwego forecolor otoczenia.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Zwraca identyfikator ustawień regionalnych kontenera.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Zwraca typ jednostek używanych przez kontener.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Określa, czy uchwyty chwytania powinny być wyświetlane.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Określa, czy kreskowanie powinno być wyświetlane.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Zwraca typ wyrównania tekstu określony przez kontener.|
|[COleControl::AmbientUIDead](#ambientuidead)|Określa, czy formant powinien odpowiadać na akcje interfejsu użytkownika.|
|[COleControl::AmbientUserMode](#ambientusermode)|Określa tryb kontenera.|
|[COleControl::BoundPropertyZmienił](#boundpropertychanged)|Powiadamia kontener, że właściwość powiązana została zmieniona.|
|[COleControl::BoundPropertyRequestEdytuj](#boundpropertyrequestedit)|Żąda uprawnień do edytowania wartości właściwości.|
|[COleControl::ClientToParent](#clienttoparent)|Tłumaczy punkt względem początku układu współrzędnych formantu do punktu względem jego pochodzenia kontenera.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Dostosowuje prostokąt szycie, jeśli nakłada się na formant.|
|[COleControl::ControlInfoZwienienie](#controlinfochanged)|Wywołanie tej funkcji po zmianie zestawu mnemonics obsługiwane przez formant.|
|[COleControl::DisplayError](#displayerror)|Wyświetla zdarzenia błędu zapasów dla użytkownika formantu.|
|[COleControl::DoClick](#doclick)|Wdrożenie metody `DoClick` magazynowej.|
|[COleControl::DoPropExchange](#dopropexchange)|Serializuje właściwości `COleControl` obiektu.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Ponownie rysuje formant OLE, który został podklasyfikowany z formantu systemu Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Umożliwia prostą obsługę ramek dla sterowania.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serializuje szerokość i wysokość formantu.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializuje właściwości zapasów formantu.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serializuje numer wersji formantu.|
|[COleControl::FireClick](#fireclick)|Uruchamia zdarzenie `Click` giełdowe.|
|[COleControl::FireDblClick](#firedblclick)|Uruchamia zdarzenie `DblClick` giełdowe.|
|[COleControl::FireError](#fireerror)|Uruchamia zdarzenie `Error` giełdowe.|
|[COleControl::FireEvent](#fireevent)|Uruchamia zdarzenie niestandardowe.|
|[COleControl::FireKeyDown](#firekeydown)|Uruchamia zdarzenie `KeyDown` giełdowe.|
|[COleControl::FireKeyPress](#firekeypress)|Uruchamia zdarzenie `KeyPress` giełdowe.|
|[COleControl::FireKeyUp](#firekeyup)|Uruchamia zdarzenie `KeyUp` giełdowe.|
|[COleControl::FireMouseDown](#firemousedown)|Uruchamia zdarzenie `MouseDown` giełdowe.|
|[COleControl::FireMouseMove](#firemousemove)|Uruchamia zdarzenie `MouseMove` giełdowe.|
|[COleControl::FireMouseUp](#firemouseup)|Uruchamia zdarzenie `MouseUp` giełdowe.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Uruchamia zdarzenie, gdy zmieni się stan gotowości formantu.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Zmienia domyślne zachowanie aktywacji formantu obsługującego `IPointerInactive` interfejs.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Zwraca wartość określonej właściwości otoczenia.|
|[COleControl::GetAppearance](#getappearance)|Zwraca wartość właściwości Wygląd magazynu.|
|[COleControl::GetBackColor](#getbackcolor)|Zwraca wartość właściwości BackColor magazynu.|
|[COleControl::GetBorderStyle](#getborderstyle)|Zwraca wartość właściwości BorderStyle.|
|[COleControl::GetCapture](#getcapture)|Określa, czy obiekt sterujący bez okien ma przechwytywanie myszy.|
|[COleControl::GetClassID](#getclassid)|Pobiera identyfikator klasy OLE formantu.|
|[COleControl::GetClientOffset](#getclientoffset)|Pobiera różnicę między lewym górnym rogu prostokątnego obszaru formantu a lewym górnym rogu jego obszaru klienta.|
|[COleControl::GetClientRect](#getclientrect)|Pobiera rozmiar obszaru klienta formantu.|
|[COleControl::GetClientSite](#getclientsite)|Wysyła zapytania do obiektu dla wskaźnika do bieżącej lokacji klienta w jego kontenerze.|
|[COleControl::GetControlFlags](#getcontrolflags)|Pobiera ustawienia flagi sterowania.|
|[COleControl::GetControlSize](#getcontrolsize)|Zwraca położenie i rozmiar formantu OLE.|
|[COleControl::GetDC](#getdc)|Zapewnia środki dla formantu bez okien, aby uzyskać kontekst urządzenia z jego kontenera.|
|[COleControl::GetEnabled](#getenabled)|Zwraca wartość właściwości stock Enabled.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Pobiera wskaźnik do rozszerzonego obiektu kontrolnego należącego do kontenera.|
|[COleControl::GetFocus](#getfocus)|Określa, czy formant ma fokus.|
|[COleControl::GetFont](#getfont)|Zwraca wartość właściwości czcionka magazynowa.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Zwraca metryki `CFontHolder` obiektu.|
|[COleControl::GetForeColor](#getforecolor)|Zwraca wartość właściwości forecolor magazynu.|
|[COleControl::GetHwnd](#gethwnd)|Zwraca wartość właściwości hWnd.|
|[COleControl::GetMessageStrowanie](#getmessagestring)|Zawiera tekst paska stanu dla elementu menu.|
|[COleControl::GetNotSupported](#getnotsupported)|Uniemożliwia dostęp do wartości właściwości formantu przez użytkownika.|
|[COleControl::GetReadyState](#getreadystate)|Zwraca stan gotowości formantu.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Zwraca prostokąt formantu względem jego kontenera.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Zwraca metryki właściwości czcionka czas.|
|[COleControl::GetText](#gettext)|Zwraca wartość właściwości Tekst lub Podpis.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Zastąpuj, aby formant bez okien był celem operacji przeciągania i upuszczania.|
|[COleControl::InicjalizacjaID](#initializeiids)|Informuje klasę podstawową identyfikatorów IID, których będzie używać formant.|
|[COleControl::InternalGetFont](#internalgetfont)|Zwraca `CFontHolder` obiekt dla właściwości Font.|
|[COleControl::InternalGetText](#internalgettext)|Pobiera stock caption lub text właściwości.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Ustawia stan gotowości formantu i uruchamia zdarzenie ready-state-change.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Unieważnia obszar wyświetlanego formantu, powodując jego ponowne wyrywanie.|
|[COleControl::InvalidateRgn](#invalidatergn)|Unieważnia obszar klienta okna kontenera w danym regionie. Może służyć do ponownego rysowania formantów bez okien w regionie.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Umożliwia specjalistyczne ładowanie formantu OLE.|
|[COleControl::JestZmodyfikowany](#ismodified)|Określa, czy stan kontroli uległ zmianie.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Wskazuje, czy kontener obsługuje zoptymalizowany rysunek dla bieżącej operacji rysowania.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Wywoływany, aby ustalić, czy podklasy formantu formantu systemu Windows.|
|[COleControl::Obciążenie](#load)|Resetuje wszystkie poprzednie dane asynchroniczne i inicjuje nowe obciążenie właściwości asynchronii formantu.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Określa, czy formant może być dezaktywowany przez kontener.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Wywoływana po zmianie właściwości otoczenia.|
|[COleControl::OnAppearanceZmienione](#onappearancechanged)|Wywoływana po zmianie właściwości Wygląd magazynu.|
|[COleControl::OnBackColorZanged](#onbackcolorchanged)|Wywoływana po zmianie właściwości BackColor.|
|[COleControl::OnBorderStyleZmienine](#onborderstylechanged)|Wywoływana po zmianie właściwości BorderStyle.|
|[COleControl::OnClick](#onclick)|Wezwany do ognia akcji Kliknij zdarzenie.|
|[COleControl::OnClose](#onclose)|Powiadamia formantu, `IOleControl::Close` który został wywołany.|
|[COleControl::OnDoVerb](#ondoverb)|Wywoływana po wykonaniu zlecenia sterującego.|
|[COleControl::OnDraw](#ondraw)|Wywoływane, gdy formantu jest wymagane, aby ponownie rysować się.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Wywoływane przez kontener, gdy formant jest wymagany do ponownego rysowania się przy użyciu kontekstu urządzenia metaplik.|
|[COleControl::OnEdytuj](#onedit)|Wywoływane przez kontener do interfejsu użytkownika Aktywuj formant OLE.|
|[COleControl::OnEnabledZmienił](#onenabledchanged)|Wywoływana po zmianie właściwości czas Enabled.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Wywoływane przez kontener do wyliczenia zleceń formantu.|
|[COleControl::OnEventAdvise](#oneventadvise)|Wywoływane, gdy programy obsługi zdarzeń są połączone lub odłączone od formantu.|
|[COleControl::OnFontZmienia](#onfontchanged)|Wywoływana po zmianie właściwości Font.|
|[COleControl::OnForeColorZmienił](#onforecolorchanged)|Wywoływana po zmianie właściwości ForeColor.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Wywoływane, gdy zdarzenia formantu są zamrożone lub niezamrożone.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Powiadamia formantu, `IOleObject::GetColorSet` który został wywołany.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Zawiera informacje mnemoniczne do kontenera.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Wywołano, aby uzyskać ciąg do reprezentowania wartości właściwości.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Żąda dojścia do menu formantu, który zostanie scalony z menu kontenera.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Zastąpienie, aby pobrać rozmiar wyświetlania formantu najbliżej proponowanego trybu rozmiaru i zasięgu.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Zwraca ciągi reprezentujące możliwe wartości właściwości.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Zwraca wartość odpowiadającą wstępnie zdefiniowanemu ciągowi.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Zastąp, aby pobrać rozmiar obszarów wyświetlania formantu (może służyć do włączania rysunku dwuprzebiegowego).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Zastąd, aby przekonwertować rozmiar formantu na prostokąt rozpoczynający się w określonej pozycji.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Zastąpojedaj, aby pobrać stan widoku formantu.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Wywoływane przez kontener, gdy formant jest dezaktywowany interfejsu użytkownika.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Zastąp, aby kontener dla nieaktywnej kontroli pod wskaźnikiem myszy wysyłał WM_MOUSEMOVE komunikatów do formantu.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Zastąpołaj, aby kontener dla nieaktywnej kontroli pod wskaźnikiem myszy wysyłał WM_SETCURSOR komunikatów do formantu.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Wywoływane po zdarzenia KeyDown czas został zwolniony.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Wywoływane po zdarzenia KeyPress czas został zwolniony.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Wywoływane po zdarzenia KeyUp czas został zwolniony.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Wskazuje, która strona właściwości ma być używana do edytowania właściwości.|
|[COleControl::OnMnemonic](#onmnemonic)|Wywoływana po naciśnięciu klucza mnemonicznego sterowania.|
|[COleControl::OnProperties](#onproperties)|Wywoływane, gdy formantu "Właściwości" zlecenie zostało wywołane.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Zastąpić, aby zbadać, czy wyświetlanie formantu nakłada się na dany punkt.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Zastąpić, aby zbadać, czy wyświetlanie formantu nakłada się na dowolny punkt w danym prostokącie.|
|[COleControl::OnRenderData](#onrenderdata)|Wywoływane przez strukturę do pobierania danych w określonym formacie.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Wywoływane przez strukturę do pobierania danych z pliku w określonym formacie.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Wywoływane przez strukturę do pobierania danych z pamięci globalnej w określonym formacie.|
|[COleControl::OnResetState](#onresetstate)|Resetuje właściwości formantu do wartości domyślnych.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Powiadamia formantu, `IOleControl::SetClientSite` który został wywołany.|
|[COleControl::OnSetData](#onsetdata)|Zastępuje dane formantu inną wartością.|
|[COleControl::OnSetExtent](#onsetextent)|Wywoływana po zmianie zasięgu formantu.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Wywoływane po zmianie wymiarów formantu.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Wywoływane, gdy formant został aktywowany interfejsu użytkownika.|
|[COleControl::OnTextZanged](#ontextchanged)|Wywoływana po zmianie właściwości Tekst lub Podpis.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Przetwarza komunikaty okienne (inne niż komunikaty myszy i klawiatury) dla kontrolek bez okien.|
|[COleControl::ParentToClient](#parenttoclient)|Tłumaczy punkt względem początku źródła kontenera do punktu względem początku początku formantu.|
|[COleControl::PostModalDialog](#postmodaldialog)|Powiadamia kontener, że modalne okno dialogowe zostało zamknięte.|
|[COleControl::PreModalDialog](#premodaldialog)|Powiadamia kontener, że modalne okno dialogowe ma być wyświetlane.|
|[COleControl::Odtwórz KontrolerWindow](#recreatecontrolwindow)|Niszczy i ponownie tworzy okno formantu.|
|[COleControl::Odśwież](#refresh)|Wymusza odświeżanie wyglądu formantu.|
|[COleControl::ReleaseCapture](#releasecapture)|Zwalnia przechwytywanie myszy.|
|[COleControl::ReleaseDC](#releasedc)|Zwalnia kontekst urządzenia wyświetlania kontenera formantu bez okien.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Resetuje element nadrzędny okna sterowania.|
|[COleControl::ResetStockProps](#resetstockprops)|Inicjuje właściwości zapasów `COleControl` do ich wartości domyślnych.|
|[COleControl::ResetVersion](#resetversion)|Inicjuje numer wersji do danej wartości.|
|[COleControl::ScrollWindow](#scrollwindow)|Umożliwia formantowi bez okien przewijanie obszaru w jego aktywnym obrazie w miejscu na wyświetlaczu.|
|[COleControl::SelectFontObject](#selectfontobject)|Wybiera niestandardową font właściwość w kontekście urządzenia.|
|[COleControl::SelectStockFont](#selectstockfont)|Wybiera właściwość czcionka giełdowa w kontekście urządzenia.|
|[COleControl::SerializeExtent](#serializeextent)|Serializuje lub inicjuje przestrzeń wyświetlania formantu.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serializuje lub inicjuje właściwości `COleControl` magazynów.|
|[COleControl::SerializeVersion](#serializeversion)|Serializuje lub inicjuje informacje o wersji formantu.|
|[COleControl::SetAppearance](#setappearance)|Ustawia wartość właściwości wygląd akcji.|
|[COleControl::SetBackColor](#setbackcolor)|Ustawia wartość właściwości backcolor magazynu.|
|[COleControl::SetBorderStyle](#setborderstyle)|Ustawia wartość właściwości BorderStyle magazynu.|
|[COleControl::SetCapture](#setcapture)|Powoduje, że okno kontenera formantu przejąć w posiadanie przechwytywania myszy w imieniu formantu.|
|[COleControl::SetControlSize](#setcontrolsize)|Ustawia położenie i rozmiar formantu OLE.|
|[COleControl::SetEnabled](#setenabled)|Ustawia wartość właściwości stock Enabled.|
|[COleControl::SetFocus](#setfocus)|Powoduje, że okno kontenera formantu przejąć w posiadanie fokus wejściowy w imieniu formantu.|
|[COleControl::SetFont](#setfont)|Ustawia wartość właściwości czcionka magazynie.|
|[COleControl::SetForeColor](#setforecolor)|Ustawia wartość właściwości forecolor magazynu.|
|[COleControl::SetInitialSize](#setinitialsize)|Ustawia rozmiar formantu OLE, gdy po raz pierwszy wyświetlany w kontenerze.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Zmienia zmodyfikowany stan formantu.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Wskazuje, że żądanie edycji nie powiodło się.|
|[COleControl::Zestaw Niewsprzejęty](#setnotsupported)|Zapobiega modyfikacji wartości właściwości formantu przez użytkownika.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Ustawia prostokąt formantu względem jego kontenera.|
|[COleControl::SetText](#settext)|Ustawia wartość właściwości Tekst lub Podpis.|
|[COleControl::ThrowError](#throwerror)|Sygnalizuje, że wystąpił błąd w formancie OLE.|
|[COleControl::TransformCoords](#transformcoords)|Przekształca wartości współrzędnych między kontenerem a formantem.|
|[COleControl::TranslateColor](#translatecolor)|Konwertuje wartość OLE_COLOR na wartość COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Określa, czy właściwości otoczenia będą dostępne przy następnym załadowaniu formantu.|
|[COleControl::WindowProc](#windowproc)|Zawiera procedurę systemu `COleControl` Windows dla obiektu.|

### <a name="protected-methods"></a>Metody chronione

|Nazwa|Opis|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Wywoływana przez strukturę, gdy wygląd formantu musi zostać zaktualizowany.|
|[COleControl::DrawMetafile](#drawmetafile)|Wywoływana przez strukturę, gdy używany jest kontekst urządzenia metaplikowego.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Umożliwia wywołanie metody automatyzacji.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Wywoływana przez platformę do inicjowania listy formatów danych obsługiwanych przez formant.|

## <a name="remarks"></a>Uwagi

Pochodzi z `CWnd`, ta klasa dziedziczy wszystkie funkcje obiektu okna systemu Windows oraz dodatkowe funkcje specyficzne dla OLE, takie jak wypalanie zdarzeń i możliwość obsługi metod i właściwości.

Formanty OLE można wstawiać do aplikacji kontenera OLE i komunikować się z kontenerem przy użyciu dwukierunkowego systemu wypalania zdarzeń i uwidaczniania metod i właściwości kontenera. Należy zauważyć, że standardowe kontenery OLE obsługują tylko podstawowe funkcje formantu OLE. Nie są one w stanie obsługiwać rozszerzone funkcje formantu OLE. Wypalania zdarzeń występuje, gdy zdarzenia są wysyłane do kontenera w wyniku niektórych akcji odbywających się w formancie. Z kolei kontener komunikuje się z formantem przy użyciu narażony zestaw metod i właściwości analogiczne do funkcji elementów członkowskich i elementów członkowskich danych klasy C++. Takie podejście umożliwia deweloperowi kontrolować wygląd formantu i powiadamiać kontener, gdy wystąpią pewne akcje.

## <a name="windowless-controls"></a>Kontrolki bez okien

Kontrolki OLE mogą być używane w miejscu aktywnym bez okna. Elementy sterujące bez okien mają istotne zalety:

- Sterowanie bez okien może być przezroczyste i niekościenny

- Formanty bez okien skracają rozmiar wystąpienia i czas tworzenia obiektu

Formanty nie potrzebują okna. Usługi, które oferuje okno mogą być łatwo dostarczane za pośrednictwem jednego okna udostępnionego (zwykle kontenera) i trochę kodu wysyłki. Posiadanie okna jest w większości niepotrzebnym powikłaniem obiektu.

Gdy używana jest aktywacja bez okien, kontener (który ma okno) jest odpowiedzialny za świadczenie usług, które w przeciwnym razie zostałyby dostarczone przez własne okno formantu. Na przykład jeśli formant musi zbadać fokus klawiatury, kwerendy przechwytywania myszy lub uzyskać kontekst urządzenia, operacje te są zarządzane przez kontener. Funkcje członkowskie bez `COleControl` okien operacji wywołać te operacje w kontenerze.

Gdy aktywacja bez okien jest włączona, kontener deleguje komunikaty wejściowe do `IOleInPlaceObjectWindowless` interfejsu formantu (rozszerzenie [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) dla obsługi bez okien). `COleControl`'s implementacja tego interfejsu będzie wysyłać te komunikaty za pośrednictwem mapy wiadomości formantu, po dostosowaniu współrzędnych myszy odpowiednio. Można przetwarzać te wiadomości, takie jak zwykłe wiadomości okna, dodając odpowiednie wpisy do mapy wiadomości.

W formancie bez okien należy `COleControl` zawsze używać funkcji `CWnd` członkowskich zamiast odpowiednich funkcji członkowskich lub powiązanych funkcji interfejsu API systemu Windows.

Obiekty sterujące OLE można również utworzyć okno tylko wtedy, gdy stają się aktywne, ale ilość pracy potrzebnej do przejścia nieaktywne aktywne idzie w górę i szybkość przejścia spada. Z tych przypadków występuje problem: na przykład należy wziąć pod uwagę siatkę pól tekstowych. Podczas kursowania w górę iw dół przez kolumnę, każdy formant musi być aktywowany w miejscu, a następnie dezaktywowany. Szybkość nieaktywnego/aktywnego przejścia będzie miała bezpośredni wpływ na szybkość przewijania.

Aby uzyskać więcej informacji na temat tworzenia struktury sterowania OLE, zobacz artykuły [MFC ActiveX Formanty](../../mfc/mfc-activex-controls.md) i [omówienie: Tworzenie programu sterowania MFC ActiveX](../../mfc/reference/mfc-activex-control-wizard.md). Aby uzyskać informacje na temat optymalizacji formantów OLE, w tym formantów bez okien i nie migotania, zobacz [MFC ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia

[Cobject](../../mfc/reference/cobject-class.md)

[Ccmdtarget](../../mfc/reference/ccmdtarget-class.md)

[Cwnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Wymagania

**Nagłówek:** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COleControl::AmbientBackColor

Zwraca wartość właściwość otaczającego backcolor.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Wartość zwracana

Bieżąca wartość otaczającej właściwości BackColor kontenera, jeśli istnieje. Jeśli właściwość nie jest obsługiwana, ta funkcja zwraca zdefiniowany przez system kolor tła systemu Windows.

### <a name="remarks"></a>Uwagi

Właściwość otoczenia BackColor jest dostępna dla wszystkich formantów i jest zdefiniowana przez kontener. Należy zauważyć, że kontener nie jest wymagane do obsługi tej właściwości.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControl::Nazwa funkcji AmbientDisplay

Nazwa przypisana przez kontener do formantu może być używana w komunikatach o błędach wyświetlanych użytkownikowi.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Wartość zwracana

Nazwa formantu OLE. Wartość domyślna to ciąg o zerowej długości.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że kontener nie jest wymagane do obsługi tej właściwości.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControl::AmbientFont

Zwraca wartość właściwość otoczenia Font.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do otaczającego kontenera interfejsu wysyłania czcionek. Wartością domyślną jest NULL. Jeśli zwracanie nie jest równe null, jesteś odpowiedzialny za zwolnienie czcionki przez wywołanie jego [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) funkcji elementu członkowskiego.

### <a name="remarks"></a>Uwagi

Właściwość otoczenia Font jest definiowana przez kontener i dostępna dla wszystkich formantów. Należy zauważyć, że kontener nie jest wymagane do obsługi tej właściwości.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControl::AmbientForeColor

Zwraca wartość właściwego forecolor otoczenia.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Wartość zwracana

Bieżąca wartość otaczającej właściwości ForeColor kontenera, jeśli istnieje. Jeśli ta funkcja nie jest obsługiwana, zwraca zdefiniowany przez system kolor tekstu systemu Windows.

### <a name="remarks"></a>Uwagi

Właściwość otoczenia ForeColor jest dostępna dla wszystkich formantów i jest zdefiniowana przez kontener. Należy zauważyć, że kontener nie jest wymagane do obsługi tej właściwości.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControl::AmbientLocaleID

Zwraca identyfikator ustawień regionalnych kontenera.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Wartość zwracana

Wartość właściwości LocaleID kontenera, jeśli istnieje. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość 0.

### <a name="remarks"></a>Uwagi

Formant można użyć LocaleID dostosować swój interfejs użytkownika dla określonych ustawień regionalnych. Należy zauważyć, że kontener nie jest wymagane do obsługi tej właściwości.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControl::AmbientAppearance

Pobiera bieżące ustawienie wyglądu obiektu sterującego.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Wartość zwracana

Wygląd formantu:

- **0** Płaski wygląd

- **1** wygląd 3D

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji, aby pobrać bieżącą wartość właściwości DISPID_AMBIENT_APPEARANCE dla formantu.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits

Zwraca typ jednostek używanych przez kontener.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Wartość zwracana

Ciąg zawierający otaczające ScaleUnits kontenera. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca ciąg o zerowej długości.

### <a name="remarks"></a>Uwagi

Właściwość ScaleUnits w kontenerze może być używana do wyświetlania pozycji lub wymiarów oznaczonych wybraną jednostką, taką jak twips lub centymetry. Należy zauważyć, że kontener nie jest wymagane do obsługi tej właściwości.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles

Określa, czy kontener umożliwia formantowi wyświetlanie uchwytów chwytania dla siebie, gdy jest aktywny.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli uchwyty powinny być wyświetlane; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość niezerową.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że kontener nie jest wymagane do obsługi tej właściwości.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COleControl::AmbientShowHatching

Określa, czy kontener umożliwia formantowi wyświetlanie się z kreskowanym wzorkiem, gdy interfejs użytkownika jest aktywny.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli powinien być pokazany kreskowany wzór; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość niezerową.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że kontener nie jest wymagane do obsługi tej właściwości.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COleControl::AmbientTextAlign

Określa wyrównanie tekstu otoczenia preferowane przez kontener formantu.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Wartość zwracana

Stan właściwości textalign otoczenia kontenera. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość 0.

Poniżej znajduje się lista prawidłowych wartości zwracanych:

|Wartość zwracana|Znaczenie|
|------------------|-------------|
|0|Wyrównanie ogólne (liczby po prawej stronie, tekst po lewej).|
|1|Lewe uzasadnienie|
|2|Wyśrodkuj|
|3|Uzasadnienie prawe|

### <a name="remarks"></a>Uwagi

Ta właściwość jest dostępna dla wszystkich osadzonych formantów i jest zdefiniowana przez kontener. Należy zauważyć, że kontener nie jest wymagane do obsługi tej właściwości.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControl::AmbientUIDead

Określa, czy kontener chce, aby formant odpowiadał na akcje interfejsu użytkownika.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli formant powinien odpowiadać na akcje interfejsu użytkownika; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość 0.

### <a name="remarks"></a>Uwagi

Na przykład kontener może ustawić to na TRUE w trybie projektowania.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COleControl::AmbientUserMode

Określa, czy kontener jest w trybie projektowania lub użytkownika.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli kontener jest w trybie użytkownika; w przeciwnym razie 0 (w trybie projektowania). Jeśli ta właściwość nie jest obsługiwana, ta funkcja zwraca wartość TRUE.

### <a name="remarks"></a>Uwagi

Na przykład kontener może ustawić to na FAŁSZ w trybie projektowania.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COleControl::BoundPropertyZmienił

Sygnalizuje, że wartość właściwości powiązanej została zmieniona.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
Identyfikator wysyłki powiązanej właściwości formantu.

### <a name="remarks"></a>Uwagi

To musi być wywoływane za każdym razem, gdy zmienia się wartość właściwości, nawet w przypadkach, gdy zmiana nie została wykonywana za pomocą właściwości Set metody. Należy szczególnie pamiętać o powiązanych właściwości, które są mapowane do zmiennych członkowskich. Za każdym razem, gdy `BoundPropertyChanged` taka zmienna elementu członkowskiego zmienia się, musi być wywoływana.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdytuj

Żąda uprawnień `IPropertyNotifySink` z interfejsu, aby zmienić wartość właściwości powiązanej dostarczone przez formant.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
Identyfikator wysyłki powiązanej właściwości formantu.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli zmiana jest dozwolona; w przeciwnym razie 0. Wartość domyślna jest niezerowa.

### <a name="remarks"></a>Uwagi

Jeśli uprawnienie zostanie odrzucone, formant nie może zezwalać na zmianę wartości właściwości. Można to zrobić, ignorując lub nie akcji, która próbowała zmienić wartość właściwości.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COleControl::ClientToParent

Przekłada współrzędne *punktu pPoint* na współrzędne nadrzędne.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds (Obfity)*<br/>
Wskaźnik do granic formantu OLE w kontenerze. Nie obszar klienta, ale obszar całego formantu, w tym obramowania i paski przewijania.

*pPunkt*<br/>
Wskaźnik do punktu klienta OLE do przetłumaczenia na współrzędne nadrzędnego (kontenera).

### <a name="remarks"></a>Uwagi

Na wejściu *pPoint* jest względem początku obszaru klienta formantu OLE (lewy górny róg obszaru klienta formantu). Na *wyjściu pPoint* jest względem początku macierzystego (lewy górny róg kontenera).

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COleControl::ClipCaretRect

Dostosowuje prostokąt daszka, jeśli jest całkowicie lub częściowo pokryty nakładającymi się, nieprzezroczystymi obiektami.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*Lprect*<br/>
Na wejściu wskaźnik do struktury [RECT,](/windows/win32/api/windef/ns-windef-rect) który zawiera obszar cieczy do dostosowania. Na wyjściu skorygowany obszar daszka lub NULL, jeśli prostokąt daszka jest całkowicie zakryty.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Dasztka to migająca linia, blok lub mapa bitowa, która zazwyczaj wskazuje, gdzie zostanie wstawiony tekst lub grafika.

Obiekt bez okien nie może bezpiecznie wyświetlić cieczy bez uprzedniego sprawdzenia, czy ciesza jest częściowo lub całkowicie ukryta przez nakładające się obiekty. Aby było to możliwe, obiekt `ClipCaretRect` może użyć, aby uzyskać karetki dostosowane (zmniejszona), aby upewnić się, że mieści się w regionie przycinania.

Obiekty tworzące cieszkę powinny przesyłać `ClipCaretRect` prostokąt ydydaszej i używać dostosowanego prostokąta dla cieszy. Jeśli cieszka jest całkowicie ukryta, ta metoda zwróci wartość FAŁSZ, a w tym przypadku nie należy w ogóle wyświetlać cieszy.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COleControl::COleControl

Konstruuje `COleControl` obiekt.

```
COleControl();
```

### <a name="remarks"></a>Uwagi

Ta funkcja zwykle nie jest wywoływana bezpośrednio. Zamiast tego formant OLE jest zwykle tworzony przez jego fabryki klasy.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COleControl::ControlInfoZwienienie

Wywołanie tej funkcji, gdy zestaw mnemonics obsługiwane przez formant uległ zmianie.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Uwagi

Po otrzymaniu tego powiadomienia kontener formantu uzyskuje nowy zestaw mnemonics, wywołując [IOleControl::GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Należy zauważyć, że kontener nie jest wymagany do odpowiadania na to powiadomienie.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControl::DisplayError

Wywoływane przez platformę po akcji Błąd zdarzenie zostało obsłużone (chyba że program obsługi zdarzeń wygasił wyświetlanie błędu).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parametry

*Scode*<br/>
Wartość kodu stanu do zgłoszenia. Aby uzyskać pełną listę możliwych kodów, zobacz artykuł [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Opis zgłaszanego błędu.

*lpszSource (źródło)*<br/>
Nazwa modułu generującego błąd (zazwyczaj nazwa modułu sterującego OLE).

*lpszHelpFile*<br/>
Nazwa pliku pomocy zawierającego opis błędu.

*nHelpID (Pomoc eksmisja)*<br/>
Identyfikator kontekstu Pomocy zgłaszanego błędu.

### <a name="remarks"></a>Uwagi

Domyślne zachowanie wyświetla okno komunikatu zawierające opis błędu, zawarte w *lpszDescription*.

Zastąd w tej funkcji należy dostosować sposób wyświetlania błędów.

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControl::DoClick

Symuluje akcję kliknięcia myszą na formancie.

```
void DoClick();
```

### <a name="remarks"></a>Uwagi

Funkcja nadrzędnego `COleControl::OnClick` elementu członkowskiego zostanie wywołana, a zdarzenie Click zostanie wywołane, jeśli jest obsługiwane przez formant.

Ta funkcja jest obsługiwana przez klasę podstawową `COleControl` jako metodę zapasową o nazwie DoClick. Aby uzyskać więcej informacji, zobacz artykuł [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControl::DoPropExchange

Wywoływana przez platformę podczas ładowania lub przechowywania formantu z reprezentacji magazynu trwałego, takiego jak strumień lub zestaw właściwości.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*Ppx*<br/>
Wskaźnik do `CPropExchange` obiektu. Ramy dostarcza ten obiekt, aby ustalić kontekst wymiany nieruchomości, w tym jego kierunku.

### <a name="remarks"></a>Uwagi

Ta funkcja zwykle wywołuje **PX_** rodziny funkcji, aby załadować lub przechowywać określone właściwości zdefiniowane przez użytkownika formantu OLE.

Jeśli Kreator sterowania został użyty do utworzenia projektu sterowania OLE, zastąpiona wersja tej funkcji `COleControl` będzie serializować właściwości `COleControl::DoPropExchange`zapasów obsługiwanych za pomocą wywołania funkcji klasy podstawowej, . Podczas dodawania właściwości zdefiniowanych przez użytkownika do formantu OLE należy zmodyfikować tę funkcję, aby serializować nowe właściwości. Aby uzyskać więcej informacji na temat serializacji, zobacz artykuł [ActiveX Formanty: Serializacja](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint

Ponownie rysuje formant OLE, który został podklasyfikowany z formantu systemu Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Wskaźnik do kontekstu urządzenia kontenera sterowania.

*połączenia z rcBounds*<br/>
Obszar, w którym ma być narysowany formant.

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji, aby prawidłowo obsługiwać malowanie nieaktywnej kontrolki OLE. Ta funkcja powinna być używana tylko wtedy, gdy podklasy `OnDraw` formantu OLE formantu systemu Windows i powinny być wywoływane w funkcji formantu.

Aby uzyskać więcej informacji na temat tej funkcji i podklasyfikowania formantu systemu Windows, zobacz artykuł [Formanty ActiveX: Podklasy formantu systemu Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControl::DrawContent

Wywoływana przez strukturę, gdy wygląd formantu musi zostać zaktualizowany.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Wskaźnik do kontekstu urządzenia.

*Rc*<br/>
Prostokątny obszar, który ma zostać wciągnięty.

### <a name="remarks"></a>Uwagi

Ta funkcja wywołuje bezpośrednio funkcję `OnDraw` nadpisywalną.

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControl::DrawMetafile

Wywoływana przez strukturę, gdy używany jest kontekst urządzenia metaplikowego.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Wskaźnik do kontekstu urządzenia metaplik.

*Rc*<br/>
Prostokątny obszar, który ma zostać wciągnięty.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame

Włącza prostą ramkę charakterystyczną dla sterowania OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Uwagi

Ta cecha umożliwia formant do obsługi wizualnego zamknięcia innych formantów, ale nie prawdziwe zamknięcia OLE. Przykładem może być pole grupy z kilkoma formantami wewnątrz. Te formanty nie są ole zawarte, ale znajdują się w tym samym polu grupy.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControl::ExchangeExtent

Serializuje lub inicjuje stan zakresu formantu (jego wymiary w jednostkach HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*Ppx*<br/>
Wskaźnik do [obiektu CPropExchange.](../../mfc/reference/cpropexchange-class.md) Ramy dostarcza ten obiekt, aby ustalić kontekst wymiany nieruchomości, w tym jego kierunku.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli funkcja powiodła się; 0 w przeciwnym razie.

### <a name="remarks"></a>Uwagi

Ta funkcja jest zwykle wywoływana `COleControl::DoPropExchange`przez domyślną implementację programu .

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControl::ExchangeStockProps

Serializuje lub inicjuje stan właściwości zapasów formantu.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*Ppx*<br/>
Wskaźnik do [obiektu CPropExchange.](../../mfc/reference/cpropexchange-class.md) Ramy dostarcza ten obiekt, aby ustalić kontekst wymiany nieruchomości, w tym jego kierunku.

### <a name="remarks"></a>Uwagi

Ta funkcja jest zwykle wywoływana `COleControl::DoPropExchange`przez domyślną implementację programu .

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControl::ExchangeVersion

Serializuje lub inicjuje stan informacji o wersji formantu.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*Ppx*<br/>
Wskaźnik do `CPropExchange` obiektu. Ramy dostarcza ten obiekt, aby ustalić kontekst wymiany nieruchomości, w tym jego kierunku.

*dwVersionDefault (Niem.*<br/>
Bieżący numer wersji formantu.

*bKonwertowanie*<br/>
Wskazuje, czy dane trwałe powinny być konwertowane na najnowszy format po zapisaniu lub przechowywane w tym samym formacie, który został załadowany.

### <a name="return-value"></a>Wartość zwracana

Nonzero funkcji powiodło się; 0 w przeciwnym razie.

### <a name="remarks"></a>Uwagi

Zazwyczaj będzie to pierwsza funkcja wywoływana przez zastąpienie formantu `COleControl::DoPropExchange`. Podczas ładowania ta funkcja odczytuje numer wersji danych trwałych i odpowiednio ustawia atrybut wersji obiektu [CPropExchange.](../../mfc/reference/cpropexchange-class.md) Podczas zapisywania ta funkcja zapisuje numer wersji danych trwałych.

Aby uzyskać więcej informacji na temat trwałości i przechowywania wersji, zobacz artykuł [ActiveX Formanty: Serializacja](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COleControl::FireClick

Wywoływana przez platformę, gdy mysz jest kliknięta przez aktywną formant.

```
void FireClick();
```

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest uruchamiane.

Aby automatyczne wypalanie click zdarzenie występuje, na mapie zdarzenia formantu musi być zdefiniowane zdarzenie Click.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControl::FireDblClick

Wywoływana przez platformę, gdy mysz jest dwukrotnie kliknięty przez aktywny formant.

```
void FireDblClick();
```

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest uruchamiane.

Aby automatyczne wypalanie zdarzenia DblClick występuje, mapa zdarzeń formantu musi mieć zdefiniowane zdarzenie DblClick.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COleControl::FireError

Uruchamia zdarzenie błąd akcji.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*Scode*<br/>
Wartość kodu stanu do zgłoszenia. Aby uzyskać pełną listę możliwych kodów, zobacz artykuł [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Opis zgłaszanego błędu.

*nHelpID (Pomoc eksmisja)*<br/>
Identyfikator pomocy zgłaszanego błędu.

### <a name="remarks"></a>Uwagi

To zdarzenie zapewnia sposób sygnalizacji, w odpowiednich miejscach w kodzie, że wystąpił błąd w formancie. W przeciwieństwie do innych zdarzeń akcji, takich jak Click lub MouseMove, Błąd nigdy nie jest uruchamiany przez strukturę.

Aby zgłosić błąd występujący podczas właściwości get function, property set function lub automation method, call [COleControl::ThrowError](#throwerror).

Implementacja zdarzenia błąd giełdowy formantu OLE używa wartości SCODE. Jeśli formant używa tego zdarzenia i jest przeznaczony do użycia w języku Visual Basic 4.0, pojawią się błędy, ponieważ wartość SCODE nie jest obsługiwana w języku Visual Basic.

Aby rozwiązać ten problem, należy ręcznie zmienić parametr SCODE w formancie . ODL do **długiego**pliku . Ponadto wszelkie niestandardowe zdarzenie, metoda lub właściwość, która używa parametru SCODE również powoduje ten sam problem.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COleControl::FireEvent

Uruchamia zdarzenie zdefiniowane przez użytkownika z formantu z dowolną liczbą opcjonalnych argumentów.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
Identyfikator wysyłki zdarzenia, które ma zostać wystrzelone.

*pbParams ( pbParams )*<br/>
Deskryptor dla typów parametrów zdarzenia.

### <a name="remarks"></a>Uwagi

Zazwyczaj ta funkcja nie powinna być wywoływana bezpośrednio. Zamiast tego można wywołać funkcje wywoływania zdarzeń w sekcji mapy zdarzeń deklaracji klasy formantu.

Argument *pbParams* jest oddzieloną przestrzenią listą **VTS_**. Jedna lub więcej z tych wartości, oddzielonych spacjami (nie przecinkami), określa listę parametrów funkcji. Dopuszczalne są następujące wartości:

|Symbol|Typ parametru|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> Dodatkowe stałe wariantu zostały zdefiniowane dla wszystkich typów wariantów, z wyjątkiem VTS_FONT i VTS_PICTURE, które zapewniają wskaźnik do stałej danych wariantu. Te stałe są nazwane przy użyciu`constantname` **konwencji VTS_P.** Na przykład VTS_PCOLOR jest wskaźnikiem do stałej VTS_COLOR.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COleControl::FireKeyDown

Wywoływana przez platformę, gdy klawisz jest naciśnięty, gdy formant jest aktywny.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar ( pnChar )*<br/>
Wskaźnik do wartości kodu klucza wirtualnego wciśniętego klawisza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser.h

*nShiftState (Stan zmiany biegów)*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK Klawisz SHIFT został wciśnięty podczas akcji.

- CTRL_MASK Klawisz CTRL został wciśnięty podczas akcji.

- ALT_MASK Klawisz ALT został wciśnięty podczas akcji.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest uruchamiane.

Aby automatyczne wypalanie zdarzenia KeyDown występuje, mapa zdarzenia formantu musi mieć zdefiniowane zdarzenie KeyDown.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControl::FireKeyPress

Wywoływana przez platformę, gdy klucz jest naciśnięty i zwolniony, gdy formant niestandardowy jest aktywny w kontenerze.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parametry

*pnChar ( pnChar )*<br/>
Wskaźnik do wartości znaku naciśnięcia klawisza.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest uruchamiane.

Odbiorca zdarzenia może zmodyfikować *pnChar*, na przykład przekonwertować wszystkie małe litery na wielkie litery. Jeśli chcesz zbadać zmodyfikowany znak, należy `OnKeyPressEvent`zastąpić .

Aby automatyczne wypalanie keypress zdarzenie występuje, mapa zdarzeń formantu musi mieć czas KeyPress zdarzenie zdefiniowane.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COleControl::FireKeyUp

Wywoływana przez platformę, gdy klucz jest zwalniany, gdy formant niestandardowy jest aktywny w kontenerze.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar ( pnChar )*<br/>
Wskaźnik do wartości kodu klucza wirtualnego zwolnionego klucza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser.h

*nShiftState (Stan zmiany biegów)*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK Klawisz SHIFT został wciśnięty podczas akcji.

- CTRL_MASK Klawisz CTRL został wciśnięty podczas akcji.

- ALT_MASK Klawisz ALT został wciśnięty podczas akcji.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest uruchamiane.

Aby automatyczne wypalanie zdarzenia KeyUp występuje, mapa zdarzenia formantu musi mieć zdefiniowane zdarzenie keyup.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControl::FireMouseDown

Wywoływana przez platformę, gdy przycisk myszy jest naciśnięty przez aktywny formant niestandardowy.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*nButton (przycisk)*<br/>
Wartość liczbowa naciśnięcia przycisku myszy. Może zawierać jedną z następujących wartości:

- LEFT_BUTTON Lewy przycisk myszy został naciśnięty.

- MIDDLE_BUTTON Środkowy przycisk myszy został naciśnięty.

- RIGHT_BUTTON Naciśnięty został prawy przycisk myszy.

*nShiftState (Stan zmiany biegów)*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK Klawisz SHIFT został wciśnięty podczas akcji.

- CTRL_MASK Klawisz CTRL został wciśnięty podczas akcji.

- ALT_MASK Klawisz ALT został wciśnięty podczas akcji.

*X*<br/>
Współrzędna x kursora po naciśnięciu przycisku myszy. Współrzędna jest względem lewego górnego rogu okna kontrolnego.

*Y*<br/>
Współrzędna y kursora po naciśnięciu przycisku myszy. Współrzędna jest względem lewego górnego rogu okna kontrolnego.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest uruchamiane.

Aby automatyczne wypalanie mousedown zdarzenie występuje, mapa zdarzenia formantu musi mieć zdarzenia MouseDown czas zdefiniowane.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControl::FireMouseMove

Wywoływana przez strukturę, gdy kursor jest przenoszony przez aktywną formant niestandardowy.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*nButton (przycisk)*<br/>
Wartość liczbowa naciśniętych przycisków myszy. Zawiera kombinację następujących wartości:

- LEFT_BUTTON Lewy przycisk myszy został naciśnięty podczas akcji.

- MIDDLE_BUTTON Środkowy przycisk myszy został naciśnięty podczas akcji.

- RIGHT_BUTTON Podczas akcji naciśnięty został prawy przycisk myszy.

*nShiftState (Stan zmiany biegów)*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK Klawisz SHIFT został wciśnięty podczas akcji.

- CTRL_MASK Klawisz CTRL został wciśnięty podczas akcji.

- ALT_MASK Klawisz ALT został wciśnięty podczas akcji.

*X*<br/>
Współrzędna x kursora. Współrzędna jest względem lewego górnego rogu okna kontrolnego.

*Y*<br/>
Współrzędna y kursora. Współrzędna jest względem lewego górnego rogu okna kontrolnego.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest uruchamiane.

Aby automatyczne wypalanie mousemove zdarzenie występuje, mapa zdarzenia formantu musi mieć czas MouseMove zdarzenie zdefiniowane.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControl::FireMouseUp

Wywoływane przez platformę, gdy przycisk myszy jest zwolniony za pomocą aktywnego formantu niestandardowego.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*nButton (przycisk)*<br/>
Wartość liczbowa zwolnionego przycisku myszy. Może mieć jedną z następujących wartości:

- LEFT_BUTTON Lewy przycisk myszy został zwolniony.

- MIDDLE_BUTTON Środkowy przycisk myszy został zwolniony.

- RIGHT_BUTTON Prawy przycisk myszy został zwolniony.

*nShiftState (Stan zmiany biegów)*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK Klawisz SHIFT został wciśnięty podczas akcji.

- CTRL_MASK Klawisz CTRL został wciśnięty podczas akcji.

- ALT_MASK Klawisz ALT został wciśnięty podczas akcji.

*X*<br/>
Współrzędna x kursora po zwolnieniu przycisku myszy. Współrzędna jest względem lewego górnego rogu okna kontrolnego.

*Y*<br/>
Współrzędna y kursora po zwolnieniu przycisku myszy. Współrzędna jest względem lewego górnego rogu okna kontrolnego.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowane jako zdarzenie niestandardowe, należy określić, kiedy zdarzenie jest uruchamiane.

Aby automatyczne wypalanie mouseup zdarzenie występuje, mapa zdarzenia formantu musi mieć czas MouseUp zdarzenie zdefiniowane.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COleControl::FireReadyStateChange

Uruchamia zdarzenie o bieżącej wartości gotowego stanu kontroli.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Uwagi

Stan gotowości może być jedną z następujących wartości:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Domyślny stan inicjowania|
|READYSTATE_LOADING|Formant aktualnie ładuje swoje właściwości|
|READYSTATE_LOADED|Formant został zainicjowany|
|READYSTATE_INTERACTIVE|Control ma wystarczającą ilość danych, aby były interaktywne, ale nie wszystkie dane asynchroniczne są jeszcze załadowane|
|READYSTATE_COMPLETE|Control ma wszystkie swoje dane|

Użyj [GetReadyState,](#getreadystate) aby określić bieżącą gotowość formantu.

[InternalSetReadyState](#internalsetreadystate) zmienia stan gotowości na dostarczoną `FireReadyStateChange`wartość, a następnie wywołuje .

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControl::GetActivationPolicy

Zmienia domyślne zachowanie aktywacji formantu obsługującego `IPointerInactive` interfejs.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Wartość zwracana

Kombinacja flag z wyliczenia POINTERINACTIVE. Możliwe flagi to:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Obiekt powinien być aktywowany w miejscu, gdy mysz wejdzie do niego podczas operacji przenoszenia myszy.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Obiekt powinien zostać dezaktywowany, gdy mysz opuści obiekt podczas operacji przenoszenia myszy.|
|POINTERINACTIVE_ACTIVATEONDRAG|Obiekt powinien być aktywowany w miejscu, gdy mysz jest przeciągana nad nim podczas operacji przeciągania i upuszczania.|

### <a name="remarks"></a>Uwagi

Gdy `IPointerInactive` interfejs jest włączony, kontener będzie delegować WM_SETCURSOR i WM_MOUSEMOVE do niego wiadomości. `COleControl`'s implementacja tego interfejsu będzie wysyłać te komunikaty za pośrednictwem mapy wiadomości formantu, po dostosowaniu współrzędnych myszy odpowiednio.

Za każdym razem, gdy kontener odbiera WM_SETCURSOR lub WM_MOUSEMOVE komunikat ze wskaźnikiem `IPointerInactive`myszy na `GetActivationPolicy` nieaktywnym obiekcie obsługującym, należy wywołać na interfejsie i zwracać flagi z wyliczenia POINTERINACTIVE.

Można przetwarzać te wiadomości, podobnie jak zwykłe wiadomości okna, dodając odpowiednie wpisy do mapy wiadomości. W programach obsługi należy `m_hWnd` unikać używania zmiennej członkowskiej (lub funkcji członkowskich, która jej używa) bez uprzedniego sprawdzenia, czy jej wartość nie jest null.

Każdy obiekt przeznaczony do zrobienia więcej niż ustawić kursor myszy i/lub wypalić zdarzenie ruchu myszy, takie jak dać specjalne wizualne sprzężenie zwrotne, należy zwrócić flagę POINTERINACTIVE_ACTIVATEONENTRY i narysować sprzężenie zwrotne tylko wtedy, gdy są aktywne. Jeśli obiekt zwraca tę flagę, kontener powinien natychmiast ją aktywować w miejscu, a `GetActivationPolicy`następnie przesłać dalej ten sam komunikat, który wyzwolił wywołanie .

Jeśli zwracane są flagi POINTERINACTIVE_ACTIVATEONENTRY i POINTERINACTIVE_DEACTIVATEONLEAVE, obiekt zostanie aktywowany tylko wtedy, gdy mysz znajdzie się nad obiektem. Jeśli zwracana jest tylko flaga POINTERINACTIVE_ACTIVATEONENTRY, obiekt zostanie aktywowany tylko raz, gdy mysz po raz pierwszy wejdzie do obiektu.

Możesz również chcieć nieaktywnego formantu być celem operacji przeciągania i upuszczania OLE. Wymaga to aktywowania formantu w momencie, gdy użytkownik przeciąga obiekt nad nim, dzięki czemu okno formantu może być zarejestrowane jako miejsce docelowe upuszczania. Aby spowodować aktywację podczas przeciągania, zwróć flagę POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Informacje przekazywane przez `GetActivationPolicy` nie powinny być buforowane przez kontener. Zamiast tego ta metoda powinna być wywoływana za każdym razem, gdy mysz wchodzi do nieaktywnego obiektu.

Jeśli obiekt nieaktywny nie żąda aktywowania w miejscu po wprowadzeniu myszy, jego kontener powinien wysyłać kolejne WM_SETCURSOR wiadomości do tego obiektu, wywołując [OnInactiveSetCursor](#oninactivesetcursor) tak długo, jak wskaźnik myszy pozostaje nad obiektem.

Włączenie `IPointerInactive` interfejsu zazwyczaj oznacza, że formant ma być w stanie przetwarzać komunikaty myszy przez cały czas. Aby uzyskać to zachowanie w kontenerze, `IPointerInactive` który nie obsługuje interfejsu, należy mieć formant zawsze aktywowany, gdy jest widoczny, co oznacza, że formant powinien mieć flagę OLEMISC_ACTIVATEWHENVISIBLE wśród jego różnych flag. Jednak aby zapobiec wprowadzaniu tej flagi w `IPointerInactive`kontenerze, który obsługuje, można również określić flagę OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControl::GetAmbientProperty

Pobiera wartość właściwości otoczenia kontenera.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parametry

*dwDispid (Niedyskład*<br/>
Identyfikator wysyłki żądanej właściwości otoczenia.

*vtProp (vtProp)*<br/>
Znacznik typu wariantu określający typ wartości, która ma zostać zwrócona w *pvProp*.

*pvProp*<br/>
Wskaźnik do adresu zmiennej, która otrzyma wartość właściwości lub wartość zwracaną. Rzeczywisty typ tego wskaźnika musi być zgodny z typem określonym przez *vtProp*.

|vtProp (vtProp)|Typ pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|Vt_bstr|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli właściwość otoczenia jest obsługiwana; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli używasz `GetAmbientProperty` do pobierania właściwości otaczającego DisplayName i ScaleUnits, ustaw *vtProp* na `CString*`VT_BSTR i *pvProp* na . Jeśli pobierasz właściwość otoczenia Font, ustaw *vtProp* na VT_FONT i *pvProp* na LPFONTDISP*.

Należy zauważyć, że funkcje zostały już przewidziane dla wspólnych właściwości otoczenia, takich jak [AmbientBackColor](#ambientbackcolor) i [AmbientFont](#ambientfont).

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControl::GetAppearance

Implementuje Get funkcji właściwości wygląd akcji formantu.

```
short GetAppearance ();
```

### <a name="return-value"></a>Wartość zwracana

Zwracana wartość określa bieżące ustawienie wyglądu jako wartość **krótką** (VT_I2), jeśli zakończy się pomyślnie. Ta wartość wynosi zero, jeśli wygląd formantu jest płaski i 1, jeśli wygląd formantu jest 3D.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControl::GetBackColor

Implementuje Pobierz funkcję zapasów formantu BackColor właściwości.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Wartość zwracana

Zwracana wartość określa bieżący kolor tła jako wartość OLE_COLOR, jeśli zakończy się pomyślnie. Tę wartość można przetłumaczyć na wartość COLORREF za pomocą wywołania . `TranslateColor`

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COleControl::GetBorderStyle

Implementuje Pobierz funkcję właściwości BorderStyle magazynu formantu.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Wartość zwracana

1, jeżeli kontrola ma normalną granicę; 0, jeśli formant nie ma obramowania.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COleControl::GetCapture

Określa, `COleControl` czy obiekt ma przechwytywanie myszy.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Wartość zwracana

Jeśli formant jest aktywowany i bez okien, zwraca **to,** jeśli formant ma obecnie przechwytywania myszy (zgodnie z ustaleniami przez kontener formantu) lub NULL, jeśli nie ma przechwytywania.

W przeciwnym `CWnd` razie zwraca obiekt, który `CWnd::GetCapture`ma przechwytywanie myszy (tak samo jak ).

### <a name="remarks"></a>Uwagi

Aktywowany formant bez okien odbiera przechwytywanie myszy, gdy wywoływana jest [setcapture.](#setcapture)

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COleControl::GetClassID

Wywoływana przez strukturę, aby pobrać identyfikator klasy OLE formantu.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parametry

*sztlsid*<br/>
Wskaźnik do lokalizacji identyfikatora klasy.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli wywołanie nie powiodło się; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zwykle realizowane przez [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COleControl::GetClientOffset

Pobiera różnicę między lewym górnym rogu prostokątnego obszaru formantu a lewym górnym rogu jego obszaru klienta.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parametry

*pdxOffset (Polski)*<br/>
Wskaźnik do poziomego odsunięcia obszaru klienta formantu OLE.

*pdyOffset (polski)*<br/>
Wskaźnik do pionowego odsunięcia obszaru klienta formantu OLE.

### <a name="remarks"></a>Uwagi

Formant OLE ma prostokątny obszar w jego kontenerze. Obszar klienta formantu jest obszarem kontrolnym z wyłączeniem obramowań i pasków przewijania. Odsunięcie `GetClientOffset` pobrane przez jest różnica między lewym górnym rogu obszaru prostokątnego formantu i lewym górnym rogu jego obszaru klienta. Jeśli formant ma elementy inne niż standardowe obramowania i paski przewijania, należy zastąpić tę funkcję elementu członkowskiego, aby określić przesunięcie.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControl::GetClientRect

Pobiera rozmiar obszaru klienta formantu.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parametry

*Lprect*<br/>
Wskaźnik do `RECT` struktury zawierającej wymiary obszaru klienta formantu bez okien; oznacza to, że rozmiar formantu minus obramowania okien, ramki, paski przewijania i tak dalej. *Parametr lpRect* wskazuje rozmiar prostokąta klienta formantu, a nie jego położenie.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControl::GetClientSite

Wysyła zapytania do obiektu dla wskaźnika do bieżącej lokacji klienta w jego kontenerze.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do bieżącej lokacji klienta formantu w kontenerze.

### <a name="remarks"></a>Uwagi

Zwrócony wskaźnik wskazuje na `IOleClientSite`wystąpienie . Interfejs, `IOleClientSite` zaimplementowane przez kontenery, jest widok obiektu jego kontekstu: gdzie jest zakotwiczony w dokumencie, gdzie pobiera jego magazynu, interfejsu użytkownika i innych zasobów.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COleControl::GetControlFlags

Pobiera ustawienia flagi sterowania.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Wartość zwracana

ORed kombinacja flag w ControlFlags wyliczenia:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Uwagi

Domyślnie `GetControlFlags` zwraca `fastBeginPaint | clipPaintDC`program .

|||
|-|-|
|`fastBeginPaint`|Jeśli jest ustawiona, używa funkcji początkowej malowania dostosowanej do formantów OLE zamiast [interfejsu API BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) (ustawionej domyślnie).|
|`clipPaintDC`|Jeśli nie jest ustawiona, `IntersectClipRect` wyłącza wywołanie wykonane przez `COleControl` i zyskuje niewielką przewagę prędkości. Jeśli używasz aktywacji bez okien, flaga nie ma wpływu.|
|`pointerInactive`|Jeśli jest ustawiona, zapewnia interakcję myszy, gdy `COleControl`formant jest `IPointerInactive` nieaktywny, włączając implementację interfejsu, który jest domyślnie wyłączony.|
|`noFlickerActivate`|Jeśli jest ustawiona, eliminuje dodatkowe operacje rysowania i towarzyszące mu migotanie wizualne. Użyj, gdy formant rysuje się identycznie w stanach nieaktywnych i aktywnych. Jeśli używasz aktywacji bez okien, flaga nie ma wpływu.|
|`windowlessActivate`|Jeśli jest ustawiona, wskazuje, że formant używa aktywacji bez okien.|
|`canOptimizeDraw`|Jeśli jest ustawiona, wskazuje, że formant wykona zoptymalizowany rysunek, jeśli kontener go obsługuje.|

Aby uzyskać `GetControlFlags` więcej informacji na temat i innych optymalizacji formantów OLE, zobacz [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COleControl::GetControlSize

Pobiera rozmiar okna formantu OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parametry

*Pcx*<br/>
Określa szerokość formantu w pikselach.

*szty*<br/>
Określa wysokość formantu w pikselach.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że wszystkie współrzędne okien kontrolnych są względem lewego górnego rogu formantu.

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COleControl::GetDC

Zapewnia obiekt bez okien, aby uzyskać kontekst ekranu (lub zgodne) urządzenia z jego kontenera.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parametry

*lprcRect*<br/>
Wskaźnik do prostokąta formant bez okien chce przerysować, we współrzędnych klienta formantu. WARTOŚĆ NULL oznacza pełny zasięg obiektu.

*Dwflags*<br/>
Atrybuty rysowania kontekstu urządzenia. Dostępne są:

- OLEDC_NODRAW Wskazuje, że obiekt nie będzie używać kontekstu urządzenia do wykonywania żadnego rysunku, a jedynie w celu uzyskania informacji o urządzeniu wyświetlającym. Kontener powinien po prostu przekazać kontroler domeny okna bez dalszego przetwarzania.

- OLEDC_PAINTBKGND Żąda, aby kontener malował tło przed zwróceniem kontrolera domeny. Obiekt powinien używać tej flagi, jeśli żąda dc do ponownego rysowania obszaru z przezroczystym tłem.

- OLEDC_OFFSCREEN Informuje kontenera, że obiekt chce renderować do mapy bitowej poza ekranem, które następnie powinny być kopiowane na ekran. Obiekt powinien używać tej flagi, gdy operacja rysowania, która ma zostać wykonania, generuje dużo migotania. Kontener może honorować to żądanie, czy nie. Jeśli jednak ta flaga nie jest ustawiona, kontener musi oddać ekranowy kontroler domeny. Dzięki temu obiekty mogą wykonywać bezpośrednie operacje ekranu, takie jak pokazywanie zaznaczenia (za pomocą operacji **XOR).**

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do kontekstu urządzenia `CWnd` wyświetlania dla obszaru klienta kontenera, jeśli zakończy się pomyślnie; w przeciwnym razie zwracana wartość to NULL. Kontekst urządzenia wyświetlania może służyć w kolejnych funkcjach GDI do rysowania w obszarze klienta okna kontenera.

### <a name="remarks"></a>Uwagi

ReleaseDC funkcji [członkowskiej](#releasedc) musi być wywołana, aby zwolnić kontekst po malowaniu. Podczas `GetDC`wywoływania obiekty przekazują prostokąt, który chcą narysować we własnych współrzędnych klienta. `GetDC`przekłada je na współrzędne obszaru klienta kontenera. Obiekt nie powinien żądać żądanego prostokąta rysunku większego niż jego własny prostokąt obszaru klienta, którego rozmiar można pobrać za pomocą [GetClientRect](#getclientrect). Zapobiega to przypadkowemu rysowaniu obiektów tam, gdzie nie powinny.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COleControl::GetEnabled

Implementuje Funkcję Pobierz właściwości enabled magazynu formantu.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli formant jest włączony; w przeciwnym razie 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COleControl::GetExtendedControl

Uzyskuje wskaźnik do obiektu obsługiwanego przez kontener, który reprezentuje formant z rozszerzonym zestawem właściwości.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do rozszerzonego obiektu sterującego kontenera. Jeśli nie ma dostępnego obiektu, wartość jest NULL.

Ten obiekt może być `IDispatch` manipulowany za pośrednictwem jego interfejsu. Można również `QueryInterface` użyć do uzyskania innych dostępnych interfejsów dostarczonych przez obiekt. Jednak obiekt nie jest wymagane do obsługi określonego zestawu interfejsów. Należy zauważyć, że poleganie na określonych cech kontenera rozszerzony obiekt kontrolny ogranicza przenośność formantu do innych dowolnych kontenerów.

### <a name="remarks"></a>Uwagi

Funkcja, która wywołuje tę funkcję jest odpowiedzialny za zwolnienie wskaźnika po zakończeniu z obiektem. Należy zauważyć, że kontener nie jest wymagany do obsługi tego obiektu.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControl::GetFocus

Określa, `COleControl` czy obiekt ma fokus.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Wartość zwracana

Jeśli formant jest aktywowany i bez okien, zwraca **to,** jeśli formant ma obecnie fokus klawiatury (zgodnie z ustaleniami kontenera formantu) lub NULL, jeśli nie ma fokusu.

W przeciwnym `CWnd` razie zwraca obiekt, który `CWnd::GetFocus`ma fokus (taki sam jak ).

### <a name="remarks"></a>Uwagi

Aktywowany formant bez okien odbiera fokus, gdy wywoływany jest [SetFocus.](#setfocus)

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControl::GetFont

Implementuje Pobierz funkcję właściwości Font.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do interfejsu wysyłania czcionek właściwości Font magazynu formantu.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że obiekt wywołujący musi zwolnić obiekt po zakończeniu. W ramach implementacji formantu użyj, `InternalGetFont` aby uzyskać dostęp do obiektu Font magazynu formantu. Aby uzyskać więcej informacji na temat używania czcionek w formancie, zobacz artykuł [Kontrolki ActiveX: Używanie czcionek w formancie ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics

Mierzy metryki tekstu dla `CFontHolder` dowolnego obiektu należącego do formantu.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Wskaźnik do struktury [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

*fontHolder*<br/>
Odwołanie do obiektu [CFontHolder.](../../mfc/reference/cfontholder-class.md)

### <a name="remarks"></a>Uwagi

Taką czcionkę można wybrać za pomocą funkcji [COleControl::SelectFontObject.](#selectfontobject) `GetFontTextMetrics`rozpocznie strukturę `TEXTMETRIC` wskazywania przez *lptm* z `fontHolder`prawidłowymi informacjami o metrykach dotyczących czcionki ,,jeśli się powiedzie, lub wypełni strukturę zerami, jeśli nie powiedzie się. Tej funkcji należy użyć zamiast [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) podczas malowania formantu, ponieważ formanty, podobnie jak każdy osadzony obiekt OLE, mogą być wymagane do renderowania się w metaplik.

Struktura `TEXTMETRIC` czcionki domyślnej jest odświeżana po wywołaniu funkcji [SelectFontObject.](#selectfontobject) Należy wywołać `GetFontTextMetrics` tylko po wybraniu właściwości font czas, aby upewnić się, że informacje, które dostarcza jest prawidłowa.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControl::GetForeColor

Implementuje Pobierz funkcję akcji ForeColor właściwości.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Wartość zwracana

Zwracana wartość określa bieżący kolor pierwszego planu jako wartość OLE_COLOR, jeśli zakończy się pomyślnie. Tę wartość można przetłumaczyć na wartość [COLORREF](/windows/win32/gdi/colorref) za pomocą wywołania . `TranslateColor`

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControl::GetHwnd

Implementuje Get funkcji hWnd czas właściwości.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Wartość zwracana

Uchwyt okna formantu OLE, jeśli istnieje; w przeciwnym razie NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COleControl::GetMessageStrowanie

Wywoływane przez strukturę, aby uzyskać krótki ciąg, który opisuje cel elementu menu identyfikowanego przez *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parametry

*Nid*<br/>
Identyfikator elementu menu.

*rMessage*<br/>
Odwołanie do [CString](../../atl-mfc-shared/reference/cstringt-class.md) obiektu, za pośrednictwem którego zostanie zwrócony ciąg.

### <a name="remarks"></a>Uwagi

Może to służyć do uzyskania wiadomości do wyświetlenia na pasku stanu, gdy element menu jest wyróżniony. Domyślna implementacja próbuje załadować zasób ciągu identyfikowany przez *nID*.

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COleControl::GetNotSupported

Uniemożliwia dostęp do wartości właściwości formantu przez użytkownika.

```
void GetNotSupported();
```

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji zamiast Get funkcji dowolnej właściwości, gdzie pobieranie właściwości przez użytkownika formantu nie jest obsługiwane. Jednym z przykładów może być właściwość, która jest tylko zapis.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControl::GetReadyState

Zwraca stan gotowości formantu.

```
long GetReadyState();
```

### <a name="return-value"></a>Wartość zwracana

Stan gotowości formantu, jedna z następujących wartości:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Domyślny stan inicjowania|
|READYSTATE_LOADING|Formant aktualnie ładuje swoje właściwości|
|READYSTATE_LOADED|Formant został zainicjowany|
|READYSTATE_INTERACTIVE|Control ma wystarczającą ilość danych, aby były interaktywne, ale nie wszystkie dane asynchroniczne są jeszcze załadowane|
|READYSTATE_COMPLETE|Control ma wszystkie swoje dane|

### <a name="remarks"></a>Uwagi

Najprostsze formanty nigdy nie trzeba rozróżniać między LOADED i INTERACTIVE. Jednak formanty, które obsługują właściwości ścieżki danych może nie być gotowy do interaktywnych, dopóki co najmniej niektóre dane są odbierane asynchronicznie. Formant powinien podjąć próbę uzyskania interakcyjnej tak szybko, jak to możliwe.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COleControl::GetRectInContainer

Uzyskuje współrzędne prostokąta formantu względem kontenera, wyrażone w jednostkach urządzenia.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*Lprect*<br/>
Wskaźnik do struktury prostokąta, do którego współrzędne formantu zostaną skopiowane.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli formant jest aktywny w miejscu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Prostokąt jest prawidłowy tylko wtedy, gdy formant jest aktywny w miejscu.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics

Mierzy metryki tekstowe dla właściwości Font magazynu formantu, którą można wybrać za pomocą funkcji [SelectStockFont.](#selectstockfont)

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Wskaźnik do struktury [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

### <a name="remarks"></a>Uwagi

Funkcja `GetStockTextMetrics` zainisalizuje `TEXTMETRIC` strukturę wskazywania przez *lptm* z prawidłowymi informacjami o metrykach, jeśli się powiedzie, lub wypełni strukturę zerami, jeśli nie powiedzie się. Użyj tej funkcji zamiast [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) podczas malowania formantu, ponieważ formanty, podobnie jak każdy osadzony obiekt OLE, mogą być wymagane do renderowania się w metaplik.

Struktura `TEXTMETRIC` czcionki domyślnej jest odświeżana, gdy `SelectStockFont` wywoływana jest funkcja. Tę funkcję należy wywołać dopiero po wybraniu czcionki giełdowej, aby upewnić się, że informacje, które dostarcza, są prawidłowe.

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControl::GetText

Implementuje Pobierz funkcję stock Text lub Caption właściwości.

```
BSTR GetText();
```

### <a name="return-value"></a>Wartość zwracana

Bieżąca wartość ciągu tekstowego formantu lub ciągu o zerowej długości, jeśli nie ma ciągu.

> [!NOTE]
> Aby uzyskać więcej informacji na temat typu danych BSTR, zobacz [Typy danych](../../mfc/reference/data-types-mfc.md) w sekcji Makra i Globalne.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że obiekt wywołujący tej funkcji musi wywołać `SysFreeString` ciąg zwrócony w celu zwolnienia zasobu. W ramach implementacji formantu użyj, `InternalGetText` aby uzyskać dostęp do właściwości Tekst lub Podpis zapasów formantu.

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COleControl::GetWindowlessDropTarget

Zastądnij, `GetWindowlessDropTarget` gdy formant bez okien ma być celem operacji przeciągania i upuszczania OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do `IDropTarget` interfejsu obiektu. Ponieważ nie ma okna, obiekt bez okien `IDropTarget` nie może zarejestrować interfejsu. Jednak aby wziąć udział w przeciąganiu i upuszczaniu, obiekt `GetWindowlessDropTarget`bez okien może nadal implementować interfejs i zwracać go w programie .

### <a name="remarks"></a>Uwagi

Normalnie wymagałoby to, aby okno formantu zostało zarejestrowane jako miejsce docelowe upuszczania. Ale ponieważ formant nie ma własnego okna, kontener użyje własnego okna jako celu upuszczania. Formant po prostu musi zapewnić `IDropTarget` implementację interfejsu, do którego kontener może delegować wywołania w odpowiednim czasie. Przykład:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COleControl::InicjalizacjaID

Informuje klasę podstawową identyfikatorów IID, których będzie używać formant.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parametry

*piidPrimary (Niemka)*<br/>
Wskaźnik do identyfikatora interfejsu głównego interfejsu wysyłki formantu.

*piidEvents*<br/>
Wskaźnik do identyfikatora interfejsu interfejsu zdarzenia formantu.

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji w konstruktorze formantu, aby poinformować klasę podstawową identyfikatorów interfejsu, które będzie używany przez formant.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControl::InternalGetFont

Dostęp do właściwości czcionki giełdowej formantu

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Wartość zwracana

Odwołanie do [obiektu CFontHolder,](../../mfc/reference/cfontholder-class.md) który zawiera obiekt Font.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControl::InternalGetText

Uzyskuje dostęp do właściwości Tekst lub Podpis zapasów formantu.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Wartość zwracana

Odwołanie do ciągu tekstowego formantu.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControl::InternalSetReadyState

Ustawia stan gotowości formantu.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parametry

*lNewReadyState*<br/>
Stan gotowości do ustawionego dla formantu, jedną z następujących wartości:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Domyślny stan inicjowania|
|READYSTATE_LOADING|Formant aktualnie ładuje swoje właściwości|
|READYSTATE_LOADED|Formant został zainicjowany|
|READYSTATE_INTERACTIVE|Control ma wystarczającą ilość danych, aby były interaktywne, ale nie wszystkie dane asynchroniczne są jeszcze załadowane|
|READYSTATE_COMPLETE|Control ma wszystkie swoje dane|

### <a name="remarks"></a>Uwagi

Najprostsze formanty nigdy nie trzeba rozróżniać między LOADED i INTERACTIVE. Jednak formanty, które obsługują właściwości ścieżki danych może nie być gotowy do interaktywnych, dopóki co najmniej niektóre dane są odbierane asynchronicznie. Formant powinien podjąć próbę uzyskania interakcyjnej tak szybko, jak to możliwe.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COleControl::InvalidateControl

Wymusza ponowne rysowanie przez formant.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*Lprect*<br/>
Wskaźnik do regionu formantu, który ma zostać unieważniony.

*bErase (Niezmy)*<br/>
Określa, czy tło w regionie aktualizacji ma zostać wymazane podczas przetwarzania regionu aktualizacji.

### <a name="remarks"></a>Uwagi

Jeśli *lpRect* ma wartość NULL, cały formant zostanie ponownie narysowany. Jeśli *lpRect* nie jest null, oznacza to część prostokąta formantu, który ma zostać unieważniony. W przypadkach, gdy formant nie ma okna lub obecnie nie jest aktywny, prostokąt jest ignorowany i wywołanie jest wywoływane do funkcji elementu członkowskiego [IAdviseSink::OnViewChange.](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) Użyj tej funkcji `CWnd::InvalidateRect` zamiast `InvalidateRect`lub .

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControl::InvalidateRgn

Unieważnia obszar klienta okna kontenera w danym regionie.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*pRgn*<br/>
Wskaźnik do obiektu [CRgn,](../../mfc/reference/crgn-class.md) który identyfikuje obszar wyświetlania obiektu OLE do unieważnienia, we współrzędnych klienta okna zawierającego. Jeśli ten parametr ma wartość NULL, zakres jest całym obiektem.

*bErase (Niezmy)*<br/>
Określa, czy tło w unieważnionym regionie ma zostać wymazane. Jeśli true, tło jest usuwane. Jeśli FALSE, tło pozostaje niezmieniona.

### <a name="remarks"></a>Uwagi

Może to służyć do ponownego rysowania formantów bez okien w kontenerze. Unieważniony region wraz ze wszystkimi innymi obszarami w regionie aktualizacji jest oznaczony do malowania podczas wysyłania następnego [WM_PAINT](/windows/win32/gdi/wm-paint) wiadomości.

Jeśli *bErase* ma wartość TRUE dla dowolnej części regionu aktualizacji, tło w całym regionie, a nie tylko w danej części, jest usuwane.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControl::IsConvertingVBX

Umożliwia specjalistyczne ładowanie formantu OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli formant jest konwertowany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Podczas konwertowania formularza, który używa formantów VBX do jednego, który używa formantów OLE, może być wymagany specjalny kod ładowania dla formantów OLE. Na przykład, jeśli ładujesz wystąpienie formantu OLE, możesz mieć wywołanie [PX_Font](persistence-of-ole-controls.md#px_font) w : `DoPropExchange`

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Jednak formanty VBX nie mają Font obiektu; każda właściwość czcionki została zapisana indywidualnie. W takim przypadku należy `IsConvertingVBX` użyć do rozróżnienia między tymi dwoma przypadkami:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Innym przypadkiem byłoby, jeśli kontrola VBX zapisane zastrzeżone dane binarne (w VBM_SAVEPROPERTY obsługi wiadomości), a kontrola OLE zapisuje swoje dane binarne w innym formacie. Jeśli chcesz, aby formant OLE był wstecznie zgodny z formantem VBX, możesz `IsConvertingVBX` odczytać zarówno stare, jak i nowe formaty przy użyciu tej funkcji, rozróżniając, czy ładowany był kontrola VBX, czy kontrolka OLE.

W `DoPropExchange` funkcji formantu można sprawdzić, czy ten warunek i jeśli true, wykonać kod obciążenia specyficzne dla tej konwersji (takich jak poprzednie przykłady). Jeśli formant nie jest konwertowany, można wykonać normalny kod obciążenia. Ta możliwość ma zastosowanie tylko do formantów konwertowanych z odpowiedników VBX.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed

Umożliwia wywołanie metody automatyzacji.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli formant został zainicjowany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Implementacja ram `IDispatch::Invoke` wywołania `IsInvokeAllowed` w celu ustalenia, czy `dispid`dana funkcja (identyfikowane przez ) mogą być wywoływane. Domyślnym zachowaniem formantu OLE jest umożliwienie wywoływania metod automatyzacji tylko wtedy, gdy formant został zainicjowany; jednak `IsInvokeAllowed` jest funkcją wirtualną i może zostać zastąpiona w razie potrzeby (na przykład, gdy formant jest używany jako serwer automatyzacji).

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COleControl::JestZmodyfikowany

Określa, czy stan formantu został zmodyfikowany.

```
BOOL IsModified();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli stan formantu został zmodyfikowany od czasu ostatniego zapisania; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Stan formantu jest modyfikowany, gdy właściwość zmienia wartość.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControl::IsOptimizedDraw

Określa, czy kontener obsługuje zoptymalizowany rysunek dla bieżącej operacji rysowania.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Wartość zwracana

PRAWDA, jeśli kontener obsługuje zoptymalizowany rysunek dla bieżącej operacji rysowania; w przeciwnym razie FALSE.

### <a name="remarks"></a>Uwagi

Jeśli obsługiwany jest zoptymalizowany rysunek, formant nie musi zaznaczać starych obiektów (piór, pędzli, czcionek itp.) w kontekście urządzenia po zakończeniu rysowania.

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl

Wywoływane przez strukturę, aby ustalić, czy podklasy formantu formantu systemu Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli formant jest podklasyfikowany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy zastąpić tę funkcję i zwrócić wartość PRAWDA, jeśli formant OLE podklasuje formant systemu Windows.

## <a name="colecontrolload"></a><a name="load"></a>COleControl::Obciążenie

Resetuje wszystkie poprzednie dane załadowane asynchronicznie i inicjuje nowe ładowanie właściwości asynchronicznie formantu.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parametry

*strNewPath (Ścieżka nienastępna)*<br/>
Wskaźnik do ciągu zawierającego ścieżkę, która odwołuje się do bezwzględnej lokalizacji właściwości formantu asynchronii.

*Wniosku*<br/>
Obiekt [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) implementująca właściwość formantu asynchroniczne.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COleControl::LockInPlaceActive

Zapobiega dezaktywacji formantu przez kontener.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parametry

*Bloku*<br/>
PRAWDA, jeśli aktywny stan w miejscu formantu ma być zablokowany; FALSE, jeśli ma być odblokowany.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli blokada powiodła się; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że każde zablokowanie formantu musi być sparowane z odblokowaniem formantu po zakończeniu. Formant należy blokować tylko na krótkie okresy, na przykład podczas wypalania zdarzenia.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange

Wywoływana przez strukturę, gdy właściwość otoczenia kontenera zmieniła wartość.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
Identyfikator wysyłki właściwości otoczenia, która uległa zmianie lub DISPID_UNKNOWN, jeśli wiele właściwości uległo zmianie.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COleControl::OnAppearanceZmienione

Wywoływana przez strukturę, gdy wartość właściwości wygląd akcji uległa zmianie.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Uwagi

Zastądeń tę funkcję, jeśli chcesz powiadomić po zmianie tej właściwości. Domyślna implementacja wywołuje `InvalidateControl`.

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COleControl::OnBackColorZanged

Wywoływana przez strukturę, gdy wartość właściwości backcolor magazynu uległa zmianie.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Uwagi

Zastądeń tę funkcję, jeśli chcesz powiadomić po zmianie tej właściwości. Domyślna implementacja wywołuje `InvalidateControl`.

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COleControl::OnBorderStyleZmienine

Wywoływana przez strukturę, gdy wartość właściwości BorderStyle magazynu uległa zmianie.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `InvalidateControl`.

Zastądeń tę funkcję, jeśli chcesz powiadomić po zmianie tej właściwości.

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControl::OnClick

Wywoływana przez platformę po kliknięciu przycisku myszy lub wywołano metodę doclicka.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parametry

*Przycisk iButton*<br/>
Indeks przycisku myszy. Może mieć jedną z następujących wartości:

- LEFT_BUTTON Kliknięcie lewego przycisku myszy.

- MIDDLE_BUTTON Kliknięcie środkowego przycisku myszy.

- RIGHT_BUTTON Kliknięcie prawego przycisku myszy.

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `COleControl::FireClick`.

Zastąpojąć tę funkcję elementu członkowskiego, aby zmodyfikować lub rozszerzyć domyślną obsługę.

## <a name="colecontrolonclose"></a><a name="onclose"></a>COleControl::OnClose

Wywoływana przez strukturę, gdy kontener `IOleControl::Close` wywołał funkcję formantu.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parametry

*dwSaveOption (10: 100 00*<br/>
Flaga wskazująca, czy obiekt powinien zostać zapisany przed załadowaniem. Prawidłowe wartości:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Uwagi

Domyślnie `OnClose` zapisuje obiekt kontrolny, jeśli został zmodyfikowany, a *dwSaveOption* jest OLECLOSE_SAVEIFDIRTY lub OLECLOSE_PROMPTSAVE.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControl::OnDoVerb

Wywoływane przez strukturę, `IOleObject::DoVerb` gdy kontener wywołuje funkcję elementu członkowskiego.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*iVerb*<br/>
Indeks zlecenia kontrolnego, który ma zostać wywołany.

*lpMsg*<br/>
Wskaźnik do komunikatu systemu Windows, który spowodował, że zlecenie do wywołania.

*hWndRodziciek*<br/>
Dojście do okna nadrzędnego formantu. Jeśli wykonanie zlecenia tworzy okno (lub okna), *hWndParent* powinny być używane jako nadrzędny.

*Lprect*<br/>
Wskaźnik do struktury RECT, do której zostaną skopiowane współrzędne formantu względem kontenera.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli połączenie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja używa ON_OLEVERB i ON_STDOLEVERB wpisów mapy komunikatów w celu określenia właściwej funkcji do wywołania.

Zastądź tę funkcję, aby zmienić domyślną obsługę zlecenia.

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControl::OnDraw

Wywoływane przez strukturę do rysowania formantu OLE w określonym prostokąt granicy przy użyciu kontekstu określonego urządzenia.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Kontekst urządzenia, w którym występuje rysunek.

*połączenia z rcBounds*<br/>
Prostokątny obszar kontroli, w tym granicy.

*rcInvalid (Niewąbrązowa*<br/>
Prostokątny obszar formantu, który jest nieprawidłowy.

### <a name="remarks"></a>Uwagi

`OnDraw`jest zazwyczaj wywoływana do wyświetlania ekranu, przekazując kontekst urządzenia ekranowego jako *pDC*. Parametr *rcBounds* identyfikuje prostokąt w kontekście urządzenia docelowego (w stosunku do bieżącego trybu mapowania). Parametr *rcInvalid* jest rzeczywistym prostokątem, który jest nieprawidłowy. W niektórych przypadkach będzie to mniejszy obszar niż *rcBounds*.

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControl::OnDrawMetafile

Wywoływane przez strukturę do rysowania formantu OLE w określonym prostokąt granicy przy użyciu określonego kontekstu urządzenia metapliku.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Kontekst urządzenia, w którym występuje rysunek.

*połączenia z rcBounds*<br/>
Prostokątny obszar kontroli, w tym granicy.

### <a name="remarks"></a>Uwagi

Implementacja domyślna wywołuje [ondraw](#ondraw) funkcji.

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControl::OnEdytuj

Powoduje, że formant jest aktywowany interfejsu użytkownika.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Wskaźnik do komunikatu systemu Windows, który wywołał zlecenie.

*hWndRodziciek*<br/>
Dojście do okna nadrzędnego formantu.

*Lprect*<br/>
Wskaźnik do prostokąta używanego przez formant w kontenerze.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli wywołanie zakończy się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ma to taki sam efekt jak wywoływanie OLEIVERB_UIACTIVATE czasownika formantu.

Ta funkcja jest zwykle używana jako funkcja obsługi dla wpisu mapy ON_OLEVERB komunikatu. Dzięki temu czasownik "Edytuj" jest dostępny w menu "Obiekt" formantu. Przykład:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COleControl::OnEnabledZmienił

Wywoływana przez platformę, gdy wartość właściwości czas Enabled została zmieniona.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Uwagi

Zastądeń tę funkcję, jeśli chcesz powiadomić po zmianie tej właściwości. Domyślna implementacja wywołuje [InvalidateControl](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControl::OnEnumVerbs

Wywoływane przez strukturę, `IOleObject::EnumVerbs` gdy kontener wywołuje funkcję elementu członkowskiego.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parametry

*ppenumOleVerb*<br/>
Wskaźnik do `IEnumOLEVERB` obiektu, który wylicza zlecenia formantu.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli czasowniki są dostępne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja wylicza ON_OLEVERB wpisów na mapie wiadomości.

Zastądź tę funkcję, aby zmienić domyślny sposób wyliczania zleceń.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControl::OnEventAdvise

Wywoływana przez platformę, gdy program obsługi zdarzeń jest połączony lub odłączony od formantu OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parametry

*bAdvise*<br/>
PRAWDA wskazuje, że program obsługi zdarzeń został połączony z formantem. FALSE wskazuje, że program obsługi zdarzeń został odłączony od formantu.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControl::OnFontZmienia

Wywoływana przez strukturę, gdy wartość właściwości font magazynu uległa zmianie.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `COleControl::InvalidateControl`. Jeśli formant jest podklasy formantu systemu Windows, domyślna implementacja wysyła również komunikat WM_SETFONT do okna formantu.

Zastądeń tę funkcję, jeśli chcesz powiadomić po zmianie tej właściwości.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControl::OnForeColorZmienił

Wywoływana przez strukturę, gdy wartość właściwości forecolor magazynu uległa zmianie.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `InvalidateControl`.

Zastądeń tę funkcję, jeśli chcesz powiadomić po zmianie tej właściwości.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControl::OnFreezeEvents

Wywoływana przez strukturę `IOleControl::FreezeEvents`po wywołaniu kontenera .

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parametry

*bZamk.*<br/>
PRAWDA, jeśli obsługa zdarzeń formantu jest zablokowana; w przeciwnym razie FALSE.

### <a name="remarks"></a>Uwagi

Domyślna implementacja nic nie robi.

Zastąp tę funkcję, jeśli chcesz dodatkowe zachowanie, gdy obsługa zdarzeń jest zablokowany lub odblokowany.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControl::OnGetColorSet

Wywoływane przez strukturę, `IViewObject::GetColorSet` gdy kontener wywołuje funkcję elementu członkowskiego.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parametry

*Ptd*<br/>
Wskazuje urządzenie docelowe, dla którego obraz powinien być renderowany. Jeśli ta wartość ma wartość NULL, obraz powinien być renderowany dla domyślnego urządzenia docelowego, zwykle urządzenia wyświetlającego.

*hicTargetDev (hicTargetDev)*<br/>
Określa kontekst informacji na urządzeniu docelowym wskazanym przez *ptd*. Ten parametr może być kontekstem urządzenia, ale nie jest jednym koniecznie. Jeśli *ptd* ma wartość NULL, *hicTargetDev* również powinien mieć wartość NULL.

*zestaw ppColorSet*<br/>
Wskaźnik do lokalizacji, do której należy skopiować zestaw kolorów, które będą używane. Jeśli funkcja nie zwraca zestawu kolorów, zwracana jest wartość NULL.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli zwracany jest prawidłowy zestaw kolorów; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Kontener wywołuje tę funkcję, aby uzyskać wszystkie kolory potrzebne do narysowania formantu OLE. Kontener może używać zestawów kolorów uzyskanych w połączeniu z kolorami, których potrzebuje do skonfigurowania ogólnej palety kolorów. Domyślna implementacja zwraca WARTOŚĆ FAŁSZ.

Zastąd w tej funkcji należy wykonać specjalne przetwarzanie tego żądania.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo

Wywoływana przez platformę, gdy kontener formantu zażądał informacji o formancie.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parametry

*pControlInfo*<br/>
Wskaźnik do struktury [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) do wypełnienia.

### <a name="remarks"></a>Uwagi

Informacje te składają się głównie z opisu kluczy mnemonicznych formantu. Domyślna implementacja wypełnia *pControlInfo* informacjami domyślnymi.

Zastąpuj tę funkcję, jeśli formant musi przetwarzać klucze mnemoniczne.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString

Wywoływane przez strukturę, aby uzyskać ciąg, który reprezentuje bieżącą wartość właściwości identyfikowane przez *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
Identyfikator wysyłki właściwości formantu.

*strValue (wartość)*<br/>
Odwołanie do [CString](../../atl-mfc-shared/reference/cstringt-class.md) obiektu, za pośrednictwem którego zostanie zwrócony ciąg.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli ciąg został zwrócony w *strValue;* w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zastąd w tej funkcji, jeśli formant ma właściwość, której wartość nie może być bezpośrednio konwertowana na ciąg i chcesz, aby wartość właściwości była wyświetlana w przeglądarce właściwości dostarczonych przez kontener.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu

Wywoływane przez platformę, gdy formant jest aktywowany w celu uzyskania menu do scalenia w istniejącym menu kontenera.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Wartość zwracana

Dojście menu formantu lub NULL, jeśli formant nie ma żadnego. Domyślna implementacja zwraca wartość NULL.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji na temat scalania zasobów OLE, zobacz artykuł [Menu i zasoby (OLE)](../../mfc/menus-and-resources-ole.md).

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent

Wywoływane przez strukturę w odpowiedzi `IViewObjectEx::GetNaturalExtent` na żądanie kontenera.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Określa sposób reprezentowania obiektu. Reprezentacje obejmują zawartość, ikonę, miniaturę lub wydrukowany dokument. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2.

*Lindex*<br/>
Część obiektu, która jest przedmiotem zainteresowania. Obecnie tylko -1 jest ważny.

*Ptd*<br/>
Wskazuje strukturę [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) definiującą urządzenie docelowe, dla którego należy zwrócić rozmiar obiektu.

*hicTargetDev (hicTargetDev)*<br/>
Określa kontekst informacji dla urządzenia docelowego wskazanego przez parametr *ptd,* z którego obiekt może wyodrębnić metryki urządzenia i przetestować możliwości urządzenia. Jeśli *ptd* ma wartość NULL, obiekt powinien zignorować wartość w *parametrze hicTargetDev.*

*pExtentInfo*<br/>
Wskazuje strukturę, `DVEXTENTINFO` która określa dane rozmiaru. Struktura `DVEXTENTINFO` jest:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Element członkowski `dwExtentMode` struktury może przyjąć jedną z dwóch wartości:

- DVEXTENT_CONTENT Zapytaj, jak duża powinna być kontrola, aby dokładnie dopasować zawartość (snap-to-size)

- DVEXTENT_INTEGRAL Podczas zmiany rozmiaru, przekaż proponowany rozmiar do kontroli

*psizel (psizel)*<br/>
Wskazuje na dane rozmiaru zwracane przez formant. Zwrócone dane rozmiaru jest ustawiona na -1 dla dowolnego wymiaru, który nie został dostosowany.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli pomyślnie zwraca lub dostosowuje rozmiar; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zastąd zniszcz tę funkcję, aby przywrócić rozmiar wyświetlania obiektu najbliżej `DVEXTENTINFO` proponowanego trybu rozmiaru i zasięgu w strukturze. Domyślna implementacja zwraca FALSE i nie wprowadza żadnych korekt do rozmiaru.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings

Wywoływane przez strukturę, aby uzyskać zestaw wstępnie zdefiniowanych ciągów reprezentujących możliwe wartości dla właściwości.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
Identyfikator wysyłki właściwości formantu.

*pStringArray (Właz)*<br/>
Tablica ciągów, która ma być wypełniona wartościami zwracanym.

*pCookieArray (pCookieArray)*<br/>
Tablica DWORD, która ma być wypełniona wartościami zwracanym.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli elementy zostały dodane do *pStringArray* i *pCookieArray*.

### <a name="remarks"></a>Uwagi

Zastądnie tej funkcji, jeśli formant ma właściwość z zestawem możliwych wartości, które mogą być reprezentowane przez ciągi. Dla każdego elementu dodanego do *pStringArray*należy dodać odpowiedni element "cookie" do *pCookieArray.* Te wartości "cookie" mogą być później `COleControl::OnGetPredefinedValue` przekazywane przez ramy do funkcji.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue

Wywoływane przez strukturę, aby uzyskać wartość odpowiadającą jednemu ze wstępnie zdefiniowanych `COleControl::OnGetPredefinedStrings`ciągów wcześniej zwróconych przez zastąpienie .

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
Identyfikator wysyłki właściwości formantu.

*dwCookie (właśc.*<br/>
Wartość pliku cookie zwrócona wcześniej przez `COleControl::OnGetPredefinedStrings`zastąpienie .

*lpvarOut (lpvarOut)*<br/>
Wskaźnik do `VARIANT` struktury, za pomocą której zostanie zwrócona wartość właściwości.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli wartość została zwrócona w *lpvarOut*; w przeciwnym razie 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControl::OnGetViewExtent

Wywoływane przez platformę w odpowiedzi na żądanie [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) kontenera.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parametry

*dwDrawAspect*<br/>
DWORD opisujący formę lub aspekt obiektu ma być wyświetlany. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2.

*Lindex*<br/>
Część obiektu, która jest przedmiotem zainteresowania. Obecnie tylko -1 jest ważny.

*Ptd*<br/>
Wskazuje strukturę [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) definiującą urządzenie docelowe, dla którego należy zwrócić rozmiar obiektu.

*lpsizel*<br/>
Wskazuje lokalizację, w której zwracany jest rozmiar obiektu.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli informacje o zakresie jest pomyślnie zwracany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zastąpokaj tę funkcję, jeśli formant używa rysunku dwuprzebiegowego, a jego części nieprzezroczyste i przezroczyste mają różne wymiary.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControl::OnGetViewRect

Wywoływane przez strukturę w odpowiedzi `IViewObjectEx::GetRect` na żądanie kontenera.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
DWORD opisujący formę lub aspekt obiektu ma być wyświetlany. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2:

- DVASPECT_CONTENT Prostokąt ograniczający całego obiektu. Lewy górny róg w miejscu pochodzenia i rozmiaru `GetViewExtent`obiektu równy zakresowi zwracany przez *program .*

- DVASPECT_OPAQUE obiekty z prostokątnym nieprzezroczystym regionem zwracają ten prostokąt. Inni zawodzą.

- DVASPECT_TRANSPARENT Prostokąt obejmujący wszystkie przezroczyste lub nieregularne części.

*pRect*<br/>
Wskazuje strukturę [RECTL](/previous-versions/dd162907\(v=vs.85\)) określającą prostokąt, w którym obiekt powinien zostać narysowany. Ten parametr steruje pozycjonowaniem i rozciąganiem obiektu.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli prostokąt o rozmiarze do obiektu jest pomyślnie zwracany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Rozmiar obiektu jest konwertowany przez `OnGetViewRect` prostokąt rozpoczynający się w określonej pozycji (domyślnie jest to lewy górny róg wyświetlacza). Zastąpokaj tę funkcję, jeśli formant używa rysunku dwuprzebiegowego, a jego części nieprzezroczyste i przezroczyste mają różne wymiary.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControl::OnGetViewStatus

Wywoływane przez strukturę w odpowiedzi `IViewObjectEx::GetViewStatus` na żądanie kontenera.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Wartość zwracana

Jedną z wartości wyliczenia VIEWSTATUS, jeśli zakończy się pomyślnie; w przeciwnym razie 0. Możliwe wartości to dowolna kombinacja następujących wartości:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Obiekt jest całkowicie nieprzezroczysty. Jeśli ten bit nie jest ustawiony, obiekt zawiera części przezroczyste. Ten bit dotyczy tylko aspektów związanych z zawartością, a nie DVASPECT_ICON lub DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Obiekt ma stałe tło (składające się z jednolitego koloru, a nie wzoru pędzla). Ten bit ma znaczenie tylko wtedy, gdy jest ustawiona VIEWSTATUS_OPAQUE i ma zastosowanie tylko do aspektów związanych z zawartością, a nie do DVASPECT_ICON lub DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Obiekt obsługuje DVASPECT_OPAQUE. Wszystkie metody IViewObjectEx, które przyjmują aspekt rysunku jako parametr, można wywołać z tym aspektem.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Obiekt obsługuje DVASPECT_TRANSPARENT. Wszystkie `IViewObjectEx` metody, które przyjmują aspekt rysunku jako parametr, można wywołać w tym aspekcie.|

### <a name="remarks"></a>Uwagi

Zastądnie tej funkcji, jeśli formant używa rysunku dwuprzebiegowego. Domyślna implementacja zwraca VIEWSTATUS_OPAQUE.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COleControl::OnHideToolBars

Wywoływane przez platformę, gdy formant jest dezaktywowany interfejsu użytkownika.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Uwagi

Implementacja powinna ukryć wszystkie paski `OnShowToolbars`narzędzi wyświetlane przez program .

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove

Wywoływany przez kontener dla nieaktywnego obiektu pod wskaźnikiem myszy po otrzymaniu komunikatu WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parametry

*lprcBounds (Obfity)*<br/>
Prostokąt ograniczający obiekt we współrzędnych klienta okna zawierającego. Informuje obiekt o jego dokładnej pozycji i rozmiarze na ekranie po odebraniu WM_MOUSEMOVE wiadomości.

*X*<br/>
Współrzędna x lokalizacji myszy we współrzędnych klienta okna zawierającego.

*Y*<br/>
Współrzędna y położenia myszy we współrzędnych klienta okna zawierającego.

*dwKeyState (Stan klucza)*<br/>
Identyfikuje bieżący stan klawiszy modyfikatora klawiatury na klawiaturze. Prawidłowe wartości mogą być kombinacją dowolnej flagi MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON i MK_RBUTTON.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że współrzędne klienta okna (piksele) są używane do przekazywania pozycji kursora myszy. Jest to możliwe dzięki przekazaniu prostokąta ograniczającego obiektu w tym samym układzie współrzędnych.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor

Wywoływany przez kontener dla nieaktywnego obiektu pod wskaźnikiem myszy po otrzymaniu komunikatu WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parametry

*lprcBounds (Obfity)*<br/>
Prostokąt ograniczający obiekt we współrzędnych klienta okna zawierającego. Informuje obiekt o jego dokładnej pozycji i rozmiarze na ekranie po odebraniu WM_SETCURSOR wiadomości.

*X*<br/>
Współrzędna x lokalizacji myszy we współrzędnych klienta okna zawierającego.

*Y*<br/>
Współrzędna y położenia myszy we współrzędnych klienta okna zawierającego.

*dwMouseMsg*<br/>
Identyfikator komunikatu myszy, dla którego wystąpił WM_SETCURSOR.

*bSetPokazywnie*<br/>
Określa, czy obiekt musi ustawić kursor. Jeśli true, obiekt musi ustawić kursor; jeśli FALSE, kursor nie jest zobowiązany do ustawiania kursora i powinien zwrócić S_FALSE w takim przypadku.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że współrzędne klienta okna (piksele) są używane do przekazywania pozycji kursora myszy. Jest to możliwe dzięki przekazaniu prostokąta ograniczającego obiektu w tym samym układzie współrzędnych.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControl::OnKeyDownEvent

Wywoływane przez platformę po przetworzyniu zdarzenia KeyDown.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*Nchar*<br/>
Wartość kodu klucza wirtualnego wciśniętego klawisza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser.h

*nShiftState (Stan zmiany biegów)*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK Klawisz SHIFT został wciśnięty podczas akcji.

- CTRL_MASK Klawisz CTRL został wciśnięty podczas akcji.

- ALT_MASK Klawisz ALT został wciśnięty podczas akcji.

### <a name="remarks"></a>Uwagi

Zastąpuj tę funkcję, jeśli formant potrzebuje dostępu do informacji o kluczu po zwolnieniu zdarzenia.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControl::OnKeyPressEvent

Wywoływane przez ramy po zdarzenia KeyPress czas został zwolniony.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parametry

*Nchar*<br/>
Zawiera wartość kodu klucza wirtualnego naciśnięcia klawisza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser.h

### <a name="remarks"></a>Uwagi

Należy zauważyć, że wartość *nChar* mogła zostać zmodyfikowana przez kontener.

Zastądń tej funkcji, jeśli chcesz powiadomić po wystąpieniu tego zdarzenia.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControl::OnKeyUpEvent

Wywoływane przez platformę po przetworzyniu zdarzenia KeyDown.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*Nchar*<br/>
Wartość kodu klucza wirtualnego wciśniętego klawisza. Aby uzyskać listę standardowych kodów kluczy wirtualnych, zobacz Winuser.h

*nShiftState (Stan zmiany biegów)*<br/>
Zawiera kombinację następujących flag:

- SHIFT_MASK Klawisz SHIFT został wciśnięty podczas akcji.

- CTRL_MASK Klawisz CTRL został wciśnięty podczas akcji.

- ALT_MASK Klawisz ALT został wciśnięty podczas akcji.

### <a name="remarks"></a>Uwagi

Zastąpuj tę funkcję, jeśli formant potrzebuje dostępu do informacji o kluczu po zwolnieniu zdarzenia.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage

Wywoływane przez strukturę, aby uzyskać identyfikator klasy strony właściwości, która implementuje edycję określonej właściwości.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parametry

*Dispid*<br/>
Identyfikator wysyłki właściwości formantu.

*lpclsid ( lpclsid )*<br/>
Wskaźnik do `CLSID` struktury, za pośrednictwem której zostanie zwrócony identyfikator klasy.

*pbPageOprzekładnia*<br/>
Zwraca wskaźnik, czy użycie strony określonej właściwości jest opcjonalne.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli identyfikator klasy został zwrócony w *lpclsid;* w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zastąd w tej funkcji, aby zapewnić sposób wywołania stron właściwości formantu z przeglądarki właściwości kontenera.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControl::OnMnemonic

Wywoływana przez strukturę, gdy kontener wykrył, że klucz mnemonic formantu OLE został naciśnięty.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parametry

*pMsg*<br/>
Wskaźnik do komunikatu systemu Windows generowanego przez naciśnięcie klawisza mnemonicznego.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COleControl::OnProperties

Wywoływana przez strukturę, gdy zlecenie właściwości formantu zostało wywołane przez kontener.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Wskaźnik do komunikatu systemu Windows, który wywołał zlecenie.

*hWndRodziciek*<br/>
Dojście do okna nadrzędnego formantu.

*Lprect*<br/>
Wskaźnik do prostokąta używanego przez formant w kontenerze.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli wywołanie zakończy się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja wyświetla okno dialogowe właściwości modalnej.

Za pomocą tej funkcji można również spowodować wyświetlanie stron właściwości formantu. Nawiązać wywołanie `OnProperties` funkcji, przekazując dojście nadrzędnego formantu w *hWndParent* parametru. W takim przypadku wartości parametrów *lpMsg* i *lpRect* są ignorowane.

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint

Wywoływane przez strukturę w odpowiedzi `IViewObjectEx::QueryHitPoint` na żądanie kontenera.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Określa sposób reprezentowania obiektu. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2.

*pRectBounds (Połączenia między obejmą pRect*<br/>
Wskaźnik do `RECT` struktury określającej prostokąt ograniczający obszaru klienta sterowania OLE.

*ptlLoc (polski)*<br/>
Wskaźnik do `POINT` struktury określający punkt, który ma być sprawdzany pod kątem trafienia. Punkt jest określony we współrzędnych obszaru klienta OLE.

*lCloseHint*<br/>
Odległość definiuj "blisko" do punktu zaznaczona pod kątem trafienia.

*pHitResult (Wyniki)*<br/>
Wskaźnik do wyniku kwerendy trafienia. Jedna z następujących wartości:

- HITRESULT_OUTSIDE *ptlLoc* znajduje się poza obiektem OLE i nie jest zamykany.

- HITRESULT_TRANSPARENT *ptlLoc* znajduje się w granicach obiektu OLE, ale nie znajduje się blisko obrazu. Na przykład punkt w środku przezroczystego okręgu może zostać HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* znajduje się wewnątrz lub na zewnątrz obiektu OLE, ale wystarczająco blisko obiektu, który ma być brany pod uwagę wewnątrz. Ta wartość może być używana przez małe, cienkie lub szczegółowe obiekty. Nawet jeśli punkt znajduje się poza prostokątem ograniczającym obiektu, może on nadal znajdować się blisko (jest to potrzebne do trafienia małych obiektów).

- HITRESULT_HIT *ptlLoc* znajduje się w obrazie obiektu.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli wynik trafienia zostanie pomyślnie zwrócony; w przeciwnym razie 0. Trafienie jest nakładaniem się obszaru wyświetlania sterowania OLE.

### <a name="remarks"></a>Uwagi

Pyta, czy prostokąt wyświetlania obiektu nakłada się na dany punkt (trafia do punktu). `QueryHitPoint`można zastąpić, aby przetestować trafienia dla obiektów niekościanych.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControl::OnQueryHitRect

Wywoływane przez strukturę w odpowiedzi `IViewObjectEx::QueryHitRect` na żądanie kontenera.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Określa sposób reprezentowania obiektu. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) lub DVASPECT2.

*pRectBounds (Połączenia między obejmą pRect*<br/>
Wskaźnik do `RECT` struktury określającej prostokąt ograniczający obszaru klienta sterowania OLE.

*chcLoc*<br/>
Wskaźnik do `RECT` struktury określający prostokąt, który ma być sprawdzany pod kątem trafienia (nakładania się na prostokąt obiektu), względem lewego górnego rogu obiektu.

*lCloseHint*<br/>
Nie używany.

*pHitResult (Wyniki)*<br/>
Wskaźnik do wyniku kwerendy trafienia. Jedna z następujących wartości:

- HITRESULT_OUTSIDE żaden punkt w prostokącie nie jest trafiony przez obiekt OLE.

- HITRESULT_HIT co najmniej jeden punkt w prostokącie będzie trafieniem na obiekt.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli wynik trafienia zostanie pomyślnie zwrócony; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Kwerenda, czy prostokąt wyświetlania obiektu nakłada się na dowolny punkt w danym prostokącie (uderza w prostokąt). `QueryHitRect`można zastąpić, aby przetestować trafienia dla obiektów niekościanych.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COleControl::OnRenderData

Wywoływane przez strukturę do pobierania danych w określonym formacie.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskazuje strukturę [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) określającą format, w którym wymagane są informacje.

*lpStgMedium*<br/>
Wskazuje strukturę [STGMEDIUM,](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) w której dane mają być zwracane.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Określony format to jeden wcześniej umieszczony w obiekcie sterującym przy użyciu funkcji członkowskich [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) lub [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) dla opóźnionego renderowania. Domyślna implementacja tej `OnRenderFileData` `OnRenderGlobalData`funkcji wywołuje lub , odpowiednio, jeśli dostarczonym nośnikiem pamięci jest plik lub pamięć. Jeśli żądany format jest CF_METAFILEPICT lub format zestawu właściwości trwałych, domyślna implementacja renderuje odpowiednie dane i zwraca wartość niezerowa. W przeciwnym razie zwraca 0 i nic nie robi.

Jeśli TYMED_NULL jest TYMED_NULL *lpStgMedium->,* STGMEDIUM powinno być przydzielane i wypełniane zgodnie z *lpFormatEtc->tymed*. Jeśli nie TYMED_NULL, STGMEDIUM należy wypełnić danymi.

Zastąp tę funkcję, aby podać dane w żądanym formacie i nośniku. W zależności od danych można zastąpić jedną z innych wersji tej funkcji. Jeśli dane są małe i stałe, `OnRenderGlobalData`należy zastąpić . Jeśli dane są w pliku lub mają zmienny `OnRenderFileData`rozmiar, należy zastąpić .

Aby uzyskać więcej `FORMATETC` informacji, zobacz i `STGMEDIUM` struktur w windows SDK.

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COleControl::OnRenderFileData

Wywoływane przez strukturę do pobierania danych w określonym formacie, gdy nośnikiem jest plik.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskazuje strukturę [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) określającą format, w którym wymagane są informacje.

*p Plik*<br/>
Wskazuje obiekt [CFile,](../../mfc/reference/cfile-class.md) w którym mają być renderowane dane.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Określony format to jeden wcześniej umieszczony w obiekcie sterującym przy użyciu funkcji elementu członkowskiego [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) do opóźnionego renderowania. Domyślna implementacja tej funkcji po prostu zwraca FALSE.

Zastąp tę funkcję, aby podać dane w żądanym formacie i nośniku. W zależności od danych można zastąpić jedną z innych wersji tej funkcji. Jeśli chcesz obsłużyć wiele nośników pamięci masowej, należy zastąpić `OnRenderData`. Jeśli dane są w pliku lub mają zmienny `OnRenderFileData`rozmiar, należy zastąpić .

Aby uzyskać więcej `FORMATETC` informacji, zobacz strukturę w windows SDK.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData

Wywoływana przez strukturę do pobierania danych w określonym formacie, gdy określonym nośnikiem pamięci jest pamięć globalna.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskazuje strukturę [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) określającą format, w którym wymagane są informacje.

*phGlobal (własówce)*<br/>
Wskazuje dojście do pamięci globalnej, w której mają być zwracane dane. Jeśli nie przydzielono pamięci, ten parametr może mieć wartość NULL.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Określony format to jeden wcześniej umieszczony w obiekcie sterującym przy użyciu funkcji elementu członkowskiego [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) do opóźnionego renderowania. Domyślna implementacja tej funkcji po prostu zwraca FALSE.

Jeśli *phGlobal* ma wartość NULL, nowy HGLOBAL powinien zostać przydzielony i zwrócony w *phGlobal*. W przeciwnym razie HGLOBAL określony przez *phGlobal* powinien być wypełniony danymi. Ilość danych umieszczonych w HGLOBAL nie może przekraczać bieżącego rozmiaru bloku pamięci. Ponadto bloku nie można ponownie przydzielić do większego rozmiaru.

Zastąp tę funkcję, aby podać dane w żądanym formacie i nośniku. W zależności od danych można zastąpić jedną z innych wersji tej funkcji. Jeśli chcesz obsłużyć wiele nośników pamięci masowej, należy zastąpić `OnRenderData`. Jeśli dane są w pliku lub mają zmienny `OnRenderFileData`rozmiar, należy zastąpić .

Aby uzyskać więcej `FORMATETC` informacji, zobacz strukturę w windows SDK.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COleControl::OnResetState

Wywoływane przez platformę, gdy właściwości formantu powinny być ustawione na ich wartości domyślne.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje [DoPropExchange](#dopropexchange), przekazując `CPropExchange` obiekt, który powoduje, że właściwości mają być ustawione na ich wartości domyślne.

Moduł zapisujący formant można wstawić kod inicjowania dla formantu OLE w tym zastąpić. Ta funkcja jest wywoływana, gdy [wywołano IPersistStream::Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) lub [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) fails, or [IPersistStreamInit::InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) or [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) is called, without first calling either `IPersistStream::Load` or `IPersistStorage::Load`.

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControl::OnSetClientSite

Wywoływana przez strukturę, gdy kontener `IOleControl::SetClientSite` wywołał funkcję formantu.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Uwagi

Domyślnie `OnSetClientSite` sprawdza, czy właściwości ścieżki danych są ładowane, a jeśli tak, wywołają `DoDataPathPropExchange`.

Zastądeń tę funkcję, aby wykonać specjalne przetwarzanie tego powiadomienia. W szczególności overrides tej funkcji należy wywołać klasę podstawową.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControl::OnSetData

Wywoływana przez strukturę, aby zastąpić dane formantu określonymi danymi.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) określającej format danych.

*lpStgMedium*<br/>
Wskaźnik do struktury [STGMEDIUM,](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) w której znajdują się dane.

*Brelease*<br/>
PRAWDA, jeśli urządzenie sterujące powinno zwolnić nośnik pamięci masowej; FALSE, jeśli formant nie powinien zwolnić nośnika.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli dane są w formacie zestawu właściwości trwałych, domyślna implementacja modyfikuje stan formantu odpowiednio. W przeciwnym razie domyślna implementacja nic nie robi. Jeśli *bWyzjąć* wartość TRUE, nawiązuje się `ReleaseStgMedium` wywołanie; w przeciwnym razie nie.

Zastąp tę funkcję, aby zastąpić dane formantu określonymi danymi.

Aby uzyskać więcej `FORMATETC` informacji, zobacz i `STGMEDIUM` struktur w windows SDK.

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COleControl::OnSetExtent

Wywoływana przez strukturę, gdy zakres formantu musi zostać zmieniony, w wyniku wywołania [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parametry

*lpSizeL ( lpSizeL )*<br/>
Wskaźnik do `SIZEL` struktury, która używa długich liczby całkowite do reprezentowania szerokości i wysokości formantu, wyrażone w jednostkach HIMETRIC.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli zmiana rozmiaru została zaakceptowana; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja obsługuje zmiany rozmiaru zakresu formantu. Jeśli formant jest aktywny w miejscu, następnie `OnPosRectChanged` następuje wywołanie kontenera.

Zastąd w tej funkcji należy zmienić domyślną zmianę rozmiaru formantu.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COleControl::OnSetObjectRects

Wywoływane przez strukturę do zaimplementowania wywołania [IOleInPlaCeObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parametry

*lpRectPos*<br/>
Wskaźnik do `RECT` struktury wskazujący nowe położenie i rozmiar formantu względem kontenera.

*lpRectClip (lpRectClip)*<br/>
Wskaźnik do `RECT` struktury wskazujący prostokątny obszar, do którego ma być przycięty formant.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli zmiana położenia została przyjęta; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja automatycznie obsługuje zmianę położenia i zmiany rozmiaru okna formantu i zwraca wartość TRUE.

Zastądnie tej funkcji, aby zmienić domyślne zachowanie tej funkcji.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControl::OnShowToolBars

Wywoływane przez platformę, gdy formant został aktywowany interfejsu użytkownika.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja nic nie robi.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COleControl::OnTextZanged

Wywoływana przez strukturę, gdy zmieniła się wartość właściwości podpis lub tekst.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `InvalidateControl`.

Zastądeń tę funkcję, jeśli chcesz powiadomić po zmianie tej właściwości.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage

Wywoływane przez strukturę w odpowiedzi `IOleInPlaceObjectWindowless::OnWindowMessage` na żądanie kontenera.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parametry

*Msg*<br/>
Identyfikator wiadomości przekazany przez system Windows.

*Wparam*<br/>
Jak przeszedł przez System Windows. Określa dodatkowe informacje specyficzne dla wiadomości. Zawartość tego parametru zależy od wartości parametru *msg.*

*Lparam*<br/>
Jak przeszedł przez System Windows. Określa dodatkowe informacje specyficzne dla wiadomości. Zawartość tego parametru zależy od wartości parametru *msg.*

*plResult (wyniki)*<br/>
Kod wyniku systemu Windows. Określa wynik przetwarzania wiadomości i zależy od wysłanej wiadomości.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Przetwarza komunikaty okien dla formantów bez okien. `COleControl`'s `OnWindowlessMessage` powinny być używane do wiadomości okien innych niż komunikaty myszy i komunikaty klawiaturowe. `COleControl`zapewnia [SetCapture](#setcapture) i [SetFocus](#setfocus) specjalnie, aby uzyskać przechwytywanie myszy i fokus klawiatury dla obiektów OLE bez okien.

Ponieważ obiekty bez okien nie mają okna, potrzebują mechanizmu, aby umożliwić wysyłanie wiadomości do nich. Obiekt OLE bez okien pobiera komunikaty `OnWindowMessage` z kontenera, za pomocą metody w `IOleInPlaceObjectWindowless` interfejsie (rozszerzenie [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) dla obsługi bez okien). `OnWindowMessage`nie przyjmuje `HWND` parametru.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControl::ParentToClient

Tłumaczy współrzędne *punktu pPoint* na współrzędne klienta.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds (Obfity)*<br/>
Wskaźnik do granic formantu OLE w kontenerze. Nie obszar klienta, ale obszar całego formantu, w tym obramowania i paski przewijania.

*pPunkt*<br/>
Wskaźnik do punktu nadrzędnego (kontenera) do przetłumaczenia na współrzędne obszaru klienta formantu.

*bHitTest (Testhittest)*<br/>
Określa, czy testowanie trafień ma być wykonywane w punkcie.

### <a name="return-value"></a>Wartość zwracana

Jeśli *bHitTest* jest FALSE, zwraca HTNOWHERE. Jeśli *bHitTest* ma wartość PRAWDA, zwraca lokalizację, w której punkt nadrzędny (kontener) wylądował w obszarze klienta formantu OLE i jest jedną z następujących wartości testu trafień myszy:

- HTBORDER W obramowaniu okna, które nie ma obramowania rozmiaru.

- HTBOTTOM W dolnej granicy poziomej okna.

- HTBOTTOMLEFT W lewym dolnym rogu obramowania okna.

- HTBOTTOMRIGHT W prawym dolnym rogu obramowania okna.

- HTCAPTION W obszarze paska tytułu.

- HTCLIENT W obszarze klienta.

- HTERROR Na tle ekranu lub na linii podziału między oknami (tak `DefWndProc` samo jak HTNOWHERE z tą różnicą, że funkcja Windows generuje sygnał dźwiękowy systemu wskazujący błąd).

- HTGROWBOX W pudełku z rozmiarem.

- HTHSCROLL Na poziomym pasku przewijania.

- HTLEFT W lewej krawędzi okna.

- HTMAXBUTTON W przycisku Maksymalizacji.

- HTMENU W obszarze menu.

- HTMINBUTTON W przycisku Minimalizuj.

- HTNOWHERE Na tle ekranu lub na linii podziału między oknami.

- HTREDUCE W przycisku Minimalizuj.

- HTRIGHT W prawej krawędzi okna.

- HTSIZE W polu rozmiaru (tak samo jak HTGROWBOX).

- HTSYSMENU W menu Sterowania lub w przycisku Zamknij w oknie podrzędnym.

- HTTOP W górnej granicy poziomej okna.

- HTTOPLEFT W lewym górnym rogu obramowania okna.

- HTTOPRIGHT W prawym górnym rogu obramowania okna.

- HTTRANSPARENT W oknie obecnie objętym innym oknem.

- HTVSCROLL Na pionowym pasku przewijania.

- HTZOOM W przycisku Maksymalizacji.

### <a name="remarks"></a>Uwagi

Na wejściu *pPoint* jest względem początku macierzystego (lewy górny róg kontenera). Na *wyjściu pPoint* jest względem początku obszaru klienta formantu OLE (lewy górny róg obszaru klienta formantu).

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControl::PostModalDialog

Powiadamia kontener, że modalne okno dialogowe zostało zamknięte.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndRodziciek*<br/>
Uchwyt do okna nadrzędnego modalnego okna dialogowego.

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji po wyświetleniu dowolnego modalnego okna dialogowego. Należy wywołać tę funkcję, aby kontener mógł włączyć `PreModalDialog`wszystkie okna najwyższego poziomu wyłączone przez program . Tę funkcję należy sparować z `PreModalDialog`wywołaniem .

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControl::PreModalDialog

Powiadamia kontener, że modalne okno dialogowe ma być wyświetlane.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndRodziciek*<br/>
Uchwyt do okna nadrzędnego modalnego okna dialogowego.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję przed wyświetleniem dowolnego modalnego okna dialogowego. Należy wywołać tę funkcję, aby kontener mógł wyłączyć wszystkie jego okna najwyższego poziomu. Po wyświetleniu modalnego okna dialogowego należy `PostModalDialog`wywołać program .

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COleControl::Odtwórz KontrolerWindow

Niszczy i ponownie tworzy okno formantu.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Uwagi

Może to być konieczne, jeśli trzeba zmienić bity stylu okna.

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COleControl::Odśwież

Wymusza odświeżanie formantu OLE.

```
void Refresh();
```

### <a name="remarks"></a>Uwagi

Ta funkcja jest obsługiwana przez klasę podstawową `COleControl` jako metodę zapasową o nazwie Refresh. Dzięki temu użytkownicy formantu OLE do ponownego przemalowania formantu w określonym czasie. Aby uzyskać więcej informacji na temat tej metody, zobacz artykuł [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COleControl::ReleaseCapture

Zwalnia przechwytywanie myszy.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli formant ma obecnie przechwytywania myszy, przechwytywania jest zwolniony. W przeciwnym razie ta funkcja nie ma wpływu.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COleControl::ReleaseDC

Zwalnia kontekst urządzenia wyświetlania kontenera formantu bez okien, zwalniając kontekst urządzenia do użycia przez inne aplikacje.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Identyfikuje kontekst urządzenia kontenera, który ma zostać zwolniony.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aplikacja musi `ReleaseDC` wywołać dla każdego wywołania [GetDC](#getdc).

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow

Ustawia element nadrzędny formantu.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parametry

*hWndOuter (właśc.*<br/>
Uchwyt okna sterującego.

*hWndRodziciek*<br/>
Dojście nowego okna nadrzędnego.

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji, aby zresetować element nadrzędny okna sterowania.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COleControl::ResetStockProps

Inicjuje stan `COleControl` właściwości magazynowych do ich wartości domyślnych.

```
void ResetStockProps();
```

### <a name="remarks"></a>Uwagi

Właściwości to: Wygląd, Kolor wsteczny, BorderStyle, Podpis, Włączone, Czcionka, ForeColor, hWnd i Tekst. Aby uzyskać opis właściwości magazynowych, zobacz [Formanty ActiveX: Dodawanie właściwości zapasów](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Można poprawić wydajność inicjowania binarnego `ResetVersion` formantu `COleControl::OnResetState`za pomocą `ResetStockProps` i zastąpić . Zobacz przykład poniżej. Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COleControl::ResetVersion

Inicjuje numer wersji do określonej wartości.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parametry

*dwVersionDefault (Niem.*<br/>
Numer wersji, który ma zostać przypisany do formantu.

### <a name="remarks"></a>Uwagi

Można poprawić wydajność inicjowania binarnego `ResetStockProps` formantu `COleControl::OnResetState`za pomocą `ResetVersion` i zastąpić . Zobacz przykład w [ResetStockProps](#resetstockprops). Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COleControl::ScrollWindow

Umożliwia obiektowi OLE bez okien przewijanie obszaru w jego aktywnym obrazie w miejscu na ekranie.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*xMount (montaż)*<br/>
Określa ilość przewijania w poziomie w jednostkach urządzenia. Ten parametr musi być wartością ujemną, aby przewinąć w lewo.

*yMount (montaż)*<br/>
Określa ilość przewijania w pionie w jednostkach urządzenia. Ten parametr musi być wartością ujemną, aby przewinąć w górę.

*Lprect*<br/>
Wskazuje obiekt [CRect](../../atl-mfc-shared/reference/crect-class.md) lub strukturę RECT, która określa część obszaru klienta obiektu OLE do przewijania we współrzędnych klienta okna zawierającego. Jeśli *lpRect* ma wartość NULL, cały obszar klienta obiektu OLE jest przewijany.

*lpClipRect*<br/>
Wskazuje obiekt `CRect` lub `RECT` strukturę określającą prostokąt, do który chcesz przyciąć. Przewijane są tylko piksele wewnątrz prostokąta. Bity poza prostokątem nie są zagrożone, nawet jeśli znajdują się w *lpRect* prostokąta. Jeśli *lpClipRect* ma wartość NULL, na prostokącie przewijania nie jest wykonywane żadne przycinanie.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COleControl::SelectFontObject

Wybiera czcionkę w kontekście urządzenia.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Wskaźnik do obiektu kontekstu urządzenia.

*fontHolder*<br/>
Odwołanie do obiektu [CFontHolder](../../mfc/reference/cfontholder-class.md) reprezentującego czcionkę, która ma zostać wybrana.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do poprzednio wybranej czcionki. Po zakończeniu wszystkich operacji rysowania, które używają *fontHolder,* należy ponownie zaznaczyć poprzednio wybraną czcionkę, przekazując ją jako parametr do [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControl::SelectStockFont

Wybiera właściwość czcionka giełdowa w kontekście urządzenia.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Kontekst urządzenia, do którego zostanie wybrana czcionka.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do poprzednio `CFont` zaznaczonego obiektu. Należy użyć [CDC::SelectObject,](../../mfc/reference/cdc-class.md#selectobject) aby wybrać tę czcionkę z powrotem w kontekście urządzenia po zakończeniu.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COleControl::SerializeExtent

Serializuje lub inicjuje stan przestrzeni wyświetlania przydzielonej formancie.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*Ar*<br/>
Obiekt `CArchive` do serializacji do lub z.

### <a name="remarks"></a>Uwagi

Można poprawić wydajność trwałości binarnej `SerializeExtent`formantu `SerializeVersion` za pomocą `COleControl::Serialize`programu , `SerializeStockProps`i zastąpić . Zobacz przykład poniżej. Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COleControl::SerializeStockProps

Serializuje lub inicjuje stan `COleControl` właściwości zapasów: Wygląd, Kolor wsteczny, BorderStyle, Podpis, Włączone, Czcionka, ForeColor i Tekst.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*Ar*<br/>
Obiekt `CArchive` do serializacji do lub z.

### <a name="remarks"></a>Uwagi

Aby uzyskać opis właściwości magazynowych, zobacz [Formanty ActiveX: Dodawanie właściwości zapasów](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Można poprawić wydajność trwałości binarnej `SerializeStockProps`formantu `SerializeVersion` za pomocą `COleControl::Serialize`programu , `SerializeExtent`i zastąpić . Na przykład zobacz kod w [SerializeExtent](#serializeextent). Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COleControl::SerializeVersion

Serializuje lub inicjuje stan informacji o wersji formantu.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*Ar*<br/>
Obiekt `CArchive` do serializacji do lub z.

*dwVersionDefault (Niem.*<br/>
Bieżący numer wersji formantu.

*bKonwertowanie*<br/>
Wskazuje, czy dane trwałe powinny być konwertowane na najnowszy format podczas zapisywania lub utrzymywane w tym samym formacie, który miał podczas ładowania.

### <a name="return-value"></a>Wartość zwracana

Numer wersji formantu. Jeśli określone archiwum `SerializeVersion` jest ładowanie, zwraca wersję załadowaną z tego archiwum. W przeciwnym razie zwraca aktualnie załadowaną wersję.

### <a name="remarks"></a>Uwagi

Można poprawić wydajność trwałości binarnej `SerializeVersion`formantu `SerializeStockProps` za pomocą `COleControl::Serialize`programu , `SerializeExtent`i zastąpić . Na przykład zobacz kod w [SerializeExtent](#serializeextent). Aby uzyskać więcej informacji na temat optymalizacji inicjowania, zobacz [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COleControl::SetAppearance

Ustawia wartość właściwości wygląd czas formantu.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parametry

*sPojasznik*<br/>
**Krótka** (VT_I2) wartość używana do wyglądu formantu. Wartość zero ustawia wygląd formantu na płaski, a wartość 1 ustawia wygląd formantu na 3D.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji o właściwościach magazynowych, zobacz [Formanty ActiveX: Właściwości](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COleControl::SetBackColor

Ustawia wartość właściwości backcolor zapasów formantu.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parametry

*dwBackColor (Kolor)*<br/>
Wartość OLE_COLOR, która ma być używana do rysowania w tle formantu.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji na temat korzystania z tej właściwości i innych powiązanych właściwości, zobacz artykuł [ActiveX Controls: Właściwości](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COleControl::SetBorderStyle

Ustawia wartość właściwości BorderStyle zapasów formantu.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parametry

*sBorderStyle (Styl sBorderStyle)*<br/>
Nowy styl obramowania dla kontroli; 0 oznacza brak obramowania, a 1 oznacza normalną granicę.

### <a name="remarks"></a>Uwagi

Okno formantu zostanie ponownie `OnBorderStyleChanged` utworzone i wywołane.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COleControl::SetCapture

Powoduje, że okno kontenera formantu przejąć w posiadanie przechwytywania myszy w imieniu formantu.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do `CWnd` obiektu okna, który wcześniej odebrał dane wejściowe myszy.

### <a name="remarks"></a>Uwagi

Jeśli formant jest aktywowany i bez okien, ta funkcja powoduje, że okno kontenera formantu do przejęcia w posiadanie przechwytywania myszy, w imieniu formantu. W przeciwnym razie ta funkcja powoduje, że sam formant przejąć w posiadanie przechwytywania myszy (tak samo jak `CWnd::SetCapture`).

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COleControl::SetControlSize

Ustawia rozmiar okna formantu OLE i powiadamia kontener, że witryna formantu zmienia.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parametry

*Cx*<br/>
Określa nową szerokość formantu w pikselach.

*Cy*<br/>
Określa nową wysokość formantu w pikselach.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli połączenie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja nie powinna być używana w konstruktorze formantu.

Należy zauważyć, że wszystkie współrzędne okien kontrolnych są względem lewego górnego rogu formantu.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COleControl::SetEnabled

Ustawia wartość właściwości czas Włączone formantu.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parametry

*bWłach*<br/>
PRAWDA, jeśli formant ma być włączony; w przeciwnym razie FALSE.

### <a name="remarks"></a>Uwagi

Po ustawieniu `OnEnabledChange` tej właściwości, jest wywoływana.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COleControl::SetFocus

Powoduje, że okno kontenera formantu przejąć w posiadanie fokus wejściowy w imieniu formantu.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do `CWnd` obiektu okna, który wcześniej miał fokus wejściowy lub NULL, jeśli nie ma takiego okna.

### <a name="remarks"></a>Uwagi

Jeśli formant jest aktywowany i bez okien, ta funkcja powoduje, że okno kontenera formantu do przejęcia w posiadanie fokusu wejściowego w imieniu formantu. Fokus wejściowy kieruje dane wejściowe klawiatury do okna kontenera, a kontener `SetFocus`wysyła wszystkie kolejne komunikaty klawiatury do wywoływania obiektu OLE. Każde okno, które wcześniej miało fokus wejściowy, traci je.

Jeśli formant nie jest bez okien, ta funkcja powoduje, że sam `CWnd::SetFocus`formant przejąć w posiadanie fokus wejściowy (tak samo jak ).

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COleControl::SetFont

Ustawia właściwość czcionki giełdowej formantu.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parametry

*pFontDisp (PFontDisp)*<br/>
Wskaźnik do interfejsu wysyłania czcionki.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControl::SetForeColor

Ustawia wartość właściwości forecolor zapasów forecolor formantu.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parametry

*dwForeColor (Kolor)*<br/>
Wartość OLE_COLOR, która ma być używana do rysowania pierwszego planu formantu.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji na temat korzystania z tej właściwości i innych powiązanych właściwości, zobacz artykuł [ActiveX Controls: Właściwości](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats

Wywoływana przez platformę do inicjowania listy formatów danych obsługiwanych przez formant.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja określa dwa formaty: CF_METAFILEPICT i zestaw właściwości trwałych.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COleControl::SetInitialSize

Ustawia rozmiar formantu OLE, gdy po raz pierwszy wyświetlany w kontenerze.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parametry

*Cx*<br/>
Początkowa szerokość formantu OLE w pikselach.

*Cy*<br/>
Początkowa wysokość formantu OLE w pikselach.

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji w konstruktorze, aby ustawić początkowy rozmiar formantu. Rozmiar początkowy jest mierzony w jednostkach urządzenia lub pikselach. Zaleca się, aby to wywołanie zostało wykonane w konstruktorze formantu.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COleControl::SetModifiedFlag

Zmienia zmodyfikowany stan formantu.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parametry

*bZmodyfikowany*<br/>
Nowa wartość zmodyfikowanej flagi formantu. WARTOŚĆ TRUE oznacza, że stan formantu został zmodyfikowany; FALSE wskazuje, że stan formantu właśnie został zapisany.

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji za każdym razem, gdy wystąpi zmiana, która wpłynie na stan trwały formantu. Na przykład, jeśli zmieni się wartość właściwości trwałej, należy wywołać tę funkcję za pomocą *bModified* **TRUE**.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COleControl::SetNotPermitted

Wskazuje, że żądanie edycji nie powiodło się.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Uwagi

Wywołanie tej `BoundPropertyRequestEdit` funkcji, gdy nie powiedzie się. Ta funkcja zgłasza wyjątek `COleDispScodeException` typu, aby wskazać, że operacja zestawu nie była dozwolona.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COleControl::Zestaw Niewsprzejęty

Zapobiega modyfikacji wartości właściwości formantu przez użytkownika.

```
void SetNotSupported();
```

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji zamiast Set funkcji dowolnej właściwości, gdzie modyfikacja wartości właściwości przez użytkownika formantu nie jest obsługiwana. Jednym z przykładów może być właściwość, która jest tylko do odczytu.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COleControl::SetRectInContainer

Ustawia współrzędne prostokąta formantu względem kontenera, wyrażone w jednostkach urządzenia.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*Lprect*<br/>
Wskaźnik do prostokąta zawierającego nowe współrzędne formantu względem kontenera.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli połączenie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli formant jest otwarty, jest zmieniany; w przeciwnym razie `OnPosRectChanged` wywoływana jest funkcja kontenera.

## <a name="colecontrolsettext"></a><a name="settext"></a>COleControl::SetText

Ustawia wartość właściwości Podpis lub Tekst w formancie.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parametry

*pszText (tekst psz)*<br/>
Wskaźnik do ciągu znaków.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że właściwości podpisu i tekstu są mapowane na tę samą wartość. Oznacza to, że wszelkie zmiany wprowadzone do jednej właściwości automatycznie zmienią obie właściwości. Ogólnie rzecz biorąc formant powinien obsługiwać akcje caption lub text właściwości, ale nie oba.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COleControl::ThrowError

Sygnalizuje wystąpienie błędu w formancie.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*Sc*<br/>
Wartość kodu stanu do zgłoszenia. Aby uzyskać pełną listę możliwych kodów, zobacz artykuł [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
Identyfikator zasobu ciągu wyjątku, który ma zostać zgłoszony.

*nHelpID (Pomoc eksmisja)*<br/>
Identyfikator pomocy tematu, który ma zostać zgłoszony.

*pszDeskrypt*<br/>
Ciąg zawierający wyjaśnienie wyjątku, który ma zostać zgłoszony.

### <a name="remarks"></a>Uwagi

Ta funkcja powinna być wywoływana tylko z wewnątrz Get lub Set funkcji dla właściwości OLE lub implementacji metody automatyzacji OLE. Jeśli chcesz zasygnalizować błędy, które występują w innych godzinach, należy zwolnić zdarzenie błąd akcji.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COleControl::TransformCoords

Przekształca wartości współrzędnych między jednostkami HIMETRIC a jednostkami macierzystymi kontenera.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parametry

*lpptlHimetric (lpptlHimetric)*<br/>
Wskaźnik do `POINTL` struktury zawierającej współrzędne w jednostkach HIMETRIC.

*lpptfKontainer*<br/>
Wskaźnik do `POINTF` struktury zawierającej współrzędne w rozmiarze jednostki kontenera.

*flagi*<br/>
Kombinacja następujących wartości:

- XFORMCOORDS_POSITION Pozycja w pojemniku.

- XFORMCOORDS_SIZE rozmiar A w pojemniku.

- XFORMCOORDS_HIMETRICTOCONTAINER przekształcanie jednostek HIMETRIC w jednostki kontenera.

- XFORMCOORDS_CONTAINERTOHIMETRIC Przekształć jednostki kontenera na jednostki HIMETRIC.

### <a name="remarks"></a>Uwagi

Pierwsze dwie flagi, XFORMCOORDS_POSITION i XFORMCOORDS_SIZE, wskazują, czy współrzędne powinny być traktowane jako położenie lub rozmiar. Pozostałe dwie flagi wskazują kierunek transformacji.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControl::TranslateColor

Konwertuje wartość koloru z OLE_COLOR typu danych na typ danych [COLORREF.](/windows/win32/gdi/colorref)

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parametry

*clrColor (wychocie)*<br/>
Typ danych OLE_COLOR. Aby uzyskać więcej informacji, zobacz funkcję [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) systemu Windows.

*hpal*<br/>
Uchwyt do opcjonalnej palety; może mieć wartość NULL.

### <a name="return-value"></a>Wartość zwracana

32-bitowa wartość koloru RGB (czerwona, zielona, niebieska), która definiuje kolor jednolity najbliżej wartości *clrColor,* którą może reprezentować urządzenie.

### <a name="remarks"></a>Uwagi

Ta funkcja jest przydatna do tłumaczenia zapasów ForeColor i BackColor właściwości do typów COLORREF używane przez funkcje członkowskie [CDC.](../../mfc/reference/cdc-class.md)

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad

Określa, czy formant powinien używać wartości właściwości otoczenia jako wartości domyślnych, gdy jest następnie ładowany ze stanu trwałego.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero wskazuje, że właściwości otoczenia będą prawidłowe; w przeciwnym razie właściwości otoczenia nie będą prawidłowe.

### <a name="remarks"></a>Uwagi

W niektórych kontenerach formant może nie mieć dostępu do jego właściwości `COleControl::DoPropExchange`otoczenia podczas początkowego wywołania zastąpienia . Dzieje się tak, jeśli kontener wywołuje [IPersistStreamInit::Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) lub [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) przed wywołaniem [IOleObject::SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (oznacza to, że jeśli nie honoruje bitu stanu OLEMISC_SETCLIENTSITEFIRST).

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COleControl::WindowProc

Zawiera procedurę systemu `COleControl` Windows dla obiektu.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametry

*Komunikat*<br/>
Określa komunikat systemu Windows do przetworzenia.

*Wparam*<br/>
Zawiera dodatkowe informacje używane do przetwarzania wiadomości. Wartość parametru zależy od komunikatu.

*Lparam*<br/>
Zawiera dodatkowe informacje używane do przetwarzania wiadomości. Wartość parametru zależy od komunikatu.

### <a name="return-value"></a>Wartość zwracana

Zwracana wartość wysyłanej wiadomości.

### <a name="remarks"></a>Uwagi

Wywołanie tej funkcji do wysyłania określonych komunikatów za pośrednictwem mapy komunikatów formantu.

## <a name="see-also"></a>Zobacz też

[Przykładowy circ3 MFC](../../overview/visual-cpp-samples.md)<br/>
[Próbka TESTHELP MFC](../../overview/visual-cpp-samples.md)<br/>
[Klasa COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Klasa CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Wykres hierarchii](../../mfc/hierarchy-chart.md)<br/>
[Klasa CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Klasa CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
