---
title: Colecontrol — klasa
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: ef44c917411efefeb6719af95185ddf7993fbab1
ms.sourcegitcommit: 975098222db3e8b297607cecaa1f504570a11799
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/10/2018
ms.locfileid: "53179022"
---
# <a name="colecontrol-class"></a>Colecontrol — klasa

Potężne klasa podstawowa dla rozwoju formantów OLE.

## <a name="syntax"></a>Składnia

```
class COleControl : public CWnd
```

## <a name="members"></a>Elementy członkowskie

### <a name="public-constructors"></a>Konstruktory publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Tworzy `COleControl` obiektu.|

### <a name="public-methods"></a>Metody publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Pobiera bieżący wygląd formantu.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Zwraca wartość właściwości BackColor otoczenia.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Zwraca nazwę formantu określonych przez kontener.|
|[COleControl::AmbientFont](#ambientfont)|Zwraca wartość właściwości Font otoczenia.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Zwraca wartość właściwości ForeColor otoczenia.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Zwraca identyfikator ustawień regionalnych kontenera|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Zwraca typ jednostek używanych przez kontener.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Określa, czy położenie uchwytów powinny być wyświetlane.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Określa, czy powinny być wyświetlane kreskowaniu.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Zwraca typ wyrównania tekstu określony przez kontener.|
|[COleControl::AmbientUIDead](#ambientuidead)|Określa, jeśli kontrolka powinna odpowiadać na akcje interfejsu użytkownika.|
|[COleControl::AmbientUserMode](#ambientusermode)|Określa tryb kontenera.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Powiadamia kontenera właściwości powiązanej został zmieniony.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Żądania uprawnień do edycji jej wartości.|
|[COleControl::ClientToParent](#clienttoparent)|Wykonuje translację punktu względem źródła kontrolki do punktu względem jego kontenera pochodzenia.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Dopasowuje prostokąt daszek, jeśli zachodzi formantu.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Wywołaj tę funkcję, po zmianie zestaw klawiszy skrótu obsługiwane przez kontrolkę.|
|[COleControl::DisplayError](#displayerror)|Wyświetla zdarzeń błędów standardowych do kontrolki użytkownika.|
|[COleControl::DoClick](#doclick)|Implementacja zasobów `DoClick` metody.|
|[COleControl::DoPropExchange](#dopropexchange)|Serializuje właściwości `COleControl` obiektu.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Ponownie rysuje kontrolkę OLE, która ma zostać należy do podklasy z kontrolki formularzy Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Umożliwia obsługę prostych ramki dla formantu.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serializuje szerokości i wysokości formantu.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializuje podstawowe właściwości formantu.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serializuje numer wersji kontroli.|
|[COleControl::FireClick](#fireclick)|Generowane temat zasobów `Click` zdarzeń.|
|[COleControl::FireDblClick](#firedblclick)|Generowane temat zasobów `DblClick` zdarzeń.|
|[COleControl::FireError](#fireerror)|Generowane temat zasobów `Error` zdarzeń.|
|[COleControl::FireEvent](#fireevent)|Wyzwala zdarzenie niestandardowe.|
|[COleControl::FireKeyDown](#firekeydown)|Generowane temat zasobów `KeyDown` zdarzeń.|
|[COleControl::FireKeyPress](#firekeypress)|Generowane temat zasobów `KeyPress` zdarzeń.|
|[COleControl::FireKeyUp](#firekeyup)|Generowane temat zasobów `KeyUp` zdarzeń.|
|[COleControl::FireMouseDown](#firemousedown)|Generowane temat zasobów `MouseDown` zdarzeń.|
|[COleControl::FireMouseMove](#firemousemove)|Generowane temat zasobów `MouseMove` zdarzeń.|
|[COleControl::FireMouseUp](#firemouseup)|Generowane temat zasobów `MouseUp` zdarzeń.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Uruchamia zdarzenie po zmianie stanu Gotowe formantu.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Zmienia domyślnego zachowania aktywacji formantu, który obsługuje `IPointerInactive` interfejsu.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Zwraca wartość określonej właściwości otoczenia.|
|[COleControl::GetAppearance](#getappearance)|Zwraca wartość właściwości wyglądu podstawowych.|
|[COleControl::GetBackColor](#getbackcolor)|Zwraca wartość właściwości BackColor podstawowych.|
|[COleControl::GetBorderStyle](#getborderstyle)|Zwraca wartość właściwości BorderStyle podstawowych.|
|[COleControl::GetCapture](#getcapture)|Określa, czy obiekt formantu niepowiązanej z oknami, aktywowane ma przechwytywanie myszy.|
|[COleControl::GetClassID](#getclassid)|Pobiera identyfikator klasy OLE formantu.|
|[COleControl::GetClientOffset](#getclientoffset)|Pobiera różnicę między lewym górnym rogu formantu prostokątny obszar i lewym górnym rogu obszaru klienckiego.|
|[COleControl::GetClientRect](#getclientrect)|Pobiera rozmiar obszaru klienckiego kontrolki.|
|[COleControl::GetClientSite](#getclientsite)|Wysyła zapytanie do obiektu dla wskaźnika do bieżącej lokacji klienta wewnątrz jej kontenera.|
|[COleControl::GetControlFlags](#getcontrolflags)|Pobiera ustawienia flagi kontroli.|
|[COleControl::GetControlSize](#getcontrolsize)|Zwraca położenie i rozmiar kontrolki OLE.|
|[COleControl::GetDC](#getdc)|Zapewnia środek kontroli niepowiązanej z oknami, można pobrać kontekstu urządzenia z jego kontenerem.|
|[COleControl::GetEnabled](#getenabled)|Zwraca wartość właściwości Enabled zasobów.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Pobiera wskaźnik do obiektu rozszerzonej kontroli do kontenera.|
|[COleControl::GetFocus](#getfocus)|Określa, czy kontrolka ma fokus.|
|[COleControl::GetFont](#getfont)|Zwraca wartość właściwości czcionki zasobów.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Zwraca wartość metryki `CFontHolder` obiektu.|
|[COleControl::GetForeColor](#getforecolor)|Zwraca wartość właściwości ForeColor podstawowych.|
|[COleControl::GetHwnd](#gethwnd)|Zwraca wartość właściwości hWnd podstawowe.|
|[COleControl::GetMessageString](#getmessagestring)|Zawiera tekst paska stanu dla elementu menu.|
|[COleControl::GetNotSupported](#getnotsupported)|Uniemożliwia dostęp do wartości właściwości kontrolki przez użytkownika.|
|[COleControl::GetReadyState](#getreadystate)|Zwraca stan gotowości formantu.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Zwraca prostokącie kontrolki względem jego kontenera.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Zwraca wartość metryki właściwości czcionki zasobów.|
|[COleControl::GetText](#gettext)|Zwraca wartość właściwości Text lub Caption podstawowych.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Przesłonić, aby zezwolić na kontrolce celem przeciągania i upuszczania operacji.|
|[COleControl::InitializeIIDs](#initializeiids)|Informuje o IID kontrolka będzie używać klasy bazowej.|
|[COleControl::InternalGetFont](#internalgetfont)|Zwraca `CFontHolder` obiektu dla właściwości czcionki zasobów.|
|[COleControl::InternalGetText](#internalgettext)|Pobiera właściwości podpisu lub tekst podstawowych.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Ustawia stan gotowości formantu i wyzwala zdarzenie zmiany w przypadku stanu gotowości.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Unieważnia obszar wyświetlany formantu, powodowania zostać odświeżone.|
|[COleControl::InvalidateRgn](#invalidatergn)|Unieważnia obszaru klienckiego okna kontenera w obrębie danego regionu. Można odświeżyć kontrolek bez okien w regionie.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Umożliwia ładowanie wyspecjalizowane kontrolki OLE.|
|[COleControl::IsModified](#ismodified)|Określa, czy zmienił się stan kontrolki.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Wskazuje, czy kontener obsługuje zoptymalizowanego rysowania dla bieżącej operacji rysowania.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Wywoływane w celu określenia, jeśli kontrolka jest podklasą Windows kontrolować także sam.|
|[COleControl::Load](#load)|Resetuje wszystkie poprzednie dane asynchronicznego i inicjuje nowe obciążenie asynchronicznego właściwości formantu.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Określa, jeśli formant będzie możliwa ich dezaktywacja przez kontener.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Wywołuje się, gdy zmieniono właściwość zostanie zmieniona.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Wywoływane po zmianie właściwości wyglądu podstawowych.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Wywołuje się, gdy zostanie zmieniona właściwość podstawowy kolor tła.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Wywoływane po zmianie właściwości BorderStyle podstawowych.|
|[COleControl::OnClick](#onclick)|Wywołuje się, by wyzwolenie akcji kliknij zdarzenie.|
|[COleControl::OnClose](#onclose)|Powiadamia kontrolkę która `IOleControl::Close` została wywołana.|
|[COleControl::OnDoVerb](#ondoverb)|Metoda wywoływana po zlecenia kontrolki została wykonana.|
|[COleControl::OnDraw](#ondraw)|Wywołuje się, gdy kontrolka zażądała ponownego narysowania.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Wywołanie przez kontener gdy kontrolka zażądała ponownego narysowania w kontekście urządzenia metaplików.|
|[COleControl::OnEdit](#onedit)|Metoda wywoływana przez kontener do aktywacji interfejsu użytkownika kontrolkę OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Wywołuje się, gdy zostanie zmieniony stock właściwość włączone.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Wywoływane przez kontener by wyliczyć zlecenia kontrolki.|
|[COleControl::OnEventAdvise](#oneventadvise)|Wywołuje się, gdy programy obsługi zdarzeń są połączone lub odłączony od formantu.|
|[COleControl::OnFontChanged](#onfontchanged)|Wywoływane po zmianie właściwości czcionki zasobów.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Wywoływane po zmianie właściwości ForeColor podstawowych.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Wywołuje się, gdy zdarzenia kontrolki są zablokowane lub są.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Powiadamia kontrolkę która `IOleObject::GetColorSet` została wywołana.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Mnemoników informacje do kontenera.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Wywołuje się, by uzyskać ciąg reprezentujący wartość właściwości.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Żąda uchwyt menu formantu, które zostaną scalone z menu kontenera.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Należy przesłonić ten element, aby pobrać rozmiar wyświetlania kontrolki najbliżej proponowane tryb rozmiar i zakresu.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Zwraca ciągów reprezentujących możliwe wartości dla właściwości.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Zwraca wartość odpowiadającą ciągowi wstępnie zdefiniowane.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Należy przesłonić, by pobrać rozmiar obszarów wyświetlania kontrolki (może służyć do włączyć dwuprzebiegową rysunku).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Przesłoń, aby przekonwertować rozmiar kontrolki prostokąt, zaczynając od określonej pozycji.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Należy przesłonić, aby pobrać stan widoku formantu.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Wywołanie przez kontener gdy kontrolka interfejsu użytkownika jest dezaktywowana.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Należy przesłonić ten element, aby mieć kontener dla formantu nieaktywne w obszarze wiadomości WM_MOUSEMOVE wysyłania wskaźnika myszy do kontrolki.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Należy przesłonić ten element, aby mieć kontener dla formantu nieaktywne w obszarze wiadomości WM_SETCURSOR wysyłania wskaźnika myszy do kontrolki.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Metoda wywoływana po standardowych KeyDown — zdarzenie zostało wyzwolone.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Metoda wywoływana po standardowych zdarzenia KeyPress zostały wyzwolone.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Metoda wywoływana po standardowych KeyUp — zdarzenie zostało wyzwolone.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Wskazuje, które strony właściwości służące do edycji właściwości.|
|[COleControl::OnMnemonic](#onmnemonic)|Wywoływane po naciśnięciu klawisza mnemoników klucz formantu.|
|[COleControl::OnProperties](#onproperties)|Wywołuje się, gdy formantu "Właściwości" verb zostało wywołane.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Należy przesłonić, aby zapytanie czy wyświetlanie formantu nakłada danego punktu.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Należy przesłonić, aby zapytanie czy wyświetlanie formantu nakłada się na dowolne miejsce w danym prostokąta.|
|[COleControl::OnRenderData](#onrenderdata)|Metoda wywoływana przez platformę, by pobrać dane w określonym formacie.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Metoda wywoływana przez platformę, by pobrać dane z pliku w określonym formacie.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Metoda wywoływana przez platformę, by pobrać dane z pamięci globalnej w określonym formacie.|
|[COleControl::OnResetState](#onresetstate)|Resetuje właściwości kontrolki do wartości domyślnych.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Powiadamia kontrolkę która `IOleControl::SetClientSite` została wywołana.|
|[COleControl::OnSetData](#onsetdata)|Zastępuje danych formantu z inną wartością.|
|[COleControl::OnSetExtent](#onsetextent)|Metoda wywoływana po rozszerzenie kontrolki została zmieniona.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Metoda wywoływana po formantu wymiary zostały zmienione.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Wywołuje się, gdy kontrolka została aktywowana w interfejsie użytkownika.|
|[COleControl::OnTextChanged](#ontextchanged)|Wywoływane po zmianie zasobu tekstu lub właściwości podpisu.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Przetwarza komunikaty okna (inne niż komunikaty klawiatury i myszy) od kontrolek bez okien.|
|[COleControl::ParentToClient](#parenttoclient)|Wykonuje translację punktu względem źródła kontenera do punktu względem kontroli źródła.|
|[COleControl::PostModalDialog](#postmodaldialog)|Powiadamia kontener o tym, że modalne okno dialogowe zostało zamknięte.|
|[COleControl::PreModalDialog](#premodaldialog)|Powiadamia kontener, który ma być wyświetlany modalne okno dialogowe.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Niszczy i ponownie tworzy okno formantu.|
|[COleControl::Refresh](#refresh)|Wymusza repaint wygląd formantu.|
|[COleControl::ReleaseCapture](#releasecapture)|Zwalnia przechwytywanie myszy.|
|[COleControl::ReleaseDC](#releasedc)|Udostępnia kontekst urządzenia wyświetlaną kontenera kontrolce.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Resetuje nadrzędnego okno kontrolki.|
|[COleControl::ResetStockProps](#resetstockprops)|Inicjuje `COleControl` podstawowy właściwości do wartości domyślnych.|
|[COleControl::ResetVersion](#resetversion)|Inicjuje numer wersji dla danej wartości.|
|[COleControl::ScrollWindow](#scrollwindow)|Umożliwia kontrolce przewiń obszaru w jej w miejscu aktywnego obrazu na ekranie.|
|[COleControl::SelectFontObject](#selectfontobject)|Wybiera właściwości niestandardowej czcionki do kontekstu urządzenia.|
|[COleControl::SelectStockFont](#selectstockfont)|Wybiera właściwości czcionki zasobów do kontekstu urządzenia.|
|[COleControl::SerializeExtent](#serializeextent)|Serializuje i inicjuje miejsce wyświetlania kontrolki.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serializuje i inicjuje `COleControl` podstawowy właściwości.|
|[COleControl::SerializeVersion](#serializeversion)|Serializuje i inicjuje informacji o kontroli wersji.|
|[COleControl::SetAppearance](#setappearance)|Ustawia wartość właściwości wyglądu podstawowych.|
|[COleControl::SetBackColor](#setbackcolor)|Ustawia wartość właściwości BackColor podstawowych.|
|[COleControl::SetBorderStyle](#setborderstyle)|Ustawia wartość właściwości BorderStyle podstawowych.|
|[COleControl::SetCapture](#setcapture)|Powoduje, że okno kontenera kontrolki do wykonania posiadania przechwytywanie myszy w imieniu formantu.|
|[COleControl::SetControlSize](#setcontrolsize)|Ustawia położenie i rozmiar kontrolki OLE.|
|[COleControl::SetEnabled](#setenabled)|Ustawia wartość właściwości Enabled zasobów.|
|[COleControl::SetFocus](#setfocus)|Powoduje, że okno kontenera kontrolki do wykonania posiada fokus wprowadzania w imieniu formantu.|
|[COleControl::SetFont](#setfont)|Ustawia wartość właściwości czcionki zasobów.|
|[COleControl::SetForeColor](#setforecolor)|Ustawia wartość właściwości ForeColor podstawowych.|
|[COleControl::SetInitialSize](#setinitialsize)|Określa rozmiar kontrolki OLE, gdy po raz pierwszy jest wyświetlany w kontenerze.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Zmiany stanu modyfikacji obiektu formantu.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Wskazuje, że żądanie edycji nie powiodło się.|
|[COleControl::SetNotSupported](#setnotsupported)|Zapobiega zmianom wartości właściwości kontrolki przez użytkownika.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Ustawia prostokącie kontrolki względem jego kontenera.|
|[COleControl::SetText](#settext)|Ustawia wartość właściwości Text lub Caption podstawowych.|
|[COleControl::ThrowError](#throwerror)|Sygnalizuje, że wystąpił błąd w kontrolce OLE.|
|[COleControl::TransformCoords](#transformcoords)|Przekształcenia koordynować wartości między kontenerem i kontrolki.|
|[COleControl::TranslateColor](#translatecolor)|Konwertuje wartość OLE_COLOR wartość COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Określa, czy właściwości otoczenia będzie dostępny podczas następnego formantu jest ładowany.|
|[COleControl::WindowProc](#windowproc)|Zawiera procedury dla Windows `COleControl` obiektu.|

### <a name="protected-methods"></a>Metody chronione

|Nazwa|Opis|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Wywoływane przez platformę, gdy musi zostać zaktualizowany wygląd formantu.|
|[COleControl::DrawMetafile](#drawmetafile)|Wywoływane przez platformę, gdy jest używane w kontekście urządzenia metaplików.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Umożliwia wywołanie metody automatyzacji.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Metoda wywoływana przez platformę, by zainicjować listy formatów danych obsługiwane przez kontrolkę.|

## <a name="remarks"></a>Uwagi

Pochodną `CWnd`, ta klasa dziedziczy wszystkie funkcje programu Windows obiekt window, a także dodatkowe funkcje specyficzne dla OLE, takich jak inicjowanie zdarzeń i możliwość obsługi metod i właściwości.

Formanty OLE można wstawiać do aplikacji kontenera OLE i komunikacji z kontenerem za pomocą dwukierunkowych systemu inicjowanie zdarzeń i uwidaczniającą metod i właściwości do kontenera. Należy pamiętać, że standardowych kontenerów OLE obsługują tylko podstawowe funkcje sterowania OLE. Są one nie obsługuje rozszerzonych funkcji sterowania OLE. Inicjowanie zdarzeń występuje, gdy zdarzenia są wysyłane do kontenera, w wyniku określone akcje mające miejsce w kontrolce. Z kolei kontenera komunikuje się za pomocą kontrolki przy użyciu narażonych zestaw metod i właściwości analogiczne do funkcji składowych i składowych danych klasy języka C++. Takie podejście umożliwia deweloperowi wygląd kontrolki i powiadom kontenera, gdy wystąpią pewne akcje.

## <a name="windowless-controls"></a>Od kontrolek bez okien

Formanty OLE mogą być używane aktywny w miejscu, bez okna. Od kontrolek bez okien są istotne korzyści:

- Od kontrolek bez okien może być przezroczysty i innych niż prostokątne

- Od kontrolek bez okien skrócić czas do rozmiaru i tworzenia wystąpienia obiektu

Formanty okna nie jest konieczne. Łatwo można podać usług oferowanych przez okno za pośrednictwem jednego okna udostępnionego (zazwyczaj kontenera) i bitowy dispatching kodu. Okno to przede wszystkim niepotrzebne kompilacji na obiekcie.

W przypadku aktywacji niepowiązanej z oknami kontenera (które mają okno) jest odpowiedzialne za świadczenie usług, które mogłyby zostały podane przez okno własne kontrolki. Na przykład jeśli formant musi zapytania fokus klawiatury, zapytanie przechwytywanie myszy lub uzyskać kontekst urządzenia, te operacje są zarządzane przez kontener. `COleControl` Składowej bez okien działania wywołają procedurę obsługi tych operacji na kontenerze.

Po włączeniu aktywacji niepowiązanej z oknami delegatów kontenera wejściowych wiadomości z formantem `IOleInPlaceObjectWindowless` interfejsu (rozszerzenie [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) niepowiązanej z oknami obsługi). `COleControl`przez implementację tego interfejsu zostanie wysyłania komunikatów za pomocą formantu mapy komunikatów, po dostosowanie myszy służy do koordynowania odpowiednio. Te komunikaty, takie jak komunikaty zwykłych okna, może przetwarzać, dodając odpowiednie pozycje na mapie komunikatów.

W kontrolce, należy zawsze używać `COleControl` zamiast odpowiednich elementów członkowskich `CWnd` funkcji składowych lub ich powiązane funkcje Windows API.

Tylko wtedy, gdy staną się aktywne, ale rośnie ilość pracy wymaganej dla przejścia nieaktywne aktywny i prędkość przejścia ulegnie awarii, obiekty kontrolek OLE można również utworzyć okno. Istnieją przypadki, gdy jest to problem: na przykład należy wziąć pod uwagę siatka pól tekstowych. Po ów w górę i w dół za pośrednictwem kolumnie, każdy formant musi być w miejscu aktywowany, a następnie zdezaktywowane. Prędkość przejścia nieaktywne/aktywny bezpośredni wpływ na szybkość przewijania.

Aby uzyskać więcej informacji na temat tworzenia platforma sterowania OLE, zobacz artykuły [kontrolki ActiveX MFC](../../mfc/mfc-activex-controls.md) i [omówienie: Tworzenie programu kontrolki ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Aby uzyskać informacje dotyczące optymalizacji formantów OLE, w tym kontrolek bez okien i pozbawionej migotania, zobacz [kontrolki ActiveX MFC: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Wymagania

**Nagłówek:** afxctl.h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

Zwraca wartość właściwości BackColor otoczenia.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Wartość zwracana

Bieżąca wartość kontenera otoczenia BackColor właściwość, jeśli istnieje. Jeśli właściwość nie jest obsługiwana, funkcja zwraca kolor tła zdefiniowanych w systemie Windows.

### <a name="remarks"></a>Uwagi

Otoczenia BackColor właściwość jest dostępna dla wszystkich kontrolek i jest zdefiniowana przez kontener. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

Podana nazwa kontenera ma przypisany do kontrolki może służyć do komunikatów o błędach wyświetlane użytkownikowi.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Wartość zwracana

Nazwa formantu OLE. Wartość domyślna to ciąg o zerowej długości.

### <a name="remarks"></a>Uwagi

Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.

##  <a name="ambientfont"></a>  COleControl::AmbientFont

Zwraca wartość właściwości Font otoczenia.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do kontenera otoczenia interfejs ekspedycji czcionki. Wartością domyślną jest NULL. Jeśli zwracana nie jest równa NULL, odpowiedzialność za zwalniania czcionki przez wywołanie jego [IUnknown::Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) funkcja elementu członkowskiego.

### <a name="remarks"></a>Uwagi

Właściwość czcionki otoczenia jest zdefiniowana przez kontener i dostępne dla wszystkich kontrolek. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

Zwraca wartość właściwości ForeColor otoczenia.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Wartość zwracana

Bieżąca wartość kontenera otoczenia ForeColor właściwość, jeśli istnieje. Jeśli nie jest obsługiwana, funkcja zwraca kolor tekstu zdefiniowanych w systemie Windows.

### <a name="remarks"></a>Uwagi

Otoczenia ForeColor właściwość jest dostępna dla wszystkich kontrolek i jest zdefiniowana przez kontener. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

Zwraca identyfikator ustawień regionalnych kontenera

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Wartość zwracana

Wartość właściwości identyfikator ustawień regionalnych kontenera, jeśli istnieje. Jeśli ta właściwość nie jest obsługiwana, funkcja zwraca 0.

### <a name="remarks"></a>Uwagi

Formant służy identyfikatorowi dostosowanie jego interfejsu użytkownika dla określonych ustawień regionalnych. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

Pobiera bieżące ustawienie wygląd obiektu formantu.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Wartość zwracana

Wygląd formantu:

- **0** płaskie wyglądu

- **1** wygląd 3D

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, aby pobrać bieżącą wartość właściwości DISPID_AMBIENT_APPEARANCE dla formantu.

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

Zwraca typ jednostek używanych przez kontener.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Wartość zwracana

Ciąg zawierający otoczenia ScaleUnits kontenera. Jeśli ta właściwość nie jest obsługiwany, ta funkcja zwraca ciąg o zerowej długości.

### <a name="remarks"></a>Uwagi

Zmieniono właściwość ScaleUnits kontener może służyć do wyświetlenia pozycji lub wymiarów, oznaczony za pomocą wybranej jednostki, takie jak twipach lub cm. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

Określa, czy kontener zezwala na formant, aby wyświetlić położenie uchwytów dla siebie, gdy jest ona aktywna.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli uchwyty powinna być wyświetlana; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, funkcja zwraca wartość różną od zera.

### <a name="remarks"></a>Uwagi

Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

Określa, czy kontener zezwala na formant Aby wyświetlić sam z kreskowanym wzorca, gdy aktywne interfejsu użytkownika.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli mają być pokazywane zakreskowane wzorca; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, funkcja zwraca wartość różną od zera.

### <a name="remarks"></a>Uwagi

Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

Określa wyrównanie tekstu otoczenia preferowane przez kontener formantu.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Wartość zwracana

Stan zmieniono właściwość TextAlign kontenera. Jeśli ta właściwość nie jest obsługiwana, funkcja zwraca 0.

Oto lista prawidłowych wartości zwracane:

|Wartość zwracana|Znaczenie|
|------------------|-------------|
|0|Wyrównanie ogólne (cyfr po prawej stronie tekstu z lewej strony).|
|1|Wyrównaj do lewej|
|2|Wyśrodkuj|
|3|Wyrównaj do prawej|

### <a name="remarks"></a>Uwagi

Ta właściwość jest dostępna dla wszystkich kontrolek osadzone i jest zdefiniowana przez kontener. Należy pamiętać, że kontener nie jest wymagany do obsługi tej właściwości.

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

Określa, jeśli kontener wymagane formant aby reagować na działania interfejsu użytkownika.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli kontrolka powinna odpowiadać na akcje interfejsu użytkownika; w przeciwnym razie 0. Jeśli ta właściwość nie jest obsługiwana, funkcja zwraca 0.

### <a name="remarks"></a>Uwagi

Na przykład kontener może ustawić to wartość true w trybie projektowania.

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

Określa, czy kontener jest w trybie projektowania lub w trybie użytkownika.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli kontener jest w trybie użytkownika; w przeciwnym razie 0 (w trybie projektowania). Jeśli ta właściwość nie jest obsługiwany, ta funkcja zwraca wartość TRUE.

### <a name="remarks"></a>Uwagi

Na przykład kontener może ustawić to wartość false w trybie projektowania.

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

Sygnalizuje, że zmieniono wartość właściwości powiązanej.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*identyfikator DISPID*<br/>
Identyfikator wysyłania powiązanych właściwości formantu.

### <a name="remarks"></a>Uwagi

Musi być wywoływana za każdym razem, gdy wartość zmiany właściwości, nawet w przypadkach, gdy zmiana nie została wprowadzona przez właściwość metody. Należy zwłaszcza pamiętać o powiązanych właściwości, które są mapowane na zmienne Członkowskie. Każdej zmianie takiego elementu członkowskiego zmiennej, `BoundPropertyChanged` musi zostać wywołana.

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

Żąda uprawnienia z `IPropertyNotifySink` interfejsu, aby zmienić wartości właściwości powiązanej dostarczane przez kontrolkę.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*identyfikator DISPID*<br/>
Identyfikator wysyłania powiązanych właściwości formantu.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli zmiana jest dozwolona; w przeciwnym razie 0. Wartością domyślną jest różna od zera.

### <a name="remarks"></a>Uwagi

Odmowa uprawnień, kontrolka musi zezwala wartość o zmianie właściwości. Można to zrobić, ignorowanie lub w przypadku braku akcji, która podjęła próbę zmiany wartości właściwości.

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

Wykonuje translację współrzędne *pPoint* na współrzędne nadrzędne.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Wskaźnik na granicach formantu OLE w kontenerze. Nie obszaru klienta, ale obszar formantu całego obramowania i paski przewijania.

*pPoint*<br/>
Wskaźnik do punktu obszaru klienta OLE na współrzędne elementu nadrzędnego (kontenera).

### <a name="remarks"></a>Uwagi

W danych wejściowych *pPoint* względem źródła obszaru klienckiego kontrolki OLE (lewy górny róg obszaru klienckiego kontrolki). W danych wyjściowych *pPoint* względem źródła elementu nadrzędnego (lewy górny róg kontenera).

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

Dopasowuje prostokąt daszek, jeśli jest ona całkowicie lub częściowo objęta nakładające się obiekty nieprzezroczyste.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lprect —*<br/>
W danych wejściowych, wskaźnik do [Prostokąt](/windows/desktop/api/windef/ns-windef-tagrect) strukturę, która zawiera obszar karetkę do skorygowania. Na dane wyjściowe, obszaru skorygowany karetki lub wartość NULL, jeśli prostokąt daszka jest całkowicie objęty.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Znak daszka jest migające linii, bloku lub mapy bitowej, który zazwyczaj wskazuje, gdzie zostanie wstawiony tekst i grafikę.

Obiekt niepowiązanej z oknami bezpiecznie nie można wyświetlić daszek bez wcześniejszego sprawdzenia tego, czy karetkę częściowo lub całkowicie ukryte przy nakładających się obiektów. Aby można było upewnij, że możliwe, można użyć obiektu `ClipCaretRect` można pobrać karetki dostosowane (zmniejszona) zapewniające mieści się w regionie wycinka.

Obiekty tworzenie daszek powinien przesłać prostokąt karetki `ClipCaretRect` i skorygowany prostokąt na użytek karetki. Jeśli karetkę jest całkowicie ukryte, ta metoda zwróci wartość FALSE, a karetkę powinny być niewidoczne na wszystkich w tym przypadku.

##  <a name="colecontrol"></a>  COleControl::COleControl

Konstruuje `COleControl` obiektu.

```
COleControl();
```

### <a name="remarks"></a>Uwagi

Ta funkcja nie jest wywoływana bezpośrednio. Zamiast tego formantu OLE jest zazwyczaj tworzony przez jego fabryki klas.

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

Wywołaj tę funkcję, gdy zmieniono zestaw klawiszy skrótu obsługiwane przez kontrolkę.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Uwagi

Po odebraniu tego powiadomienia, kontener formantu uzyskuje nowy zestaw klawiszy skrótu poprzez wywołanie [IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Pamiętaj, że kontener nie jest wymagane, aby odpowiedzieć na to powiadomienie.

##  <a name="displayerror"></a>  COleControl::DisplayError

Metoda wywoływana przez platformę po standardowych zdarzeń błąd został obsłużony (chyba że program obsługi zdarzeń został pominięty ekran błędu).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parametry

*scode*<br/>
Wartość Kod stanu jest raportowane. Aby uzyskać pełną listę możliwych kodów, zobacz artykuł [kontrolek ActiveX: Tematy zaawansowane](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Opis jest zgłoszony błąd.

*lpszSource*<br/>
Nazwa modułu wygenerowanie tego błędu (zwykle nazwa modułu sterowania OLE).

*lpszHelpFile*<br/>
Nazwa pliku Pomocy zawierającego opis błędu.

*nHelpID*<br/>
Pomoc kontekstowy identyfikator jest zgłoszony błąd.

### <a name="remarks"></a>Uwagi

Domyślne zachowanie Wyświetla okno komunikatu, zawierający opis błędu, zawarte w *lpszDescription*.

Należy przesłonić tę funkcję, aby dostosować sposób wyświetlania błędów.

##  <a name="doclick"></a>  COleControl::DoClick

Symuluje myszy kliknij akcję na formancie.

```
void DoClick();
```

### <a name="remarks"></a>Uwagi

Overridable `COleControl::OnClick` składowa zostanie wywołana i kliknij zdarzenie zostanie wyzwolone, jeśli jest obsługiwany przez kontrolkę zasobów.

Ta funkcja jest obsługiwana przez `COleControl` klasy bazowej jako podstawowe metody o nazwie DoClick. Aby uzyskać więcej informacji, zobacz artykuł [kontrolek ActiveX: Metody](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

Metoda wywoływana przez platformę, gdy ładowania lub zapisywania kontrolki z poziomu reprezentację z magazynu trwałego, takiego jak zestaw strumienia lub właściwość.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Wskaźnik do `CPropExchange` obiektu. Struktura dostarcza tego obiektu w celu ustanowienia kontekście wymiany właściwości, w tym kierunku.

### <a name="remarks"></a>Uwagi

Ta funkcja jest zwykle wykonywania wywołań do **PX_** rodziny funkcji do załadowania lub zapisania określonych zdefiniowanych przez użytkownika właściwości kontrolki OLE.

Jeśli Kreator kontrolek został użyty do utworzenia projektu kontrolki OLE, zastąpiona wersja tej funkcji będzie serializować właściwości podstawowe obsługiwane przez `COleControl` z wywołaniem do funkcji klasy bazowej `COleControl::DoPropExchange`. W miarę dodawania właściwości zdefiniowane przez użytkownika do kontrolki OLE, musisz zmodyfikować tę funkcję, aby serializować nowej właściwości. Aby uzyskać więcej informacji na temat serializacji, zobacz artykuł [kontrolek ActiveX: Serializacja](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

Ponownie rysuje kontrolkę OLE, która ma zostać należy do podklasy z kontrolki formularzy Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*podstawowego kontrolera domeny*<br/>
Wskaźnik do kontekstu urządzenia kontenera kontrolki.

*rcBounds*<br/>
Obszar, w którym ma być rysowany formantu.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, aby poprawnie obsługiwać malowania nieaktywnego kontrolki OLE. Ta funkcja powinna służyć wyłącznie jeśli OLE kontrolować podklasy kontrolki Windows i powinna być wywoływana `OnDraw` funkcja kontrolki.

Aby uzyskać więcej informacji na temat tej funkcji i Tworzenie podklasy kontrolki Windows, zobacz artykuł [kontrolek ActiveX: Tworzenie podklasy kontrolki Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

##  <a name="drawcontent"></a>  COleControl::DrawContent

Wywoływane przez platformę, gdy musi zostać zaktualizowany wygląd formantu.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*podstawowego kontrolera domeny*<br/>
Wskaźnik do kontekstu urządzenia.

*RC*<br/>
Prostokątny obszar, aby znajdować się na środku.

### <a name="remarks"></a>Uwagi

Ta funkcja wywołuje bezpośrednio możliwym do zastąpienia `OnDraw` funkcji.

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

Wywoływane przez platformę, gdy jest używane w kontekście urządzenia metaplików.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametry

*podstawowego kontrolera domeny*<br/>
Wskaźnik na kontekście urządzenia metaplików.

*RC*<br/>
Prostokątny obszar, aby znajdować się na środku.

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

Umożliwia cechy ramki proste kontrolki OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Uwagi

Cecha ta umożliwia kontrolce obsługują visual zawierania innych kontrolek, ale nie true zawierania OLE. Przykładem może być za pomocą kilku formantów wewnątrz pola grupy. Te formanty nie są zawarte OLE, ale znajdują się w tym samym komputerze grupy.

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

Serializuje i inicjuje stanu formantu w zakresie (wymiary w jednostkach HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Wskaźnik do [CPropExchange](../../mfc/reference/cpropexchange-class.md) obiektu. Struktura dostarcza tego obiektu w celu ustanowienia kontekście wymiany właściwości, w tym kierunku.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli funkcja się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja jest zazwyczaj wywoływana przez domyślną implementację elementu `COleControl::DoPropExchange`.

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

Serializuje i inicjuje stan podstawowe właściwości formantu.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Wskaźnik do [CPropExchange](../../mfc/reference/cpropexchange-class.md) obiektu. Struktura dostarcza tego obiektu w celu ustanowienia kontekście wymiany właściwości, w tym kierunku.

### <a name="remarks"></a>Uwagi

Ta funkcja jest zazwyczaj wywoływana przez domyślną implementację elementu `COleControl::DoPropExchange`.

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

Serializuje i inicjuje stan formantu informacji o wersji.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*pPX*<br/>
Wskaźnik do `CPropExchange` obiektu. Struktura dostarcza tego obiektu w celu ustanowienia kontekście wymiany właściwości, w tym kierunku.

*dwVersionDefault*<br/>
Bieżący numer wersji kontroli.

*bConvert*<br/>
Wskazuje, czy trwałe dane powinny być konwertowane do najnowszego formatu podczas zapisywania lub przechowywane w tym samym formacie, który został załadowany.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera funkcja zakończyła się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zazwyczaj jest to pierwsza funkcja wywoływane przez formant zastępowania metody `COleControl::DoPropExchange`. Podczas ładowania, ta funkcja odczytuje numer wersji trwałych danych i ustawia atrybut wersji [CPropExchange](../../mfc/reference/cpropexchange-class.md) obiekt odpowiednio. Podczas zapisywania, funkcja ta zapisuje numer wersji trwałych danych.

Aby uzyskać więcej informacji na temat stanu trwałego i przechowywania wersji, zobacz artykuł [kontrolek ActiveX: Serializacja](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>  COleControl::FireClick

Wywoływane przez platformę, po kliknięciu przycisku myszy nad aktywny formant.

```
void FireClick();
```

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest uruchamiane.

Automatyczne uruchomieniu zdarzenia kliknij nastąpi Mapa zdarzeń formantu musi mieć zasobu kliknij zdarzenie zdefiniowane.

##  <a name="firedblclick"></a>  COleControl::FireDblClick

Wywoływane przez platformę, gdy wskaźnik myszy zostanie dwukrotnym kliknięciu aktywny formant.

```
void FireDblClick();
```

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest uruchamiane.

Automatyczne uruchomieniu zdarzenia DblClick nastąpi Mapa zdarzeń formantu musi mieć podstawowy zdarzenia DblClick zdefiniowane.

##  <a name="fireerror"></a>  COleControl::FireError

Wyzwala zdarzenie błędu.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*scode*<br/>
Wartość Kod stanu jest raportowane. Aby uzyskać pełną listę możliwych kodów, zobacz artykuł [kontrolek ActiveX: Tematy zaawansowane](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Opis jest zgłoszony błąd.

*nHelpID*<br/>
Identyfikator Pomocy jest zgłoszony błąd.

### <a name="remarks"></a>Uwagi

To zdarzenie umożliwia sygnalizacji w odpowiednich miejscach w kodzie, wystąpi błąd w obrębie kontrolki. W przeciwieństwie do innych standardowych zdarzeń, takich jak MouseMove, lub kliknij błąd nigdy nie jest wywoływane przez platformę.

Aby zgłosić błąd występujący podczas funkcję get właściwości, funkcji set właściwość lub metoda automatyzacji, należy wywołać [COleControl::ThrowError](#throwerror).

Implementacja zdarzenie błędu Stock kontrolkę OLE używa wartości SCODE. Jeśli formant używa tego zdarzenia jest przeznaczony do użycia w języku Visual Basic w wersji 4.0, zostaną zwrócone błędy, ponieważ wartość SCODE nie jest obsługiwana w języku Visual Basic.

Aby rozwiązać ten problem, należy ręcznie zmienić parametr SCODE w formancie. ODL pliku **długie**. Ponadto dowolne niestandardowe zdarzenie, metody lub właściwości, która używa parametru SCODE również powoduje, że ten sam problem.

##  <a name="fireevent"></a>  COleControl::FireEvent

Wyzwala zdarzenie zdefiniowane przez użytkownika, z kontrolki z dowolnej liczby argumentów opcjonalnych.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parametry

*identyfikator DISPID*<br/>
Identyfikator wysyłania zdarzeń do uruchomienia.

*pbParams*<br/>
Deskryptor dla typów parametrów zdarzenia.

### <a name="remarks"></a>Uwagi

Zazwyczaj ta funkcja nie należy wywoływać bezpośrednio. Zamiast tego będzie wywoływać funkcje inicjowanie zdarzeń w sekcji mapy zdarzeń kontroli nad deklaracją klasy.

*PbParams* argument jest listę rozdzielonych spacjami **VTS_**. Co najmniej jeden z tych wartości, rozdzielone spacjami (nie przecinki) określa listę parametrów funkcji. Dopuszczalne są następujące wartości:

|Symbol|Typ parametru|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Dodatkowe variant — stałe zostały zdefiniowane dla wszystkich wariantów typów, z wyjątkiem VTS_FONT i VTS_PICTURE, stanowiące wskaźnik ze stałą danych variant. Te stałe są nazywane przy użyciu **VTS_P** `constantname` Konwencji. Na przykład VTS_PCOLOR jest wskaźnikiem do VTS_COLOR — stała.

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

Wywoływane przez platformę, po naciśnięciu klawisza, gdy kontrolka jest aktywny w interfejsie użytkownika.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Wskaźnik do wartości wirtualnego kod klawisza, który po naciśnięciu klawisza. Aby uzyskać listę standardowa wirtualnej kody klawiszy Zobacz Winuser.h

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- Klawisz SHIFT SHIFT_MASK został naciśnięty podczas działania.

- W trakcie akcji został naciśnięty klawisz CTRL CTRL_MASK.

- W trakcie akcji został naciśnięty klawisz ALT ALT_MASK.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest uruchamiane.

Automatyczne uruchomieniu zdarzenia KeyDown nastąpi Mapa zdarzeń formantu musi mieć podstawowy zdarzenia KeyDown zdefiniowane.

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

Wywoływane przez platformę, gdy klucz jest wciśnięty i zwolnieniu, gdy kontrolka niestandardowa jest aktywny w interfejsie użytkownika w ramach kontenera.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Wskaźnik do znaku wartość naciśniętego klawisza.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest uruchamiane.

Odbiorca zdarzenia mogą być modyfikowane *pnChar*, na przykład przekonwertować wszystkie małe litery na wielkie litery. Jeśli chcesz sprawdzić znak modyfikacji, zastępują `OnKeyPressEvent`.

Automatyczne uruchomieniu zdarzenia KeyPress nastąpi Mapa zdarzeń formantu musi mieć podstawowy zdarzenia KeyPress zdefiniowane.

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

Wywoływane przez platformę po zwolnieniu klawisza, gdy kontrolka niestandardowa jest aktywny w interfejsie użytkownika w ramach kontenera.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametry

*pnChar*<br/>
Wskaźnik do wartości wirtualnego kod klawisza wydana klucza. Aby uzyskać listę standardowa wirtualnej kody klawiszy Zobacz Winuser.h

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- Klawisz SHIFT SHIFT_MASK został naciśnięty podczas działania.

- W trakcie akcji został naciśnięty klawisz CTRL CTRL_MASK.

- W trakcie akcji został naciśnięty klawisz ALT ALT_MASK.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest uruchamiane.

Automatyczne uruchomieniu zdarzenia KeyUp nastąpi Mapa zdarzeń formantu musi mieć podstawowe zdarzenie KeyUp zdefiniowane.

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

Wywoływane przez platformę, po naciśnięciu przycisku myszy nad aktywny formant niestandardowy.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*Nprzycisk*<br/>
Naciśnięty przycisk myszy wartość liczbową. Nazwa może zawierać jedną z następujących wartości:

- LEFT_BUTTON lewego przycisku myszy został naciśnięty w dół.

- MIDDLE_BUTTON środkowego przycisku myszy został naciśnięty w dół.

- RIGHT_BUTTON prawym przyciskiem myszy został naciśnięty w dół.

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- Klawisz SHIFT SHIFT_MASK został naciśnięty podczas działania.

- W trakcie akcji został naciśnięty klawisz CTRL CTRL_MASK.

- W trakcie akcji został naciśnięty klawisz ALT ALT_MASK.

*x*<br/>
Współrzędna x kursora podczas użycia przycisku myszy w dół. Współrzędna jest określana względem lewego górnego rogu okna kontrolki.

*y*<br/>
Współrzędna y kursora podczas użycia przycisku myszy w dół. Współrzędna jest określana względem lewego górnego rogu okna kontrolki.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest uruchamiane.

Automatyczne uruchomieniu zdarzenia MouseDown nastąpi Mapa zdarzeń formantu musi mieć podstawowy MouseDown — zdarzenie zdefiniowane.

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

Wywoływane przez platformę, gdy kursor jest przesuwany nad aktywny formant niestandardowy.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*Nprzycisk*<br/>
Naciśnięto wartość liczbową przycisków myszy. Zawiera kombinację następujących wartości:

- LEFT_BUTTON lewego przycisku myszy został naciśnięty klawisz podczas działania.

- MIDDLE_BUTTON środkowego przycisku myszy został naciśnięty klawisz podczas działania.

- RIGHT_BUTTON prawym przyciskiem myszy został naciśnięty klawisz podczas działania.

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- Klawisz SHIFT SHIFT_MASK został naciśnięty podczas działania.

- W trakcie akcji został naciśnięty klawisz CTRL CTRL_MASK.

- W trakcie akcji został naciśnięty klawisz ALT ALT_MASK.

*x*<br/>
Współrzędna x kursora. Współrzędna jest określana względem lewego górnego rogu okna kontrolki.

*y*<br/>
Współrzędna y kursora. Współrzędna jest określana względem lewego górnego rogu okna kontrolki.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest uruchamiane.

Automatyczne uruchomieniu zdarzenia MouseMove wystąpić Mapa zdarzeń formantu musi mieć podstawowy MouseMove — zdarzenie zdefiniowane.

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

Wywoływane przez platformę, po zwolnieniu przycisku myszy nad aktywny formant niestandardowy.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametry

*Nprzycisk*<br/>
Wartość liczbowa przycisku myszy. Może mieć jedną z następujących wartości:

- Wydano LEFT_BUTTON lewego przycisku myszy.

- Wydano MIDDLE_BUTTON środkowego przycisku myszy.

- RIGHT_BUTTON prawym przyciskiem myszy został wydany.

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- Klawisz SHIFT SHIFT_MASK został naciśnięty podczas działania.

- W trakcie akcji został naciśnięty klawisz CTRL CTRL_MASK.

- W trakcie akcji został naciśnięty klawisz ALT ALT_MASK.

*x*<br/>
Współrzędna x kursora, gdy przycisk myszy został wydany. Współrzędna jest określana względem lewego górnego rogu okna kontrolki.

*y*<br/>
Współrzędna y kursora prowadzącego zwolnionych przycisk myszy. Współrzędna jest określana względem lewego górnego rogu okna kontrolki.

### <a name="remarks"></a>Uwagi

Jeśli to zdarzenie jest zdefiniowany jako zdarzenie niestandardowe, należy określić, gdy zdarzenie jest uruchamiane.

Automatyczne uruchomieniu zdarzenia MouseUp nastąpi Mapa zdarzeń formantu musi mieć podstawowy MouseUp — zdarzenie zdefiniowane.

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

Uruchamia zdarzenie z bieżącą wartością stanu gotowości kontrolki.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Uwagi

Stanu gotowości może być jednym z następujących wartości:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Stan inicjowania domyślnego|
|READYSTATE_LOADING|Obecnie ładowania właściwości formantu|
|READYSTATE_LOADED|Kontrolka została zainicjowana.|
|READYSTATE_INTERACTIVE|Kontrolka ma wystarczającej ilości danych w interaktywne, ale jeszcze ładowania danych nie wszystkie asynchroniczne|
|READYSTATE_COMPLETE|Kontrolka ma swoje dane|

Użyj [GetReadyState](#getreadystate) ustalenie bieżącej gotowości formantu.

[InternalSetReadyState](#internalsetreadystate) zmiany stanu gotowości dostarczona wartość, a następnie wywołuje `FireReadyStateChange`.

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

Zmienia domyślnego zachowania aktywacji formantu, który obsługuje `IPointerInactive` interfejsu.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Wartość zwracana

Kombinacja flag z wyliczenia POINTERINACTIVE. Możliwe flagi są:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Obiekt powinien być aktywowany, gdy wskaźnik myszy zostanie przesunięty go podczas operacji przenoszenia myszy w miejscu.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Obiekt powinien zdezaktywowane, gdy wskaźnik myszy opuszcza obiektu podczas operacji przenoszenia myszy.|
|POINTERINACTIVE_ACTIVATEONDRAG|Obiekt powinien być w miejscu aktywowany, gdy wskaźnik myszy jest przeciągany nad nią podczas przeciągania i upuszczania operacji.|

### <a name="remarks"></a>Uwagi

Gdy `IPointerInactive` interfejs jest włączony, kontener oddeleguje WM_SETCURSOR i WM_MOUSEMOVE wiadomości do niego. `COleControl`przez implementację tego interfejsu zostanie wysyłania komunikatów za pomocą formantu mapy komunikatów, po dostosowanie myszy służy do koordynowania odpowiednio.

Zawsze, gdy kontener otrzyma komunikat WM_SETCURSOR lub WM_MOUSEMOVE z kursorem myszy nad nieaktywnym obiektem obsługi `IPointerInactive`, powinien wywoływać `GetActivationPolicy` interfejsu i zwracany flagi z wyliczenia POINTERINACTIVE.

Te komunikaty, podobnie jak zwykłe okna komunikatów, może przetwarzać, dodając odpowiednie pozycje na mapie komunikatów. W inne programy obsługi należy unikać `m_hWnd` zmienną członkowską (lub dowolnej funkcji Członkowskich, które korzysta z niego) bez uprzedniego sprawdzania, czy wartość jest różna od NULL.

Każdy obiekt ma więcej niż Ustaw kursor myszy i/lub fire zdarzenie przesunięcia kursora myszy, takie jak specjalne opinii programu visual powinien wróć flagi POINTERINACTIVE_ACTIVATEONENTRY i narysuj opinii, tylko wtedy, gdy aktywne. Jeśli obiekt zwraca tę flagę, kontenera należy aktywować go w miejscu natychmiast i przekazywać je po ten sam komunikat, który wyzwolił wywołanie `GetActivationPolicy`.

Jeśli nie zostały zwrócone POINTERINACTIVE_ACTIVATEONENTRY i POINTERINACTIVE_DEACTIVATEONLEAVE flagi, następnie obiektu tylko zostanie aktywowany, gdy wskaźnik myszy znajduje się nad obiekt. Jeśli tylko Flaga POINTERINACTIVE_ACTIVATEONENTRY ma zostać zwrócona, następnie obiektu tylko zostanie aktywowane, gdy gdy wskaźnik myszy po raz pierwszy najedzie obiektu.

Można również kontrolkę, która celem OLE przeciągania i upuszczania operacji jest nieaktywny. Wymaga aktywowania kontrolki w tym momencie użytkownik przeciąga obiekt nad nim, tak, aby okna formantu może zostać zarejestrowana jako miejsca docelowego. Aby spowodować Aktywacja podczas przeciągania, zwróć flagi POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Informacje przekazywane przez `GetActivationPolicy` nie powinno być buforowane przez kontener. Zamiast tego ta metoda powinna być wywoływana za każdym razem, gdy wskaźnik myszy zostanie przesunięty nieaktywnym obiektem.

Jeśli nieaktywnym obiektem nie żąda być aktywowany, gdy wskaźnik myszy przechodzi on w miejscu, jego kontener powinny wysyłania kolejnych komunikatów WM_SETCURSOR do tego obiektu przez wywołanie metody [OnInactiveSetCursor](#oninactivesetcursor) tak długo, jak wskaźnik myszy pozostaje na obiekcie.

Włączanie `IPointerInactive` interfejsu zazwyczaj oznacza, że ma formant aby mieć możliwość przetwarzania komunikatów myszy przez cały czas. Aby uzyskać to zachowanie w kontenerze, który nie obsługuje `IPointerInactive` interfejsu, konieczne będzie mieć formantu zawsze aktywowany, gdy jest widoczne, co oznacza, że formant powinien mieć flagę OLEMISC_ACTIVATEWHENVISIBLE wśród różnych flag. Jednak aby uniknąć tej flagi z zastosowaniem w pojemniku, który obsługuje `IPointerInactive`, można również określić flagę OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

Pobiera wartość zmieniono właściwość środowiska kontenera.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parametry

*dwDispid*<br/>
Identyfikator alokacji żądanej właściwości otoczenia.

*vtProp*<br/>
Tag typu variant, który określa typ wartości, które ma zostać zwrócone w *pvProp*.

*pvProp*<br/>
Wskaźnik na adres zmiennej, która będzie odbierać wartość właściwości lub wartości zwracanej. Rzeczywisty typ wskaźnika this musi być zgodna z typem określonym przez *vtProp*.

|vtProp|Typ pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli zmieniono właściwość jest obsługiwana; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli używasz `GetAmbientProperty` można pobrać właściwości DisplayName i ScaleUnits otoczenia, ustaw *vtProp* do VT_BSTR i *pvProp* do `CString*`. Jeśli pobierasz otoczenia właściwość czcionki ustawiony *vtProp* do VT_FONT i *pvProp* do LPFONTDISP *.

Należy pamiętać, że funkcje zostały już przewidziane typowe właściwości otoczenia, takich jak [AmbientBackColor](#ambientbackcolor) i [AmbientFont](#ambientfont).

##  <a name="getappearance"></a>  COleControl::GetAppearance

Implementuje funkcję Get, podstawowe właściwości wyglądu formantu.

```
short GetAppearance ();
```

### <a name="return-value"></a>Wartość zwracana

Wartość zwracana określa bieżące ustawienie wygląd jako **krótki** wartości (VT_I2), jeśli to się powiedzie. Ta wartość wynosi zero, jeśli wygląd formantu jest stosowana jest stała i 1, jeśli wygląd formantu 3D.

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

Implementuje funkcję Get, podstawowe właściwości BackColor formantu.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Wartość zwracana

Wartość zwracana określa bieżący kolor tła jako wartość OLE_COLOR, jeśli to się powiedzie. Ta wartość mogą być tłumaczone na wartość COLORREF z wywołaniem `TranslateColor`.

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

Implementuje funkcję Get, podstawowe właściwości BorderStyle formantu.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Wartość zwracana

1, jeśli kontrolka ma obramowanie normalny; 0, jeśli kontrolka ma bez obramowania.

##  <a name="getcapture"></a>  COleControl::GetCapture

Określa, czy `COleControl` obiekt ma przechwytywanie myszy.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Wartość zwracana

Jeśli kontrolka jest aktywowany i bez okien, zwraca **to** Jeśli kontrolka ma obecnie przechwytywania (zgodnie z ustaleniami kontener formantu) lub wartość NULL, jeśli nie ma przechwytywanie myszy.

W przeciwnym razie zwraca `CWnd` obiekt, który ma przechwytywanie myszy (taka sama jak `CWnd::GetCapture`).

### <a name="remarks"></a>Uwagi

Aktywowano kontrolkę niepowiązanej z oknami odbiera myszy podczas przechwytywania [SetCapture](#setcapture) jest wywoływana.

##  <a name="getclassid"></a>  COleControl::GetClassID

Metoda wywoływana przez platformę, by pobrać identyfikator klasy OLE formantu.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parametry

*pclsid*<br/>
Wskaźnik do lokalizacji identyfikator klasy.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli wywołanie zakończyła się niepowodzeniem; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zwykle implementowany przez [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

Pobiera różnicę między lewym górnym rogu formantu prostokątny obszar i lewym górnym rogu obszaru klienckiego.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parametry

*pdxOffset*<br/>
Wskaźnik na przesunięcie w poziomie obszaru klienckiego kontrolki OLE.

*pdyOffset*<br/>
Wskaźnik na przesunięcie w pionie obszaru klienckiego kontrolki OLE.

### <a name="remarks"></a>Uwagi

Kontrolka OLE ma prostokątny obszar wewnątrz jej kontenera. Obszaru klienckiego kontrolki jest obszar formantu, z wyłączeniem obramowanie i paski przewijania. Przesunięcie pobierane przez `GetClientOffset` jest różnica między lewym górnym rogu formantu prostokątny obszar i lewym górnym rogu obszaru klienckiego. Jeśli formant ma-client elementów innych niż standardowe obramowanie i paski przewijania, należy zastąpić tej funkcji elementu członkowskiego, aby określić przesunięcie.

##  <a name="getclientrect"></a>  COleControl::GetClientRect

Pobiera rozmiar obszaru klienckiego kontrolki.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parametry

*lprect —*<br/>
Wskaźnik do `RECT` struktury zawierającej wymiary obszaru klienckiego kontrolki niepowiązanej z oknami, czyli rozmiar formantu minus obramowania okna, ramki, paski przewijania i tak dalej. *Lprect —* parametr wskazuje rozmiar kontrolki jego klienta, nie położenia.

##  <a name="getclientsite"></a>  COleControl::GetClientSite

Wysyła zapytanie do obiektu dla wskaźnika do bieżącej lokacji klienta wewnątrz jej kontenera.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do bieżącej lokacji klienta kontrolki w jego kontenerze.

### <a name="remarks"></a>Uwagi

Zwrócony wskaźnik wskazuje na wystąpienie `IOleClientSite`. `IOleClientSite` Interfejs implementowany przez kontenery, znajduje się obiekt kontekst: miejsca w dokumencie, w którym pobiera jego magazyn, interfejs użytkownika i innych zasobów, w której jest zakotwiczona.

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

Pobiera ustawienia flagi kontroli.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Wartość zwracana

/ / Zsumowanie logiczne kombinacją flag w wyliczeniu ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Uwagi

Domyślnie `GetControlFlags` zwraca `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Jeśli ustawiona, funkcja używa begin programu paint przeznaczonym dla formantów OLE zamiast [BeginPaint](/windows/desktop/api/winuser/nf-winuser-beginpaint) interfejsu API (ustawienie domyślne).|
|`clipPaintDC`|Jeśli nie zostanie ustawiona, wyłącza wywołanie `IntersectClipRect` przez `COleControl` i uzyskuje korzyści małej szybkości. Jeśli używasz aktywacji niepowiązanej z oknami flaga nie wywiera żadnego wpływu.|
|`pointerInactive`|Jeśli ustawiona, zapewnia interakcji z myszą, mimo że formant jest nieaktywny przez włączenie `COleControl`przez implementację `IPointerInactive` interfejs, który jest domyślnie wyłączona.|
|`noFlickerActivate`|Jeśli ustawiona, eliminuje operacji bardzo rysowania i towarzyszące migotania visual. Opcja używana podczas Twoja kontrolka rysuje samą siebie identycznie w Stanach nieaktywne i aktywne. Jeśli używasz aktywacji niepowiązanej z oknami flaga nie wywiera żadnego wpływu.|
|`windowlessActivate`|Jeśli ustawiona, wskazuje kontroli nad używa aktywacji niepowiązanej z oknami.|
|`canOptimizeDraw`|Jeśli ustawiona, wskazuje, że kontrolka będzie wykonywać zoptymalizowanego rysowania, jeśli kontener obsługuje tę funkcję.|

Aby uzyskać więcej informacji na temat `GetControlFlags` zobaczyć inne optymalizacje formantów OLE [kontrolek ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

Pobiera rozmiar okna kontrolki OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parametry

*pcx*<br/>
Określa szerokość formantu w pikselach.

*pcy*<br/>
Określa wysokość formantu w pikselach.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że wszystkie współrzędne dla systemu windows formantu względem lewego górnego rogu kontrolki.

##  <a name="getdc"></a>  COleControl::GetDC

Zapewnia obiekt bez okien do kontekstu urządzenia get ekranu (lub zgodny), z jego kontenerem.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parametry

*lprcRect*<br/>
Wskaźnik do prostokąta niepowiązanej z oknami kontroli chce, aby odświeżyć we współrzędnych klienta formantu. Wartość NULL oznacza pełną obiektu zakresu.

*Flagidw*<br/>
Atrybuty rysowania kontekstu urządzenia. Dostępne są następujące opcje:

- OLEDC_NODRAW wskazuje, że obiekt nie umożliwia wykonywania żadnych rysowania ale jedynie, aby uzyskać informacje na temat urządzenia wyświetlającego kontekstu urządzenia. Kontener należy po prostu przekazać DC okna bez dalszego przetwarzania.

- Żądania OLEDC_PAINTBKGND, czy kontener rysowania tła przed powrotem do kontrolera domeny. Obiekt należy używać tej flagi, gdy żąda kontrolera domeny do ponownego narysowania obszaru z przezroczystym tłem.

- OLEDC_OFFSCREEN informuje kontenera, w którym obiekt chce renderowania w bitmapy poza ekranem, który następnie powinny zostać skopiowane do ekranu. Podczas operacji rysowania, którego chcesz wykonać generuje wiele migotania, obiekt należy używać tej flagi. Kontener jest bezpłatne uznaje to żądanie, czy nie. Jednak jeśli ta flaga nie jest ustawiona, kontener musi ponownie przekazanie na ekranie kontrolera domeny. Dzięki temu obiektów do wykonywania operacji bezpośrednie ekranu, takich jak pokazywanie zaznaczenia (za pośrednictwem **XOR** operacji).

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do kontekstu urządzenia wyświetlaną w kontenerze `CWnd` obszaru klienckiego Jeśli pomyślnie; w przeciwnym razie wartość zwracana jest wartość NULL. Kontekst urządzenia ekranu może służyć w kolejnych funkcji GDI do rysowania w obszarze klienta okna kontenera.

### <a name="remarks"></a>Uwagi

[ReleaseDC](#releasedc) należy wywołać funkcję elementu członkowskiego do wydania kontekstu po malowania. Podczas wywoływania `GetDC`, obiekty przekazać prostokąt chcą Rysowanie w w ich własnych współrzędne klienta. `GetDC` tłumaczy je na współrzędne obszaru klienckiego kontenera. Obiekt nie będą wymagać żądaną prostokąt rysowania przekracza swój własny prostokąta obszaru klienta, rozmiar, które mogą być pobierane z [GetClientRect](#getclientrect). Zapobiega to przypadkowo rysowania, których nie mają obiektów.

##  <a name="getenabled"></a>  COleControl::GetEnabled

Implementuje funkcję Get kontroli nad zasobów Właściwość Enabled.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli kontrolka jest włączona; w przeciwnym razie 0.

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

Uzyskuje wskaźnik do obiektu utrzymywane przez kontener, który reprezentuje kontrolkę za pomocą rozszerzonych zbiór właściwości.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do kontenera w rozszerzonych obiekt formantu. Jeśli żaden obiekt nie jest dostępny, wartość jest równa NULL.

Ten obiekt może być zmieniane za pośrednictwem jego `IDispatch` interfejsu. Można również użyć `QueryInterface` uzyskanie innych dostępnych dostarczanych przez obiekt. Obiekt nie jest wymagany do obsługi określonego zestawu interfejsów. Należy pamiętać, że polegania na określonych funkcji kontener formantu rozszerzonego ogranicza przenoszenia kontrolki do innych kontenerów dowolnego.

### <a name="remarks"></a>Uwagi

Funkcja, która wywołuje tę funkcję, jest odpowiedzialny za wskaźnika, po zakończeniu pracy nad obiekt. Należy pamiętać, że kontener nie jest wymagany do obsługi tego obiektu.

##  <a name="getfocus"></a>  COleControl::GetFocus

Określa, czy `COleControl` obiekt ma fokus.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Wartość zwracana

Jeśli kontrolka jest aktywowany i bez okien, zwraca **to** Jeśli kontrolka ma obecnie skupić się (zgodnie z ustaleniami kontener formantu) lub wartość NULL, jeśli nie ma fokus klawiatury.

W przeciwnym razie zwraca `CWnd` obiektu, który ma fokus (taka sama jak `CWnd::GetFocus`).

### <a name="remarks"></a>Uwagi

Aktywowane bez okien formant uzyskuje fokus podczas [SetFocus](#setfocus) jest wywoływana.

##  <a name="getfont"></a>  COleControl::GetFont

Implementuje właściwości czcionki zasobów funkcję Get.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do interfejs ekspedycji czcionki zasobów formantu właściwość czcionki.

### <a name="remarks"></a>Uwagi

Należy pamiętać, że obiekt wywołujący musi zwolnić obiekt po zakończeniu. W ramach implementacji kontrolki, należy użyć `InternalGetFont` dostępu do podstawowego obiektu czcionki formantu. Aby uzyskać więcej informacji na temat korzystania z czcionek w kontrolce, zobacz artykuł [kontrolek ActiveX: Używanie czcionek w kontrolce ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

Mierzy metryki tekst dla każdego `CFontHolder` obiektów należących do formantu.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Wskaźnik do [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) struktury.

*fontHolder*<br/>
Odwołanie do [CFontHolder](../../mfc/reference/cfontholder-class.md) obiektu.

### <a name="remarks"></a>Uwagi

Takie czcionki można wybrać z [COleControl::SelectFontObject](#selectfontobject) funkcji. `GetFontTextMetrics` zainicjuje `TEXTMETRIC` wskazywanej przez *lptm* prawidłowych metryk informacje na temat `fontHolder`użytkownika czcionki, jeśli kończy się pomyślnie lub wprowadź strukturę zerami, jeśli to nie powiodło się. Należy użyć tej funkcji, zamiast [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) podczas malowanie kontrolki, ponieważ formanty, takie jak dowolne osadzonych obiektów OLE może być wymagane do renderowania samodzielnie w metaplik.

`TEXTMETRIC` Struktury jest domyślna czcionka odświeżane, gdy [SelectFontObject](#selectfontobject) funkcja jest wywoływana. Należy wywołać `GetFontTextMetrics` tylko po wybraniu właściwości czcionki zasobów w celu zapewnienia informacji zapewnia prawidłowe.

##  <a name="getforecolor"></a>  COleControl::GetForeColor

Implementuje funkcję Get, podstawowe właściwości ForeColor.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Wartość zwracana

Wartość zwracana określa bieżący kolor pierwszego planu jako wartość OLE_COLOR, jeśli to się powiedzie. Ta wartość może być przekonwertowana na [COLORREF](/windows/desktop/gdi/colorref) wartości z wywołaniem `TranslateColor`.

##  <a name="gethwnd"></a>  COleControl::GetHwnd

Implementuje funkcję Get właściwości hWnd podstawowe.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Wartość zwracana

Uchwyt okna kontrolkę OLE, jeśli takie istnieją; w przeciwnym razie wartość NULL.

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

Wywoływane przez platformę, by uzyskać krótkiego ciągu, który opisuje przeznaczenie identyfikowane przez element menu *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parametry

*nID*<br/>
Identyfikator elementu menu.

*rMessage*<br/>
Odwołanie do [CString](../../atl-mfc-shared/reference/cstringt-class.md) obiektu za pomocą którego zostanie zwrócony ciąg.

### <a name="remarks"></a>Uwagi

Może to służyć uzyskać komunikat do wyświetlenia na pasku stanu, gdy element menu zostanie wyróżniona. Domyślna implementacja próbuje załadować ciągu zasobu zidentyfikowanego z użyciem *nID*.

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

Uniemożliwia dostęp do wartości właściwości kontrolki przez użytkownika.

```
void GetNotSupported();
```

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, zamiast funkcji Get dowolnej właściwości, w którym pobieranie właściwości według kontrolki użytkownika nie jest obsługiwane. Jednym z przykładów byłoby właściwości, która jest tylko do zapisu.

##  <a name="getreadystate"></a>  COleControl::GetReadyState

Zwraca stan gotowości kontrolki.

```
long GetReadyState();
```

### <a name="return-value"></a>Wartość zwracana

Stan gotowości kontrolki, jedną z następujących wartości:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Stan inicjowania domyślnego|
|READYSTATE_LOADING|Obecnie ładowania właściwości formantu|
|READYSTATE_LOADED|Kontrolka została zainicjowana.|
|READYSTATE_INTERACTIVE|Kontrolka ma wystarczającej ilości danych w interaktywne, ale jeszcze ładowania danych nie wszystkie asynchroniczne|
|READYSTATE_COMPLETE|Kontrolka ma swoje dane|

### <a name="remarks"></a>Uwagi

Większości prostych kontrolek nigdy nie należy do rozróżnienia między ZAŁADOWANY i interakcyjne. Jednak formantów, które obsługują właściwości ścieżki danych nie może być gotowe do przeniesienia interaktywne asynchronicznie otrzymanie przynajmniej części danych. Formant powinien próbować stać się interakcyjne tak szybko, jak to możliwe.

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

Uzyskuje współrzędnych prostokąta kontroli względem kontenera wyrażona w jednostkach urządzenia.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lprect —*<br/>
Wskaźnik do struktury prostokąt, do którego zostaną skopiowane współrzędne formantu.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli kontrolka jest aktywny w miejscu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Prostokąt jest tylko wtedy, gdy kontrolka jest aktywny w miejscu.

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

Mierzy metryki tekstu dla formantu właściwości czcionki zasobów, które można wybrać z [selectstockfont —](#selectstockfont) funkcji.

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parametry

*lptm*<br/>
Wskaźnik do [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) struktury.

### <a name="remarks"></a>Uwagi

`GetStockTextMetrics` Zainicjuje funkcja `TEXTMETRIC` wskazywanej przez *lptm* przy użyciu informacji o prawidłowych metryk, jeśli kończy się pomyślnie lub wypełnienie, strukturze zerami, jeśli nie powiodło się. Użyj tej funkcji, zamiast [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) podczas malowanie kontrolki, ponieważ formanty, takie jak dowolne osadzonych obiektów OLE może być wymagane do renderowania samodzielnie w metaplik.

`TEXTMETRIC` Struktury jest domyślna czcionka odświeżane, gdy `SelectStockFont` funkcja jest wywoływana. Tę funkcję, należy wywołać tylko wtedy, gdy wybór zapasów czcionki do zapewnienia informacji zawartych w nim jest nieprawidłowa.

##  <a name="gettext"></a>  COleControl::GetText

Implementuje funkcję Get, podstawowe właściwości Text lub Caption.

```
BSTR GetText();
```

### <a name="return-value"></a>Wartość zwracana

Bieżąca wartość ciągu tekstowego kontrolki lub ciągiem o zerowej długości, jeśli ciąg nie jest obecny.

> [!NOTE]
>  Aby uzyskać więcej informacji na typ danych, zobacz [typy danych](../../mfc/reference/data-types-mfc.md) w sekcji makra i funkcje globalne.

### <a name="remarks"></a>Uwagi

Należy zauważyć, że obiekt wywołujący tę funkcję, należy wywołać `SysFreeString` w ciągu zwracane do bezpłatnego zasobu. W ramach implementacji kontrolki, należy użyć `InternalGetText` dostępu podstawowe właściwości Text lub Caption formantu do.

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

Zastąp `GetWindowlessDropTarget` kiedy chcesz kontrolce celem OLE przeciąganie i upuszczanie działania.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do obiektu `IDropTarget` interfejsu. Ponieważ nie ma w oknie, nie można zarejestrować obiektu bez okien `IDropTarget` interfejsu. Jednak aby uczestniczyć w operacji przeciągania i upuszczania, bez okien obiektu można nadal implementować interfejs i zwrócić go w `GetWindowlessDropTarget`.

### <a name="remarks"></a>Uwagi

Zwykle wymagałoby to, że okno Kontrola zostać zarejestrowana jako miejsca docelowego. Jednak ponieważ kontrolka nie ma żadnych własnego okna, kontener użyje osobnym oknie jako miejsca docelowego. Kontrolka po prostu musi dostarczać implementację `IDropTarget` interfejsu, do którego kontener mogą delegować uprawnienia do wywołania w odpowiednim czasie. Na przykład:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

Informuje o IID kontrolka będzie używać klasy bazowej.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parametry

*piidPrimary*<br/>
Wskaźnik do interfejsu identyfikator formantu podstawowy interfejs ekspedycji.

*piidEvents*<br/>
Wskaźnik do Identyfikatora interfejsu interfejsu zdarzenia formantu.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję w Konstruktorze formantu do informowania klasy bazowej interfejsu identyfikatory formant, który będzie używany.

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

Uzyskuje dostęp do właściwości czcionki zasobów kontrolki

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Wartość zwracana

Odwołanie do [CFontHolder](../../mfc/reference/cfontholder-class.md) obiekt, który zawiera podstawowe obiektu czcionki.

##  <a name="internalgettext"></a>  COleControl::InternalGetText

Uzyskuje dostęp do właściwości Text lub Caption podstawowych kontrolki.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Wartość zwracana

Odwołanie do sterowania ciąg tekstowy.

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

Ustawia stan gotowości kontrolki.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parametry

*lNewReadyState*<br/>
Stan gotowości, aby ustawić dla formantu, jedną z następujących wartości:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Stan inicjowania domyślnego|
|READYSTATE_LOADING|Obecnie ładowania właściwości formantu|
|READYSTATE_LOADED|Kontrolka została zainicjowana.|
|READYSTATE_INTERACTIVE|Kontrolka ma wystarczającej ilości danych w interaktywne, ale jeszcze ładowania danych nie wszystkie asynchroniczne|
|READYSTATE_COMPLETE|Kontrolka ma swoje dane|

### <a name="remarks"></a>Uwagi

Większości prostych kontrolek nigdy nie należy do rozróżnienia między ZAŁADOWANY i interakcyjne. Jednak formantów, które obsługują właściwości ścieżki danych nie może być gotowe do przeniesienia interaktywne asynchronicznie otrzymanie przynajmniej części danych. Formant powinien próbować stać się interakcyjne tak szybko, jak to możliwe.

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

Wymusza formantu do narysowania.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*lprect —*<br/>
Wskaźnik do regionu tej kontrolki unieważnione.

*bErase*<br/>
Określa, czy ma zostać wymazane, po przetworzeniu region aktualizacji tła w obrębie regionu aktualizacji.

### <a name="remarks"></a>Uwagi

Jeśli *lprect —* ma wartość NULL, zostanie narysowany ponownie całego kontroli. Jeśli *lprect —* nie ma wartości NULL, oznacza to część prostokącie kontrolki, która ma zostać unieważnione. W przypadkach, gdzie formant ma żadnego okna lub nie jest obecnie aktywna, prostokąta jest ignorowane i wykonywane jest wywołanie, aby lokacja klienta [IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange) funkcja elementu członkowskiego. Użyj tej funkcji, zamiast `CWnd::InvalidateRect` lub `InvalidateRect`.

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

Unieważnia obszaru klienckiego okna kontenera w obrębie danego regionu.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametry

*pRgn*<br/>
Wskaźnik do [CRgn](../../mfc/reference/crgn-class.md) obiekt, który identyfikuje region wyświetlania obiektu OLE do unieważnienia we współrzędnych klienta okna nadrzędnego. Jeśli ten parametr ma wartość NULL, zakres, w jakim jest cały obiekt.

*bErase*<br/>
Określa, czy ma zostać wymazane, tła w obrębie regionu nieważne. W przypadku opcji TRUE tle są usuwane. W przypadku wartości FAŁSZ tło pozostaje niezmieniony.

### <a name="remarks"></a>Uwagi

Może to służyć ponowne kontrolek bez okien w kontenerze. Region unieważniany, wraz z innych obszarów w regionie aktualizacji jest oznaczony do malowania, kiedy następnym [WM_PAINT](/windows/desktop/gdi/wm-paint) zostanie wysłana wiadomość.

Jeśli *bErase* ma wartość TRUE dla dowolnej części regionu aktualizacji, tło cały region, a nie tylko w danej części, są usuwane.

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

Umożliwia ładowanie wyspecjalizowane kontrolki OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli kontrolka jest przekształcany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Podczas konwertowania formularz, który używa VBX kontroluje na taki, który używa formantów OLE, kod ładujący specjalne dla formantów OLE mogą być wymagane. Na przykład, jeśli są ładowane wystąpienie kontrolki OLE, Niewykluczone, że wywołanie [px_font —](persistence-of-ole-controls.md#px_font) w swojej `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Jednak formantów VBX nie ma obiektu czcionki; Każda właściwość czcionki została zapisana indywidualnie. W tym przypadku używasz `IsConvertingVBX` na rozróżnienie tych dwóch przypadkach:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Innym przypadku będzie, jeśli formant VBX zapisane zastrzeżonych danych binarnych (w jego VBM_SAVEPROPERTY program obsługi komunikatów) i kontroli nad OLE zapisuje swoje dane binarne w innym formacie. Jeśli chcesz, aby kontrolka OLE jako starszymi wersjami za pomocą kontrolki VBX można odczytać zarówno stare i nowe formatów przy użyciu `IsConvertingVBX` funkcji przy rozróżnianiu czy ładowania VBX kontrolki lub kontrolki OLE.

W swojej kontrolce `DoPropExchange` funkcji, można sprawdzić, czy ten warunek i w przypadku opcji true na wykonanie kodu obciążenia specyficzne dla tej konwersji (na przykład w poprzednich przykładach). Jeśli formant nie jest przekształcany, można wykonać normalnego obciążenia kodu. Tę możliwość ma zastosowanie tylko do konwersji z VBX odpowiedniki formantów.

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

Umożliwia wywołanie metody automatyzacji.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli formant został zainicjowany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Implementacja struktury `IDispatch::Invoke` wywołania `IsInvokeAllowed` do określenia, czy daną funkcję (identyfikowane przez `dispid`) mogą być wywoływane. Domyślne zachowanie dla formantu OLE jest umożliwienie automatyzacji metody można wywołać tylko wtedy, gdy kontrolka została zainicjowana; jednak `IsInvokeAllowed` jest funkcją wirtualną i może zostać zastąpiona w razie (na przykład, gdy kontrolka jest on używany jako serwer automatyzacji).

##  <a name="ismodified"></a>  COleControl::IsModified

Określa, jeśli stan formantu został zmodyfikowany.

```
BOOL IsModified();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli stan formantu został zmieniony od ostatniego zachowywania; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Stan formantu został zmodyfikowany po zmianie wartości pola właściwości.

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

Określa, czy kontener obsługuje zoptymalizowanego rysowania dla bieżącej operacji rysowania.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Wartość zwracana

Wartość TRUE, jeśli kontener obsługuje zoptymalizowanego rysowania dla bieżącej operacji rysowania; w przeciwnym razie wartość FALSE.

### <a name="remarks"></a>Uwagi

Jeśli zoptymalizowanego rysowania jest obsługiwany, formant muszą nie wybierz stare obiekty (pióra, pędzle, czcionki, itp.) w kontekście urządzenia po zakończeniu operacji rysowania.

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

Metoda wywoływana przez platformę, aby określić, jeśli kontrolka jest podklasą Windows kontrolować także sam.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli kontrolka jest podklasą klasy; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję i zwraca wartość PRAWDA, jeśli Twoja OLE kontrolować podklasy kontrolki Windows.

##  <a name="load"></a>  COleControl::Load

Resetuje wszystkie poprzednie dane ładowane asynchronicznie i inicjuje nowy Ładowanie asynchroniczne właściwości formantu.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parametry

*strNewPath*<br/>
Wskaźnik do ciągu zawierającego ścieżką, która odwołuje się lokalizacja bezwzględna właściwości kontrolki asynchronicznego.

*Prop*<br/>
A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) obiekt implementujący właściwości kontrolki asynchronicznego.

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

Zapobiega dezaktywowanie formant kontenera.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parametry

*Blok*<br/>
Wartość TRUE, jeśli aktywny w miejscu stan formantu jest zablokowany; Wartość FALSE, jeśli do odblokowania.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli blokada powiodła się. w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy pamiętać o tym, czy każdy blokowania kontrolki musi łączyć się z odblokowywania kontroli po zakończeniu. Powinna tylko zablokować formantu do krótkich okresów, takie jak podczas wyzwalania zdarzenia.

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

Wywoływane przez platformę, gdy zmieniono właściwość środowiska kontenera zmieniono wartość.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parametry

*dispID*<br/>
Identyfikator wysyłania zmieniona właściwość otoczenia lub DISPID_UNKNOWN, jeśli zmieniły się wiele właściwości.

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości wyglądu podstawowego.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości. Domyślna implementacja wywołuje `InvalidateControl`.

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości BackColor zapasów.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości. Domyślna implementacja wywołuje `InvalidateControl`.

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości BorderStyle zapasów.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `InvalidateControl`.

Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości.

##  <a name="onclick"></a>  COleControl::OnClick

Wywoływane przez platformę, gdy kliknięto przycisk myszy lub metodę DoClick zostało wywołane.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parametry

*iButton*<br/>
Indeks przycisk myszy. Może mieć jedną z następujących wartości:

- Został kliknięty LEFT_BUTTON lewego przycisku myszy.

- Został kliknięty MIDDLE_BUTTON środkowego przycisku myszy.

- RIGHT_BUTTON, który został kliknięty prawym przyciskiem myszy.

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `COleControl::FireClick`.

Zastąpienie tej funkcji elementu członkowskiego, modyfikacji lub domyślna obsługa rozszerzenia.

##  <a name="onclose"></a>  COleControl::OnClose

Wywoływane przez platformę, gdy kontener wywołał formantu `IOleControl::Close` funkcji.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parametry

*dwSaveOption*<br/>
Flaga wskazująca, czy obiekt powinien zostać zapisany przed załadowaniem. Prawidłowe wartości to:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Uwagi

Domyślnie `OnClose` zapisuje obiekt formantu, jeśli został zmodyfikowany i *dwSaveOption* OLECLOSE_SAVEIFDIRTY lub OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

Wywoływane przez platformę, gdy kontener wywoła `IOleObject::DoVerb` funkcja elementu członkowskiego.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*iVerb*<br/>
Indeks zlecenia kontrolki do wywołania.

*lpMsg*<br/>
Wskaźnik do komunikat Windows, który spowodował zlecenia do wywołania.

*hWndParent*<br/>
Dojście do nadrzędnego okna kontrolki. W przypadku wykonywania zlecenie tworzy okno (lub windows), *hWndParent* powinien być używany jako element nadrzędny.

*lprect —*<br/>
Wskaźnik do struktury Prostokąt, do którego zostaną skopiowane współrzędne formantu względem kontenera.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja używa ON_OLEVERB i ON_STDOLEVERB wpisy mapy komunikatów do określenia prawidłowego funkcja do wywołania.

Należy przesłonić tę funkcję, aby zmienić domyślne obsługi zlecenie.

##  <a name="ondraw"></a>  COleControl::OnDraw

Metoda wywoływana przez platformę, by narysować kontrolkę OLE w określonym prostokąt otaczający w kontekście określonego urządzenia.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parametry

*podstawowego kontrolera domeny*<br/>
Kontekst urządzenia, w której występuje rysunku.

*rcBounds*<br/>
Prostokątny obszar kontrolki, w tym obramowania.

*rcInvalid*<br/>
Prostokątny obszar formant, który jest nieprawidłowy.

### <a name="remarks"></a>Uwagi

`OnDraw` jest zwykle nazywany do wyświetlania na ekranie, przekazując ekranu kontekstu urządzenia jako *kontrolera pDC*. *RcBounds* parametr identyfikuje prostokąt w kontekście urządzenia docelowego (względem jego bieżący tryb mapowanie). *RcInvalid* parametr jest rzeczywista prostokąt, który jest nieprawidłowy. W niektórych przypadkach będzie mniejszy obszar niż *rcBounds*.

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

Metoda wywoływana przez platformę, by narysować kontrolkę OLE w określonym prostokąt otaczający przy użyciu określonego meta pliku kontekstu urządzenia.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametry

*podstawowego kontrolera domeny*<br/>
Kontekst urządzenia, w której występuje rysunku.

*rcBounds*<br/>
Prostokątny obszar kontrolki, w tym obramowania.

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje [OnDraw](#ondraw) funkcji.

##  <a name="onedit"></a>  COleControl::OnEdit

Powoduje, że formant aby być uaktywniany z UI.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Wskaźnik do komunikatu Windows, która wywołała zlecenie.

*hWndParent*<br/>
Dojście do nadrzędnego okna kontrolki.

*lprect —*<br/>
Wskaźnik do prostokąta używany przez formant w kontenerze.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli wywołanie się kończy się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ma to ten sam skutek jak zlecenie OLEIVERB_UIACTIVATE formantu.

Ta funkcja jest zwykle używana jako funkcja obsługi ON_OLEVERB wpisu mapy wiadomości. Dzięki temu czasownik "Edit" dostępne w menu "Object" formantu. Na przykład:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości Enabled zasobów.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości. Domyślna implementacja wywołuje [InvalidateControl](#invalidatecontrol).

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

Wywoływane przez platformę, gdy kontener wywoła `IOleObject::EnumVerbs` funkcja elementu członkowskiego.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parametry

*ppenumOleVerb*<br/>
Wskaźnik do `IEnumOLEVERB` obiekt, który wylicza zlecenia kontrolki.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli zlecenia są dostępne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja wylicza wpisy ON_OLEVERB w mapie wiadomości.

Przesłonić tę funkcję, aby zmienić domyślną metodą wyliczanie zleceń.

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

Wywoływane przez platformę, gdy program obsługi zdarzeń jest podłączony do lub odłączony od kontrolkę OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parametry

*bAdvise*<br/>
Wartość TRUE wskazuje, że program obsługi zdarzeń została podłączona do formantu. Wartość FALSE wskazuje, że program obsługi zdarzeń został odłączony od formantu.

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości zapasów czcionki.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `COleControl::InvalidateControl`. Jeśli kontrolka jest tworzenie podklasy kontrolki Windows, domyślną implementację również wysyła komunikat WM_SETFONT do okna formantu.

Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

Wywoływane przez platformę, gdy zmieniono wartość właściwości ForeColor zapasów.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `InvalidateControl`.

Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości.

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

Wywoływane przez platformę po wywołania kontenera `IOleControl::FreezeEvents`.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parametry

*bFreeze*<br/>
Wartość TRUE, jeśli kontrolka jest zamrożony obsługi zdarzeń; w przeciwnym razie wartość FALSE.

### <a name="remarks"></a>Uwagi

Domyślna implementacja nic nie robi.

Należy przesłonić tę funkcję, jeśli dodatkowe zachowanie podczas obsługi zdarzeń jest zablokowane lub są.

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

Wywoływane przez platformę, gdy kontener wywoła `IViewObject::GetColorSet` funkcja elementu członkowskiego.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parametry

*ptd*<br/>
Wskazuje urządzenie docelowe, dla którego obraz powinien być renderowany. Jeśli ta wartość wynosi NULL, obraz powinien być renderowany dla domyślnego urządzenia, zwykle urządzeniu.

*hicTargetDev*<br/>
Określa kontekst informacji na urządzeniu docelowym, wskazywanym przez *ptd*. Ten parametr może być kontekstu urządzenia, ale nie jest jednym niekoniecznie. Jeśli *ptd* ma wartość NULL, *hicTargetDev* również powinna być równa NULL.

*ppColorSet*<br/>
Wskaźnik do lokalizacji, do którego powinny zostać skopiowane zestaw kolorów, które będzie używane. Jeśli funkcja nie zwraca zestaw kolorów, zwracana jest wartość NULL.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli zwracany jest zestaw prawidłowym kolorem; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Kontener wywoła tę funkcję, aby uzyskać wszystkie kolory, które są potrzebne, aby narysować kontrolkę OLE. Kontener może korzystać Ustawia kolor uzyskane w połączeniu z kolorami, należy ją ustawić ogólną palety kolorów. Domyślna implementacja zwraca wartość FALSE.

Należy przesłonić tę funkcję, aby wykonywać żadnych specjalnych przetwarzanie tego żądania.

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

Wywoływane przez platformę, gdy kontener formantu zażądał informacji na temat kontroli.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parametry

*pControlInfo*<br/>
Wskaźnik do [CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo) struktury do wypełnienia.

### <a name="remarks"></a>Uwagi

Te informacje składa się przede wszystkim opis klawiszami mnemoników formantu. Wypełnia implementacji domyślnej *pControlInfo* przy użyciu informacji domyślnych.

Należy przesłonić tę funkcję, jeśli formant musi przetworzyć klawiszami mnemoników.

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

Wywoływane przez platformę, by uzyskać ciąg reprezentujący bieżącą wartość właściwości identyfikowane przez *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parametry

*identyfikator DISPID*<br/>
Identyfikator wysyłania właściwości formantu.

*strValue*<br/>
Odwołanie do [CString](../../atl-mfc-shared/reference/cstringt-class.md) obiektu za pomocą którego zostanie zwrócony ciąg.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli ciąg został zwrócony w *strValue;* w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, jeśli formant ma właściwość, którego wartość nie może zostać bezpośrednio przekonwertowany na ciąg i ma wartość właściwości do wyświetlenia w przeglądarce właściwości podane w kontenerze.

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

Wywoływane przez platformę, gdy kontrolka jest aktywowana można uzyskać z menu do scalenia do istniejącego menu kontenera w interfejsie użytkownika.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Wartość zwracana

Uchwyt menu kontrolki lub wartość NULL, jeśli kontrolka ma wartość none. Domyślna implementacja zwraca wartość NULL.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji o scalaniu zasoby OLE, zobacz artykuł [menu i zasoby (OLE)](../../mfc/menus-and-resources-ole.md).

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

Metoda wywoływana przez strukturę w odpowiedzi na kontenerze `IViewObjectEx::GetNaturalExtent` żądania.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Określa, jak obiekt może być reprezentowana. Reprezentacje obejmują zawartość, ikony, miniaturę lub wydrukować dokument. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) lub DVASPECT2.

*lindex*<br/>
Część obiektu, który ma znaczenie. Aktualnie tylko wartości -1 jest prawidłowy.

*ptd*<br/>
Wskazuje [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) struktury Definiowanie urządzenie docelowe, dla którego ma zostać zwrócony rozmiar obiektu.

*hicTargetDev*<br/>
Określa kontekst informacji dla urządzeń docelowych, wskazywanym przez *ptd* parametru, z którego obiekt można wyodrębnić metryki urządzenia i przetestować jego możliwości. Jeśli *ptd* ma wartość NULL, obiekt powinien ignorować wartość *hicTargetDev* parametru.

*pExtentInfo*<br/>
Wskazuje `DVEXTENTINFO` strukturę, która określa danych zmiany rozmiaru. `DVEXTENTINFO` Struktura jest:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Element członkowski struktury `dwExtentMode` może mieć jedną z dwóch wartości:

- DVEXTENT_CONTENT zapytanie, jak duże formant powinien być dokładnie dopasowana do zawartości (przystawki — rozmiar)

- DVEXTENT_INTEGRAL podczas zmiany rozmiaru, należy przekazać proponowany rozmiar do kontrolki

*psizel*<br/>
Wskazuje rozmiaru danych zwróconych przez kontrolkę. Dane zwrócone ustalania rozmiaru jest równa -1 dla każdego wymiaru, która nie została dostosowana.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli pomyślnie zwraca lub ustawia rozmiar; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Przesłonić tę funkcję, aby zwrócić rozmiar wyświetlania obiektu najbliżej proponowany rozmiar i zakresu tryb `DVEXTENTINFO` struktury. Domyślna implementacja zwraca wartość FALSE i sprawia, że nie zmiany rozmiaru.

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

Metoda wywoływana przez platformę, by uzyskać zestaw wstępnie zdefiniowanych ciągów reprezentujących możliwych wartości dla właściwości.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parametry

*identyfikator DISPID*<br/>
Identyfikator wysyłania właściwości formantu.

*pStringArray*<br/>
Tablica ciągu, który ma zostać wypełniony przy użyciu wartości zwracane.

*pCookieArray*<br/>
Tablica typu DWORD, ma zostać wypełniony przy użyciu wartości zwracane.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli elementy zostały dodane do *pStringArray* i *pCookieArray*.

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, jeśli formant ma właściwość o zestaw możliwych wartości, które mogą być reprezentowane przez parametry. Dla każdego elementu dodane do *pStringArray*, należy dodać odpowiedni element "plików cookie", aby *pCookieArray.* Te wartości "plików cookie" później mogą być przekazywane przez platformę, by `COleControl::OnGetPredefinedValue` funkcji.

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

Wywoływane przez platformę, aby uzyskać wartość jednego z ciągów wstępnie zdefiniowanych wcześniej zwracany przez nadpisanie `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parametry

*identyfikator DISPID*<br/>
Identyfikator wysyłania właściwości formantu.

*dwCookie*<br/>
Wartość pliku cookie, wcześniej zwracany przez nadpisanie `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
Wskaźnik do `VARIANT` struktury za pomocą którego zostanie zwrócona wartość właściwości.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli wartość została zwrócona w *lpvarOut*; w przeciwnym razie 0.

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

Metoda wywoływana przez strukturę w odpowiedzi na kontenerze [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) żądania.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parametry

*dwDrawAspect*<br/>
DWORD opisujący, które tworzą lub aspekcie obiektu ma być wyświetlana. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) lub DVASPECT2.

*lindex*<br/>
Część obiektu, który ma znaczenie. Aktualnie tylko wartości -1 jest prawidłowy.

*ptd*<br/>
Wskazuje [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) struktury Definiowanie urządzenie docelowe, dla którego ma zostać zwrócony rozmiar obiektu.

*lpsizel*<br/>
Wskazuje lokalizację, w której zwracany jest rozmiar obiektu.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli informacje o zakresie pomyślnie jest zwracana; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, jeśli formant używa dwuprzebiegową rysowania i jej części nieprzezroczystych i przejrzyste mają różne wymiary.

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

Metoda wywoływana przez strukturę w odpowiedzi na kontenerze `IViewObjectEx::GetRect` żądania.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
DWORD opisujący, które tworzą lub aspekcie obiektu ma być wyświetlana. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) lub DVASPECT2:

- Prostokąt blokujących DVASPECT_CONTENT całego obiektu. Lewy górny róg w lokalizacji i rozmiarze równym stopniu zwrócona przez obiekt `GetViewExtent` *.*

- Obiekty DVASPECT_OPAQUE prostokątny obszar nieprzezroczyste Zwróć tego prostokąta. Inne zakończyć się niepowodzeniem.

- Prostokąt DVASPECT_TRANSPARENT obejmujące wszystkie części przezroczyste lub nieprawidłowo.

*pRect*<br/>
Wskazuje [RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907) struktury, określając prostokąt, w którym ma być rysowany obiektu. Ten parametr określa pozycjonowanie i rozciąganie obiektu.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli pomyślnie zwracana jest prostokąt o rozmiarze do obiektu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Rozmiar obiektu jest konwertowany przez `OnGetViewRect` do prostokąta, zaczynając od określonej pozycji (wartość domyślna to lewym górnym rogu ekranu). Należy przesłonić tę funkcję, jeśli formant używa dwuprzebiegową rysowania i jej części nieprzezroczystych i przejrzyste mają różne wymiary.

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

Metoda wywoływana przez strukturę w odpowiedzi na kontenerze `IViewObjectEx::GetViewStatus` żądania.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Wartość zwracana

Jedna z wartości wyliczenia stan, jeśli to się powiedzie; w przeciwnym razie 0. Możliwe wartości to dowolnej kombinacji następujących czynności:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Obiekt jest całkowicie nieprzezroczysty. Jeśli ten bit nie jest ustawiona, obiekt zawiera przezroczyste części. Ten bit ma zastosowanie tylko aspektów związanych z zawartością, a nie DVASPECT_ICON lub DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Obiekt ma jednolite tło (składający się jednolitego koloru, nie zaś wzoru pędzla). Ten bit ma znaczenie tylko wtedy, gdy VIEWSTATUS_OPAQUE ustawiono dotyczy tylko aspektów związanych z zawartością, a nie DVASPECT_ICON lub DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Obiekt obsługuje DVASPECT_OPAQUE. Wszystkie metody IViewObjectEx przyjmujące aspekt rysowania parametr można wywołać ten aspekt.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Obiekt obsługuje DVASPECT_TRANSPARENT. Wszystkie `IViewObjectEx` metod, dla których aspekt rysowania jako parametr można wywołać ten aspekt.|

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, jeśli formant używa dwuprzebiegową rysowania. Domyślna implementacja zwraca VIEWSTATUS_OPAQUE.

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

Wywoływane przez platformę, gdy kontrolka interfejsu użytkownika jest dezaktywowana.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Uwagi

Implementacja powinien ukrywanie wszystkich pasków narzędzi, wyświetlane przez `OnShowToolbars`.

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

Metoda wywoływana przez kontener dla nieaktywnych obiektu pod kursorem myszy na odebranie komunikatu WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Obiekt, który blokujących prostokąt we współrzędnych klienta okna nadrzędnego. Informuje obiekt jego dokładnego położenia i rozmiaru na ekranie WM_MOUSEMOVE wiadomość została odebrana.

*x*<br/>
Współrzędna x lokalizacji myszy we współrzędnych klienta okna nadrzędnego.

*y*<br/>
Współrzędna y lokalizacji myszy we współrzędnych klienta okna nadrzędnego.

*dwKeyState*<br/>
Określa bieżący stan klawisze modyfikujące klawiatury na klawiaturze. Prawidłowe wartości może być kombinacją dowolnych flagi MK_CONTROL MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON i MK_RBUTTON.

### <a name="remarks"></a>Uwagi

Należy pamiętać, że współrzędne klienta okna (w pikselach) są używane do przekazywania pozycji kursora myszy. Jest to możliwe, przekazując także prostokąt otaczający obiektu tego samego układu współrzędnych.

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

Metoda wywoływana przez kontener dla nieaktywnych obiektu pod kursorem myszy na odebranie komunikatu WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Obiekt, który blokujących prostokąt we współrzędnych klienta okna nadrzędnego. Informuje obiekt jego dokładnego położenia i rozmiaru na ekranie Odebrano komunikat WM_SETCURSOR.

*x*<br/>
Współrzędna x lokalizacji myszy we współrzędnych klienta okna nadrzędnego.

*y*<br/>
Współrzędna y lokalizacji myszy we współrzędnych klienta okna nadrzędnego.

*dwMouseMsg*<br/>
Identyfikator komunikatu myszy, dla którego wystąpił WM_SETCURSOR.

*bSetAlways*<br/>
Określa, czy obiekt, należy ustawić kursor. W przypadku opcji TRUE obiektu należy ustawić kursor; w przypadku wartości FAŁSZ kursor nie ma obowiązku Ustaw kursor i powinna zwrócić wartość S_FALSE w takiej sytuacji.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy pamiętać, że współrzędne klienta okna (w pikselach) są używane do przekazywania pozycji kursora myszy. Jest to możliwe, przekazując także prostokąt otaczający obiektu tego samego układu współrzędnych.

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

Wywoływane przez platformę, po przetworzeniu zdarzenia KeyDown podstawowe.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*nChar*<br/>
Wartość Kod klawisza wirtualnego po naciśnięciu klawisza. Aby uzyskać listę standardowa wirtualnej kody klawiszy Zobacz Winuser.h

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- Klawisz SHIFT SHIFT_MASK został naciśnięty podczas działania.

- W trakcie akcji został naciśnięty klawisz CTRL CTRL_MASK.

- W trakcie akcji został naciśnięty klawisz ALT ALT_MASK.

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, jeśli formant musi mieć dostęp do kluczowych informacji po zdarzenie zostało wyzwolone.

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

Wywoływane przez platformę po akcji, które zdarzenia KeyPress zostały wyzwolone.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parametry

*nChar*<br/>
Zawiera wartość wirtualnego kod klawisza klawisz modyfikujący. Aby uzyskać listę standardowa wirtualnej kody klawiszy Zobacz Winuser.h

### <a name="remarks"></a>Uwagi

Należy pamiętać, że *nChar* wartość została zmodyfikowana przez kontener.

Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienie po wystąpieniu tego zdarzenia.

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

Wywoływane przez platformę, po przetworzeniu zdarzenia KeyDown podstawowe.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametry

*nChar*<br/>
Wartość Kod klawisza wirtualnego po naciśnięciu klawisza. Aby uzyskać listę standardowa wirtualnej kody klawiszy Zobacz Winuser.h

*nShiftState*<br/>
Zawiera kombinację następujących flag:

- Klawisz SHIFT SHIFT_MASK został naciśnięty podczas działania.

- W trakcie akcji został naciśnięty klawisz CTRL CTRL_MASK.

- W trakcie akcji został naciśnięty klawisz ALT ALT_MASK.

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, jeśli formant musi mieć dostęp do kluczowych informacji po zdarzenie zostało wyzwolone.

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

Metoda wywoływana przez platformę, by uzyskać identyfikator klasy strony właściwości, która implementuje edycji określonej właściwości.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parametry

*identyfikator DISPID*<br/>
Identyfikator wysyłania właściwości formantu.

*lpclsid*<br/>
Wskaźnik do `CLSID` struktury za pomocą którego zostanie zwrócony identyfikator klasy.

*pbPageOptional*<br/>
Zwraca wartość wskazuje, czy użycia strony określona właściwość jest opcjonalna.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli identyfikator klasy został zwrócony w *lpclsid*; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Należy przesłonić tę funkcję, zapewnia metodę do wywołania stron właściwości formantu w przeglądarce właściwości kontenera.

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

Wywoływane przez platformę, gdy kontener wykrył naciśnięto mnemoników klucz kontrolkę OLE.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parametry

*pMsg*<br/>
Wskaźnik do komunikatu Windows, wygenerowanego przez naciśnięcie klawisza mnemoników.

##  <a name="onproperties"></a>  COleControl::OnProperties

Wywoływane przez platformę, gdy zlecenie właściwości formantu zostało wywołane przez kontener.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lpMsg*<br/>
Wskaźnik do komunikatu Windows, która wywołała zlecenie.

*hWndParent*<br/>
Dojście do nadrzędnego okna kontrolki.

*lprect —*<br/>
Wskaźnik do prostokąta używany przez formant w kontenerze.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli wywołanie się kończy się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja wyświetlane jest okno dialogowe właściwości modal.

Ta funkcja umożliwia również spowodować wyświetlenie strony właściwości formantu. Wywołanie `OnProperties` funkcję, przekazując uchwyt formantu nadrzędnego *hWndParent* parametru. W tym przypadku wartości *lpMsg* i *lprect —* parametry są ignorowane.

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

Metoda wywoływana przez strukturę w odpowiedzi na kontenerze `IViewObjectEx::QueryHitPoint` żądania.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Określa, jak obiekt jest reprezentowana. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) lub DVASPECT2.

*pRectBounds*<br/>
Wskaźnik do `RECT` struktury, określając prostokąt otaczający obszaru klienckiego kontrolki OLE.

*ptlLoc*<br/>
Wskaźnik do `POINT` struktury, określając punkt, które mają być sprawdzane trafienie. Punkt jest określona w współrzędne obszaru klienta OLE.

*lCloseHint*<br/>
Odległość, który definiuje "Zamknij" w punkcie sprawdzane pod kątem trafień.

*pHitResult*<br/>
Wskaźnik do wyniku zapytania trafień. Jeden z następujących wartości:

- HITRESULT_OUTSIDE *ptlLoc* jest poza OLE object i zamyka.

- HITRESULT_TRANSPARENT *ptlLoc* znajduje się w granicach obiektu OLE, ale nie w pobliżu obrazu. Na przykład punkt w środku przezroczyste okrąg może być HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* jest wewnątrz lub na zewnątrz obiekt OLE, ale tyle nisko do obiektu, aby zostały uznane za wewnątrz. Małe, cienka lub szczegółowe obiektów może używać tej wartości. Nawet w przypadku punkt znajduje się poza blokujących prostokąt obiektu go może w dalszym ciągu można Zamknij (jest to niezbędne do osiągnięcia małych obiektów).

- HITRESULT_HIT *ptlLoc* mieści się w obrazie obiektu.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli pomyślnie zostanie zwrócony wynik trafień; w przeciwnym razie 0. Trafienie jest nakładanie się z obszaru wyświetlania kontrolki OLE.

### <a name="remarks"></a>Uwagi

Zapytania, czy obiekt wyświetlania prostokąt pokrywa się danego punktu (osiąga punkt). `QueryHitPoint` może zostać zastąpiona w celu testowania trafień dla obiektów innych niż prostokątne.

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

Metoda wywoływana przez strukturę w odpowiedzi na kontenerze `IViewObjectEx::QueryHitRect` żądania.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametry

*dwAspect*<br/>
Określa, jak obiekt może być reprezentowana. Prawidłowe wartości są pobierane z wyliczenia [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) lub DVASPECT2.

*pRectBounds*<br/>
Wskaźnik do `RECT` struktury, określając prostokąt otaczający obszaru klienckiego kontrolki OLE.

*prcLoc*<br/>
Wskaźnik do `RECT` struktury, określając prostokąt, które mają być sprawdzane trafień (nakładają się na prostokącie obiektu), względem lewy górny róg obiektu.

*lCloseHint*<br/>
Nie używany.

*pHitResult*<br/>
Wskaźnik do wyniku zapytania trafień. Jeden z następujących wartości:

- HITRESULT_OUTSIDE, który ma sensu prostokąta tych limitów zostanie osiągnięty przez obiekt OLE.

- HITRESULT_HIT co najmniej jeden punkt w prostokącie będzie trafień na obiekcie.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli pomyślnie zostanie zwrócony wynik trafień; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Pyta, czy obiekt wyświetlania prostokąt pokrywa się kiedykolwiek w danym prostokąt (liczba trafień prostokąta). `QueryHitRect` może zostać zastąpiona w celu testowania trafień dla obiektów innych niż prostokątne.

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

Metoda wywoływana przez platformę, by pobrać dane w określonym formacie.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskazuje [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Struktura określająca format, w którym wymagane informacje.

*lpStgMedium*<br/>
Wskazuje [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) struktury, w którym ma zostać zwrócone dane.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Podany format jest jednym wcześniej umieszczone w przy użyciu obiektu kontroli [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) lub [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) funkcje Członkowskie dla opóźnione renderowanie. Domyślna implementacja ta funkcja wywołuje `OnRenderFileData` lub `OnRenderGlobalData`, odpowiednio, jeśli podany nośnik jest pliku lub pamięci. Jeśli żądany format jest CF_METAFILEPICT lub format zestaw właściwości trwałe, domyślna implementacja powoduje wyświetlenie odpowiednich danych i zwraca wartość różną od zera. W przeciwnym razie zwraca wartość 0, a nie wykonuje żadnych działań.

Jeśli *lpStgMedium -> tymed* jest TYMED_NULL, STGMEDIUM powinny być przydzielny i wypełnione określony przez *lpFormatEtc -> tymed*. W przeciwnym razie TYMED_NULL, STGMEDIUM powinno być wypełnione w miejscu z danymi.

Należy przesłonić tę funkcję, aby podać dane w żądany format i średnie. W zależności od danych można zastąpić jedną z innych wersji tej funkcji, zamiast tego. W przypadku małych i stały rozmiar danych zastąpić `OnRenderGlobalData`. Jeśli Twoje dane znajduje się w pliku, lub o zmiennym rozmiarze, zastąpić `OnRenderFileData`.

Aby uzyskać więcej informacji, zobacz `FORMATETC` i `STGMEDIUM` struktur w zestawie Windows SDK.

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

Metoda wywoływana przez platformę, by pobrać dane w określonym formacie pliku po nośnika magazynowania.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskazuje [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Struktura określająca format, w którym wymagane informacje.

*pFile*<br/>
Wskazuje [CFile](../../mfc/reference/cfile-class.md) obiekt danych ma być renderowany.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Podany format jest jednym wcześniej umieszczone w przy użyciu obiektu kontroli [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) funkcję członkowską opóźnione renderowanie. Domyślna implementacja tej funkcji, po prostu zwraca wartość FALSE.

Należy przesłonić tę funkcję, aby podać dane w żądany format i średnie. W zależności od danych można zastąpić jedną z innych wersji tej funkcji, zamiast tego. Jeśli chcesz obsługiwać wiele nośników magazynowania, należy zastąpić `OnRenderData`. Jeśli Twoje dane znajduje się w pliku, lub o zmiennym rozmiarze, zastąpić `OnRenderFileData`.

Aby uzyskać więcej informacji, zobacz `FORMATETC` struktury w zestawie Windows SDK.

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

Metoda wywoływana przez platformę, by pobrać dane w określonym formacie po określonym nośniku pamięci globalnej.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskazuje [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Struktura określająca format, w którym wymagane informacje.

*phGlobal*<br/>
Wskazuje dojścia do pamięci globalnej, w którym ma zostać zwrócone dane. Jeśli nie pamięć została przydzielona, ten parametr może być równa NULL.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Podany format jest jednym wcześniej umieszczone w przy użyciu obiektu kontroli [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) funkcję członkowską opóźnione renderowanie. Domyślna implementacja tej funkcji, po prostu zwraca wartość FALSE.

Jeśli *phGlobal* ma wartość NULL, a następnie nowe wartości HGLOBAL powinien być przydzielony i zwracane w *phGlobal*. W przeciwnym razie wartości HGLOBAL określony przez *phGlobal* powinno być wypełnione przy użyciu danych. Ilość danych, umieszczone w wartości HGLOBAL nie może przekraczać bieżący rozmiar bloku pamięci. Ponadto nie można ponownie przydzielane bloku, na większy rozmiar.

Należy przesłonić tę funkcję, aby podać dane w żądany format i średnie. W zależności od danych można zastąpić jedną z innych wersji tej funkcji, zamiast tego. Jeśli chcesz obsługiwać wiele nośników magazynowania, należy zastąpić `OnRenderData`. Jeśli Twoje dane znajduje się w pliku, lub o zmiennym rozmiarze, zastąpić `OnRenderFileData`.

Aby uzyskać więcej informacji, zobacz `FORMATETC` struktury w zestawie Windows SDK.

##  <a name="onresetstate"></a>  COleControl::OnResetState

Wywoływane przez platformę, gdy właściwości formantu, powinny być ustawione wartości domyślne.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje [DoPropExchange](#dopropexchange), przekazując `CPropExchange` obiekt, który powoduje, że właściwości można ustawić wartości domyślne.

Moduł zapisujący kontroli można wstawić kod inicjujący kontrolkę OLE w tym możliwym do zastąpienia. Ta funkcja jest wywoływana, gdy [IPersistStream::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) lub [IPersistStorage::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) zakończy się niepowodzeniem, lub [IPersistStreamInit::InitNew](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) lub [IPersistStorage: : InitNew](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew) jest wywoływana bez wywoływania jednej `IPersistStream::Load` lub `IPersistStorage::Load`.

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

Wywoływane przez platformę, gdy kontener wywołał formantu `IOleControl::SetClientSite` funkcji.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Uwagi

Domyślnie `OnSetClientSite` sprawdza, czy właściwości ścieżki danych są ładowane i, jeśli są one wywołuje `DoDataPathPropExchange`.

Należy przesłonić tę funkcję, aby wykonywać żadnych specjalnych przetwarzanie tego powiadomienia. W szczególności zastąpienia tę funkcję, należy wywołać klasy bazowej.

##  <a name="onsetdata"></a>  COleControl::OnSetData

Metoda wywoływana przez platformę, aby zamienić dane formantu z określonymi danymi.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parametry

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktury, określając format danych.

*lpStgMedium*<br/>
Wskaźnik do [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) struktury, w którym znajdują się dane.

*bRelease*<br/>
Wartość TRUE, jeśli kontrolka powinna zwolnić nośnika magazynowania; Wartość FALSE, jeśli formant nie powinna zwolnić nośnika magazynowania.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

We właściwości trwałych danych ustawiono format, domyślna implementacja modyfikuje stanu formantu w związku z tym. W przeciwnym razie Domyślna implementacja nic nie robi. Jeśli *bRelease* jest wartość TRUE, a następnie wywołania `ReleaseStgMedium` wykonano; w przeciwnym razie nie.

Należy przesłonić tę funkcję, aby zamienić dane formantu z określonymi danymi.

Aby uzyskać więcej informacji, zobacz `FORMATETC` i `STGMEDIUM` struktur w zestawie Windows SDK.

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

Wywoływane przez platformę, gdy rozszerzenie kontrolki musi zostać zmieniony w wyniku wywołania [IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parametry

*lpSizeL*<br/>
Wskaźnik do `SIZEL` strukturę, która używa długich liczb całkowitych, który reprezentuje szerokość i wysokość kontrolki, wyrażona w jednostkach HIMETRIC.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli zmiana rozmiaru został zaakceptowany, w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja obsługuje zmienianie rozmiaru kontrolki w jakim stopniu. Jeśli kontrolka jest aktywny w miejscu, wywołanie kontenera `OnPosRectChanged` jest przeprowadzane.

Należy przesłonić tę funkcję, aby zmienić domyślnego rozmiaru kontrolki.

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

Wywoływane przez platformę, by zaimplementować wywołanie [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parametry

*lpRectPos*<br/>
Wskaźnik do `RECT` struktury, wskazujące nowe położenie i rozmiar względem kontenera kontrolki.

*lpRectClip*<br/>
Wskaźnik do `RECT` struktury wskazujący prostokątny obszar, do którego ma zostać obcięty formantu.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli zmiana położenia został zaakceptowany, w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja automatycznie obsługuje zmiany położenia i rozmiaru okna formantu i zwraca wartość TRUE.

Należy przesłonić tę funkcję, aby zmienić domyślne zachowanie tej funkcji.

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

Wywoływane przez platformę, gdy kontrolka została aktywowana w interfejsie użytkownika.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja nic nie robi.

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

Wywoływane przez platformę, gdy zmieniono wartość podstawowe właściwości podpisu lub tekstu.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje `InvalidateControl`.

Należy przesłonić tę funkcję, jeśli chcesz, aby powiadomienia po tej zmianie właściwości.

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

Metoda wywoływana przez strukturę w odpowiedzi na kontenerze `IOleInPlaceObjectWindowless::OnWindowMessage` żądania.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parametry

*komunikat:*<br/>
Identyfikator komunikatu jako zakończony powodzeniem przez Windows.

*wParam*<br/>
Jako zakończony powodzeniem przez Windows. Określa dodatkowe informacje specyficzne dla wiadomości. Zawartość tego parametru zależy od wartości *msg* parametru.

*lParam*<br/>
Jako zakończony powodzeniem przez Windows. Określa dodatkowe informacje specyficzne dla wiadomości. Zawartość tego parametru zależy od wartości *msg* parametru.

*plResult*<br/>
Kod wyniku Windows. Określa wyniku przetwarzania komunikatów i zależy od wiadomość została wysłana.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Przetwarza komunikaty okna od kontrolek bez okien. `COleControl`firmy `OnWindowlessMessage` powinna być używana dla komunikatów okien niż komunikatów myszy i klawiatury komunikatów. `COleControl` udostępnia [SetCapture](#setcapture) i [SetFocus](#setfocus) specjalnie w celu uzyskania fokus do przechwytywania i klawiatury myszy bez okien obiektów OLE.

Ponieważ obiekty bez okien nie jest oknem, muszą one mechanizm umożliwiające do nich wiadomości wysyłania kontenera. Bez okien obiektu OLE pobiera komunikaty z jego kontenera za pomocą `OnWindowMessage` metody `IOleInPlaceObjectWindowless` interfejsu (rozszerzenie [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) niepowiązanej z oknami obsługi). `OnWindowMessage` nie przyjmuje `HWND` parametru.

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

Wykonuje translację współrzędne *pPoint* na współrzędne klienta.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parametry

*lprcBounds*<br/>
Wskaźnik na granicach formantu OLE w kontenerze. Nie obszaru klienta, ale obszar formantu całego obramowania i paski przewijania.

*pPoint*<br/>
Wskaźnik do elementu nadrzędnego (kontenera) wskaż można przetłumaczyć współrzędne obszaru klienckiego kontrolki.

*bHitTest*<br/>
Określa, czy testowania trafień ma zostać wykonane w punkcie.

### <a name="return-value"></a>Wartość zwracana

Jeśli *bHitTest* ma wartość FAŁSZ, zwraca HTNOWHERE. Jeśli *bHitTest* ma wartość TRUE, zwraca obszaru klienckiego kontrolki OLE otwarta lokalizacji, w której punkt nadrzędnego (kontenera) i jest jednym z następujących myszy testowania trafienia wartości:

- HTBORDER w obramowania okna, które ma granicę z ustalanym.

- HTBOTTOM w poziomie dolną krawędź okna.

- HTBOTTOMLEFT w lewym dolnym rogu krawędź okna.

- HTBOTTOMRIGHT w prawym dolnym rogu krawędź okna.

- HTCAPTION w obszarze paska tytułu.

- HTCLIENT w obszarze klienta.

- HTERROR na tle ekranu lub w jednoznaczny systemu windows (takie same jak HTNOWHERE poza tym, że `DefWndProc` funkcji Windows tworzy sygnał dźwiękowy systemu, aby wskazać błąd).

- HTGROWBOX w polu rozmiar.

- HTHSCROLL w poziomych pasków przewijania.

- HTLEFT w lewej krawędzi okna.

- Przycisk HTMAXBUTTON w maksymalizacji.

- HTMENU w obszarze menu.

- Przycisk HTMINBUTTON w zminimalizować.

- HTNOWHERE na tle ekranu lub w jednoznaczny systemu windows.

- Przycisk HTREDUCE w zminimalizować.

- HTRIGHT w prawej krawędzi okna.

- HTSIZE w polu Rozmiar (tak jak HTGROWBOX).

- HTSYSMENU w formant menu lub przycisk Zamknij okno podrzędne.

- HTTOP w górna krawędź pozioma okna.

- HTTOPLEFT w lewym górnym rogu krawędź okna.

- HTTOPRIGHT w prawym górnym rogu krawędź okna.

- HTTRANSPARENT w oknie obecnie pasuje do żadnego innego okna.

- HTVSCROLL w pionowy pasek przewijania.

- Przycisk HTZOOM w maksymalizacji.

### <a name="remarks"></a>Uwagi

W danych wejściowych *pPoint* względem źródła elementu nadrzędnego (lewy górny róg kontenera). W danych wyjściowych *pPoint* względem źródła obszaru klienckiego kontrolki OLE (lewy górny róg obszaru klienckiego kontrolki).

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

Powiadamia kontener o tym, że modalne okno dialogowe zostało zamknięte.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndParent*<br/>
Obsługa do nadrzędnego okna, okno modalne okno dialogowe.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, po wyświetleniu modalnego okna dialogowego. Musisz wywołać tę funkcję, dzięki czemu kontenera można włączyć wszystkich okien najwyższego poziomu wyłączone przez `PreModalDialog`. Ta funkcja łączyć się z wywołaniem `PreModalDialog`.

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

Powiadamia kontener, który ma być wyświetlany modalne okno dialogowe.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametry

*hWndParent*<br/>
Obsługa do nadrzędnego okna, okno modalne okno dialogowe.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, przed wyświetleniem modalnego okna dialogowego. Musisz wywołać tę funkcję, dzięki czemu kontenera można wyłączyć jego okien najwyższego poziomu. Po wyświetleniu modalne okno dialogowe musi wywołać `PostModalDialog`.

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

Niszczy i ponownie tworzy okno formantu.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Uwagi

Może to być konieczne, jeśli zajdzie potrzeba zmiany bitów styl okna.

##  <a name="refresh"></a>  COleControl::Refresh

Wymusza repaint kontrolkę OLE.

```
void Refresh();
```

### <a name="remarks"></a>Uwagi

Ta funkcja jest obsługiwana przez `COleControl` klasy bazowej jako podstawowe metody o nazwie odświeżania. Dzięki temu użytkownicy kontrolki OLE do odświeżenia formantu o określonej godzinie. Aby uzyskać więcej informacji na temat tej metody, zobacz artykuł [kontrolek ActiveX: Metody](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

Zwalnia przechwytywanie myszy.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli kontrolka ma obecnie przechwytywanie myszy, przechwytywania jest zwalniana. W przeciwnym razie ta funkcja nie ma znaczenia.

##  <a name="releasedc"></a>  COleControl::ReleaseDC

Udostępnia kontekst urządzenia wyświetlaną kontenera kontrolce, zwalniając kontekst urządzenia do użytku przez inne aplikacje.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*podstawowego kontrolera domeny*<br/>
Identyfikuje kontekst urządzenia kontenera do wydania.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aplikacja musi wywołać `ReleaseDC` dla każdego wywołania [getdc —](#getdc).

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

Ustawia element nadrzędny kontrolki.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parametry

*hWndOuter*<br/>
Uchwyt okna formantu.

*hWndParent*<br/>
Uchwyt nowe okno nadrzędne.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, aby zresetować nadrzędnego okno kontrolki.

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

Inicjuje stan `COleControl` podstawowy właściwości do wartości domyślnych.

```
void ResetStockProps();
```

### <a name="remarks"></a>Uwagi

Dostępne są następujące właściwości: Wygląd, kolor tła, BorderStyle, podpis, włączone, czcionki, ForeColor, hWnd i tekst. Aby uzyskać opis właściwości podstawowe, zobacz [kontrolek ActiveX: Dodawanie właściwości standardowych](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Możesz poprawić wydajność binarne inicjowanie kontrolki za pomocą `ResetStockProps` i `ResetVersion` do zastąpienia `COleControl::OnResetState`. Zobacz przykład poniżej. Więcej informacji na temat optymalizowania inicjalizacji, zobacz [kontrolek ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

Inicjuje numer wersji do określonej wartości.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parametry

*dwVersionDefault*<br/>
Numer wersji, która ma być przypisany do kontrolki.

### <a name="remarks"></a>Uwagi

Możesz poprawić wydajność binarne inicjowanie kontrolki za pomocą `ResetVersion` i `ResetStockProps` do zastąpienia `COleControl::OnResetState`. Zobacz przykład w [ResetStockProps](#resetstockprops). Więcej informacji na temat optymalizowania inicjalizacji, zobacz [kontrolek ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

Umożliwia niepowiązanej z oknami obiektu OLE przewijać w obszarze jej w miejscu aktywnego obrazu na ekranie.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*xAmount*<br/>
Określa, w urządzeniu jednostek przewijanie w poziomie. Ten parametr musi być wartością ujemną, przewiń w lewo.

*yAmount*<br/>
Określa, w urządzeniu jednostek przewijanie w pionie. Ten parametr musi być wartością ujemną, przewiń w górę.

*lprect —*<br/>
Wskazuje [CRect](../../atl-mfc-shared/reference/crect-class.md) obiektu lub struktury Prostokąt, który określa część obiektu OLE obszaru klienta, aby przewijać, we współrzędnych klienta okna nadrzędnego. Jeśli *lprect —* ma wartość NULL, jest przewijane obszaru klienckiego całego obiektu OLE.

*lpClipRect*<br/>
Wskazuje `CRect` obiektu lub `RECT` strukturę, która określa prostokąt klipu. Przewijane są tylko pikseli wewnątrz prostokąta. Usługi BITS poza prostokąta nie ulegają zmianom, nawet jeśli leżą one w *lprect —* prostokąta. Jeśli *lpClipRect* ma wartość NULL, wycinka nie odbywa się na prostokącie przewijania.

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

Wybiera czcionkę do kontekstu urządzenia.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametry

*podstawowego kontrolera domeny*<br/>
Wskaźnik do obiektu kontekstu urządzenia.

*fontHolder*<br/>
Odwołanie do [CFontHolder](../../mfc/reference/cfontholder-class.md) obiekt reprezentujący czcionki do wybrania.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do wcześniej wybranej czcionki. Gdy obiekt wywołujący zostało zakończone wszystkich operacji rysowania, które używają *fontHolder,* go powinien ponownie wybrać poprzednio wybranej czcionki przez przekazanie jej jako parametr do [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

Wybiera właściwości czcionki zasobów do kontekstu urządzenia.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parametry

*podstawowego kontrolera domeny*<br/>
Kontekst urządzenia, do którego zostanie wybrana czcionka.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do poprzednio wybranego `CFont` obiektu. Należy używać [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) wybrać tę czcionkę powrót do kontekstu urządzenia, po zakończeniu.

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

Serializuje i inicjuje stanu miejsca na wyświetlanie przydzielony do formantu.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*ar*<br/>
Element `CArchive` obiektu do zserializowania do lub z.

### <a name="remarks"></a>Uwagi

Możesz poprawić wydajność binarne trwałości formantu za pomocą `SerializeExtent`, `SerializeStockProps`, i `SerializeVersion` do zastąpienia `COleControl::Serialize`. Zobacz przykład poniżej. Więcej informacji na temat optymalizowania inicjalizacji, zobacz [kontrolek ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

Serializuje i inicjuje stan `COleControl` podstawowy właściwości: Wygląd, kolor tła, BorderStyle, podpis, włączone, czcionki, ForeColor i tekst.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parametry

*ar*<br/>
Element `CArchive` obiektu do zserializowania do lub z.

### <a name="remarks"></a>Uwagi

Aby uzyskać opis właściwości podstawowe, zobacz [kontrolek ActiveX: Dodawanie właściwości standardowych](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Możesz poprawić wydajność binarne trwałości formantu za pomocą `SerializeStockProps`, `SerializeExtent`, i `SerializeVersion` do zastąpienia `COleControl::Serialize`. Na przykład wyświetlić kod w [SerializeExtent](#serializeextent). Więcej informacji na temat optymalizowania inicjalizacji, zobacz [kontrolek ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

Serializuje i inicjuje stan formantu informacji o wersji.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametry

*ar*<br/>
Element `CArchive` obiektu do zserializowania do lub z.

*dwVersionDefault*<br/>
Bieżący numer wersji kontroli.

*bConvert*<br/>
Wskazuje, czy trwałe dane powinny być konwertowane do najnowszego formatu, gdy jest zapisywany lub przechowywane w tym samym formacie, że był wykorzystywany podczas została załadowana.

### <a name="return-value"></a>Wartość zwracana

Numer wersji kontroli. W przypadku ładowania określonego archiwum `SerializeVersion` zwraca informacje o wersji załadowany z tego archiwum. W przeciwnym razie zwraca aktualnie załadowana wersja.

### <a name="remarks"></a>Uwagi

Możesz poprawić wydajność binarne trwałości formantu za pomocą `SerializeVersion`, `SerializeExtent`, i `SerializeStockProps` do zastąpienia `COleControl::Serialize`. Na przykład wyświetlić kod w [SerializeExtent](#serializeextent). Więcej informacji na temat optymalizowania inicjalizacji, zobacz [kontrolek ActiveX: Optymalizacja](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>  COleControl::SetAppearance

Ustawia wartość podstawowe właściwości wyglądu kontrolki.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parametry

*sAppearance*<br/>
A **krótki** wartości (VT_I2), która zostanie użyta wyglądu kontrolki. Wartość zero Ustawia wygląd kontrolki płaskim i ustawia wartość 1 wygląd formantu 3D.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji o właściwości podstawowe, zobacz [kontrolek ActiveX: Właściwości](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

Ustawia wartość właściwości BackColor podstawowe kontrolki.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parametry

*dwBackColor*<br/>
Wartość OLE_COLOR ma być używany w tle rysowania kontrolki.

### <a name="remarks"></a>Uwagi

Więcej informacji na temat korzystania z tej właściwości i innych związanych z właściwości, zobacz artykuł [kontrolek ActiveX: Właściwości](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

Ustawia wartość właściwości BorderStyle podstawowe kontrolki.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parametry

*sBorderStyle*<br/>
Nowy styl obramowania kontrolki; 0 oznacza brak obramowania, a wartość 1 oznacza normalne obramowanie.

### <a name="remarks"></a>Uwagi

Okno kontrolki, następnie zostanie ponownie utworzone i `OnBorderStyleChanged` o nazwie.

##  <a name="setcapture"></a>  COleControl::SetCapture

Powoduje, że okno kontenera kontrolki do wykonania posiadania przechwytywanie myszy w imieniu formantu.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do `CWnd` obiekt okna, który otrzymali wcześniej wprowadzanie za pomocą myszy.

### <a name="remarks"></a>Uwagi

Jeśli kontrolka jest aktywowany i bez okien, ta funkcja powoduje, że w oknie kontenera kontrolki do wykonania posiadania przechwytywanie myszy w imieniu formantu. W przeciwnym razie ta funkcja powoduje, że nim być przesyłany przechwytywanie myszy (taka sama jak `CWnd::SetCapture`).

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

Ustawia rozmiar okna kontrolki OLE i powiadamia kontenera, w którym lokacji kontroli ulega zmianie.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parametry

*CX*<br/>
Określa szerokość nowego formantu w pikselach.

*CY*<br/>
Określa nową wysokość formantu w pikselach.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

W Konstruktorze kontroli nad nie należy użyć tej funkcji.

Należy zauważyć, że wszystkie współrzędne dla systemu windows formantu względem lewego górnego rogu kontrolki.

##  <a name="setenabled"></a>  COleControl::SetEnabled

Ustawia wartość właściwości Enabled kontrolki zasobów.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parametry

*bWłączony*<br/>
Wartość TRUE, jeśli kontrolka jest włączona; w przeciwnym razie wartość FALSE.

### <a name="remarks"></a>Uwagi

Po ustawieniu tej właściwości `OnEnabledChange` jest wywoływana.

##  <a name="setfocus"></a>  COleControl::SetFocus

Powoduje, że okno kontenera kontrolki do wykonania posiada fokus wprowadzania w imieniu formantu.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do `CWnd` obiekt okna, który stracił dane wejściowe, skupić się, lub wartość NULL, jeśli istnieje nie takie okno.

### <a name="remarks"></a>Uwagi

Jeśli kontrolka jest aktywowany i bez okien, ta funkcja powoduje, że w oknie kontenera kontrolki do wykonania posiada fokus wprowadzania w imieniu formantu. Fokus wprowadzania kieruje danych wprowadzonych z klawiatury do okna kontenera, a kontener komunikaty będą rozsyłane wszystkie kolejne klawiatury do obiektu OLE, który wywołuje `SetFocus`. Dowolne okno, która miała wcześniej fokus wprowadzania traci go.

Jeśli formant nie jest niepowiązanej z oknami, ta funkcja powoduje, że nim być przesyłany fokus wprowadzania (taka sama jak `CWnd::SetFocus`).

##  <a name="setfont"></a>  COleControl::SetFont

Ustawia właściwości czcionki zasobów kontrolki.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parametry

*pFontDisp*<br/>
Wskaźnik do interfejs ekspedycji czcionki.

##  <a name="setforecolor"></a>  COleControl::SetForeColor

Ustawia wartość właściwości ForeColor zapasów, kontrolki.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parametry

*dwForeColor*<br/>
Wartość OLE_COLOR służący do pierwszego planu rysunku kontrolki.

### <a name="remarks"></a>Uwagi

Więcej informacji na temat korzystania z tej właściwości i innych związanych z właściwości, zobacz artykuł [kontrolek ActiveX: Właściwości](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

Metoda wywoływana przez platformę, by zainicjować listy formatów danych obsługiwane przez kontrolkę.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja określa dwa formaty: Ustaw CF_METAFILEPICT i trwałe właściwości.

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

Określa rozmiar kontrolki OLE, gdy po raz pierwszy jest wyświetlany w kontenerze.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parametry

*CX*<br/>
Początkowa szerokość kontrolki OLE w pikselach.

*CY*<br/>
Początkowa wysokość formantu OLE w pikselach.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję w konstruktora do ustawienia początkowego rozmiaru formantu. Początkowy rozmiar jest mierzona w jednostkach urządzenia lub pikselach. Zaleca się, że to połączenie nawiązywane w Konstruktorze formantu.

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

Zmiany stanu modyfikacji obiektu formantu.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parametry

*bModified*<br/>
Nowa wartość dla formantu zmodyfikowana flagi. Wartość TRUE wskazuje, że stan formantu został zmodyfikowany; Wartość FALSE wskazuje, czy po prostu został zapisany stan formantu.

### <a name="remarks"></a>Uwagi

Wywołanie, że ta funkcja zawsze wtedy, gdy nastąpi zmiana wpłynie na trwały stan formantu. Na przykład, jeśli zmieni się wartość właściwości trwałe, wywołaj tę funkcję, za pomocą *bModified* **TRUE**.

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

Wskazuje, że żądanie edycji nie powiodło się.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, gdy `BoundPropertyRequestEdit` zakończy się niepowodzeniem. Ta funkcja zgłosi wyjątek typu `COleDispScodeException` do wskazania ustalonej operacji było niedozwolone.

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

Zapobiega zmianom wartości właściwości kontrolki przez użytkownika.

```
void SetNotSupported();
```

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, zamiast funkcji Set w dowolnej właściwości, których nie jest obsługiwana zmiana wartości właściwości według kontrolki użytkownika. Jednym z przykładów byłoby właściwość, która jest tylko do odczytu.

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

Ustawia współrzędne prostokąt kontroli względem kontenera wyrażona w jednostkach urządzenia.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parametry

*lprect —*<br/>
Wskaźnik do prostokąta zawierającego współrzędne nowego kontroli względem kontenera.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli wywołanie zakończyło się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli kontrolka jest otwarty, zmiany jego rozmiaru; w przeciwnym razie kontenera `OnPosRectChanged` funkcja jest wywoływana.

##  <a name="settext"></a>  COleControl::SetText

Ustawia wartość kontroli nad podstawowe właściwości podpisu lub tekstu.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parametry

*pszText*<br/>
Wskaźnik do ciągu znaków.

### <a name="remarks"></a>Uwagi

Należy pamiętać, że właściwości podstawowe podpisu i tekst są zamapowane na tę samą wartość. Oznacza to, że wszelkie zmiany wprowadzone do żadnej właściwości, spowoduje to automatyczną zmianę obie te właściwości. Ogólnie rzecz biorąc formant powinien obsługiwać stock podpis lub właściwości tekstu, ale nie oba.

##  <a name="throwerror"></a>  COleControl::ThrowError

Sygnały wystąpieniu błędu w kontrolce.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametry

*sc*<br/>
Wartość Kod stanu jest raportowane. Aby uzyskać pełną listę możliwych kodów, zobacz artykuł [kontrolek ActiveX: Tematy zaawansowane](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
Identyfikator ciągu zasobu wyjątku zgłoszenia.

*nHelpID*<br/>
Identyfikator Pomocy temat zgłaszana w.

*pszDescription*<br/>
Ciąg zawierający wyjaśnienie wyjątek, należy podać.

### <a name="remarks"></a>Uwagi

Ta funkcja powinna być wywoływana tylko z w funkcji Get lub Set dla właściwości OLE lub implementacji metody automatyzacji OLE. Jeśli potrzebujesz do sygnalizowania błędów występujących w innym czasie, należy wywołać podstawowe zdarzenia błędu.

##  <a name="transformcoords"></a>  COleControl::TransformCoords

Przekształcenia koordynować wartości z zakresu od HIMETRIC i kontenerów natywnych jednostek.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parametry

*lpptlHimetric*<br/>
Wskaźnik do `POINTL` struktury zawierającego współrzędne w jednostkach HIMETRIC.

*lpptfContainer*<br/>
Wskaźnik do `POINTF` struktury zawierającej współrzędnych w jego rozmiar jednostki.

*flagi*<br/>
Kombinacją następujących wartości:

- Pozycja XFORMCOORDS_POSITION A w kontenerze.

- Rozmiar A XFORMCOORDS_SIZE w kontenerze.

- Jednostek HIMETRIC Przekształcanie XFORMCOORDS_HIMETRICTOCONTAINER kontenera jednostek.

- XFORMCOORDS_CONTAINERTOHIMETRIC Przekształć kontenera jednostek do jednostek HIMETRIC.

### <a name="remarks"></a>Uwagi

Pierwsze dwie flagi, XFORMCOORDS_POSITION i XFORMCOORDS_SIZE, wskazują, czy współrzędne powinny być traktowane jako położenie i rozmiar. Pozostałe dwie flagi wskazują kierunek transformacji.

##  <a name="translatecolor"></a>  COleControl::TranslateColor

Konwertuje wartość koloru z typu danych OLE_COLOR [COLORREF](/windows/desktop/gdi/colorref) typu danych.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parametry

*clrColor*<br/>
Typ danych OLE_COLOR. Aby uzyskać więcej informacji, zobacz Windows [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor) funkcji.

*hpal*<br/>
Dojście do palety opcjonalne; może mieć wartości NULL.

### <a name="return-value"></a>Wartość zwracana

Wartość koloru 32-bitowych RGB (czerwony, zielony, niebieski), który definiuje stałą kolor najbliżej *clrColor* wartość, która może reprezentować urządzenia.

### <a name="remarks"></a>Uwagi

Funkcja ta jest przydatna do translacji właściwości ForeColor i kolor tła podstawowe typy COLORREF używane przez [CDC](../../mfc/reference/cdc-class.md) funkcji elementów członkowskich.

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

Określa, czy formant należy używać wartości właściwości otoczenia jako wartości domyślne, gdy później jest ładowany z jego stan trwały.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Wartość zwracana

NonZero wskazuje, że właściwości otoczenia będzie nieprawidłowa, w przeciwnym razie nie będą prawidłowe właściwości otoczenia.

### <a name="remarks"></a>Uwagi

W niektórych kontenery formantu może nie mieć dostępu do właściwości otoczenia podczas początkowego wywołania do zastępowania metody `COleControl::DoPropExchange`. Dotyczy to sytuacji, gdy kontener wywoła [IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load) lub [IPersistStorage::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) przed wywołaniem [IOleObject::SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) (to znaczy, jeśli nie ma uwzględnić bitu stan OLEMISC_SETCLIENTSITEFIRST).

##  <a name="windowproc"></a>  COleControl::WindowProc

Zawiera procedury dla Windows `COleControl` obiektu.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametry

*komunikat*<br/>
Określa komunikat Windows, które mają być przetwarzane.

*wParam*<br/>
Zawiera dodatkowe informacje używane podczas przetwarzania komunikatu. Wartość tego parametru jest zależna od wiadomości.

*lParam*<br/>
Zawiera dodatkowe informacje używane podczas przetwarzania komunikatu. Wartość tego parametru jest zależna od wiadomości.

### <a name="return-value"></a>Wartość zwracana

Wartość zwracana przez wysłanych komunikatów.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, możesz wysyłać określonych wiadomości za pomocą formantu mapy komunikatów.

## <a name="see-also"></a>Zobacz też

[CIRC3 próbki MFC](../../visual-cpp-samples.md)<br/>
[Próbki MFC TESTHELP](../../visual-cpp-samples.md)<br/>
[Klasa COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Klasa CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Wykres hierarchii](../../mfc/hierarchy-chart.md)<br/>
[Klasa CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Klasa CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
