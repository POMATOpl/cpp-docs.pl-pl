---
title: COleClientItem Class
ms.date: 11/04/2016
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: ec3048e7bd033e5c296b558dd2083c648bc377e7
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/04/2019
ms.locfileid: "57295360"
---
# <a name="coleclientitem-class"></a>COleClientItem Class

Definiuje interfejs kontenera elementów OLE.

## <a name="syntax"></a>Składnia

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Elementy członkowskie

### <a name="public-constructors"></a>Konstruktory publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Konstruuje `COleClientItem` obiektu.|

### <a name="public-methods"></a>Metody publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|Otwiera element OLE dla danej operacji, a następnie wykonuje określone zlecenie.|
|[COleClientItem::ActivateAs](#activateas)|Uaktywnia elementu jako innego typu.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Uzyskuje dostęp do danych obiektu OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Wskazuje, czy aplikacja kontenera można utworzyć obiekt osadzony.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Wskazuje, czy aplikacja kontenera można utworzyć obiekt połączony.|
|[COleClientItem::CanPaste](#canpaste)|Wskazuje, czy w Schowku znajduje się element OLE możliwego do osadzenia lub statyczną.|
|[COleClientItem::CanPasteLink](#canpastelink)|Wskazuje, czy w Schowku znajduje się możliwym elementu OLE.|
|[COleClientItem::Close](#close)|Zamyka łączy się z serwerem, ale nie niszczy element OLE.|
|[COleClientItem::ConvertTo](#convertto)|Konwertuje element do innego typu.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Kopiuje element OLE do Schowka.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Tworzy kopię istniejącego elementu.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Tworzy element osadzony ze Schowka.|
|[COleClientItem::CreateFromData](#createfromdata)|Tworzy element osadzony na podstawie obiektu danych.|
|[COleClientItem::CreateFromFile](#createfromfile)|Tworzy element osadzony na podstawie pliku.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Tworzy element połączony ze Schowka.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Tworzy połączony element z obiektu danych.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Tworzy element połączony z plikiem.|
|[COleClientItem::CreateNewItem](#createnewitem)|Tworzy nowy element osadzony poprzez uruchomienie aplikacji serwera.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Tworzy element statyczny ze Schowka.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Tworzy statyczny element z obiektu danych.|
|[COleClientItem::Deactivate](#deactivate)|Dezaktywuje element.|
|[COleClientItem::DeactivateUI](#deactivateui)|Przywraca interfejsu użytkownika aplikacji kontenera do stanu pierwotnego.|
|[COleClientItem::Delete](#delete)|Usuwa lub zamyka element OLE, jeśli był połączony element.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Wykonuje operację przeciągania i upuszczania.|
|[COleClientItem::DoVerb](#doverb)|Wykonuje określone zlecenie.|
|[COleClientItem::Draw](#draw)|Rysuje element OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Pobiera widok, w której element jest aktywny w miejscu.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Zwraca granice elementu OLE prostokąta.|
|[COleClientItem::GetClassID](#getclassid)|Pobiera identyfikator elementu obecne klasy.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Pobiera dane, które zostają umieszczone w Schowku, wywołując `CopyToClipboard` funkcja elementu członkowskiego.|
|[COleClientItem::GetDocument](#getdocument)|Zwraca `COleDocument` obiekt, który zawiera element istnieje.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Pobiera bieżący widok elementu do renderowania.|
|[COleClientItem::GetExtent](#getextent)|Zwraca granice elementu OLE prostokąta.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Pobiera uchwyt do ikony skojarzone z serwerem określonym identyfikatorem CLSID.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Pobiera metaplik używany do rysowania ikona elementu.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Zwraca wskaźnik do okna edycji w miejscu elementu.|
|[COleClientItem::GetItemState](#getitemstate)|Pobiera stan bieżącego elementu.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Zwraca stan ostatniej operacji OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Zwraca tryb aktualizacji dla połączonego elementu (funkcja Zaawansowane).|
|[COleClientItem::GetType](#gettype)|Zwraca typ (osadzone, połączone lub statycznej) elementu OLE.|
|[COleClientItem::GetUserType](#getusertype)|Pobiera ciąg opisujący typ elementu.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Zwraca wartość PRAWDA, jeśli element jest aktywny w miejscu.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Zwraca wartość TRUE, jeśli połączony element jest zgodna z jego dokumentu źródłowego.|
|[COleClientItem::IsModified](#ismodified)|Zwraca wartość TRUE, jeśli element został zmodyfikowany od momentu jego ostatniego zapisane.|
|[COleClientItem::IsOpen](#isopen)|Zwraca wartość TRUE, jeśli element jest obecnie otwarty w aplikacji serwera.|
|[COleClientItem::IsRunning](#isrunning)|Zwraca wartość PRAWDA, jeśli działa aplikacja serwera elementu.|
|[COleClientItem::OnActivate](#onactivate)|Metoda wywoływana przez platformę, by powiadomić element, że została aktywowana.|
|[COleClientItem::OnActivateUI](#onactivateui)|Metoda wywoływana przez platformę, by powiadomić element jest aktywowana i powinien zostać wyświetlony interfejs użytkownika.|
|[COleClientItem::OnChange](#onchange)|Wywołuje się, gdy serwer zmiany elementu OLE. Implementacja jest wymagana.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Wywoływane przez platformę, gdy element jest dezaktywowany.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Wywoływane przez platformę, gdy serwer został usunięty interfejs użytkownika w miejscu.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Metoda wywoływana przez platformę, by pobrać dane, które mają zostać skopiowane do Schowka.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Metoda wywoływana przez strukturę w celu utworzenia złożonego menu.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Metoda wywoływana przez platformę, by usunąć menu kontenera ze złożonego menu.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Metoda wywoływana przez platformę, by zainstalować i usunąć złożone menu.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Metoda wywoływana przez platformę, by pokazać lub ukryć paski sterowania.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Metoda wywoływana przez platformę, by zaktualizować pasek tytułu okna ramki.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Ponownie uaktywnia elementu i Cofa ostatnią operację edycji w miejscu.|
|[COleClientItem::Release](#release)|Zwalnia połączenia OLE połączony element, a następnie zamyka go, jeśli był otwarty. Niszczy element klienta.|
|[COleClientItem::Reload](#reload)|Ponownie ładuje elementu po wywołaniu `ActivateAs`.|
|[COleClientItem::Run](#run)|Jest uruchamiana aplikacja skojarzona z elementem.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Ustawia bieżący widok elementu do renderowania.|
|[COleClientItem::SetExtent](#setextent)|Ustawia prostokąt otaczający element OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Określa nazwy serwera wyświetli podczas edycji elementu OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Buforuje metaplik używany do rysowania ikona elementu.|
|[COleClientItem::SetItemRects](#setitemrects)|Ustawia prostokąt otaczający elementu.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Ustawia tryb aktualizacji dla połączonego elementu (funkcja Zaawansowane).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Ustawia print-urządzenie dla tego elementu klienta.|
|[COleClientItem::UpdateLink](#updatelink)|Aktualizuje pamięć podręczną prezentacji elementu.|

### <a name="protected-methods"></a>Metody chronione

|Nazwa|Opis|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Metoda wywoływana przez platformę, aby określić, czy Aktywacja w miejscu jest dozwolona.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Wywoływane przez platformę, gdy zmienia położenie elementu.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Metoda wywoływana przez platformę, by cofnąć po aktywacji.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Metoda wywoływana przez platformę, by odrzucić informacje o stanie cofania elementu.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Metoda wywoływana przez platformę, by uzyskać współrzędne prostokątnego wycinka elementu.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Metoda wywoływana przez platformę, by uzyskać położenie elementu względem widoku.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Wywoływane przez platformę, gdy element jest aktywowany w miejscu.|
|[COleClientItem::OnScrollBy](#onscrollby)|Metoda wywoływana przez platformę, by przewinąć element w widoku.|
|[COleClientItem::OnShowItem](#onshowitem)|Metoda wywoływana przez platformę, by wyświetlić element OLE.|

## <a name="remarks"></a>Uwagi

Element OLE reprezentuje dane, tworzone i konserwowane przez aplikacji serwera, który może być "bezproblemowo" dołączany do dokumentu, tak aby była wyświetlana użytkownikowi jako pojedynczego dokumentu. Wynikiem jest "dokument złożony" składa się z elementu OLE i dokumentu zawierającego.

Element OLE można osadzony lub połączony. Jeśli jest wbudowany, jego dane są przechowywane jako część złożonego dokumentu. Jeśli jest on połączony, jego dane są przechowywane jako część oddzielnym pliku, utworzone przez aplikację serwera, a tylko łącze do tego pliku są przechowywane w dokumencie złożonym. Wszystkie elementy OLE zawiera informacje określające aplikacji serwera, która powinna być wywoływana, aby je edytować.

`COleClientItem` definiuje kilka funkcji możliwym do zastąpienia, które są wywoływane w odpowiedzi na żądania z serwera aplikacji; te / / overridables zazwyczaj działa jako powiadomienia. Dzięki temu aplikacja serwera poinformować kontenera zmiany wprowadzane przez użytkownika podczas edycji elementu OLE lub można pobrać informacji potrzebnych podczas edycji.

`COleClientItem` może być używany z [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md), lub [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) klasy. Aby użyć `COleClientItem`dziedziczyć po nim klasę i zaimplementować [OnChange](#onchange) funkcja elementu członkowskiego, który definiuje, jak kontenera reaguje na zmiany wprowadzone do elementu. Aby zapewnić obsługę aktywacji w miejscu, należy zastąpić [OnGetItemPosition](#ongetitemposition) funkcja elementu członkowskiego. Ta funkcja zawiera informacje dotyczące wyświetlana pozycja elementu OLE.

Aby uzyskać więcej informacji o korzystaniu z interfejsu kontenera, zobacz artykuły [kontenerów: Implementowanie kontenera](../../mfc/containers-implementing-a-container.md) i [aktywacji](../../mfc/activation-cpp.md).

> [!NOTE]
>  Zestaw Windows SDK odnosi się do elementy osadzone i połączone jako "obiekty" i odwołuje się do typów elementów jako "klasy". Ta dokumentacja używa termin "item", aby odróżnić jednostki OLE z odpowiedniego obiektu języka C++ i termin "type" odróżnienia kategorii OLE klasy języka C++.

## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Wymagania

**Nagłówek:** afxole.h

##  <a name="activate"></a>  COleClientItem::Activate

Wywołaj tę funkcję, aby wykonać określone zlecenie zamiast [DoVerb](#doverb) tak, aby zrobić własne przetwarzanie, gdy wyjątek jest zgłaszany.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nVerb*<br/>
Określa polecenie do wykonania. Może to być jedna z następujących czynności:

|Wartość|Znaczenie|Symbol|
|-----------|-------------|------------|
|- 0|Primary — Zlecenie|OLEIVERB_PRIMARY|
|- 1|Pomocniczy zlecenia|(Brak)|
|- 1|Wyświetlanie elementu do edycji|OLEIVERB_SHOW|
|- 2|Edytuj element w osobnym oknie|OLEIVERB_OPEN|
|- 3|Ukrywanie elementu|OLEIVERB_HIDE|

Wartość-1 zwykle jest aliasem dla innej zlecenie. Jeśli otwarty do edycji nie jest obsługiwany, -2 ma taki sam skutek jak -1. Aby uzyskać dodatkowe wartości, zobacz [IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) w zestawie Windows SDK.

*pView*<br/>
Wskaźnik do okna widoku kontenera, który zawiera element OLE; jest on używany przez aplikację serwera aktywacji w miejscu. Ten parametr powinien mieć wartości NULL, jeśli kontener nie obsługuje aktywacji w miejscu.

*lpMsg*<br/>
Wskaźnik na komunikat, który spowodował elementu zostanie uaktywniony.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja została napisana przy użyciu biblioteki klas Microsoft Foundation, ta funkcja powoduje, że [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) funkcji składowej typu odpowiadającego `COleServerItem` obiektu do wykonania.

Jeśli primary — zlecenie jest edycji i zero jest określona w *nVerb* parametru, aplikacja serwera zostanie uruchomiona, aby zezwolić na element OLE, który chcesz edytować. Jeśli aplikacja kontenera obsługuje aktywacji w miejscu, edytowanie może odbywać się w miejscu. Jeśli kontener nie obsługuje aktywacji w miejscu (lub jeśli określono zlecenie Otwórz), serwer jest uruchamiany w osobnym oknie i edytowanie może odbywać się tam. Zazwyczaj po użytkownik aplikacji kontenera kliknie dwukrotnie elementu OLE wartość primary — zlecenie w *nVerb* parametr określa akcję, która użytkownik może robić. Jednakże, jeśli serwer obsługuje tylko jedną akcję, zajmuje tę akcję, niezależnie od tego, która wartość jest określona w *nVerb* parametru.

Aby uzyskać więcej informacji, zobacz [IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) w zestawie Windows SDK.

##  <a name="activateas"></a>  COleClientItem::ActivateAs

Używa urządzeń konwersji obiektów OLE do aktywowania elementu, tak jakby był to element o typie określonym przez *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*lpszUserType*<br/>
Wskaźnik na ciąg reprezentujący typ użytkownika docelowego, takie jak "Dokument programu Word."

*clsidOld*<br/>
Identyfikator odwołania do elementu bieżącej klasy. Identyfikator klasy powinny reprezentować typ pierwotny obiekt, przechowywane, chyba że jest to łącze. W takim przypadku należy CLSID elementu, do którego odwołuje się łącze. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) automatycznie określa identyfikator klasy poprawne dla elementu.

*clsidNew*<br/>
Odwołanie do identyfikatora klasy docelowej

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jest to automatycznie przez [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Go nie jest zazwyczaj wywoływana bezpośrednio.

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

Wywołaj tę funkcję, aby zainicjować [COleDataObject](../../mfc/reference/coledataobject-class.md) do uzyskiwania dostępu do danych w elemencie OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parametry

*rDataObject*<br/>
Odwołanie do `COleDataObject` obiekt, który zostanie zainicjowana w celu zezwolenia na dostęp do danych w element OLE.

##  <a name="canactivate"></a>  COleClientItem::CanActivate

Wywoływane przez platformę, gdy użytkownik zażąda aktywacji w miejscu elementu OLE; wartość zwracaną przez funkcję Określa, czy Aktywacja w miejscu jest dozwolona.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli aktywacja w miejscu jest dozwolona; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja umożliwia aktywacji w miejscu, jeśli kontener ma prawidłową okna. Należy przesłonić tę funkcję, aby zaimplementować logikę specjalną, aby zaakceptować lub odmowy żądania aktywacji. Na przykład żądanie aktywacji można odrzucić, jeśli element OLE jest zbyt mała lub nie są obecnie widoczne.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::CanInPlaceActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) w zestawie Windows SDK.

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

Sprawdza, czy aplikacja kontenera można utworzyć obiekt osadzony z danym `COleDataObject` obiektu.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do [COleDataObject](../../mfc/reference/coledataobject-class.md) obiektu, z którego ma zostać utworzony element OLE.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli kontener można utworzyć obiekt osadzony z `COleDataObject` obiektu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

`COleDataObject` Klasa służy do pobierania danych w różnych formatach, ze Schowka, za pomocą przeciągania i upuszczania, lub z wbudowanego elementu OLE transferu danych.

Kontenery, można użyć tej funkcji zdecydować włączyć lub wyłączyć ich polecenia Edytuj Wklej i Edytuj Wklej specjalne.

Aby uzyskać więcej informacji, zobacz artykuł [obiekty danych i źródeł danych (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

Sprawdza, czy aplikacja kontenera można utworzyć obiektu połączonego z danym `COleDataObject` obiektu.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do [COleDataObject](../../mfc/reference/coledataobject-class.md) obiektu, z którego ma zostać utworzony element OLE.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli kontener można utworzyć obiektu połączonego z `COleDataObject` obiektu.

### <a name="remarks"></a>Uwagi

`COleDataObject` Klasa służy do pobierania danych w różnych formatach, ze Schowka, za pomocą przeciągania i upuszczania, lub z wbudowanego elementu OLE transferu danych.

Kontenery, można użyć tej funkcji zdecydować włączyć lub wyłączyć ich polecenia Edytuj Wklej specjalne i Edytuj Wklej łącze.

Aby uzyskać więcej informacji, zobacz artykuł [obiekty danych i źródeł danych (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>  COleClientItem::CanPaste

Wywołaj tę funkcję, aby zobaczyć, czy wbudowanego elementu OLE można wkleić ze Schowka.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli ze Schowka; można wkleić wbudowanego elementu OLE w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) i [OleQueryCreateFromData](/windows/desktop/api/ole2/nf-ole2-olequerycreatefromdata) w zestawie Windows SDK.

##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink

Wywołaj tę funkcję, aby zobaczyć, czy połączony element OLE można wkleić ze Schowka.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli ze Schowka; można wkleić połączony element OLE w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) i [OleQueryLinkFromData](/windows/desktop/api/ole2/nf-ole2-olequerylinkfromdata) w zestawie Windows SDK.

##  <a name="close"></a>  COleClientItem::Close

Wywołaj tę funkcję, aby zmienić stan elementu OLE z uruchomiona załadować stanu, oznacza to, załadować jej obsługi w pamięci, ale serwer nie działa.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Flaga, określania, w jakich okolicznościach elementu OLE jest zapisywana, gdy zwraca załadować stan. Może mieć jedną z następujących wartości:

- Element OLECLOSE_SAVEIFDIRTY Zapisz OLE.

- OLECLOSE_NOSAVE nie zapisuj elementu OLE.

- OLECLOSE_PROMPTSAVE monit o zapisanie elementu OLE.

### <a name="remarks"></a>Uwagi

Ta funkcja nie obowiązuje, gdy element OLE nie jest uruchomiony.

Aby uzyskać więcej informacji, zobacz [IOleObject::Close](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-close) w zestawie Windows SDK.

##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem

Konstruuje `COleClientItem` obiektu i dodaje go do kolekcji dokumentów kontenerów elementów dokumentu, tworzy tylko obiektu języka C++, która nie wykonuje żadnych Inicjalizacja OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parametry

*pContainerDoc*<br/>
Wskaźnik do dokumentu kontenera, który będzie zawierać tego elementu. Może to być dowolny [COleDocument](../../mfc/reference/coledocument-class.md) utworów zależnych.

### <a name="remarks"></a>Uwagi

W przypadku przekazania wskaźnika o wartości NULL nie jest wprowadzone do dokumentu kontenera. Należy jawnie wywołać [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Należy wywołać jedną z następujących funkcji elementów członkowskich tworzenia, zanim użyjesz elementu OLE:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

Wywołaj tę funkcję elementu członkowskiego, aby przekonwertować typu określonego przez element *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*clsidNew*<br/>
Identyfikator klasy na typ docelowy.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jest to automatycznie przez [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Nie jest konieczne wywołują go bezpośrednio.

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

Wywołaj tę funkcję, aby skopiować element OLE do Schowka.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
Wartość TRUE, jeśli informacje o linku, powinny zostać skopiowane do Schowka, dzięki czemu element z łączem do wklejenia; w przeciwnym razie wartość FALSE.

### <a name="remarks"></a>Uwagi

Zazwyczaj można Wywołaj tę funkcję, pisząc programy obsługi komunikatów dla polecenia Kopiuj lub Wytnij z menu Edycja. Jeśli chcesz zaimplementować polecenia Kopiuj lub Wytnij, musi implementować zaznaczenie elementu w kontenerze aplikacji.

Aby uzyskać więcej informacji, zobacz [OleSetClipboard](/windows/desktop/api/ole2/nf-ole2-olesetclipboard) w zestawie Windows SDK.

##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom

Wywołaj tę funkcję, aby utworzyć kopię określonego elementu OLE.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parametry

*pSrcItem*<br/>
Wskaźnik na element OLE które mają być zduplikowane.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Kopia jest identyczna z elementu źródłowego. Ta funkcja służy do obsługi operacji cofania.

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

Wywołaj tę funkcję, aby utworzyć element osadzony od zawartości Schowka.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Renderowanie*<br/>
Flaga, określający, jak serwer będzie renderować element OLE. Możliwe wartości dla [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) w zestawie Windows SDK.

*cfFormat*<br/>
Określa format danych schowka przechowywanie w pamięci podręcznej podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura używana, jeśli *renderowania* OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru, tylko wtedy, gdy chcesz określić informacji o formacie dodatkowe poza określonym przez format schowka *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne są używane dla innych pól w `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zazwyczaj wywołać tę funkcję z obsługi wiadomości dla polecenia Wklej menu Edycja. (Polecenie Paste jest włączone przez platformę, gdy [CanPaste](#canpaste) funkcja elementu członkowskiego zwraca wartość różną od zera.)

Aby uzyskać więcej informacji, zobacz [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) i [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) w zestawie Windows SDK.

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

Wywołaj tę funkcję, aby utworzyć element osadzony z `COleDataObject` obiektu.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do [COleDataObject](../../mfc/reference/coledataobject-class.md) obiektu, z którego ma zostać utworzony element OLE.

*Renderowanie*<br/>
Flaga, określający, jak serwer będzie renderować element OLE. Możliwe wartości dla [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) w zestawie Windows SDK.

*cfFormat*<br/>
Określa format danych schowka przechowywanie w pamięci podręcznej podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura używana, jeśli *renderowania* OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru, tylko wtedy, gdy chcesz określić informacji o formacie dodatkowe poza określonym przez format schowka *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne są używane dla innych pól w `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Podaj operacji transferu danych, takich jak wklejanie ze Schowka lub operacji przeciągania i upuszczania, `COleDataObject` obiektów, zawierającego informacje o oferowanych przez aplikację serwera. Zazwyczaj jest on używany w zastąpienie metody [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Aby uzyskać więcej informacji, zobacz [OleCreateFromData](/windows/desktop/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), i [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) w zestawie Windows SDK.

##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile

Wywołaj tę funkcję, aby utworzyć wbudowanego elementu OLE z pliku.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Wskaźnik na nazwę pliku, z którego ma zostać utworzony element OLE.

*Identyfikator klasy*<br/>
Zarezerwowane do użytku w przyszłości.

*Renderowanie*<br/>
Flaga, określający, jak serwer będzie renderować element OLE. Możliwe wartości dla [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) w zestawie Windows SDK.

*cfFormat*<br/>
Określa format danych schowka przechowywanie w pamięci podręcznej podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura używana, jeśli *renderowania* OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru, tylko wtedy, gdy chcesz określić informacji o formacie dodatkowe poza określonym przez format schowka *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne są używane dla innych pól w `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Struktura wywołuje tę funkcję z [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) Jeśli użytkownik wybierze OK z okna dialogowego Wstawianie obiektu, jeśli wybrano pozycję Utwórz przy użyciu przycisku pliku.

Aby uzyskać więcej informacji, zobacz [OleCreateFromFile](/windows/desktop/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), i [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) w zestawie Windows SDK.

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

Wywołaj tę funkcję, aby utworzyć połączony element z zawartość Schowka.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Renderowanie*<br/>
Flaga, określający, jak serwer będzie renderować element OLE. Możliwe wartości dla [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) w zestawie Windows SDK.

*cfFormat*<br/>
Określa format danych schowka przechowywanie w pamięci podręcznej podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura używana, jeśli *renderowania* OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru, tylko wtedy, gdy chcesz określić informacji o formacie dodatkowe poza określonym przez format schowka *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne są używane dla innych pól w `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zazwyczaj wywołać tę funkcję z obsługi wiadomości w poleceniu Wklej łącze w menu Edycja. (Polecenie Wklej łącze jest włączone w implementacji domyślnej [COleDocument](../../mfc/reference/coledocument-class.md) Jeśli Schowek zawiera element OLE, który może być połączony.)

Aby uzyskać więcej informacji, zobacz [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) i [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) w zestawie Windows SDK.

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

Wywołaj tę funkcję, aby utworzyć połączony element z `COleDataObject` obiektu.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do [COleDataObject](../../mfc/reference/coledataobject-class.md) obiektu, z którego ma zostać utworzony element OLE.

*Renderowanie*<br/>
Flaga, określający, jak serwer będzie renderować element OLE. Możliwe wartości dla [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) w zestawie Windows SDK.

*cfFormat*<br/>
Określa format danych schowka przechowywanie w pamięci podręcznej podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura używana, jeśli *renderowania* OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru, tylko wtedy, gdy chcesz określić informacji o formacie dodatkowe poza określonym przez format schowka *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne są używane dla innych pól w `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Połączenie się z tym podczas operacja przeciągania po użytkownik wskazuje, że można utworzyć łącza. Może również służyć do obsługi polecenia Edytuj Wklej. Jest wywoływana przez strukturę w `COleClientItem::CreateLinkFromClipboard` i [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) gdy wybrano opcję łącza.

Aby uzyskać więcej informacji, zobacz [OleCreateLinkFromData](/windows/desktop/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), i [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) w zestawie Windows SDK.

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

Wywołaj tę funkcję, aby utworzyć połączony element OLE z pliku.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Wskaźnik na nazwę pliku, z którego ma zostać utworzony element OLE.

*Renderowanie*<br/>
Flaga, określający, jak serwer będzie renderować element OLE. Możliwe wartości dla [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) w zestawie Windows SDK.

*cfFormat*<br/>
Określa format danych schowka przechowywanie w pamięci podręcznej podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura używana, jeśli *renderowania* OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru, tylko wtedy, gdy chcesz określić informacji o formacie dodatkowe poza określonym przez format schowka *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne są używane dla innych pól w `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Struktura wywołuje tę funkcję, jeśli użytkownik wybierze OK z okna dialogowego Wstawianie obiektu, gdy wybrano tworzenie przy użyciu przycisku pliku i Link pole wyboru jest zaznaczone. Jest wywoływane z [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Aby uzyskać więcej informacji, zobacz [OleCreateLinkToFile](/windows/desktop/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), i [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) w zestawie Windows SDK.

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

Wywołaj tę funkcję, aby utworzyć element osadzony; Ta funkcja spowoduje uruchomienie aplikacji serwera, który umożliwia użytkownikowi utworzenie elementów OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Identyfikator klasy*<br/>
Identyfikator, który unikatowo identyfikuje typ elementu OLE do utworzenia.

*Renderowanie*<br/>
Flaga, określający, jak serwer będzie renderować element OLE. Możliwe wartości dla [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) w zestawie Windows SDK.

*cfFormat*<br/>
Określa format danych schowka przechowywanie w pamięci podręcznej podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura używana, jeśli *renderowania* OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru, tylko wtedy, gdy chcesz określić informacji o formacie dodatkowe poza określonym przez format schowka *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne są używane dla innych pól w `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Struktura wywołuje tę funkcję, jeśli użytkownik wybierze OK z okna dialogowego Wstawianie obiektu w przypadku wybrania przycisku Utwórz nowy.

Aby uzyskać więcej informacji, zobacz [OleCreate](/windows/desktop/api/ole/nf-ole-olecreate), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), i [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) w zestawie Windows SDK.

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

Wywołaj tę funkcję, aby utworzyć element statyczny od zawartości Schowka.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Renderowanie*<br/>
Flaga, określający, jak serwer będzie renderować element OLE. Możliwe wartości dla [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) w zestawie Windows SDK.

*cfFormat*<br/>
Określa format danych schowka przechowywanie w pamięci podręcznej podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura używana, jeśli *renderowania* OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru, tylko wtedy, gdy chcesz określić informacji o formacie dodatkowe poza określonym przez format schowka *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne są używane dla innych pól w `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Statyczny element zawiera dane prezentacji, ale nie danych natywnych; w związku z tym go nie można edytować. Zazwyczaj można wywołać tę funkcję, jeśli [CreateFromClipboard](#createfromclipboard) funkcji składowej nie powiedzie się.

Aby uzyskać więcej informacji, zobacz [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) i [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) w zestawie Windows SDK.

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

Wywołaj tę funkcję, aby utworzyć element statyczny z `COleDataObject` obiektu.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do [COleDataObject](../../mfc/reference/coledataobject-class.md) obiektu, z którego ma zostać utworzony element OLE.

*Renderowanie*<br/>
Flaga, określający, jak serwer będzie renderować element OLE. Możliwe wartości dla [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) w zestawie Windows SDK.

*cfFormat*<br/>
Określa format danych schowka przechowywanie w pamięci podręcznej podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struktura używana, jeśli *renderowania* OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru, tylko wtedy, gdy chcesz określić informacji o formacie dodatkowe poza określonym przez format schowka *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne są używane dla innych pól w `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Statyczny element zawiera dane prezentacji, ale nie danych natywnych; w związku z tym go nie można edytować. To jest zasadniczo taki sam jak [CreateStaticFromClipboard](#createstaticfromclipboard) z tą różnicą, że elementów statycznych można tworzyć na podstawie dowolnego `COleDataObject`, nie tylko ze Schowka.

Używane w [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) po wybraniu statyczne.

Aby uzyskać więcej informacji, zobacz [OleCreateStaticFromData](/windows/desktop/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), i [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) w zestawie Windows SDK.

##  <a name="deactivate"></a>  COleClientItem::Deactivate

Wywołaj tę funkcję, aby zdezaktywować elementu OLE i zwolnić wszystkie zasoby skojarzone.

```
void Deactivate();
```

### <a name="remarks"></a>Uwagi

Gdy użytkownik kliknie przycisk myszy w obszarze klienta poza granice elementu, zwykle Dezaktywuj aktywny element OLE w miejscu. Należy pamiętać, że dezaktywowanie elementu OLE spowoduje odrzucenie stanie cofania, uniemożliwiając wywołać [ReactivateAndUndo](#reactivateandundo) funkcja elementu członkowskiego.

Jeśli aplikacja obsługuje cofania, nie należy wywoływać `Deactivate`; zamiast tego należy wywołać [DeactivateUI](#deactivateui).

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) w zestawie Windows SDK.

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

Wywołaj tę funkcję, gdy użytkownik dezaktywuje element, któremu został aktywowany w miejscu.

```
void DeactivateUI();
```

### <a name="remarks"></a>Uwagi

Ta funkcja spowoduje przywrócenie interfejsu użytkownika aplikacji kontenera do stanu pierwotnego, ukrywanie dowolnego menu i inne formanty, które zostały utworzone dla aktywacji w miejscu.

Ta funkcja nie opróżnia informacje o stanie cofania dla elementu. Czy informacje są przechowywane, aby [ReactivateAndUndo](#reactivateandundo) później mogą być używane do wykonania polecenia Cofnij w aplikacji serwera, w przypadku, gdy wybrano polecenie Cofnij kontenera natychmiast po dezaktywacji elementu.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) w zestawie Windows SDK.

##  <a name="delete"></a>  COleClientItem::Delete

Wywołaj tę funkcję, aby usunąć element OLE z kontenerem.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parametry

*bAutoDelete*<br/>
Określa, czy element jest do usunięcia z dokumentu.

### <a name="remarks"></a>Uwagi

Ta funkcja wywołuje [wersji](#release) funkcji członkowskiej, co z kolei spowoduje usunięcie obiektu języka C++ dla elementu, trwałe usunięcie elementu OLE z dokumentu. Jeśli osadzonego elementu OLE danych natywnych dla elementu jest usunięte. Zawsze zamknięciu używania serwera; w związku z tym jeśli element jest Otwórz łącze, ta funkcja zamyka te błędy.

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

Wywołaj `DoDragDrop` funkcja elementu członkowskiego, które można wykonać operacji przeciągania i upuszczania.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parametry

*lpItemRect*<br/>
Prostokąt elementu na ekranie współrzędne klienta (w pikselach).

*ptOffset*<br/>
Przesunięcie od *lpItemRect* których położenie myszy zakończyła się w czasie przeciągania.

*bIncludeLink*<br/>
Ustaw tę opcję na wartość TRUE, jeśli łącze, które dane powinny zostać skopiowane do Schowka. Ustaw ją na wartość FALSE, jeśli aplikacja serwera nie obsługuje łączy.

*dwEffects*<br/>
Określa, czy efekty, których elementem źródłowym przeciągania pozwoli w operacji przeciągania

*lpRectStartDrag*<br/>
Wskaźnik do prostokąt, który definiuje, w którym faktycznie zacznie przeciągania. Aby uzyskać więcej informacji zobacz następujące sekcji uwag.

### <a name="return-value"></a>Wartość zwracana

Wartość DROPEFFECT. Jeśli jest to DROPEFFECT_MOVE, należy usunąć oryginalnych danych.

### <a name="remarks"></a>Uwagi

Operacja przeciągania i upuszczania nie rozpoczyna się natychmiast. Czeka, aż kursor myszy opuszcza prostokąt określony przez *lpRectStartDrag* lub dopóki nie przeszły przez określoną liczbę milisekund. Jeśli *lpRectStartDrag* ma wartość NULL, rozmiar prostokąta wynosi jeden piksel.

Czas opóźnienia jest określona przez ustawienie klucza rejestru. Możesz zmienić czas opóźnienia, wywołując [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) lub [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Jeśli nie określisz czas opóźnienia, jest używana domyślna wartość 200 ms. Przeciągnij opóźnienia są przechowywane w następujący sposób:

- Czas opóźnienia przeciągania Windows NT jest przechowywany w HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Czas opóźnienia przeciągania 3.x Windows są przechowywane w ZWYCIĘSTWA. Plik INI, w sekcji [Windows}.

- Przeciągnij Windows 95/98 opóźnienia są przechowywane w pamięci podręcznej wersji systemu Windows. PLIKU INI.

Dla przeciągnij więcej informacji o tym, jak opóźnienie informacje są przechowywane w rejestrze albo lub. Plik INI, zobacz [WriteProfileString](/windows/desktop/api/winbase/nf-winbase-writeprofilestringa) w zestawie Windows SDK.

##  <a name="doverb"></a>  COleClientItem::DoVerb

Wywołaj `DoVerb` wykonać określone zlecenie.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nVerb*<br/>
Określa polecenie do wykonania. Może ono obejmować jedną z następujących czynności:

|Wartość|Znaczenie|Symbol|
|-----------|-------------|------------|
|- 0|Primary — Zlecenie|OLEIVERB_PRIMARY|
|- 1|Pomocniczy zlecenia|(Brak)|
|- 1|Wyświetlanie elementu do edycji|OLEIVERB_SHOW|
|- 2|Edytuj element w osobnym oknie|OLEIVERB_OPEN|
|- 3|Ukrywanie elementu|OLEIVERB_HIDE|

Wartość-1 zwykle jest aliasem dla innej zlecenie. Jeśli otwarty do edycji nie jest obsługiwany, -2 ma taki sam skutek jak -1. Aby uzyskać dodatkowe wartości, zobacz [IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) w zestawie Windows SDK.

*pView*<br/>
Wskaźnik do okna widoku; jest on używany przez serwer aktywacji w miejscu. Tego parametru powinna być równa NULL, jeśli aplikacja kontenera nie zezwala na aktywacji w miejscu.

*lpMsg*<br/>
Wskaźnik na komunikat, który spowodował elementu zostanie uaktywniony.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli pomyślnie wykonano zlecenie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja wywołuje [Aktywuj](#activate) funkcja elementu członkowskiego do wykonania zlecenie. Ponadto przechwytuje wyjątki i wyświetla okno komunikatu dla użytkownika, jeśli jeden jest zgłaszany.

Jeśli primary — zlecenie jest edycji i zero jest określona w *nVerb* parametru, aplikacja serwera zostanie uruchomiona, aby zezwolić na element OLE, który chcesz edytować. Jeśli aplikacja kontenera obsługuje aktywacji w miejscu, edytowanie może odbywać się w miejscu. Jeśli kontener nie obsługuje aktywacji w miejscu (lub jeśli określono zlecenie Otwórz), serwer jest uruchamiany w osobnym oknie i edytowanie może odbywać się tam. Zazwyczaj po użytkownik aplikacji kontenera kliknie dwukrotnie elementu OLE wartość primary — zlecenie w *nVerb* parametr określa akcję, która użytkownik może robić. Jednakże, jeśli serwer obsługuje tylko jedną akcję, zajmuje tę akcję, niezależnie od tego, która wartość jest określona w *nVerb* parametru.

##  <a name="draw"></a>  COleClientItem::Draw

Wywołaj tę funkcję, aby narysować element OLE w określonym prostokąt otaczający w kontekście określonego urządzenia.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*pDC*<br/>
Wskaźnik do [CDC](../../mfc/reference/cdc-class.md) obiekt używany do rysowania elementu OLE.

*lpBounds*<br/>
Wskaźnik do [CRect](../../atl-mfc-shared/reference/crect-class.md) obiektu lub `RECT` strukturę, która definiuje prostokąt otaczający do rysowania elementu OLE (w jednostkach logicznych jest ustalany na podstawie kontekstu urządzenia).

*nDrawAspect*<br/>
Określa aspekt OLE elementu, oznacza to, jak powinna być wyświetlana. Jeśli *nDrawAspect* wynosi -1, ostatni aspekt, ustawić za pomocą [SetDrawAspect](#setdrawaspect) jest używany. Aby uzyskać więcej informacji na temat możliwych wartości dla tej flagi, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Funkcja może używać metaplik reprezentacja elementu OLE, utworzone przez [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) funkcji składowej typu `COleServerItem`.

Zazwyczaj używają `Draw` do wyświetlania na ekranie, przekazując kontekst urządzenia ekranu jako *kontrolera pDC*. W takim przypadku należy określić tylko dwa pierwsze parametry.

*LpBounds* parametr identyfikuje prostokąt w kontekście urządzenia docelowego (względem jego bieżący tryb mapowanie). Renderowanie może obejmować skalowanie obrazu i może służyć przez aplikacje kontenera celu nałożenia widoku, która skaluje się między widokiem wyświetlanych i finalnego obrazu drukowanych.

Aby uzyskać więcej informacji, zobacz [IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw) w zestawie Windows SDK.

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

Zwraca widok, w której element jest aktywowany w miejscu.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do widoku. w przeciwnym razie wartość NULL, jeśli element nie jest aktywowany w miejscu.

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

Wywołaj tę funkcję, aby pobrać rozmiar elementu OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*lpSize*<br/>
Wskaźnik do `SIZE` struktury lub [CSize](../../atl-mfc-shared/reference/csize-class.md) obiektu, który będzie otrzymywać informacje o rozmiarze.

*nDrawAspect*<br/>
Określa aspekt elementu OLE, którego granice, które mają być pobierane. Możliwe wartości, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; 0, jeśli element OLE jest pusta.

### <a name="remarks"></a>Uwagi

Ta funkcja udostępnia te same informacje co [GetExtent](#getextent). Jednak można wywoływać `GetCachedExtent` Aby uzyskać informacje o zakresie podczas przetwarzania innych programów obsługi OLE, takich jak [OnChange](#onchange). Wymiary znajdują się w jednostkach MM_HIMETRIC.

Jest to możliwe, ponieważ `GetCachedExtent` używa [IViewObject2](/windows/desktop/api/oleidl/nn-oleidl-iviewobject2) interfejsu, zamiast używać [IOleObject](/windows/desktop/api/oleidl/nn-oleidl-ioleobject) interfejsu można pobrać w zakresie tego elementu. `IViewObject2` Obiektu COM buforuje informacje o stopniu, używane podczas poprzedniego wywołania [IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw).

Aby uzyskać więcej informacji, zobacz [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) w zestawie Windows SDK.

##  <a name="getclassid"></a>  COleClientItem::GetClassID

Zwraca identyfikator klasy elementu do pamięci wskazywany przez *pClassID*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parametry

*pClassID*<br/>
Wskaźnik do identyfikatora typu [CLSID](/windows/desktop/com/clsid-key-hklm) można pobrać identyfikator klasy. Instrukcje dotyczące CLSID zobacz zestaw Windows SDK.

### <a name="remarks"></a>Uwagi

Identyfikator klasy jest 128-bitową liczbą, która unikatowo identyfikuje aplikację, która umożliwia edytowanie elementu.

Aby uzyskać więcej informacji, zobacz [IPersist::GetClassID](/windows/desktop/api/objidl/nf-objidl-ipersist-getclassid) w zestawie Windows SDK.

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

Wywołaj tę funkcję, aby uzyskać `COleDataSource` obiekt, który zawiera wszystkie dane, które zostają umieszczone w Schowku przez wywołanie [CopyToClipboard](#copytoclipboard) funkcja elementu członkowskiego.

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parametry

*pDataSource*<br/>
Wskaźnik do [COleDataSource](../../mfc/reference/coledatasource-class.md) obiektu, który będzie otrzymywać dane zawarte w elemencie OLE.

*bIncludeLink*<br/>
Wartość TRUE, jeśli Połącz dane mają zostać uwzględnione; w przeciwnym razie wartość FALSE.

*lpOffset*<br/>
Przesunięcie kursora myszy ze źródła obiektu w pikselach.

*lpSize*<br/>
Rozmiar obiektu w pikselach.

### <a name="remarks"></a>Uwagi

`GetClipboardData` jest wywoływana jako domyślną implementację elementu [OnGetClipboardData](#ongetclipboarddata). Zastąp `OnGetClipboardData` tylko wtedy, gdy chcesz zaoferować formatów danych oprócz oferowane przez `CopyToClipboard`. Umieścić te formaty w `COleDataSource` obiekt przed lub po wywołaniu `CopyToClipboard`, a następnie przekaż `COleDataSource` obiekt [COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) funkcji. Na przykład, chcąc położenie elementu OLE w dokumencie jego kontenera w taki sposób, aby dołączyć ją do Schowka, możesz będzie zdefiniowanie własnego formatu przekazywania tych informacji i umieść go w `COleDataSource` przed wywołaniem `CopyToClipboard`.

##  <a name="getdocument"></a>  COleClientItem::GetDocument

Wywołaj tę funkcję, aby uzyskać wskaźnik do dokumentu, który zawiera element OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do dokumentu, który zawiera element OLE. Wartość NULL, jeśli element nie jest częścią dokumentu.

### <a name="remarks"></a>Uwagi

This, wskaźnik zezwala na dostęp do `COleDocument` obiekt, który jest przekazywany jako argument do `COleClientItem` konstruktora.

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

Wywołaj `GetDrawAspect` funkcja elementu członkowskiego w celu ustalenia bieżącego "proporcji" lub widoku elementu.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość z wyliczenia DVASPECT, w których wartości są wymienione w odwołanie do [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Uwagi

Aspekt Określa, jaki element ma być renderowany.

##  <a name="getextent"></a>  COleClientItem::GetExtent

Wywołaj tę funkcję, aby pobrać rozmiar elementu OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parametry

*lpSize*<br/>
Wskaźnik do `SIZE` struktury lub `CSize` obiektu, który będzie otrzymywać informacje o rozmiarze.

*nDrawAspect*<br/>
Określa aspekt elementu OLE, którego granice, które mają być pobierane. Możliwe wartości, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; 0, jeśli element OLE jest pusta.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja została napisana przy użyciu biblioteki klas Microsoft Foundation, ta funkcja powoduje, że [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) funkcji składowej typu odpowiadającego `COleServerItem` obiekt wywoływany. Należy pamiętać, że pobrany rozmiar może się różnić od rozmiaru ostatnim ustawieniu [SetExtent](#setextent) funkcji członkowskiej; rozmiar określony przez `SetExtent` jest traktowany jako sugestię. Wymiary znajdują się w jednostkach MM_HIMETRIC.

> [!NOTE]
>  Nie wywołuj `GetExtent` podczas przetwarzania nieprawidłowego OLE, takich jak [OnChange](#onchange). Wywołaj [GetCachedExtent](#getcachedextent) zamiast tego.

Aby uzyskać więcej informacji, zobacz [IOleObject::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getextent) w zestawie Windows SDK.

##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry

Wywołaj tę funkcję elementu członkowskiego, aby pobrać dojścia do zasobu ikony skojarzone z serwerem określonym identyfikatorem CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parametry

*Identyfikator klasy*<br/>
Odwołanie do identyfikatora CLSID serwera skojarzonych z ikoną.

### <a name="return-value"></a>Wartość zwracana

Prawidłowe dojście do zasobu ikony lub wartość NULL, jeśli nie można odnaleźć serwera ikona lub ikona domyślna.

### <a name="remarks"></a>Uwagi

Ta funkcja elementu członkowskiego nie uruchomienie serwera ani nie uzyskać ikony dynamicznie, nawet wtedy, gdy serwer jest już uruchomiony. Zamiast tej funkcji elementu członkowskiego spowoduje otwarcie obrazu pliku wykonywalnego serwera i pobiera statyczny ikony skojarzone z serwerem, ponieważ została zarejestrowana.

##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile

Pobiera metaplik używany do rysowania ikona elementu.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Wartość zwracana

Dojście do metaplik, jeśli to się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

Jeśli nie ma żadnej bieżącej ikony, zwracany jest ikona domyślna. To jest wywoływana automatycznie przez okna dialogowe MFC/OLE i zazwyczaj nie jest wywoływany bezpośrednio.

Ta funkcja również wywołuje [SetIconicMetafile](#seticonicmetafile) w pamięci podręcznej metaplik do późniejszego użycia.

##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow

Wywołaj `GetInPlaceWindow` funkcję elementu członkowskiego, aby uzyskać wskaźnik do okna, w którym element został otwarty do edycji w miejscu.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do elementu okna edycji w miejscu; Wartość NULL, jeśli element nie jest aktywny czy jej serwer jest niedostępny.

### <a name="remarks"></a>Uwagi

Ta funkcja powinna być wywoływana tylko dla elementów, które są aktywne w miejscu.

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

Wywołaj tę funkcję, aby uzyskać bieżący stan elementu OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Wartość zwracana

A `COleClientItem::ItemState` wyliczyć wartość, która może być jedną z następujących czynności: `emptyState`, `loadedState`, `openState`, `activeState`, `activeUIState`. Aby uzyskać informacje o tych stanów, zobacz artykuł [kontenerów: Stany elementu klienckiego](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Uwagi

Aby otrzymać powiadomienie po zmianie stanu elementu OLE, użyj [OnChange](#onchange) funkcja elementu członkowskiego.

Aby uzyskać więcej informacji, zobacz artykuł [kontenerów: Stany elementu klienckiego](../../mfc/containers-client-item-states.md).

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

Zwraca kod stanu ostatniej operacji OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość SCODE.

### <a name="remarks"></a>Uwagi

Dla funkcji elementów członkowskich, które zwracają wartość logiczna, wartość FALSE lub innego członka funkcji, które zwracają wartość NULL `GetLastStatus` zwraca szczegółowe informacje o błędzie. Należy pamiętać, że większość funkcji elementów członkowskich OLE zgłaszają wyjątki poważniejsze błędów. Informacje szczegółowe dotyczące interpretacji SCODE zależy od bazowego połączenia OLE, który ostatnio zwrócił wartość SCODE.

Aby uzyskać więcej informacji na temat SCODE, zobacz [struktury COM kody błędów](/windows/desktop/com/structure-of-com-error-codes) w dokumentacji zestawu Windows SDK.

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

Wywołaj tę funkcję, aby uzyskać bieżącą wartość opcji Aktualizacja łącza dla elementu OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Wartość zwracana

Jeden z następujących wartości:

- OLEUPDATE_ALWAYS aktualizacji połączony element, jeśli to możliwe. Ta opcja obsługuje przycisk radiowy aktualizacji automatycznych link w oknie dialogowym łącza.

- OLEUPDATE_ONCALL zaktualizować połączonego elementu tylko na żądania z aplikacji kontenera (gdy [UpdateLink](#updatelink) funkcja członkowska jest wywoływana). Ta opcja obsługuje przycisk radiowy ręcznej aktualizacji link w oknie dialogowym łącza.

### <a name="remarks"></a>Uwagi

To jest zaawansowanym działaniem.

Ta funkcja jest wywoływana automatycznie przez [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) klasy.

Aby uzyskać więcej informacji, zobacz [IOleLink::GetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-getupdateoptions) w zestawie Windows SDK.

##  <a name="gettype"></a>  COleClientItem::GetType

Wywołaj tę funkcję, aby określić, czy osadzony lub połączony element OLE lub statycznym.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Wartość zwracana

Liczba całkowita bez znaku z jedną z następujących wartości:

- Element OT_LINK OLE jest łączem.

- Jest osadzony element OT_EMBEDDED OLE.

- Element OT_STATIC OLE są statyczne, oznacza to, zawiera tylko prezentacji, dane nie natywnych i dlatego nie można edytować.

##  <a name="getusertype"></a>  COleClientItem::GetUserType

Wywołaj tę funkcję, aby uzyskać widoczny dla użytkownika ciąg opisujący typ elementu OLE, takich jak "Dokument programu Word."

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parametry

*nUserClassType*<br/>
Wartość określająca żądany wariant ciąg opisujący typ elementu OLE. Może to mieć jedną z następujących wartości:

- USERCLASSTYPE_FULL pełnej wpisz nazwę wyświetlaną dla użytkownika.

- USERCLASSTYPE_SHORT krótka nazwa (maksymalnie 15 znaków) do użycia w menu podręcznym i okno dialogowe Edytuj linki.

- Nazwa USERCLASSTYPE_APPNAME obsługi klasy aplikacji.

*rString*<br/>
Odwołanie do [CString](../../atl-mfc-shared/reference/cstringt-class.md) obiektu, do którego ma zostać zwrócony ciąg opisujący typ elementu OLE.

### <a name="remarks"></a>Uwagi

Jest to często wpis w systemowej bazie danych rejestracji.

W przypadku żądanego, ale nie jest dostępna pełna nazwa typu krótka nazwa jest używana zamiast tego. Jeśli żaden wpis dla typu elementu OLE znajduje się w bazie danych rejestracji lub jeśli nie ma żadnych typów użytkowników, które zarejestrowana dla typu elementu OLE, następnie typ użytkownika przechowywanych obecnie we służy element OLE. Jeśli nazwa typu użytkownika jest pustym ciągiem, "Nieznanego obiektu" jest używany.

Aby uzyskać więcej informacji, zobacz [IOleObject::GetUserType](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getusertype) w zestawie Windows SDK.

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

Wywołaj tę funkcję, aby sprawdzić, czy element OLE jest aktywny w miejscu.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli element OLE jest aktywny w miejscu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Są często do wykonywania logiki różne w zależności od tego, czy element jest edytowany w miejscu. Funkcja sprawdza, czy bieżący stan elementu jest równa albo `activeState` lub `activeUIState`.

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

Wywołaj tę funkcję, aby sprawdzić, czy element OLE na bieżąco.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli aktualne; element OLE w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Połączony element może być nieaktualna jego dokument źródłowy został zaktualizowany. Element osadzony, który zawiera Link znajdujący się w nim podobnie może stać się nieaktualne. Funkcja wykonuje sprawdzenie cyklicznego elementu OLE. Pamiętaj, że ustalania, czy element OLE jest nieaktualna może być jak kosztowne niż rzeczywiście aktualizacji.

Jest to automatycznie przez [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) implementacji.

Aby uzyskać więcej informacji, zobacz [IOleObject::IsUpToDate](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-isuptodate) w zestawie Windows SDK.

##  <a name="ismodified"></a>  COleClientItem::IsModified

Wywołaj tę funkcję, aby zobaczyć, czy element OLE został zmieniony (zmodyfikowane od ostatniego zapisu).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli element OLE został zmieniony; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [IPersistStorage::IsDirty](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-isdirty) w zestawie Windows SDK.

##  <a name="isopen"></a>  COleClientItem::IsOpen

Wywołaj tę funkcję, aby sprawdzić, czy element OLE jest otwarte oznacza to otwarte w wystąpieniu aplikacja serwera uruchomiona w osobnym oknie.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli element OLE jest otwarty; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Służy do określenia, kiedy narysuj obiekt za pomocą wzorca kreskowaniu. Otwórz obiekt powinien mieć wzorem kreskowanym rysowane na obiekcie. Możesz użyć [CRectTracker](../../mfc/reference/crecttracker-class.md) obiekt w tym celu.

##  <a name="isrunning"></a>  COleClientItem::IsRunning

Wywołaj tę funkcję, aby zobaczyć, czy element OLE jest uruchomiony; czy element jest ładowany i uruchamiany w aplikacji serwera.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli element OLE jest uruchomiony; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [OleIsRunning](/windows/desktop/api/ole2/nf-ole2-oleisrunning) w zestawie Windows SDK.

##  <a name="onactivate"></a>  COleClientItem::OnActivate

Metoda wywoływana przez platformę, by powiadomić element, czy po prostu został aktywowany w miejscu.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Uwagi

Należy pamiętać, że ta funkcja jest wywoływana, aby wskazać, że serwer jest uruchomiony, nie, aby wskazać, że zainstalowano interfejs użytkownika w aplikacji kontenera. W tym momencie obiekt nie ma interfejsu użytkownika aktywny (nie jest `activeUIState`). Nie został on zainstalowany, jego menu lub paska narzędzi. [OnActivateUI](#onactivateui) funkcja członkowska jest wywoływana, gdy tak się stanie.

Domyślna implementacja wywołuje [OnChange](#onchange) funkcji składowej z OLE_CHANGEDSTATE jako parametr. Należy przesłonić tę funkcję, aby wykonać niestandardowe przetwarzanie, gdy element staje się aktywny w miejscu.

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

Struktura wywołuje `OnActivateUI` po obiekcie została wprowadzona w stan aktywny UI.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Uwagi

Obiekt ma zainstalowany menu i paska narzędzi.

Domyślna implementacja pamięta HWND serwera do późniejszego `GetServerWindow` wywołania.

##  <a name="onchange"></a>  COleClientItem::OnChange

Wywoływane przez platformę, gdy użytkownik modyfikuje, zapisuje lub zamyka element OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parametry

*nCode*<br/>
Przyczyna serwera zmieniono tego elementu. Może mieć jedną z następujących wartości:

- OLE_CHANGED OLE wyglądu elementu została zmieniona.

- Element OLE_SAVED OLE został zapisany.

- Element OLE_CLOSED OLE został zamknięty.

- OLE_CHANGED_STATE OLE element został zmieniony z jednego stanu do drugiego.

*dwParam*<br/>
Jeśli *nCode* OLE_SAVED lub OLE_CLOSED, ten parametr nie jest używany. Jeśli *nCode* jest OLE_CHANGED, ten parametr określa aspekt elementu OLE, które uległy zmianie. Możliwe wartości, zobacz *dwParam* parametru [COleClientItem::Draw](#draw). Jeśli *nCode* jest OLE_CHANGED_STATE, ten parametr jest `COleClientItem::ItemState` wyliczonych wartości i opisy stanu wprowadzanych. Może mieć jedną z następujących wartości: `emptyState`, `loadedState`, `openState`, `activeState`, lub `activeUIState`.

### <a name="remarks"></a>Uwagi

(Jeśli aplikacja serwera są zapisywane przy użyciu biblioteki klas Microsoft Foundation, ta funkcja jest wywoływana w odpowiedzi na `Notify` funkcje elementów członkowskich `COleServerDoc` lub `COleServerItem`.) Domyślna implementacja powoduje oznaczenie dokumentu kontenera jako zmodyfikowanych Jeśli *nCode* OLE_CHANGED lub OLE_SAVED.

OLE_CHANGED_STATE, aby uzyskać bieżący stan zwróciło [GetItemState](#getitemstate) będzie w dalszym ciągu poprzedni stan, co oznacza stanu, które były aktualne przed tą zmianą stanu.

Należy przesłonić tę funkcję, aby odpowiadanie na zmiany w stanie elementu OLE. Zaktualizujesz wygląd elementu unieważniając obszaru, w którym jest wyświetlany element. Na początku przesłonięcia, należy wywołać implementację klasy bazowej.

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

Metoda wywoływana przez platformę, by powiadomić kontenera, w którym element OLE zakres został zmieniony podczas aktywacji w miejscu.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parametry

*rectPos*<br/>
Wskazuje pozycję elementu względem pola klienta aplikacji kontenera.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli pomyślnie zostanie zmieniona pozycja elementu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja Określa nowy prostokąt widoczne wywołań i element OLE [SetItemRects](#setitemrects) z nowymi wartościami. Domyślna implementacja jest obliczana prostokąt widoczny dla elementu i przekazuje informację do serwera.

Należy przesłonić tę funkcję, aby zastosować reguły specjalne do operacji zmiany rozmiaru/przenoszenia. Jeśli aplikacja jest napisany w MFC, to wywołanie wyników, ponieważ serwer o nazwie [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

Wywoływane przez platformę, gdy element OLE przejście ze stanu aktywne w miejscu ( `activeState`) do stanu załadowane, co oznacza dezaktywacji po aktywacji w miejscu.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Uwagi

Należy pamiętać, że ta funkcja jest wywoływana w celu wskazania, że element OLE są zamknięte, nie to interfejs użytkownika zostało usunięte z aplikacji kontenera. Jeśli tak się stanie, [OnDeactivateUI](#ondeactivateui) funkcja członkowska jest wywoływana.

Domyślna implementacja wywołuje [OnChange](#onchange) funkcji składowej z OLE_CHANGEDSTATE jako parametr. Należy przesłonić tę funkcję, aby wykonać niestandardowe przetwarzanie, gdy jest dezaktywowany aktywny element w miejscu. Na przykład jeśli są używane polecenia Cofnij do aplikacji kontenera można zastąpić tę funkcję, aby odrzucić poprzedni stan wskazujący, że ostatnia operacja wykonana na element OLE nie można cofnąć, gdy element jest dezaktywowany.

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

Wywoływane przez platformę, gdy użytkownik wywoła polecenie Cofnij po aktywowaniu elementu OLE w miejscu.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje [DeactivateUI](#deactivateui) dezaktywować interfejs użytkownika serwera. Należy przesłonić tę funkcję, w przypadku wdrażania polecenia Cofnij do aplikacji kontenera. W przesłonięcia Wywołaj funkcję w wersji klasy bazowej, a następnie Cofnij ostatnie polecenie, które są wykonywane w aplikacji.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::DeactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) w zestawie Windows SDK.

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

Wywołuje się, gdy użytkownik dezaktywuje element, który został aktywowany w miejscu.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parametry

*bUndoable*<br/>
Określa, czy edycji zmiany można cofnąć.

### <a name="remarks"></a>Uwagi

Ta funkcja spowoduje przywrócenie interfejsu użytkownika aplikacji kontenera do stanu pierwotnego, ukrywanie dowolnego menu i inne formanty, które zostały utworzone dla aktywacji w miejscu.

Jeśli *bUndoable* ma wartość FAŁSZ, kontenera należy wyłączyć polecenia Cofnij obowiązuje odrzucanie poprzedni stan kontenera, ponieważ oznacza, że ostatnia operacja wykonana przez serwer jest nieodwracalna.

##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState

Wywoływane przez platformę, gdy użytkownik wykona akcję, która odrzuca wszystkie stany cofania podczas edycji elementu OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja nic nie robi. Należy przesłonić tę funkcję, w przypadku wdrażania polecenia Cofnij do aplikacji kontenera. W przypadku przesłonięcia odrzucenie stany cofania aplikacji kontenera.

Serwer został napisany z biblioteki klas Microsoft Foundation, serwer może spowodować tej funkcji do wywołania przez wywołanie [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::DiscardUndoState](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) w zestawie Windows SDK.

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

Wywoływane przez platformę, by pobrać `COleDataSource` obiekt, który zawiera wszystkie dane, które zostają umieszczone w Schowku wywołania [CopyToClipboard](#copytoclipboard) lub [DoDragDrop](#dodragdrop) funkcja elementu członkowskiego.

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
Ustaw tę opcję na wartość TRUE, jeśli danych link powinien zostać skopiowany do Schowka. Ustaw tę pozycję na wartość FALSE, jeśli serwer aplikacji nie obsługuje łączy.

*lpOffset*<br/>
Wskaźnik do przesunięcia kursora myszy ze źródła obiektu w pikselach.

*lpSize*<br/>
Wskaźnik do rozmiaru obiektu w pikselach.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do [COleDataSource](../../mfc/reference/coledatasource-class.md) obiekt zawierający dane Schowka.

### <a name="remarks"></a>Uwagi

Domyślna implementacja ta funkcja wywołuje [GetClipboardData](#getclipboarddata).

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

Struktura wywołuje `OnGetClipRect` funkcja elementu członkowskiego, by uzyskać współrzędne prostokątnego wycinka elementu, który jest edytowany w miejscu.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parametry

*rClipRect*<br/>
Wskaźnik do obiektu klasy [CRect](../../atl-mfc-shared/reference/crect-class.md) który będzie przechowywać współrzędne prostokątnego wycinka elementu.

### <a name="remarks"></a>Uwagi

Współrzędne są podawane w pikselach względem pola klienta okna aplikacji kontenera.

Domyślna implementacja po prostu zwraca prostokąt klienta widok, w której element jest aktywny w miejscu.

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

Struktura wywołuje `OnGetItemPosition` funkcja elementu członkowskiego, by uzyskać współrzędne elementu, który jest edytowany w miejscu.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parametry

*elemencie rPosition*<br/>
Odwołanie do [CRect](../../atl-mfc-shared/reference/crect-class.md) obiektu, który będzie zawierać współrzędne elementu.

### <a name="remarks"></a>Uwagi

Współrzędne są podawane w pikselach względem pola klienta okna aplikacji kontenera.

Domyślna implementacja tej funkcji, nic nie robi. Aplikacje, które obsługują edycję w miejscu wymaga implementacji.

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

Wywoływane przez platformę, gdy element jest aktywowany w miejscu.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parametry

*ppMainFrame*<br/>
Wskaźnik do wskaźnika do głównej ramki okna.

*ppDocFrame*<br/>
Wskaźnik do wskaźnika do okna ramki dokumentu.

*lpFrameInfo*<br/>
Wskaźnik do [OLEINPLACEFRAMEINFO](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) struktury, który będzie otrzymywać informacje okna ramki.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja jest używana do pobierania informacji o oknie nadrzędnym elementu OLE.

Jeśli kontener jest aplikacja MDI, domyślna implementacja zwraca wskaźnik do [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) obiektu *ppMainFrame* i wskaźnik do aktywnego [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)obiektu *ppDocFrame*. Jeśli kontener jest aplikacją SDI, domyślna implementacja zwraca wskaźnik do [CFrameWnd](../../mfc/reference/cframewnd-class.md) obiektu *ppMainFrame* i zwraca wartość NULL w *ppDocFrame*. Domyślna implementacja wypełnia również elementy członkowskie *lpFrameInfo*.

Przesłonić tę funkcję tylko wtedy, gdy jest to domyślna implementacja nie własnych aplikacji; na przykład, jeśli aplikacja ma paradygmatu interfejsu użytkownika, który różni się od SDI lub MDI. Jest to zaawansowany możliwym do zastąpienia.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::GetWindowContext](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) i [OLEINPLACEFRAMEINFO](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) struktury w zestawie Windows SDK.

##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus

Wywoływane przez platformę podczas aktywacji w miejscu, aby wstawić menu aplikacji kontenera do pustego menu.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Wskazuje pustego menu.

*lpMenuWidths*<br/>
Punkty do tablicy sześciu DŁUGICH wartości wskazujący, ile menu znajdują się w każdej z następujących grup menu: Plik, Edytuj, kontenerów, obiektów, w oknie Pomoc. Aplikacja kontenera jest odpowiedzialny za grupy menu Plik, kontener i okna, odpowiadające elementom 0, 2 i 4 tej tablicy.

### <a name="remarks"></a>Uwagi

To menu jest następnie przekazywany do serwera, który wstawia swój własny menu, Tworzenie złożonego menu. Ta funkcja może zostać wywołana wielokrotnie tworzenie kilka złożonego menu.

Domyślna implementacja wstawia do *pMenuShared* menu kontenera w miejscu, czyli grupy menu Plik, kontener i okna. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) służy do ustawiania tego zasobu menu. Domyślna implementacja przypisuje odpowiednie wartości do elementów, 0, 2 i 4 w *lpMenuWidths*, w zależności od zasobów menu. Przesłonić tę funkcję, jeśli domyślna implementacja nie jest odpowiedni dla aplikacji; na przykład, jeśli aplikacja nie korzysta z szablonów dokumentów kojarzenia zasoby z typów dokumentów. Jeśli zastąpisz tę funkcję, należy również zastąpić [OnSetMenu](#onsetmenu) i [OnRemoveMenus](#onremovemenus). Jest to zaawansowany możliwym do zastąpienia.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceFrame::InsertMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) w zestawie Windows SDK.

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

Metoda wywoływana przez platformę, by usunąć menu kontenera z określonym złożonego menu, po zakończeniu aktywacji w miejscu.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Wskazuje złożonego menu tworzony przez wywołania [OnInsertMenus](#oninsertmenus) funkcja elementu członkowskiego.

### <a name="remarks"></a>Uwagi

Domyślna implementacja powoduje usunięcie z *pMenuShared* menu kontenera w miejscu, które jest, grupy menu Plik, kontener i okna. Przesłonić tę funkcję, jeśli domyślna implementacja nie jest odpowiedni dla aplikacji; na przykład, jeśli aplikacja nie korzysta z szablonów dokumentów kojarzenia zasoby z typów dokumentów. Jeśli zastąpisz tę funkcję, należy prawdopodobnie zastąpić [OnInsertMenus](#oninsertmenus) i [OnSetMenu](#onsetmenu) także. Jest to zaawansowany możliwym do zastąpienia.

Podmenu na *pMenuShared* może być współużytkowany przez więcej niż jeden złożony menu, jeśli serwer ma wielokrotne wywołania `OnInsertMenus`. W związku z tym nie należy usuwać wszelkich podmenu w zastąpienie metody `OnRemoveMenus`; tylko należy odłączyć.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceFrame::RemoveMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) w zestawie Windows SDK.

##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy

Metoda wywoływana przez platformę, by przewinąć element OLE w odpowiedzi na żądania z serwera.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parametry

*sizeExtent*<br/>
Określa odległość, w pikselach, aby przewijać w x i y kierunkach.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli element został przewijane; 0, jeśli element nie może być przewijane.

### <a name="remarks"></a>Uwagi

Na przykład jeśli użytkownik przesuwa się poza regionem widoczne podczas wykonywania edycji w miejscu elementu OLE jest częściowo widoczny, ta funkcja jest wywoływana widoczne kursora. Domyślna implementacja nic nie robi. Należy przesłonić tę funkcję, aby przewinąć element według określonej ilości. Należy pamiętać, że w wyniku przewijanie, widoczną część elementu OLE można zmienić. Wywołaj [SetItemRects](#setitemrects) można zaktualizować elementu prostokąt widoczny.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::Scroll](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-scroll) w zestawie Windows SDK.

##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu

Wywoływane przez platformę, dwa razy podczas aktywacji w miejscu rozpoczyna się i kończy; Aby zainstalować złożone menu i po raz drugi po raz pierwszy (przy użyciu *holemenu* równa NULL) go usunąć.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Wskaźnik do złożonego menu tworzony przez wywołania [OnInsertMenus](#oninsertmenus) funkcja elementu członkowskiego i `InsertMenu` funkcji.

*holemenu*<br/>
Obsługa deskryptora menu zwracany przez `OleCreateMenuDescriptor` funkcji lub wartość NULL, jeśli kod dispatching zostanie usunięta.

*hwndActiveObject*<br/>
Dojście do okna edycji elementu OLE. To okno, które będą otrzymywać polecenia edycji OLE.

### <a name="remarks"></a>Uwagi

Domyślna implementacja instaluje lub usuwa złożone menu, a następnie wywołuje [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor) funkcję, aby zainstalować lub usunąć dispatching kodu. Należy przesłonić tę funkcję, jeśli domyślna implementacja nie jest odpowiedni dla aplikacji. Jeśli zastąpisz tę funkcję, należy prawdopodobnie zastąpić [OnInsertMenus](#oninsertmenus) i [OnRemoveMenus](#onremovemenus) także. Jest to zaawansowany możliwym do zastąpienia.

Aby uzyskać więcej informacji, zobacz [OleCreateMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor), i [IOleInPlaceFrame::SetMenu](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) w zestawie Windows SDK.

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

Metoda wywoływana przez platformę, by pokazać lub ukryć paski sterowania aplikacji kontenera.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parametry

*pFrameWnd*<br/>
Wskaźnik do okno ramowe aplikacji kontenera. Może to być główne okno ramowe lub okno podrzędne MDI.

*bShow*<br/>
Określa, czy paski sterowania mają zostać pokazane lub ukryte.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli wywołanie funkcji powoduje, że zmiany w stanie paski sterowania; 0 Jeśli wywołanie powoduje, że nie wprowadzono zmian lub *pFrameWnd* nie wskazuje kontenera ramki okna.

### <a name="remarks"></a>Uwagi

Ta funkcja zwraca 0, jeśli paski sterowania znajdują się już w stanie określony przez *bShow.* Ta operacja zostanie wykonana, na przykład, jeśli są ukrywane paski sterowania i *bShow* ma wartość FALSE.

Domyślna implementacja usuwa pasek narzędzi z okno ramek najwyższego poziomu.

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

Metoda wywoływana przez platformę, by wyświetlić element OLE, dzięki czemu całkowicie widoczne podczas edycji.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Uwagi

Jest używany, gdy aplikacja kontenera obsługuje łącza do elementów osadzonych (to znaczy, jeśli mają pochodne klasy dokumentów z [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Ta funkcja jest wywoływana podczas aktywacji w miejscu lub jeśli element OLE została źródło łącza, a użytkownik chce, aby go edytować. Domyślna implementacja aktywuje pierwszy widok dokumentu kontenera. Należy przesłonić tę funkcję, aby przewiń dokument o, tak aby będzie widoczna pozycja OLE.

##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle

Wywoływane przez platformę podczas aktywacji w miejscu, aby zaktualizować pasek tytułu okna ramki.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Wartość zwracana

Zaktualizowana wartość różną od zera, jeśli ta funkcja tytułu ramki, w przeciwnym razie wartość zero.

### <a name="remarks"></a>Uwagi

Domyślna implementacja nie zmienia się tytuł okna ramek. Przesłonić tę funkcję, jeśli chcesz tytułu innej ramki dla aplikacji, na przykład " *aplikacja serwera* - *elementu* w *docname*" (tak, jak "Microsoft Excel — arkusz kalkulacyjny w raporcie. DOC"). Jest to zaawansowany możliwym do zastąpienia.

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

Wywołaj tę funkcję, aby ponownie aktywować elementów OLE i Cofnij Ostatnia operacja wykonana przez użytkownika podczas edycji w miejscu.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja kontenera obsługuje polecenie Cofnij, wywołaj tę funkcję, jeśli użytkownik wybierze polecenie Cofnij natychmiast po dezaktywacji elementu OLE.

Jeśli aplikacja serwera są zapisywane przy użyciu biblioteki klas Microsoft Foundation, ta funkcja powoduje wywołanie serwer [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject::ReactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) w zestawie Windows SDK.

##  <a name="release"></a>  COleClientItem::Release

Wywołaj tę funkcję, aby wyczyścić zasoby używane przez element OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Flaga, określania, w jakich okolicznościach elementu OLE jest zapisywana, gdy zwraca załadować stan. Aby uzyskać listę możliwych wartości, zobacz [COleClientItem::Close](#close).

### <a name="remarks"></a>Uwagi

`Release` jest wywoływana przez `COleClientItem` destruktora.

Aby uzyskać więcej informacji, zobacz [IUnknown::Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) w zestawie Windows SDK.

##  <a name="reload"></a>  COleClientItem::Reload

Zamknięcie i ponowne załadowanie elementu.

```
BOOL Reload();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Wywołaj `Reload` funkcji po aktywowaniu elementu jako element innego typu przez wywołanie [ActivateAs](#activateas).

##  <a name="run"></a>  COleClientItem::Run

Jest uruchamiana aplikacja skojarzona z tym elementem.

```
void Run();
```

### <a name="remarks"></a>Uwagi

Wywołaj `Run` funkcja elementu członkowskiego, aby uruchomić aplikację serwera przed aktywowaniem elementu. Jest to wykonywane automatycznie przez [Aktywuj](#activate) i [DoVerb](#doverb), więc zazwyczaj nie jest to konieczne wywołać tę funkcję. Wywołaj tę funkcję, jeśli jest to niezbędne do uruchomienia serwera, aby można było ustawić atrybut elementów, takich jak [SetExtent](#setextent), przed wykonaniem [DoVerb](#doverb).

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

Wywołaj `SetDrawAspect` funkcja elementu członkowskiego, aby ustawić "proporcji" lub widoku elementu.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parametry

*nDrawAspect*<br/>
Wartość z wyliczenia DVASPECT. Ten parametr może mieć jedną z następujących wartości:

- Element DVASPECT_CONTENT jest reprezentowana w taki sposób, aby go mogą być wyświetlane jako osadzonego obiektu wewnątrz jej kontenera.

- DVASPECT_THUMBNAIL element jest renderowany w reprezentacji "miniaturę", więc, że mogą być wyświetlane w narzędziu do przeglądania.

- Element DVASPECT_ICON jest reprezentowany przez ikonę.

- Element DVASPECT_DOCPRINT jest reprezentowany tak, jakby były drukowane, za pomocą polecenia drukowania, za pomocą menu Plik.

### <a name="remarks"></a>Uwagi

Aspekt Określa, jak element ma być renderowany przy platformy [Rysowanie](#draw) dla tej funkcji, jeśli wartość domyślna *nDrawAspect* argument jest używany.

Ta funkcja jest wywoływana automatycznie przez ikonę zmiany (i innych oknach dialogowych, które bezpośrednio wywołać okno dialogowe Zmień ikonę) umożliwiające aspekt ikony ekranu na żądanie użytkownika.

##  <a name="setextent"></a>  COleClientItem::SetExtent

Wywołaj tę funkcję, aby określić, ile miejsca jest dostępna dla elementu OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parametry

*Rozmiar*<br/>
A [CSize](../../atl-mfc-shared/reference/csize-class.md) obiekt, który zawiera informacje o rozmiarze.

*nDrawAspect*<br/>
Określa aspekt elementu OLE, których zakresem mają być tworzone. Możliwe wartości, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Uwagi

Jeśli aplikacja została napisana przy użyciu biblioteki klas Microsoft Foundation, powoduje to, że [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) funkcji składowej typu odpowiadającego `COleServerItem` obiekt wywoływany. Element OLE następnie odpowiednio zmienić jego wyświetlania. Wymiary mogą być w jednostkach MM_HIMETRIC. Wywołaj tę funkcję, gdy użytkownik zmienia rozmiar elementu OLE, lub jeśli obsługujesz pewnego rodzaju negocjacji układu.

Aby uzyskać więcej informacji, zobacz [IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent) w zestawie Windows SDK.

##  <a name="sethostnames"></a>  COleClientItem::SetHostNames

Wywołaj tę funkcję, aby określić nazwę aplikacji kontenera i nazwy kontenera dla wbudowanego elementu OLE.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parametry

*lpszHost*<br/>
Wskaźnik na nazwę widoczny dla użytkownika aplikacji kontenera.

*lpszHostObj*<br/>
Wskaźnik na ciąg identyfikujący kontenera, który zawiera element OLE.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja została napisana przy użyciu biblioteki klas Microsoft Foundation, ta funkcja wywołuje [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) funkcji składowej typu `COleServerDoc` dokument, który zawiera element OLE. Te informacje są używane w tytule okna podczas edycji elementu OLE. Każdorazowo, gdy jest ładowany dokument kontenera, struktura wywołuje tę funkcję dla wszystkich elementów OLE w dokumencie. `SetHostNames` ma zastosowanie tylko do elementów osadzonych. Nie jest to konieczne wywołać tę funkcję w każdym razem, gdy aktywowano wbudowanego elementu OLE do edycji.

To jest również nazywany automatycznie z nazwą aplikacji i nazwy dokumentu po załadowaniu obiekt lub gdy zostanie zapisany pod inną nazwą. W związku z tym nie jest zazwyczaj konieczne bezpośrednio wywołać tę funkcję.

Aby uzyskać więcej informacji, zobacz [IOleObject::SetHostNames](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-sethostnames) w zestawie Windows SDK.

##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile

Buforuje metaplik używany do rysowania ikona elementu.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parametry

*hMetaPict*<br/>
Dojście do metaplik używany do rysowania ikona elementu.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Użyj [GetIconicMetafile](#geticonicmetafile) można pobrać metaplik.

*HMetaPict* parametru jest kopiowana do elementu; w związku z tym, *hMetaPict* musi zostać uwolniony przez obiekt wywołujący.

##  <a name="setitemrects"></a>  COleClientItem::SetItemRects

Wywołaj tę funkcję, aby ustawić prostokąt otaczający lub Prostokąt widoczny elementu OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*lprcPosRect*<br/>
Wskaźnik do prostokąta zawierającego granice elementu OLE względem okna nadrzędnego, we współrzędnych klienta.

*lprcClipRect*<br/>
Wskaźnik do prostokąta zawierającego granice widoczną część elementu OLE względem okna nadrzędnego, we współrzędnych klienta.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja jest wywoływana przez domyślną implementację elementu [OnChangeItemPosition](#onchangeitemposition) funkcja elementu członkowskiego. Należy wywołać tę funkcję, zawsze wtedy, gdy zmianie tego elementu położenia lub widoczną część OLE. Zwykle oznacza to, wywołać go z widoku [OnSize](../../mfc/reference/cwnd-class.md#onsize) i [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) funkcji elementów członkowskich.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) w zestawie Windows SDK.

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

Wywołaj tę funkcję, aby ustawić opcję Aktualizacja łącza do przedstawiania określony element połączony.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parametry

*dwUpdateOpt*<br/>
Wartość opcji Aktualizacja łącza dla tego elementu. Ta wartość musi być jedną z następujących czynności:

- OLEUPDATE_ALWAYS aktualizacji połączony element, jeśli to możliwe. Ta opcja obsługuje przycisk radiowy aktualizacji automatycznych link w oknie dialogowym łącza.

- OLEUPDATE_ONCALL zaktualizować połączonego elementu tylko na żądania z aplikacji kontenera (gdy [UpdateLink](#updatelink) funkcja członkowska jest wywoływana). Ta opcja obsługuje przycisk radiowy ręcznej aktualizacji link w oknie dialogowym łącza.

### <a name="remarks"></a>Uwagi

Zazwyczaj nie należy zmieniać opcje aktualizacji, wybierany przez użytkownika w oknie dialogowym łącza.

Aby uzyskać więcej informacji, zobacz [IOleLink::SetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-setupdateoptions) w zestawie Windows SDK.

##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice

Wywołaj tę funkcję, aby zmienić print-urządzenie dla tego elementu.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parametry

*ptd*<br/>
Wskaźnik do [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) struktury danych, który zawiera informacje dotyczące nowego urządzenia docelowego drukowania. Może mieć wartości NULL.

*PPD*<br/>
Wskaźnik do [PRINTDLG](https://msdn.microsoft.com/library/windows/desktop/ms646940) struktury danych, który zawiera informacje dotyczące nowego urządzenia docelowego drukowania. Może mieć wartości NULL.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli funkcja zakończyła się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja aktualizuje print-urządzenie dla elementu, ale nie powoduje odświeżenia pamięci podręcznej prezentacji. Aby zaktualizować pamięć podręczną prezentacji dla elementu, należy wywołać [UpdateLink](#updatelink).

Argumenty do tej funkcji zawierają informacje, które OLE system używa do identyfikowania urządzenia docelowego. `PRINTDLG` Struktura zawiera informacje Windows używane do zainicjowania wspólne okno dialogowe drukowania. Po zamknięciu okna dialogowego użytkownika Windows zwraca informacje o wybór użytkownika w tej strukturze. `m_pd` Członkiem [CPrintDialog](../../mfc/reference/cprintdialog-class.md) obiekt jest `PRINTDLG` struktury.

Aby uzyskać więcej informacji na temat tej struktury, zobacz [PRINTDLG](/windows/desktop/api/commdlg/ns-commdlg-tagpda) w zestawie Windows SDK.

Aby uzyskać więcej informacji, zobacz [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) w zestawie Windows SDK.

##  <a name="updatelink"></a>  COleClientItem::UpdateLink

Wywołaj tę funkcję, aby wykonać natychmiastową aktualizację prezentacji danych elementu OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera w przypadku powodzenia; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Połączone elementy funkcji znajduje się źródło łącza, aby uzyskać nowe prezentacji do elementu OLE. Ten proces może obejmować uruchamianie co najmniej jednej aplikacji serwera, które może być czasochłonne. Dla elementów osadzonych funkcja działa cyklicznie, sprawdzanie, czy element osadzony zawiera łącza, które mogą być nieaktualne i aktualizowanie ich. Użytkownik może również ręcznie zaktualizować poszczególnych łączy za pomocą okna dialogowego łącza.

Aby uzyskać więcej informacji, zobacz [IOleLink::Update](/windows/desktop/api/oleidl/nf-oleidl-iolelink-update) w zestawie Windows SDK.

## <a name="see-also"></a>Zobacz także

[Próbki MFC MFCBIND](../../visual-cpp-samples.md)<br/>
[Próbki MFC OCLIENT](../../visual-cpp-samples.md)<br/>
[Klasa CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Wykres hierarchii](../../mfc/hierarchy-chart.md)<br/>
[Klasa COleServerItem](../../mfc/reference/coleserveritem-class.md)
