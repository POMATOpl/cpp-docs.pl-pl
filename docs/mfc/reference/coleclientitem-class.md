---
title: Klasa COleClientItem
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: ce321c9709b752602a664142f283884f4d17b50b
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753963"
---
# <a name="coleclientitem-class"></a>Klasa COleClientItem

Definiuje interfejs kontenera do elementów OLE.

## <a name="syntax"></a>Składnia

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Elementy członkowskie

### <a name="public-constructors"></a>Konstruktory publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Konstruuje `COleClientItem` obiekt.|

### <a name="public-methods"></a>Metody publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleClientItem::Aktywuj](#activate)|Otwiera element OLE dla operacji, a następnie wykonuje określony zlecenie.|
|[COleClientItem::ActivateAs](#activateas)|Aktywuje element jako inny typ.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Uzyskuje dostęp do danych w obiekcie OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Wskazuje, czy aplikacja kontenera może utworzyć obiekt osadzony.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Wskazuje, czy aplikacja kontenera może utworzyć obiekt połączony.|
|[COleClientItem::CanPaste](#canpaste)|Wskazuje, czy Schowek zawiera osadzony lub statyczny element OLE.|
|[COleClientItem::CanPasteLink](#canpastelink)|Wskazuje, czy Schowek zawiera element OLE, który można połączyć.|
|[COleClientItem::Zamknij](#close)|Zamyka łącze do serwera, ale nie niszczy elementu OLE.|
|[COleClientItem::ConvertTo](#convertto)|Konwertuje element na inny typ.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Kopiuje element OLE do Schowka.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Tworzy duplikat istniejącego elementu.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Tworzy osadzony element ze Schowka.|
|[COleClientItem::CreateFromData](#createfromdata)|Tworzy element osadzony z obiektu danych.|
|[COleClientItem::CreateFromFile](#createfromfile)|Tworzy osadzony element z pliku.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Tworzy połączony element ze Schowka.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Tworzy połączony element z obiektu danych.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Tworzy połączony element z pliku.|
|[COleClientItem::CreateNewItem](#createnewitem)|Tworzy nowy element osadzony, uruchamiając aplikację serwera.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Tworzy element statyczny ze Schowka.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Tworzy element statyczny z obiektu danych.|
|[COleClientItem::Daktywować](#deactivate)|Dezaktywuje element.|
|[COleClientItem::DeaktywnieJI](#deactivateui)|Przywraca interfejs użytkownika aplikacji kontenera do stanu pierwotnego.|
|[COleClientItem::Delete](#delete)|Usuwa lub zamyka element OLE, jeśli był elementem połączonym.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Wykonuje operację przeciągania i upuszczania.|
|[COleClientItem::DoVerb](#doverb)|Wykonuje określony zlecenie.|
|[COleClientItem::Draw](#draw)|Rysuje element OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Pobiera widok, w którym element jest aktywowany w miejscu.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Zwraca granice prostokąta elementu OLE.|
|[COleClientItem::GetClassID](#getclassid)|Pobiera identyfikator klasy bieżącego elementu.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Pobiera dane, które zostaną umieszczone w Schowku, wywołując funkcję `CopyToClipboard` elementu członkowskiego.|
|[COleClientItem::GetDocument](#getdocument)|Zwraca `COleDocument` obiekt zawierający bieżący element.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Pobiera bieżącego widoku elementu do renderowania.|
|[COleClientItem::GetExtent](#getextent)|Zwraca granice prostokąta elementu OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Pobiera dojście do ikony skojarzonej z serwerem określonego clsid.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Pobiera metaplik używany do rysowania ikony elementu.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Zwraca wskaźnik do okna edycji w miejscu elementu.|
|[COleClientItem::GetItemState](#getitemstate)|Pobiera bieżącego stanu elementu.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Zwraca stan ostatniej operacji OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Zwraca tryb aktualizacji połączonego elementu (funkcja zaawansowana).|
|[COleClientItem::GetType](#gettype)|Zwraca typ (osadzony, połączony lub statyczny) elementu OLE.|
|[COleClientItem::GetUserType](#getusertype)|Pobiera ciąg opisujący typ elementu.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Zwraca wartość PRAWDA, jeśli element jest aktywny w miejscu.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Zwraca wartość PRAWDA, jeśli połączony element jest aktualny z dokumentem źródłowym.|
|[COleClientItem::Jestmodified](#ismodified)|Zwraca wartość PRAWDA, jeśli element został zmodyfikowany od czasu ostatniego zapisania.|
|[COleClientItem::Isopen](#isopen)|Zwraca wartość PRAWDA, jeśli element jest aktualnie otwarty w aplikacji serwera.|
|[COleClientItem::IsRunning](#isrunning)|Zwraca wartość PRAWDA, jeśli jest uruchomiona aplikacja serwera elementu.|
|[COleClientItem::OnActivate](#onactivate)|Wywoływana przez strukturę, aby powiadomić element, który jest aktywowany.|
|[COleClientItem::OnActivateUi](#onactivateui)|Wywoływana przez strukturę, aby powiadomić element, który jest aktywowany i powinien pokazać jego interfejs użytkownika.|
|[COleClientItem::OnChange](#onchange)|Wywoływana, gdy serwer zmienia element OLE. Wymagana implementacja.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Wywoływana przez platformę, gdy element jest dezaktywowany.|
|[COleClientItem::OnDeactivateui](#ondeactivateui)|Wywoływana przez platformę, gdy serwer usunął swój interfejs użytkownika w miejscu.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Wywoływane przez strukturę, aby uzyskać dane do skopiowania do Schowka.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Wywoływana przez strukturę do tworzenia menu złożonego.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Wywoływane przez strukturę, aby usunąć menu kontenera z menu złożonego.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Wywoływana przez strukturę, aby zainstalować i usunąć menu złożone.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Wywoływana przez strukturę, aby pokazać i ukryć paski sterowania.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Wywoływana przez strukturę, aby zaktualizować pasek tytułu okna ramki.|
|[COleClientItem::ReaktywujAndUndo](#reactivateandundo)|Ponownie aktywuje element i cofa ostatnią operację edycji w miejscu.|
|[COleClientItem::Zwolnij](#release)|Zwalnia połączenie z elementem połączonym OLE i zamyka go, jeśli był otwarty. Nie niszczy elementu klienta.|
|[COleClientItem::Przeładuj](#reload)|Ponownie ładuje element po `ActivateAs`wywołaniu .|
|[COleClientItem::Uruchom](#run)|Uruchamia aplikację skojarzoną z elementem.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Ustawia bieżący widok elementu do renderowania.|
|[COleClientItem::SetExtent](#setextent)|Ustawia prostokąt ograniczający elementu OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Ustawia nazwy wyświetlane przez serwer podczas edytowania elementu OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Buforuje metaplik używany do rysowania ikony elementu.|
|[COleClientItem::SetItemRects](#setitemrects)|Ustawia prostokąt ograniczający elementu.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Ustawia tryb aktualizacji elementu połączonego (funkcja zaawansowana).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Ustawia urządzenie docelowe drukowania dla tego elementu klienta.|
|[COleClientItem::UpdateLink](#updatelink)|Aktualizuje pamięć podręczną prezentacji elementu.|

### <a name="protected-methods"></a>Metody chronione

|Nazwa|Opis|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Wywoływane przez strukturę, aby ustalić, czy aktywacja w miejscu jest dozwolone.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Wywoływana przez strukturę, gdy zmienia się pozycja elementu.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Wywoływana przez platformę, aby cofnąć po aktywacji.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Wywoływane przez strukturę, aby odrzucić informacje o stanie cofania elementu.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Wywoływane przez strukturę, aby uzyskać element clipping-prostokąt współrzędne.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Wywoływane przez ramy, aby uzyskać pozycję elementu względem widoku.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Wywoływana przez strukturę, gdy element jest aktywowany w miejscu.|
|[COleClientItem::OnScrollBy](#onscrollby)|Wywoływane przez strukturę, aby przewinąć element do widoku.|
|[COleClientItem::OnShowItem](#onshowitem)|Wywoływane przez strukturę do wyświetlania elementu OLE.|

## <a name="remarks"></a>Uwagi

Element OLE reprezentuje dane utworzone i obsługiwane przez aplikację serwera, które mogą być "bezproblemowo" włączone do dokumentu, tak aby wydaje się użytkownikowi być pojedynczym dokumentem. Wynikiem jest "dokument złożony" składający się z elementu OLE i dokumentu zawierającego.

Element OLE może być osadzony lub połączony. Jeśli jest osadzony, jego dane są przechowywane jako część dokumentu złożonego. Jeśli jest połączony, jego dane są przechowywane jako część oddzielnego pliku utworzonego przez aplikację serwera, a tylko łącze do tego pliku jest przechowywane w dokumencie złożonym. Wszystkie elementy OLE zawierają informacje określające aplikację serwera, która powinna zostać wywołana w celu ich edycji.

`COleClientItem`definiuje kilka zastępowalnych funkcji, które są wywoływane w odpowiedzi na żądania z aplikacji serwera; te zastępowalne zazwyczaj działają jako powiadomienia. Dzięki temu aplikacja serwera informuje kontener o zmianach wprowadzanych przez użytkownika podczas edytowania elementu OLE lub w celu pobrania informacji potrzebnych podczas edycji.

`COleClientItem`może być używany z klasą [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)lub [COleServerDoc.](../../mfc/reference/coleserverdoc-class.md) Aby `COleClientItem`użyć , wyprowadzić klasę z niego i zaimplementować [OnChange](#onchange) funkcji elementu członkowskiego, który definiuje, jak kontener reaguje na zmiany wprowadzone do elementu. Aby obsługiwać aktywację w miejscu, należy zastąpić [OnGetItemPosition](#ongetitemposition) funkcji elementu członkowskiego. Ta funkcja zawiera informacje o wyświetlanym położeniu elementu OLE.

Aby uzyskać więcej informacji na temat korzystania z interfejsu kontenera, zobacz artykuły [Kontenery: Implementowanie kontenera](../../mfc/containers-implementing-a-container.md) i [aktywacja](../../mfc/activation-cpp.md).

> [!NOTE]
> Windows SDK odnosi się do elementów osadzonych i połączonych jako "obiekty" i odnosi się do typów elementów jako "klasy". To odwołanie używa terminu "item", aby odróżnić jednostkę OLE od odpowiedniego obiektu C++ i terminu "typ", aby odróżnić kategorię OLE od klasy C++.

## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia

[Cobject](../../mfc/reference/cobject-class.md)

[Ccmdtarget](../../mfc/reference/ccmdtarget-class.md)

[Cdocitem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Wymagania

**Nagłówek:** afxole.h

## <a name="coleclientitemactivate"></a><a name="activate"></a>COleClientItem::Aktywuj

Wywołanie tej funkcji, aby wykonać określony zlecenie zamiast [DoVerb,](#doverb) dzięki czemu można wykonać własne przetwarzanie, gdy wyjątek.

```cpp
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nWerb*<br/>
Określa zlecenie do wykonania. Może to być jedna z następujących czynności:

|Wartość|Znaczenie|Symbol|
|-----------|-------------|------------|
|- 0|Primary — Zlecenie|OLEIVERB_PRIMARY|
|- 1|Czasownik wtórny|(Brak)|
|- 1|Element wyświetlania do edycji|OLEIVERB_SHOW|
|- 2|Edytowanie elementu w osobnym oknie|OLEIVERB_OPEN|
|- 3|Ukryj element|OLEIVERB_HIDE|

Wartość -1 jest zazwyczaj aliasem dla innego zlecenia. Jeśli otwarta edycja nie jest obsługiwana, -2 ma taki sam efekt jak -1. Aby uzyskać dodatkowe wartości, zobacz [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) w windows SDK.

*pWidok*<br/>
Wskaźnik do okna widoku kontenera, który zawiera element OLE; jest to używane przez aplikację serwera do aktywacji w miejscu. Ten parametr powinien być null, jeśli kontener nie obsługuje aktywacji w miejscu.

*lpMsg*<br/>
Wskaźnik do wiadomości, która spowodowała, że element ma być aktywowany.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja serwera została napisana przy użyciu biblioteki klas Programu Microsoft Foundation, `COleServerItem` ta funkcja powoduje, że funkcja elementu członkowskiego [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) odpowiedniego obiektu ma zostać wykonana.

Jeśli zleceniem podstawowym jest Edycja, a w parametrze *nVerb* określono zero, zostanie uruchomiona aplikacja serwera, aby umożliwić edycję elementu OLE. Jeśli aplikacja kontenera obsługuje aktywację w miejscu, edycja może odbywać się na miejscu. Jeśli kontener nie obsługuje aktywacji w miejscu (lub jeśli open zlecenie jest określony), serwer jest uruchamiany w osobnym oknie i edycji można tam zrobić. Zazwyczaj, gdy użytkownik aplikacji kontenera dwukrotnie klika element OLE, wartość zlecenia podstawowego w parametrze *nVerb* określa, jaką akcję może podjąć użytkownik. Jeśli jednak serwer obsługuje tylko jedną akcję, wykonuje tę akcję, niezależnie od tego, która wartość jest określona w parametrze *nVerb.*

Aby uzyskać więcej informacji, zobacz [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) w windows SDK.

## <a name="coleclientitemactivateas"></a><a name="activateas"></a>COleClientItem::ActivateAs

Używa obiektów do konwersji obiektów OLE, aby aktywować element tak, jakby był elementem typu określonego przez *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*lpszUserType*<br/>
Wskaźnik do ciągu reprezentującego docelowy typ użytkownika, na przykład "Dokument programu Word".

*clsidOld (100 000)*<br/>
Odwołanie do bieżącego identyfikatora klasy elementu. Identyfikator klasy powinien reprezentować typ rzeczywistego obiektu, zgodnie z zapisami, chyba że jest to łącze. W takim przypadku powinien to być identyfikator CLSID elementu, do którego odnosi się łącze. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) automatycznie zapewnia poprawny identyfikator klasy dla elementu.

*clsidNowy*<br/>
Odwołanie do identyfikatora klasy docelowej.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jest to wywoływane automatycznie przez [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Zwykle nie jest wywoływana bezpośrednio.

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a>COleClientItem::AttachDataObject

Wywołanie tej funkcji, aby zainicjować [COleDataObject](../../mfc/reference/coledataobject-class.md) dostępu do danych w elemencie OLE.

```cpp
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parametry

*rDataObject*<br/>
Odwołanie do `COleDataObject` obiektu, który zostanie zainicjowany, aby umożliwić dostęp do danych w elemencie OLE.

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a>COleClientItem::CanActivate

Wywoływane przez platformę, gdy użytkownik żąda aktywacji w miejscu elementu OLE; Wartość zwracana tej funkcji określa, czy aktywacja w miejscu jest dozwolona.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowa, jeśli aktywacja w miejscu jest dozwolona; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja umożliwia aktywację w miejscu, jeśli kontener ma prawidłowe okno. Zastąpuj tę funkcję, aby zaimplementować specjalną logikę akceptowania lub odrzucania żądania aktywacji. Na przykład żądanie aktywacji można odmówić, jeśli element OLE jest zbyt mały lub obecnie nie jest widoczny.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) w usłudze Windows SDK.

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a>COleClientItem::CanCreateFromData

Sprawdza, czy aplikacja kontenera może utworzyć `COleDataObject` obiekt osadzony z danego obiektu.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject (1000)*<br/>
Wskaźnik do [obiektu COleDataObject,](../../mfc/reference/coledataobject-class.md) z którego ma zostać utworzony element OLE.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli kontener może utworzyć osadzony obiekt z `COleDataObject` obiektu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Klasa `COleDataObject` jest używana w transferach danych do pobierania danych w różnych formatach ze Schowka, przez przeciąganie i upuszczanie lub z osadzonego elementu OLE.

Kontenery mogą używać tej funkcji do włączania lub wyłączania poleceń Edytuj wklejanie i Edytuj wklej specjalne.

Aby uzyskać więcej informacji, zobacz artykuł [Obiekty danych i źródła danych (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a>COleClientItem::CanCreateLinkFromData

Sprawdza, czy aplikacja kontenera może utworzyć `COleDataObject` obiekt połączony z danego obiektu.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject (1000)*<br/>
Wskaźnik do [obiektu COleDataObject,](../../mfc/reference/coledataobject-class.md) z którego ma zostać utworzony element OLE.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli kontener może utworzyć `COleDataObject` połączony obiekt z obiektu.

### <a name="remarks"></a>Uwagi

Klasa `COleDataObject` jest używana w transferach danych do pobierania danych w różnych formatach ze Schowka, przez przeciąganie i upuszczanie lub z osadzonego elementu OLE.

Kontenery mogą używać tej funkcji do włączania lub wyłączania poleceń Edytuj wklejanie specjalne i Edytuj łącze wklejania.

Aby uzyskać więcej informacji, zobacz artykuł [Obiekty danych i źródła danych (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a>COleClientItem::CanPaste

Wywołanie tej funkcji, aby zobaczyć, czy osadzony element OLE może być wklejony ze Schowka.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli osadzony element OLE może być wklejony ze Schowka; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) i [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) w windows SDK.

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a>COleClientItem::CanPasteLink

Wywołanie tej funkcji, aby zobaczyć, czy połączony element OLE może być wklejony ze Schowka.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli połączony element OLE może być wklejony ze Schowka; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) i [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) w windows SDK.

## <a name="coleclientitemclose"></a><a name="close"></a>COleClientItem::Zamknij

Wywołanie tej funkcji, aby zmienić stan elementu OLE ze stanu uruchomionego do stanu załadowany, czyli ładowane z jego obsługi w pamięci, ale z serwerem nie jest uruchomiony.

```cpp
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parametry

*dwCloseOption (Kolosaopcja)*<br/>
Flaga określająca, w jakich okolicznościach element OLE jest zapisywany po powrocie do załadowanego stanu. Może mieć jedną z następujących wartości:

- OLECLOSE_SAVEIFDIRTY Zapisz element OLE.

- OLECLOSE_NOSAVE Nie zapisuj elementu OLE.

- OLECLOSE_PROMPTSAVE Monituj użytkownika o zapisanie elementu OLE.

### <a name="remarks"></a>Uwagi

Ta funkcja nie ma wpływu, gdy element OLE nie jest uruchomiony.

Aby uzyskać więcej informacji, zobacz [IOleObject::Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) w windows SDK.

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a>COleClientItem::COleClientItem

Konstruuje `COleClientItem` obiekt i dodaje go do kolekcji dokumentu kontenera elementów dokumentu, który konstruuje tylko C++ obiektu i nie wykonuje inicjowania OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parametry

*pContainerDoto*<br/>
Wskaźnik do dokumentu kontenera, który będzie zawierał ten element. Może to być dowolna [pochodna COleDocument.](../../mfc/reference/coledocument-class.md)

### <a name="remarks"></a>Uwagi

Jeśli przekażesz wskaźnik NULL, do dokumentu kontenera nie zostanie wprowadzone żadne dodanie. Należy jawnie wywołać [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Przed użyciem elementu OLE należy wywołać jedną z następujących funkcji elementu członkowskiego tworzenia:

- [UtwórzfromClipboard](#createfromclipboard)

- [Utwórzfromdata](#createfromdata)

- [Utwórz PlikFrom](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [Utwórz plik LinkFrom](#createlinkfromfile)

- [Utwórz pozycję Nieujomka](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a>COleClientItem::ConvertTo

Wywołanie tej funkcji elementu członkowskiego, aby przekonwertować element na typ określony przez *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*clsidNowy*<br/>
Identyfikator klasy typu docelowego.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jest to wywoływane automatycznie przez [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Nie jest konieczne, aby wywołać go bezpośrednio.

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a>COleClientItem::CopyToClipboard

Wywołanie tej funkcji, aby skopiować element OLE do Schowka.

```cpp
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
PRAWDA, jeśli informacje o łączach powinny zostać skopiowane do Schowka, umożliwiając wklejenie połączonego elementu; w przeciwnym razie FALSE.

### <a name="remarks"></a>Uwagi

Zazwyczaj ta funkcja jest wywoływana podczas pisania programów obsługi wiadomości dla poleceń Kopiuj lub Wytnij z menu Edycja. Należy zaimplementować wybór elementu w aplikacji kontenera, jeśli chcesz zaimplementować polecenia Kopiuj lub Wytnij.

Aby uzyskać więcej informacji, zobacz [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) w zestawie Windows SDK.

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a>COleClientItem::CreateCloneFrom

Wywołanie tej funkcji, aby utworzyć kopię określonego elementu OLE.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parametry

*pSrcItem (komputer z o.o.*<br/>
Wskaźnik do elementu OLE, który ma zostać zduplikowany.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Kopia jest identyczna z elementem źródłowym. Za pomocą tej funkcji można obsługiwać operacje cofania.

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a>COleClientItem::CreateFromClipboard

Wywołanie tej funkcji, aby utworzyć element osadzony z zawartości Schowka.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w windows SDK.

*cfFormat*<br/>
Określa format danych Schowka, który ma być buforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [struktury FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używane, jeśli *renderowanie* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie poza formatem Schowka określonym przez *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne `FORMATETC` będą używane dla innych pól w strukturze.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zazwyczaj wywołanie tej funkcji z obsługi wiadomości dla polecenia Wklej w menu Edycja. (Polecenie Wklej jest włączone przez platformę, jeśli funkcja elementu członkowskiego [CanPaste](#canpaste) zwraca wartość niezerową).

Aby uzyskać więcej informacji, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w windows SDK.

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a>COleClientItem::CreateFromData

Wywołanie tej funkcji, aby utworzyć `COleDataObject` element osadzony z obiektu.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject (1000)*<br/>
Wskaźnik do [obiektu COleDataObject,](../../mfc/reference/coledataobject-class.md) z którego ma zostać utworzony element OLE.

*Renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w windows SDK.

*cfFormat*<br/>
Określa format danych Schowka, który ma być buforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [struktury FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używane, jeśli *renderowanie* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie poza formatem Schowka określonym przez *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne `FORMATETC` będą używane dla innych pól w strukturze.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Operacje transferu danych, takie jak wklejanie ze Schowka `COleDataObject` lub operacje przeciągania i upuszczania, zapewniają obiekty zawierające informacje oferowane przez aplikację serwera. Jest on zwykle używany w przesłonie [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Aby uzyskać więcej informacji, zobacz [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w windows SDK.

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a>COleClientItem::CreateFromFile

Wywołanie tej funkcji, aby utworzyć osadzony element OLE z pliku.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Wskaźnik do nazwy pliku, z którego ma zostać utworzony element OLE.

*Clsid*<br/>
Zarezerwowane do użytku w przyszłości.

*Renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w windows SDK.

*cfFormat*<br/>
Określa format danych Schowka, który ma być buforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [struktury FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używane, jeśli *renderowanie* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie poza formatem Schowka określonym przez *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne `FORMATETC` będą używane dla innych pól w strukturze.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Struktura wywołuje tę funkcję z [COleInsertDialog::CreateItem,](../../mfc/reference/coleinsertdialog-class.md#createitem) jeśli użytkownik wybierze OK z okna dialogowego Wstawianie obiektu po wybraniu przycisku Utwórz z pliku.

Aby uzyskać więcej informacji, zobacz [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w windows SDK.

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a>COleClientItem::CreateLinkFromClipboard

Wywołanie tej funkcji, aby utworzyć element połączony z zawartością Schowka.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w windows SDK.

*cfFormat*<br/>
Określa format danych Schowka, który ma być buforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [struktury FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używane, jeśli *renderowanie* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie poza formatem Schowka określonym przez *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne `FORMATETC` będą używane dla innych pól w strukturze.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zazwyczaj ta funkcja jest wywoływana z programu obsługi wiadomości dla polecenia Wklej łącze w menu Edycja. (Polecenie Wklej łącze jest włączone w domyślnej implementacji [COleDocument,](../../mfc/reference/coledocument-class.md) jeśli Schowek zawiera element OLE, z którym można się połączyć).

Aby uzyskać więcej informacji, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w windows SDK.

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a>COleClientItem::CreateLinkFromData

Wywołanie tej funkcji, aby `COleDataObject` utworzyć element połączony z obiektu.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject (1000)*<br/>
Wskaźnik do [obiektu COleDataObject,](../../mfc/reference/coledataobject-class.md) z którego ma zostać utworzony element OLE.

*Renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w windows SDK.

*cfFormat*<br/>
Określa format danych Schowka, który ma być buforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [struktury FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używane, jeśli *renderowanie* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie poza formatem Schowka określonym przez *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne `FORMATETC` będą używane dla innych pól w strukturze.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Wywołanie tego podczas operacji upuszczania, gdy użytkownik wskazuje, że należy utworzyć łącze. Może być również używany do obsługi polecenia Edytuj wklej. Jest wywoływana przez `COleClientItem::CreateLinkFromClipboard` strukturę w i w [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) po wybraniu opcji Link.

Aby uzyskać więcej informacji, zobacz [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w windows SDK.

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a>COleClientItem::CreateLinkFromFile

Wywołanie tej funkcji, aby utworzyć połączony element OLE z pliku.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Wskaźnik do nazwy pliku, z którego ma zostać utworzony element OLE.

*Renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w windows SDK.

*cfFormat*<br/>
Określa format danych Schowka, który ma być buforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [struktury FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używane, jeśli *renderowanie* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie poza formatem Schowka określonym przez *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne `FORMATETC` będą używane dla innych pól w strukturze.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Struktura wywołuje tę funkcję, jeśli użytkownik wybierze przycisk OK z okna dialogowego Wstawianie obiektu po zaznaczeniu przycisku Utwórz z pliku i zaznaczeniu pola wyboru Łącze. Jest wywoływana z [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Aby uzyskać więcej informacji, zobacz [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w windows SDK.

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a>COleClientItem::CreateNewItem

Wywołanie tej funkcji, aby utworzyć element osadzony; ta funkcja uruchamia aplikację serwera, która umożliwia użytkownikowi utworzenie elementu OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Clsid*<br/>
Identyfikator, który jednoznacznie identyfikuje typ elementu OLE do utworzenia.

*Renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w windows SDK.

*cfFormat*<br/>
Określa format danych Schowka, który ma być buforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [struktury FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używane, jeśli *renderowanie* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie poza formatem Schowka określonym przez *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne `FORMATETC` będą używane dla innych pól w strukturze.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Struktura wywołuje tę funkcję, jeśli użytkownik wybierze przycisk OK z okna dialogowego Wstawianie obiektu po wybraniu przycisku Utwórz nowy.

Aby uzyskać więcej informacji, zobacz [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w windows SDK.

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a>COleClientItem::CreateStaticFromClipboard

Wywołanie tej funkcji, aby utworzyć element statyczny z zawartości Schowka.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w windows SDK.

*cfFormat*<br/>
Określa format danych Schowka, który ma być buforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [struktury FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używane, jeśli *renderowanie* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie poza formatem Schowka określonym przez *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne `FORMATETC` będą używane dla innych pól w strukturze.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Element statyczny zawiera dane prezentacji, ale nie dane macierzyste; w związku z tym nie może być edytowany. Zazwyczaj wywołanie tej funkcji, jeśli [CreateFromClipboard](#createfromclipboard) funkcji elementu członkowskiego nie powiedzie się.

Aby uzyskać więcej informacji, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w windows SDK.

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a>COleClientItem::CreateStaticFromData

Wywołanie tej funkcji, aby utworzyć `COleDataObject` element statyczny z obiektu.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject (1000)*<br/>
Wskaźnik do [obiektu COleDataObject,](../../mfc/reference/coledataobject-class.md) z którego ma zostać utworzony element OLE.

*Renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w windows SDK.

*cfFormat*<br/>
Określa format danych Schowka, który ma być buforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do [struktury FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używane, jeśli *renderowanie* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie poza formatem Schowka określonym przez *cfFormat*. Jeśli ten parametr zostanie pominięty, wartości domyślne `FORMATETC` będą używane dla innych pól w strukturze.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Element statyczny zawiera dane prezentacji, ale nie dane macierzyste; w związku z tym nie można go edytować. Jest to zasadniczo taka sama jak [CreateStaticFromClipboard,](#createstaticfromclipboard) z tą `COleDataObject`różnicą, że element statyczny może być utworzony z dowolnego , nie tylko ze Schowka.

Używane w [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) po wybraniu statysty.

Aby uzyskać więcej informacji, zobacz [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w windows SDK.

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a>COleClientItem::Daktywować

Wywołanie tej funkcji, aby dezaktywować element OLE i zwolnić wszelkie skojarzone zasoby.

```cpp
void Deactivate();
```

### <a name="remarks"></a>Uwagi

Zazwyczaj dezaktywujesz aktywny element OLE w miejscu, gdy użytkownik kliknie myszą w obszarze klienta poza granicami elementu. Należy zauważyć, że dezaktywacja elementu OLE spowoduje odrzucenie jego stanu cofania, uniemożliwiając wywołanie funkcji elementu członkowskiego [ReactivateAndUndo.](#reactivateandundo)

Jeśli aplikacja obsługuje cofanie, `Deactivate`nie należy wywoływać ; zamiast tego zadzwoń [DeactivateUI](#deactivateui).

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) w usłudze Windows SDK.

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a>COleClientItem::DeaktywnieJI

Wywołanie tej funkcji, gdy użytkownik dezaktywuje element, który został aktywowany w miejscu.

```cpp
void DeactivateUI();
```

### <a name="remarks"></a>Uwagi

Ta funkcja przywraca interfejs użytkownika aplikacji kontenera do stanu pierwotnego, ukrywając wszystkie menu i inne formanty, które zostały utworzone w celu aktywacji w miejscu.

Ta funkcja nie opróżnia informacji o stanie cofania dla elementu. Te informacje są zachowywane tak, [że ReactivateAndOdo](#reactivateandundo) może być później używany do wykonywania polecenia cofania w aplikacji serwera, w przypadku, gdy polecenie cofania kontenera jest wybierany natychmiast po dezaktywacji elementu.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) w usłudze Windows SDK.

## <a name="coleclientitemdelete"></a><a name="delete"></a>COleClientItem::Delete

Wywołanie tej funkcji, aby usunąć element OLE z dokumentu kontenera.

```cpp
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parametry

*bAutoDelete*<br/>
Określa, czy element ma zostać usunięty z dokumentu.

### <a name="remarks"></a>Uwagi

Ta funkcja wywołuje release funkcji [elementu](#release) członkowskiego, który z kolei usuwa C++ obiektu dla elementu, trwale usunięcie elementu OLE z dokumentu. Jeśli element OLE jest osadzony, dane macierzyste dla elementu są usuwane. Zawsze zamyka uruchomiony serwer; w związku z tym jeśli element jest otwartym łączem, ta funkcja zamyka go.

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a>COleClientItem::DoDragDrop

Wywołanie `DoDragDrop` funkcji elementu członkowskiego, aby wykonać operację przeciągania i upuszczania.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parametry

*lpItemRect*<br/>
Prostokąt elementu na ekranie we współrzędnych klienta (piksele).

*ptOffset (polski)*<br/>
Przesunięcie z *lpItemRect* gdzie pozycja myszy był w czasie przeciągania.

*bIncludeLink*<br/>
Ustaw wartość TRUE, jeśli dane łącza mają zostać skopiowane do Schowka. Ustaw go na FALSE, jeśli aplikacja serwera nie obsługuje łączy.

*dwEfektyty*<br/>
Określa efekty, na które źródło przeciągania pozwoli w operacji przeciągania.

*lpRectStartDrag*<br/>
Wskaźnik do prostokąta, który definiuje, gdzie faktycznie rozpoczyna się przeciąganie. Aby uzyskać więcej informacji zobacz następujące sekcji uwag.

### <a name="return-value"></a>Wartość zwracana

Wartość DROPEFFECT. Jeśli jest DROPEFFECT_MOVE, oryginalne dane powinny zostać usunięte.

### <a name="remarks"></a>Uwagi

Operacja przeciągania i upuszczania nie rozpoczyna się natychmiast. Czeka, aż kursor myszy opuści prostokąt określony przez *lpRectStartDrag* lub do określonej liczby milisekund minęło. Jeśli *lpRectStartDrag* ma wartość NULL, rozmiar prostokąta wynosi jeden piksel.

Czas opóźnienia jest określony przez ustawienie klucza rejestru. Czas opóźnienia można zmienić, wywołując [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) lub [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Jeśli nie określisz czasu opóźnienia, używana jest wartość domyślna 200 milisekund. Czas opóźnienia przeciągania jest przechowywany w następujący sposób:

- Czas opóźnienia przeciągania systemu Windows NT jest przechowywany w HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Czas opóźnienia przeciągania systemu Windows 3.x jest przechowywany w win. INI w sekcji [Windows}.

- Czas opóźnienia przeciągania systemu Windows 95/98 jest przechowywany w buforowanej wersji programu WIN. Ini.

Aby uzyskać więcej informacji o tym, jak informacje o opóźnieniu przeciągania są przechowywane w rejestrze lub pliku . INI, zobacz [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) w windows SDK.

## <a name="coleclientitemdoverb"></a><a name="doverb"></a>COleClientItem::DoVerb

Wywołanie `DoVerb` wykonania określonego zlecenia.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nWerb*<br/>
Określa zlecenie do wykonania. Może zawierać jedną z następujących czynności:

|Wartość|Znaczenie|Symbol|
|-----------|-------------|------------|
|- 0|Primary — Zlecenie|OLEIVERB_PRIMARY|
|- 1|Czasownik wtórny|(Brak)|
|- 1|Element wyświetlania do edycji|OLEIVERB_SHOW|
|- 2|Edytowanie elementu w osobnym oknie|OLEIVERB_OPEN|
|- 3|Ukryj element|OLEIVERB_HIDE|

Wartość -1 jest zazwyczaj aliasem dla innego zlecenia. Jeśli otwarta edycja nie jest obsługiwana, -2 ma taki sam efekt jak -1. Aby uzyskać dodatkowe wartości, zobacz [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) w windows SDK.

*pWidok*<br/>
Wskaźnik do okna widoku; jest to używane przez serwer do aktywacji w miejscu. Ten parametr powinien mieć wartość NULL, jeśli aplikacja kontenera nie zezwala na aktywację w miejscu.

*lpMsg*<br/>
Wskaźnik do wiadomości, która spowodowała, że element ma być aktywowany.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli czasownik został pomyślnie wykonany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja wywołuje [Włącz](#activate) funkcję elementu członkowskiego, aby wykonać zlecenie. Przechwytuje również wyjątki i wyświetla okno komunikatu dla użytkownika, jeśli zostanie ono rzucone.

Jeśli zleceniem podstawowym jest Edycja, a w parametrze *nVerb* określono zero, zostanie uruchomiona aplikacja serwera, aby umożliwić edycję elementu OLE. Jeśli aplikacja kontenera obsługuje aktywację w miejscu, edycja może odbywać się na miejscu. Jeśli kontener nie obsługuje aktywacji w miejscu (lub jeśli open zlecenie jest określony), serwer jest uruchamiany w osobnym oknie i edycji można tam zrobić. Zazwyczaj, gdy użytkownik aplikacji kontenera dwukrotnie klika element OLE, wartość zlecenia podstawowego w parametrze *nVerb* określa, jaką akcję może podjąć użytkownik. Jeśli jednak serwer obsługuje tylko jedną akcję, wykonuje tę akcję, niezależnie od tego, która wartość jest określona w parametrze *nVerb.*

## <a name="coleclientitemdraw"></a><a name="draw"></a>COleClientItem::Draw

Wywołanie tej funkcji, aby narysować element OLE do określonego prostokąta ograniczającego przy użyciu określonego kontekstu urządzenia.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*Pdc*<br/>
Wskaźnik do obiektu [CDC](../../mfc/reference/cdc-class.md) używanego do rysowania elementu OLE.

*lpBounds (Obfity)*<br/>
Wskaźnik do [CRect](../../atl-mfc-shared/reference/crect-class.md) `RECT` obiektu lub struktury, która definiuje prostokąt ograniczający, w którym do rysowania elementu OLE (w jednostkach logicznych określonych przez kontekst urządzenia).

*nDrawAspect*<br/>
Określa aspekt elementu OLE, czyli sposób wyświetlania. Jeśli *nDrawAspect* jest -1, używany jest ostatni zestaw aspektów przy użyciu [SetDrawAspect.](#setdrawaspect) Aby uzyskać więcej informacji na temat możliwych wartości dla tej flagi, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Funkcja może używać reprezentacji metapliku elementu OLE utworzonego przez `COleServerItem`funkcję elementu członkowskiego [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) .

Zazwyczaj używa `Draw` się do wyświetlania ekranu, przekazując kontekst urządzenia ekranowego jako *pDC*. W takim przypadku należy określić tylko dwa pierwsze parametry.

*Parametr lpBounds* identyfikuje prostokąt w kontekście urządzenia docelowego (w stosunku do bieżącego trybu mapowania). Renderowanie może obejmować skalowanie obrazu i może służyć przez aplikacje kontenera do nałożenia widoku, który skaluje się między wyświetlanym widokiem a końcowym wydrukowanym obrazem.

Aby uzyskać więcej informacji, zobacz [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) w windows SDK.

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a>COleClientItem::GetActiveView

Zwraca widok, na którym element jest aktywowany w miejscu.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do widoku; w przeciwnym razie NULL, jeśli element nie jest uaktywniony w miejscu.

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a>COleClientItem::GetCachedExtent

Wywołanie tej funkcji, aby pobrać rozmiar elementu OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*lpSize (rozmiar)*<br/>
Wskaźnik do `SIZE` struktury lub [CSize](../../atl-mfc-shared/reference/csize-class.md) obiektu, który otrzyma informacje o rozmiarze.

*nDrawAspect*<br/>
Określa aspekt elementu OLE, którego granice mają zostać pobrane. Aby uzyskać możliwe wartości, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; 0, jeśli element OLE jest pusty.

### <a name="remarks"></a>Uwagi

Ta funkcja zawiera te same informacje co [GetExtent](#getextent). Jednak można wywołać, `GetCachedExtent` aby uzyskać informacje o zakresie podczas przetwarzania innych programów obsługi OLE, takich jak [OnChange](#onchange). Wymiary są w MM_HIMETRIC jednostkach.

Jest to `GetCachedExtent` możliwe, ponieważ używa interfejsu [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) zamiast używać interfejsu [IOleObject,](/windows/win32/api/oleidl/nn-oleidl-ioleobject) aby uzyskać zakres tego elementu. Obiekt `IViewObject2` COM buforuje informacje o zasięgu użyte w poprzednim wywołaniu [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Aby uzyskać więcej informacji, zobacz [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) w windows SDK.

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a>COleClientItem::GetClassID

Zwraca identyfikator klasy elementu do pamięci wskazywionej przez *pClassID*.

```cpp
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parametry

*Pclassid*<br/>
Wskaźnik do identyfikatora typu [CLSID,](/windows/win32/com/clsid-key-hklm) aby pobrać identyfikator klasy. Aby uzyskać informacje o clsid, zobacz Windows SDK.

### <a name="remarks"></a>Uwagi

Identyfikator klasy to 128-bitowy numer, który jednoznacznie identyfikuje aplikację edytującą element.

Aby uzyskać więcej informacji, zobacz [IPersist::GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) w windows SDK.

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a>COleClientItem::GetClipboardData

Wywołanie tej funkcji, aby uzyskać obiekt zawierający `COleDataSource` wszystkie dane, które zostaną umieszczone w Schowku przez wywołanie [copytoclipboard](#copytoclipboard) funkcji elementu członkowskiego.

```cpp
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parametry

*pDataSource (źródło danych)*<br/>
Wskaźnik do [obiektu COleDataSource,](../../mfc/reference/coledatasource-class.md) który otrzyma dane zawarte w elemencie OLE.

*bIncludeLink*<br/>
PRAWDA, jeśli dane łącza powinny być zawarte; w przeciwnym razie FALSE.

*lpOffset (zestaw lpOffset)*<br/>
Przesunięcie kursora myszy od początku powstania obiektu w pikselach.

*lpSize (rozmiar)*<br/>
Rozmiar obiektu w pikselach.

### <a name="remarks"></a>Uwagi

`GetClipboardData`jest wywoływana jako domyślna implementacja [OnGetClipboardData](#ongetclipboarddata). Zastąp `OnGetClipboardData` tylko wtedy, gdy chcesz oferować formaty `CopyToClipboard`danych oprócz formatów oferowanych przez program . Umieść te formaty `COleDataSource` w obiekcie `CopyToClipboard`przed lub `COleDataSource` po wywołaniu , a następnie przekaż obiekt do [funkcji COleDataSource::SetClipboard.](../../mfc/reference/coledatasource-class.md#setclipboard) Na przykład, jeśli chcesz, aby pozycja ole w dokumencie kontenera towarzyszyła mu w Schowku, należy `COleDataSource` zdefiniować `CopyToClipboard`własny format przekazywania tych informacji i umieścić go w przed wywołaniem .

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a>COleClientItem::GetDocument

Wywołanie tej funkcji, aby uzyskać wskaźnik do dokumentu, który zawiera element OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do dokumentu zawierającego element OLE. NULL, jeśli element nie jest częścią dokumentu.

### <a name="remarks"></a>Uwagi

Ten wskaźnik umożliwia `COleDocument` dostęp do obiektu, który `COleClientItem` został przekazany jako argument do konstruktora.

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a>COleClientItem::GetDrawAspect

Wywołanie `GetDrawAspect` funkcji elementu członkowskiego, aby określić bieżący "aspekt" lub widok elementu.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość z wyliczenia DVASPECT, której wartości są wymienione w odwołaniu dla [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Uwagi

Aspekt określa sposób renderowania elementu.

## <a name="coleclientitemgetextent"></a><a name="getextent"></a>COleClientItem::GetExtent

Wywołanie tej funkcji, aby pobrać rozmiar elementu OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parametry

*lpSize (rozmiar)*<br/>
Wskaźnik do `SIZE` struktury `CSize` lub obiektu, który otrzyma informacje o rozmiarze.

*nDrawAspect*<br/>
Określa aspekt elementu OLE, którego granice mają zostać pobrane. Aby uzyskać możliwe wartości, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; 0, jeśli element OLE jest pusty.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja serwera została napisana przy użyciu biblioteki klas Programu Microsoft Foundation, `COleServerItem` ta funkcja powoduje, że funkcja elementu członkowskiego [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) odpowiedniego obiektu ma zostać wywołana. Należy zauważyć, że pobrany rozmiar może różnić się od rozmiaru ostatniego zestawu przez [SetExtent](#setextent) funkcji elementu członkowskiego; rozmiar określony `SetExtent` przez jest traktowany jako sugestia. Wymiary są w MM_HIMETRIC jednostkach.

> [!NOTE]
> Nie należy `GetExtent` wywoływać podczas przetwarzania obsługi OLE, takich jak [OnChange](#onchange). Zamiast tego zadzwoń [do GetCachedExtent.](#getcachedextent)

Aby uzyskać więcej informacji, zobacz [IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) w windows SDK.

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a>COleClientItem::GetIconFromRegistry

Wywołanie tej funkcji elementu członkowskiego, aby pobrać dojście do zasobu ikony skojarzonego z serwerem określonego identyfikatora CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parametry

*Clsid*<br/>
Odwołanie do CLSID dla serwera skojarzonego z ikoną.

### <a name="return-value"></a>Wartość zwracana

Nie można odnaleźć prawidłowego dojścia do zasobu ikony lub wartości NULL, jeśli nie można odnaleźć ikony serwera lub ikony domyślnej.

### <a name="remarks"></a>Uwagi

Ta funkcja elementu członkowskiego nie uruchomi serwera ani nie uzyska ikony dynamicznie, nawet jeśli serwer jest już uruchomiony. Zamiast tego ta funkcja elementu członkowskiego otwiera obraz wykonywalny serwera i pobiera ikonę statyczną skojarzoną z serwerem w miarę jego rejestracji.

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a>COleClientItem::GetIconicMetafile

Pobiera metaplik używany do rysowania ikony elementu.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Wartość zwracana

Uchwyt do metapliku, jeśli zakończy się pomyślnie; w przeciwnym razie NULL.

### <a name="remarks"></a>Uwagi

Jeśli nie ma bieżącej ikony, zwracana jest domyślna ikona. Jest to wywoływane automatycznie przez okna dialogowe MFC/OLE i zwykle nie jest wywoływana bezpośrednio.

Ta funkcja wywołuje również [SetIconicMetafile](#seticonicmetafile) do buforowania metapliku do późniejszego użycia.

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a>COleClientItem::GetInPlaceWindow

Wywołanie `GetInPlaceWindow` funkcji elementu członkowskiego, aby uzyskać wskaźnik do okna, w którym element został otwarty do edycji w miejscu.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do okna edycji w miejscu elementu; NULL, jeśli element nie jest aktywny lub jego serwer jest niedostępny.

### <a name="remarks"></a>Uwagi

Ta funkcja powinna być wywoływana tylko dla elementów, które są aktywne w miejscu.

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a>COleClientItem::GetItemState

Wywołanie tej funkcji, aby uzyskać bieżący stan elementu OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Wartość zwracana

Wyliczona `COleClientItem::ItemState` wartość, która może być jedną `emptyState` `loadedState`z `openState` `activeState`następujących `activeUIState`wartości: , , , , . Aby uzyskać informacje na temat tych stanów, zobacz artykuł [Kontenery: Stany elementu klienta](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Uwagi

Aby otrzymywać powiadomienia o zmianie stanu elementu OLE, należy użyć funkcji elementu członkowskiego [OnChange.](#onchange)

Aby uzyskać więcej informacji, zobacz artykuł [Kontenery: Stany pozycji klienta](../../mfc/containers-client-item-states.md).

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a>COleClientItem::GetLastStatus

Zwraca kod stanu ostatniej operacji OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość SCODE.

### <a name="remarks"></a>Uwagi

Dla funkcji członkowskich, które zwracają wartość BOOL FALSE lub `GetLastStatus` inne funkcje członkowskie, które zwracają wartość NULL, zwraca bardziej szczegółowe informacje o niepowodzeniu. Należy pamiętać, że większość funkcji elementów członkowskich OLE zgłasza wyjątki dla poważniejszych błędów. Szczegółowe informacje na temat interpretacji SCODE zależy od podstawowej wywołania OLE, który ostatnio zwrócił wartość SCODE.

Aby uzyskać więcej informacji na temat SCODE, zobacz [Struktura kodów błędów COM](/windows/win32/com/structure-of-com-error-codes) w dokumentacji sdk systemu Windows.

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a>COleClientItem::GetLinkUpdateOptions

Wywołanie tej funkcji, aby uzyskać bieżącą wartość opcji aktualizacji łącza dla elementu OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Wartość zwracana

Jedna z następujących wartości:

- OLEUPDATE_ALWAYS Aktualizuj połączony element, gdy tylko jest to możliwe. Ta opcja obsługuje przycisk opcji Automatyczna aktualizacja łącza w oknie dialogowym Łącza.

- OLEUPDATE_ONCALL Aktualizuj połączony element tylko na żądanie z aplikacji kontenera (gdy wywoływana jest funkcja elementu członkowskiego [UpdateLink).](#updatelink) Ta opcja obsługuje przycisk opcji Ręczna aktualizacja łącza w oknie dialogowym Łącza.

### <a name="remarks"></a>Uwagi

Jest to operacja zaawansowana.

Ta funkcja jest wywoływana automatycznie przez [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) klasy.

Aby uzyskać więcej informacji, zobacz [IOleLink::GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) w zestawie Windows SDK.

## <a name="coleclientitemgettype"></a><a name="gettype"></a>COleClientItem::GetType

Wywołanie tej funkcji, aby ustalić, czy element OLE jest osadzony lub połączony lub statyczny.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Wartość zwracana

Niepodpisana liczba całkowita z jedną z następujących wartości:

- OT_LINK Element OLE jest łączem.

- OT_EMBEDDED Element OLE jest osadzony.

- OT_STATIC Element OLE jest statyczny, oznacza to, że zawiera tylko dane prezentacji, a nie dane macierzyste, a zatem nie mogą być edytowane.

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a>COleClientItem::GetUserType

Wywołanie tej funkcji, aby uzyskać ciąg widoczny dla użytkownika opisujący typ elementu OLE, takich jak "Dokument programu Word".

```cpp
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parametry

*nUserClassType (Typ klasy użycznika)*<br/>
Wartość wskazująca żądany wariant ciągu opisującego typ elementu OLE. Może to mieć jedną z następujących wartości:

- USERCLASSTYPE_FULL Pełna nazwa typu wyświetlana użytkownikowi.

- USERCLASSTYPE_SHORT Krótka nazwa (maksymalnie 15 znaków) do użycia w wyskakujących menu i oknie dialogowym Edytowanie łączy.

- USERCLASSTYPE_APPNAME Nazwa aplikacji obsługującej klasę.

*rString*<br/>
Odwołanie do [CString](../../atl-mfc-shared/reference/cstringt-class.md) obiektu, do którego ciąg opisujący typ elementu OLE ma być zwrócony.

### <a name="remarks"></a>Uwagi

Jest to często wpis w bazie danych rejestracji systemu.

Jeśli wymagana jest pełna nazwa typu, ale nie jest dostępna, zamiast tego używana jest krótka nazwa. Jeśli w bazie danych rejestracji nie zostanie znaleziony żaden wpis typu elementu OLE lub jeśli dla typu elementu OLE nie jest zarejestrowany żaden wpis, używany jest typ użytkownika aktualnie przechowywany w elemencie OLE. Jeśli nazwa tego typu użytkownika jest pustym ciągiem, używany jest "Nieznany obiekt".

Aby uzyskać więcej informacji, zobacz [IOleObject::GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) w windows SDK.

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a>COleClientItem::IsInPlaceActive

Wywołanie tej funkcji, aby zobaczyć, czy element OLE jest aktywny w miejscu.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli element OLE jest aktywny w miejscu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jest to wspólne do wykonywania różnych logiki w zależności od tego, czy element jest edytowany w miejscu. Funkcja sprawdza, czy bieżący stan towaru `activeState` jest `activeUIState`równy lub .

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a>COleClientItem::IsLinkUpToDate

Wywołanie tej funkcji, aby zobaczyć, czy element OLE jest aktualny.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli element OLE jest aktualny; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Połączony element może być nieaktualny, jeśli jego dokument źródłowy został zaktualizowany. Osadzony element, który zawiera łącza w nim może podobnie stać się nieaktualne. Funkcja wykonuje cykliczne sprawdzanie elementu OLE. Należy zauważyć, że określenie, czy element OLE jest nieaktualny, może być tak kosztowne, jak faktycznie wykonanie aktualizacji.

Jest to wywoływane automatycznie przez [implementację COleLinksDialog.](../../mfc/reference/colelinksdialog-class.md)

Aby uzyskać więcej informacji, zobacz [IOleObject::IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) w zestawie Windows SDK.

## <a name="coleclientitemismodified"></a><a name="ismodified"></a>COleClientItem::Jestmodified

Wywołanie tej funkcji, aby zobaczyć, czy element OLE jest zanieczyszczony (zmodyfikowany od czasu ostatniego zapisania).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli element OLE jest zabrudzony; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [IPersistStorage::IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) w windows SDK.

## <a name="coleclientitemisopen"></a><a name="isopen"></a>COleClientItem::Isopen

Wywołanie tej funkcji, aby zobaczyć, czy element OLE jest otwarty; oznacza to, że otwierane w wystąpieniu aplikacji serwera uruchomionej w osobnym oknie.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli element OLE jest otwarty; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Służy do określenia, kiedy narysować obiekt za pomocą wzoru kreskowania. Otwarty obiekt powinien mieć wzór kreskowania narysowany na wierzchu obiektu. Można użyć [CRectTracker](../../mfc/reference/crecttracker-class.md) obiektu, aby to osiągnąć.

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a>COleClientItem::IsRunning

Wywołanie tej funkcji, aby zobaczyć, czy element OLE jest uruchomiony; oznacza to, czy element jest ładowany i uruchomiony w aplikacji serwera.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli element OLE jest uruchomiony; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) w windows SDK.

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a>COleClientItem::OnActivate

Wywoływana przez platformę, aby powiadomić element, który właśnie został aktywowany w miejscu.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Uwagi

Należy zauważyć, że ta funkcja jest wywoływana, aby wskazać, że serwer jest uruchomiony, a nie wskazać, że jego interfejs użytkownika został zainstalowany w aplikacji kontenera. W tym momencie obiekt nie ma aktywnego interfejsu `activeUIState`użytkownika (nie jest ). Nie zainstalowała swoich menu ani paska narzędzi. Funkcja elementu członkowskiego [OnActivateUI](#onactivateui) jest wywoływana, gdy tak się stanie.

Domyślna implementacja wywołuje [onchange](#onchange) funkcji elementu członkowskiego z OLE_CHANGEDSTATE jako parametr. Zastąd w tej funkcji należy wykonać przetwarzanie niestandardowe, gdy element stanie się aktywny w miejscu.

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a>COleClientItem::OnActivateUi

Struktura wywołuje, `OnActivateUI` gdy obiekt wszedł w stan aktywnego interfejsu użytkownika.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Uwagi

Obiekt ma teraz zainstalowany pasek narzędzi i menu.

Domyślna implementacja zapamiętuje hwnd `GetServerWindow` serwera dla późniejszych wywołań.

## <a name="coleclientitemonchange"></a><a name="onchange"></a>COleClientItem::OnChange

Wywoływane przez platformę, gdy użytkownik modyfikuje, zapisuje lub zamyka element OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parametry

*kod n*<br/>
Powodem, dla którego serwer zmienił ten element. Może mieć jedną z następujących wartości:

- OLE_CHANGED wygląd elementu OLE uległ zmianie.

- OLE_SAVED Element OLE został zapisany.

- OLE_CLOSED Element OLE został zamknięty.

- OLE_CHANGED_STATE Element OLE został zmieniony z jednego stanu na inny.

*dwParam (polski)*<br/>
Jeśli *kod nCode* jest OLE_SAVED lub OLE_CLOSED, ten parametr nie jest używany. Jeśli *nCode* jest OLE_CHANGED, ten parametr określa aspekt elementu OLE, który uległ zmianie. Aby uzyskać możliwe wartości, zobacz parametr *dwParam* [COleClientItem::Draw](#draw). Jeśli *nCode* jest OLE_CHANGED_STATE, ten parametr `COleClientItem::ItemState` jest wartością wyliczoną i opisuje wprowadzony stan. Może mieć jedną z następujących `emptyState` `loadedState`wartości: `activeState`, `activeUIState`, `openState`, , lub .

### <a name="remarks"></a>Uwagi

(Jeśli aplikacja serwera jest napisana przy użyciu biblioteki klas Programu `Notify` Microsoft Foundation, ta funkcja jest wywoływana w odpowiedzi na funkcje członkowskie `COleServerDoc` lub `COleServerItem`.) Domyślna implementacja oznacza dokument kontenera jako zmodyfikowany, jeśli *kod nCode* jest OLE_CHANGED lub OLE_SAVED.

Dla OLE_CHANGED_STATE bieżący stan zwrócony z [GetItemState](#getitemstate) nadal będzie stary stan, co oznacza stan, który był aktualny przed tą zmianą stanu.

Zastąd w tej funkcji należy odpowiedzieć na zmiany stanu elementu OLE. Zazwyczaj można zaktualizować wygląd elementu, unieważniając obszar, w którym element jest wyświetlany. Wywołanie implementacji klasy podstawowej na początku zastąpienia.

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a>COleClientItem::OnChangeItemPosition

Wywoływane przez strukturę, aby powiadomić kontener, że zakres elementu OLE zmienił się podczas aktywacji w miejscu.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parametry

*rectPos*<br/>
Wskazuje położenie elementu względem obszaru klienta aplikacji kontenera.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli pozycja elementu została pomyślnie zmieniona; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja określa nowy widoczny prostokąt elementu OLE i wywołuje [SetItemRects](#setitemrects) z nowymi wartościami. Domyślna implementacja oblicza widoczny prostokąt elementu i przekazuje te informacje do serwera.

Zastąd w tej funkcji należy zastosować specjalne reguły do operacji ponownego rozmiaru/przenoszenia. Jeśli aplikacja jest napisana w MFC, to wywołanie powoduje, ponieważ serwer o nazwie [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a>COleClientItem::OnDeactivate

Wywoływana przez platformę, gdy element OLE przechodzi ze `activeState`stanu aktywnego w miejscu ( ) do załadowanego stanu, co oznacza, że jest dezaktywowany po aktywacji w miejscu.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Uwagi

Należy zauważyć, że ta funkcja jest wywoływana, aby wskazać, że element OLE jest zamknięty, a nie, że jego interfejs użytkownika został usunięty z aplikacji kontenera. W takim przypadku wywoływana jest funkcja elementu członkowskiego [OnDeactivateUI.](#ondeactivateui)

Domyślna implementacja wywołuje [onchange](#onchange) funkcji elementu członkowskiego z OLE_CHANGEDSTATE jako parametr. Zastąd w tej funkcji należy wykonać niestandardowe przetwarzanie, gdy aktywny element w miejscu jest dezaktywowany. Na przykład jeśli obsługujesz polecenie cofnij w aplikacji kontenera, można zastąpić tę funkcję, aby odrzucić stan cofania, wskazując, że ostatniej operacji wykonywanej na elemencie OLE nie można cofnąć po dezaktywacji elementu.

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a>COleClientItem::OnDeactivateAndUndo

Wywoływane przez strukturę, gdy użytkownik wywołuje polecenie cofania po aktywowaniu elementu OLE w miejscu.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja wywołuje [DeactivateUI,](#deactivateui) aby dezaktywować interfejs użytkownika serwera. Zastądź tę funkcję, jeśli implementujesz polecenie cofnij w aplikacji kontenera. W zastąpieniu wywołaj wersję klasy podstawowej funkcji, a następnie cofnij ostatnie polecenie wykonane w aplikacji.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::DeactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) w windows SDK.

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a>COleClientItem::OnDeactivateui

Wywoływane, gdy użytkownik dezaktywuje element, który został aktywowany w miejscu.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parametry

*bDagowalsz*<br/>
Określa, czy zmiany edycji są cofnięte.

### <a name="remarks"></a>Uwagi

Ta funkcja przywraca interfejs użytkownika aplikacji kontenera do stanu pierwotnego, ukrywając wszystkie menu i inne formanty, które zostały utworzone w celu aktywacji w miejscu.

Jeśli *bUndoable* jest FALSE, kontener powinien wyłączyć polecenie cofnij, w efekcie odrzucając stan cofania kontenera, ponieważ wskazuje, że ostatnia operacja wykonana przez serwer nie jest cofalna.

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a>COleClientItem::OnDiscardUndoState

Wywoływane przez platformę, gdy użytkownik wykonuje akcję, która odrzuca stan cofania podczas edytowania elementu OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja nic nie robi. Zastądź tę funkcję, jeśli implementujesz polecenie cofnij w aplikacji kontenera. W przesłonie odrzucić stan cofania aplikacji kontenera.

Jeśli serwer został napisany za pomocą biblioteki klas Microsoft Foundation, serwer może spowodować wywołanie tej funkcji przez wywołanie [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::DiscardUndoState](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) w windows SDK.

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a>COleClientItem::OnGetClipboardData

Wywoływane przez strukturę, `COleDataSource` aby uzyskać obiekt zawierający wszystkie dane, które zostaną umieszczone w Schowku przez wywołanie [copytoclipboard](#copytoclipboard) lub Funkcji członkowskiej [DoDragDrop.](#dodragdrop)

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
Ustaw wartość TRUE, jeśli dane łącza mają zostać skopiowane do Schowka. Ustaw to na FALSE, jeśli aplikacja serwera nie obsługuje łączy.

*lpOffset (zestaw lpOffset)*<br/>
Wskaźnik do odsunięcia kursora myszy od początku obiektu w pikselach.

*lpSize (rozmiar)*<br/>
Wskaźnik do rozmiaru obiektu w pikselach.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do [obiektu COleDataSource](../../mfc/reference/coledatasource-class.md) zawierającego dane Schowka.

### <a name="remarks"></a>Uwagi

Domyślna implementacja tej funkcji wywołuje [GetClipboardData](#getclipboarddata).

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a>COleClientItem::OnGetClipRect

Struktura wywołuje `OnGetClipRect` funkcję elementu członkowskiego, aby uzyskać współrzędne clipping-prostokąt elementu, który jest edytowany w miejscu.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parametry

*rClipRect*<br/>
Wskaźnik do obiektu klasy [CRect,](../../atl-mfc-shared/reference/crect-class.md) który będzie zawierać współrzędne clipping-prostokąt elementu.

### <a name="remarks"></a>Uwagi

Współrzędne znajdują się w pikselach względem obszaru klienta okna aplikacji kontenera.

Domyślna implementacja po prostu zwraca prostokąt klienta widoku, w którym element jest aktywny w miejscu.

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a>COleClientItem::OnGetItemPosition

Struktura wywołuje `OnGetItemPosition` funkcję elementu członkowskiego, aby uzyskać współrzędne elementu, który jest edytowany w miejscu.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parametry

*rPozycja*<br/>
Odwołanie do [obiektu CRect,](../../atl-mfc-shared/reference/crect-class.md) który będzie zawierał współrzędne pozycji elementu.

### <a name="remarks"></a>Uwagi

Współrzędne znajdują się w pikselach względem obszaru klienta okna aplikacji kontenera.

Domyślna implementacja tej funkcji nic nie robi. Aplikacje obsługujące edycję w miejscu wymagają jego implementacji.

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a>COleClientItem::OnGetWindowContext

Wywoływana przez strukturę, gdy element jest aktywowany w miejscu.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parametry

*ppMainFrame (Polski)*<br/>
Wskaźnik do wskaźnika do okna ramki głównej.

*ppDocFrame (polski)*<br/>
Wskaźnik do wskaźnika do okna ramki dokumentu.

*lpFrameInfo*<br/>
Wskaźnik do struktury [OLEINPLACEFRAMEINFO,](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) która będzie odbierać informacje o oknie ramki.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja służy do pobierania informacji o oknie nadrzędnym elementu OLE.

Jeśli kontener jest aplikacją MDI, domyślna implementacja zwraca wskaźnik do obiektu [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) w *ppMainFrame* i wskaźnik do aktywnego obiektu [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) w *ppDocFrame*. Jeśli kontener jest aplikacją SDI, domyślna implementacja zwraca wskaźnik do obiektu [CFrameWnd](../../mfc/reference/cframewnd-class.md) w *ppMainFrame* i zwraca wartość NULL w *ppDocFrame*. Domyślna implementacja wypełnia również członków *lpFrameInfo*.

Zastąp tę funkcję tylko wtedy, gdy domyślna implementacja nie odpowiada aplikacji; na przykład, jeśli aplikacja ma paradygmat interfejsu użytkownika, który różni się od SDI lub MDI. Jest to zaawansowane zastąpienie.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) i struktura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) w pliku SDK systemu Windows.

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a>COleClientItem::OnInsertMenus

Wywoływana przez strukturę podczas aktywacji w miejscu, aby wstawić menu aplikacji kontenera do pustego menu.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parametry

*pMenuShared (pMenuShared)*<br/>
Wskazuje puste menu.

*lpMenuWidths*<br/>
Wskazuje tablicę sześciu wartości LONG wskazujących, ile menu znajduje się w każdej z następujących grup menu: Plik, Edycja, Kontener, Obiekt, Okno, Pomoc. Aplikacja kontenera jest odpowiedzialny za file, container, i window grup menu, odpowiadające elementom 0, 2 i 4 tej tablicy.

### <a name="remarks"></a>Uwagi

To menu jest następnie przekazywane do serwera, który wstawia własne menu, tworząc menu złożone. Tę funkcję można wywołać wielokrotnie do tworzenia kilku menu złożonych.

Domyślna implementacja wstawia do *pMenuShared* menu kontenera w miejscu; oznacza to, że grupy menu Plik, Kontener i Okno. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) służy do ustawiania tego zasobu menu. Domyślna implementacja przypisuje również odpowiednie wartości do elementów 0, 2 i 4 w *lpMenuWidths*, w zależności od zasobu menu. Zastąp tę funkcję, jeśli domyślna implementacja nie jest odpowiednia dla aplikacji; na przykład jeśli aplikacja nie używa szablonów dokumentów do kojarzenia zasobów z typami dokumentów. W przypadku zastąpienia tej funkcji należy również zastąpić [onsetmenu](#onsetmenu) i [onremovemenus](#onremovemenus). Jest to zaawansowane zastąpienie.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceFrame::InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) w usłudze Windows SDK.

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a>COleClientItem::OnRemoveMenus

Wywoływane przez strukturę, aby usunąć menu kontenera z określonego menu złożonego po zakończeniu aktywacji w miejscu.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parametry

*pMenuShared (pMenuShared)*<br/>
Wskazuje menu złożone skonstruowane przez wywołania funkcji elementu członkowskiego [OnInsertMenus.](#oninsertmenus)

### <a name="remarks"></a>Uwagi

Domyślna implementacja usuwa z *pMenuShared* menu kontenera w miejscu, czyli pliki, kontener i window grup menu. Zastąp tę funkcję, jeśli domyślna implementacja nie jest odpowiednia dla aplikacji; na przykład jeśli aplikacja nie używa szablonów dokumentów do kojarzenia zasobów z typami dokumentów. Jeśli zastąpisz tę funkcję, prawdopodobnie należy zastąpić [OnInsertMenus](#oninsertmenus) i [OnSetMenu,](#onsetmenu) jak również. Jest to zaawansowane zastąpienie.

Podmenu na *pMenuShared* mogą być współużytkowane przez więcej `OnInsertMenus`niż jedno menu złożone, jeśli serwer wielokrotnie wywoływał . W związku z tym nie należy usuwać żadnych `OnRemoveMenus`podmenu w przesłonie ; należy je tylko odłączyć.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceFrame::RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) w usłudze Windows SDK.

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a>COleClientItem::OnScrollBy

Wywoływane przez strukturę, aby przewinąć element OLE w odpowiedzi na żądania z serwera.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parametry

*rozmiarWysekcja*<br/>
Określa odległości w pikselach, aby przewijać w kierunkach x i y.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli element został przewinięty; 0, jeśli nie można przewinąć elementu.

### <a name="remarks"></a>Uwagi

Na przykład jeśli element OLE jest częściowo widoczny, a użytkownik przesuwa się poza widocznym regionem podczas edytowania w miejscu, ta funkcja jest wywoływana, aby zachować widoczny kursor. Domyślna implementacja nic nie robi. Zastąd w tej funkcji należy przewinąć element o określoną kwotę. Należy zauważyć, że w wyniku przewijania widoczna część elementu OLE może ulec zmianie. Wywołaj [SetItemRects,](#setitemrects) aby zaktualizować widoczny prostokąt elementu.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) w windows SDK.

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a>COleClientItem::OnSetMenu

Wywoływana przez ramy dwa razy, gdy aktywacja w miejscu rozpoczyna się i kończy; po raz pierwszy zainstalować menu złożone i po raz drugi (z *holemenu* równa NULL), aby go usunąć.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parametry

*pMenuShared (pMenuShared)*<br/>
Wskaźnik do menu złożonego skonstruowane przez wywołania [oninsertMenus](#oninsertmenus) funkcji elementu członkowskiego i `InsertMenu` funkcji.

*holemenu*<br/>
Dojmij do deskryptora menu zwróconego `OleCreateMenuDescriptor` przez funkcję lub NULL, jeśli kod wysyłki ma zostać usunięty.

*hwndActiveObject (Aktywnyobject)*<br/>
Uchwyt do okna edycji elementu OLE. Jest to okno, które będzie odbierać polecenia edycji z OLE.

### <a name="remarks"></a>Uwagi

Domyślna implementacja instaluje lub usuwa menu złożone, a następnie wywołuje funkcję [OleSetMenuDescriptor,](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) aby zainstalować lub usunąć kod wysyłki. Zastąd w tej funkcji, jeśli domyślna implementacja nie jest odpowiednia dla aplikacji. Jeśli zastąpisz tę funkcję, prawdopodobnie należy zastąpić [OnInsertMenus](#oninsertmenus) i [OnRemoveMenus,](#onremovemenus) jak również. Jest to zaawansowane zastąpienie.

Aby uzyskać więcej informacji, zobacz [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)i [IOleInPlaceFrame::SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) w zestawie Windows SDK.

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a>COleClientItem::OnShowControlBars

Wywoływane przez strukturę, aby pokazać i ukryć paski sterowania aplikacji kontenera.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parametry

*pFrameWnd (pFrameWnd)*<br/>
Wskaźnik do okna ramki aplikacji kontenera. Może to być okno ramki głównej lub okno podrzędne MDI.

*bPokaż*<br/>
Określa, czy paski sterujące mają być wyświetlane, czy ukryte.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli wywołanie funkcji powoduje zmianę stanu słupków sterowania; 0, jeśli wywołanie nie powoduje żadnych zmian lub jeśli *pFrameWnd* nie wskazuje okna ramki kontenera.

### <a name="remarks"></a>Uwagi

Ta funkcja zwraca wartość 0, jeśli paski sterowania są już w stanie określonym przez *bShow.* Taka liczba może wystąpić, na przykład, jeśli paski sterowania są ukryte i *bShow* jest FALSE.

Domyślna implementacja usuwa pasek narzędzi z okna ramki najwyższego poziomu.

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a>COleClientItem::OnShowItem

Wywoływana przez strukturę do wyświetlania elementu OLE, dzięki czemu jest całkowicie widoczna podczas edycji.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Uwagi

Jest on używany, gdy aplikacja kontenera obsługuje łącza do elementów osadzonych (oznacza to, że jeśli zostały uzyskane klasy dokumentu z [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Ta funkcja jest wywoływana podczas aktywacji w miejscu lub gdy element OLE jest źródłem łącza i użytkownik chce go edytować. Domyślna implementacja aktywuje pierwszy widok w dokumencie kontenera. Zastąd w tej funkcji należy przewinąć dokument, tak aby element OLE był widoczny.

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a>COleClientItem::OnUpdateFrameTitle

Wywoływana przez strukturę podczas aktywacji w miejscu, aby zaktualizować pasek tytułu okna ramki.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli ta funkcja pomyślnie zaktualizował tytuł ramki, w przeciwnym razie zero.

### <a name="remarks"></a>Uwagi

Domyślna implementacja nie zmienia tytułu okna ramki. Zastąp tę funkcję, jeśli chcesz mieć inny tytuł ramki dla aplikacji, na przykład "*element* *aplikacji* - serwera w *docname*" (jak w "Microsoft Excel - arkusz kalkulacyjny w raporcie. doc"). Jest to zaawansowane zastąpienie.

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a>COleClientItem::ReaktywujAndUndo

Wywołanie tej funkcji, aby ponownie uaktywnić element OLE i cofnąć ostatnią operację wykonaną przez użytkownika podczas edycji w miejscu.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja kontenera obsługuje polecenie cofnij, wywołanie tej funkcji, jeśli użytkownik wybierze polecenie cofania natychmiast po dezaktywacji elementu OLE.

Jeśli aplikacja serwera jest zapisywana za pomocą bibliotek klas Programu Microsoft Foundation, ta funkcja powoduje, że serwer wywołuje [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject::ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) w windows SDK.

## <a name="coleclientitemrelease"></a><a name="release"></a>COleClientItem::Zwolnij

Wywołanie tej funkcji, aby oczyścić zasoby używane przez element OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parametry

*dwCloseOption (Kolosaopcja)*<br/>
Flaga określająca, w jakich okolicznościach element OLE jest zapisywany po powrocie do załadowanego stanu. Aby uzyskać listę możliwych wartości, zobacz [COleClientItem::Close](#close).

### <a name="remarks"></a>Uwagi

`Release`jest wywoływana `COleClientItem` przez destruktora.

Aby uzyskać więcej informacji, zobacz [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) w windows SDK.

## <a name="coleclientitemreload"></a><a name="reload"></a>COleClientItem::Przeładuj

Zamyka i ponownie ładuje element.

```
BOOL Reload();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Wywołanie `Reload` funkcji po aktywowaniu elementu jako elementu innego typu przez wywołanie [ActivateAs](#activateas).

## <a name="coleclientitemrun"></a><a name="run"></a>COleClientItem::Uruchom

Uruchamia aplikację skojarzoną z tym elementem.

```cpp
void Run();
```

### <a name="remarks"></a>Uwagi

Wywołanie `Run` funkcji członkowskiej, aby uruchomić aplikację serwera przed aktywacją elementu. Odbywa się to automatycznie przez [Activate](#activate) i [DoVerb](#doverb), więc zwykle nie jest konieczne wywołanie tej funkcji. Wywołaj tę funkcję, jeśli konieczne jest uruchomienie serwera w celu ustawienia atrybutu elementu, takiego jak [SetExtent,](#setextent)przed wykonaniem [doverb](#doverb).

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a>COleClientItem::SetDrawAspect

Wywołanie `SetDrawAspect` funkcji elementu członkowskiego, aby ustawić "aspekt" lub widok elementu.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parametry

*nDrawAspect*<br/>
Wartość z wyliczenia DVASPECT. Ten parametr może mieć jedną z następujących wartości:

- DVASPECT_CONTENT Element jest reprezentowany w taki sposób, że może być wyświetlany jako obiekt osadzony wewnątrz jego kontenera.

- DVASPECT_THUMBNAIL Element jest renderowany w reprezentacji "miniatury", dzięki czemu może być wyświetlany w narzędziu do przeglądania.

- DVASPECT_ICON Element jest reprezentowany przez ikonę.

- DVASPECT_DOCPRINT Element jest reprezentowany tak, jakby był drukowany za pomocą polecenia Drukuj z menu Plik.

### <a name="remarks"></a>Uwagi

Aspekt określa, jak element ma być renderowany przez [Draw,](#draw) gdy używana jest wartość domyślna dla argumentu *nDrawAspect* tej funkcji.

Ta funkcja jest wywoływana automatycznie przez ikonę zmiany (i inne okna dialogowe, które bezpośrednio wywołują okno dialogowe Zmień ikonę), aby włączyć kultowy aspekt wyświetlania na żądanie użytkownika.

## <a name="coleclientitemsetextent"></a><a name="setextent"></a>COleClientItem::SetExtent

Wywołanie tej funkcji, aby określić, ile miejsca jest dostępne dla elementu OLE.

```cpp
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parametry

*Rozmiar*<br/>
Obiekt [CSize](../../atl-mfc-shared/reference/csize-class.md) zawierający informacje o rozmiarze.

*nDrawAspect*<br/>
Określa aspekt elementu OLE, którego granice mają być ustawione. Aby uzyskać możliwe wartości, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Uwagi

Jeśli aplikacja serwera została napisana przy użyciu biblioteki klas Programu Microsoft Foundation, `COleServerItem` powoduje to, że funkcja elementu członkowskiego [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) odpowiedniego obiektu ma zostać wywołana. Element OLE można następnie odpowiednio dostosować jego wyświetlacz. Wymiary muszą znajdować się w MM_HIMETRIC jednostkach. Wywołanie tej funkcji, gdy użytkownik ma zmienić rozmiar elementu OLE lub jeśli obsługujesz jakąś formę negocjacji układu.

Aby uzyskać więcej informacji, zobacz [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) w zestawie Windows SDK.

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a>COleClientItem::SetHostNames

Wywołanie tej funkcji, aby określić nazwę aplikacji kontenera i nazwę kontenera dla osadzonego elementu OLE.

```cpp
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parametry

*lpszHost (lpszHost)*<br/>
Wskaźnik do nazwy widoczne dla użytkownika aplikacji kontenera.

*lpszHostObj*<br/>
Wskaźnik do identyfikującego ciągu kontenera, który zawiera element OLE.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja serwera została napisana przy użyciu biblioteki klas Programu Microsoft Foundation, ta `COleServerDoc` funkcja wywołuje funkcję członkowską [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) dokumentu zawierającego element OLE. Te informacje są używane w tytułach okien, gdy element OLE jest edytowany. Za każdym razem, gdy dokument kontenera jest ładowany, struktura wywołuje tę funkcję dla wszystkich elementów OLE w dokumencie. `SetHostNames`ma zastosowanie tylko do elementów osadzonych. Nie jest konieczne wywołanie tej funkcji za każdym razem, gdy osadzony element OLE jest aktywowany do edycji.

Jest to również wywoływane automatycznie z nazwą aplikacji i nazwą dokumentu podczas ładowania obiektu lub zapisywania pliku pod inną nazwą. W związku z tym zwykle nie jest konieczne, aby wywołać tę funkcję bezpośrednio.

Aby uzyskać więcej informacji, zobacz [IOleObject::SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) w zestawie Windows SDK.

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a>COleClientItem::SetIconicMetafile

Buforuje metaplik używany do rysowania ikony elementu.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parametry

*hMetaPict (MetalaPict)*<br/>
Uchwyt do metapliku używanego do rysowania ikony elementu.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Użyj [GetIconicMetafile,](#geticonicmetafile) aby pobrać metaplik.

Parametr *hMetaPict* jest kopiowany do elementu; w związku z tym *hMetaPict* musi być zwolniona przez wywołującego.

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a>COleClientItem::SetItemRects

Wywołanie tej funkcji, aby ustawić prostokąt ograniczający lub widoczny prostokąt elementu OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*lprcPosRect*<br/>
Wskaźnik do prostokąta zawierającego granice elementu OLE względem jego okna nadrzędnego we współrzędnych klienta.

*lprcClipRect*<br/>
Wskaźnik do prostokąta zawierającego granice widocznej części elementu OLE względem jego okna nadrzędnego we współrzędnych klienta.

### <a name="return-value"></a>Wartość zwracana

Nonzero jeśli się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja jest wywoływana przez domyślną implementację funkcji elementu członkowskiego [OnChangeItemPosition.](#onchangeitemposition) Tę funkcję należy wywołać za każdym razem, gdy zmieni się położenie lub widoczna część elementu OLE. Zazwyczaj oznacza to, że można wywołać go z widoku [OnSize](../../mfc/reference/cwnd-class.md#onsize) i [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) funkcji członkowskich.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) w zestawie Windows SDK.

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a>COleClientItem::SetLinkUpdateOptions

Wywołanie tej funkcji, aby ustawić opcję aktualizacji łącza dla prezentacji określonego elementu połączonego.

```cpp
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parametry

*dwUpdateOpt*<br/>
Wartość opcji aktualizacji łącza dla tego elementu. Ta wartość musi być jedną z następujących wartości:

- OLEUPDATE_ALWAYS Aktualizuj połączony element, gdy tylko jest to możliwe. Ta opcja obsługuje przycisk opcji Automatyczna aktualizacja łącza w oknie dialogowym Łącza.

- OLEUPDATE_ONCALL Aktualizuj połączony element tylko na żądanie z aplikacji kontenera (gdy wywoływana jest funkcja elementu członkowskiego [UpdateLink).](#updatelink) Ta opcja obsługuje przycisk opcji Ręczna aktualizacja łącza w oknie dialogowym Łącza.

### <a name="remarks"></a>Uwagi

Zazwyczaj nie należy zmieniać opcji aktualizacji wybranych przez użytkownika w oknie dialogowym Łącza.

Aby uzyskać więcej informacji, zobacz [IOleLink::SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) w zestawie Windows SDK.

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a>COleClientItem::SetPrintDevice

Wywołanie tej funkcji, aby zmienić urządzenie docelowe drukowania dla tego elementu.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parametry

*Ptd*<br/>
Wskaźnik do struktury danych [DVTARGETDEVICE,](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) która zawiera informacje o nowym urządzeniu docelowym wydruku. Może mieć wartość NULL.

*Ppd*<br/>
Wskaźnik do struktury danych [PRINTDLG,](/windows/win32/api/commdlg/ns-commdlg-printdlga) która zawiera informacje o nowym urządzeniu docelowym wydruku. Może mieć wartość NULL.

### <a name="return-value"></a>Wartość zwracana

Nonzero, jeśli funkcja zakończyła się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja aktualizuje urządzenie docelowe drukowania dla elementu, ale nie odświeża pamięci podręcznej prezentacji. Aby zaktualizować pamięć podręczną prezentacji dla elementu, zadzwoń do [programu UpdateLink](#updatelink).

Argumenty tej funkcji zawierają informacje używane przez system OLE do identyfikowania urządzenia docelowego. Struktura `PRINTDLG` zawiera informacje używane przez system Windows do inicjowania wspólnego okna dialogowego Drukowanie. Po zamknięciu okna dialogowego system Windows zwraca informacje o wyborach użytkownika w tej strukturze. Element `m_pd` członkowski [obiektu CPrintDialog](../../mfc/reference/cprintdialog-class.md) jest strukturą. `PRINTDLG`

Aby uzyskać więcej informacji na temat tej struktury, zobacz [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) w windows SDK.

Aby uzyskać więcej informacji, zobacz [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) w windows SDK.

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a>COleClientItem::UpdateLink

Wywołanie tej funkcji, aby natychmiast zaktualizować dane prezentacji elementu OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Wartość zwracana

Nonzero na sukces; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

W przypadku elementów połączonych funkcja znajduje źródło łącza w celu uzyskania nowej prezentacji dla elementu OLE. Ten proces może obejmować uruchomienie co najmniej jednej aplikacji serwera, co może być czasochłonne. W przypadku elementów osadzonych funkcja działa rekurencyjnie, sprawdzając, czy element osadzony zawiera łącza, które mogą być nieaktualne, i aktualizując je. Użytkownik może również ręcznie aktualizować poszczególne łącza za pomocą okna dialogowego Łącza.

Aby uzyskać więcej informacji, zobacz [IOleLink::Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) w windows SDK.

## <a name="see-also"></a>Zobacz też

[Próbka MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[Próbka MFC OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[Klasa CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Wykres hierarchii](../../mfc/hierarchy-chart.md)<br/>
[Klasa COleServerItem](../../mfc/reference/coleserveritem-class.md)
