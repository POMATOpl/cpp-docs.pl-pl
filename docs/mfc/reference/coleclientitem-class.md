---
description: 'Dowiedz się więcej na temat: Klasa COleClientItem'
title: Klasa COleClientItem
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: b0cffd8767190a9dc6b81c3c6e49af6075231e55
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/11/2020
ms.locfileid: "97250650"
---
# <a name="coleclientitem-class"></a>Klasa COleClientItem

Definiuje interfejs kontenera do elementów OLE.

## <a name="syntax"></a>Składnia

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Elementy członkowskie

### <a name="public-constructors"></a>Konstruktory publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleClientItem:: COleClientItem](#coleclientitem)|Konstruuje `COleClientItem` obiekt.|

### <a name="public-methods"></a>Metody publiczne

|Nazwa|Opis|
|----------|-----------------|
|[COleClientItem:: Activate](#activate)|Otwiera element OLE dla operacji, a następnie wykonuje określone zlecenie.|
|[COleClientItem:: ActivateAs](#activateas)|Aktywuje element jako inny typ.|
|[COleClientItem:: AttachDataObject](#attachdataobject)|Uzyskuje dostęp do danych w obiekcie OLE.|
|[COleClientItem:: CanCreateFromData](#cancreatefromdata)|Wskazuje, czy aplikacja kontenera może utworzyć osadzony obiekt.|
|[COleClientItem:: CanCreateLinkFromData](#cancreatelinkfromdata)|Wskazuje, czy aplikacja kontenera może utworzyć obiekt połączony.|
|[COleClientItem:: Ostatnia próba](#canpaste)|Wskazuje, czy Schowek zawiera element osadzony lub statyczny.|
|[COleClientItem:: CanPasteLink](#canpastelink)|Wskazuje, czy Schowek zawiera element OLE z możliwością łączenia.|
|[COleClientItem:: Close](#close)|Zamyka łącze do serwera, ale nie niszczy elementu OLE.|
|[COleClientItem:: ConvertTo](#convertto)|Konwertuje element na inny typ.|
|[COleClientItem:: CopyToClipboard](#copytoclipboard)|Kopiuje element OLE do Schowka.|
|[COleClientItem:: CreateCloneFrom](#createclonefrom)|Tworzy duplikat istniejącego elementu.|
|[COleClientItem:: CreateFromClipboard](#createfromclipboard)|Tworzy element osadzony ze schowka.|
|[COleClientItem:: CreateFromData](#createfromdata)|Tworzy element osadzony na podstawie obiektu danych.|
|[COleClientItem:: CreateFromFile](#createfromfile)|Tworzy element osadzony z pliku.|
|[COleClientItem:: CreateLinkFromClipboard](#createlinkfromclipboard)|Tworzy połączony element ze schowka.|
|[COleClientItem:: CreateLinkFromData](#createlinkfromdata)|Tworzy połączony element z obiektu danych.|
|[COleClientItem:: CreateLinkFromFile](#createlinkfromfile)|Tworzy połączony element z pliku.|
|[COleClientItem:: CreateNewItem](#createnewitem)|Tworzy nowy element osadzony, uruchamiając aplikację serwera.|
|[COleClientItem:: CreateStaticFromClipboard](#createstaticfromclipboard)|Tworzy element statyczny ze schowka.|
|[COleClientItem:: CreateStaticFromData](#createstaticfromdata)|Tworzy element statyczny na podstawie obiektu danych.|
|[COleClientItem::D eactivate](#deactivate)|Dezaktywuje element.|
|[COleClientItem::D eactivateUI](#deactivateui)|Przywraca interfejs użytkownika aplikacji kontenera do jego oryginalnego stanu.|
|[COleClientItem::D Usuń](#delete)|Usuwa lub zamyka element OLE, jeśli był elementem połączonym.|
|[COleClientItem::D oDragDrop](#dodragdrop)|Wykonuje operację przeciągania i upuszczania.|
|[COleClientItem::D oVerb](#doverb)|Wykonuje określone zlecenie.|
|[COleClientItem::D RAW](#draw)|Rysuje element OLE.|
|[COleClientItem:: GetActiveView](#getactiveview)|Pobiera widok, w którym element jest aktywowany.|
|[COleClientItem:: GetCachedExtent](#getcachedextent)|Zwraca granice prostokąta elementu OLE.|
|[COleClientItem:: GetClassID](#getclassid)|Pobiera identyfikator klasy elementu obecnego.|
|[COleClientItem:: GetClipboardData](#getclipboarddata)|Pobiera dane, które byłyby umieszczane w schowku przez wywołanie `CopyToClipboard` funkcji elementu członkowskiego.|
|[COleClientItem:: GetDocument](#getdocument)|Zwraca `COleDocument` obiekt, który zawiera element obecny.|
|[COleClientItem:: GetDrawAspect](#getdrawaspect)|Pobiera bieżący widok elementu do renderowania.|
|[COleClientItem:: getzakres](#getextent)|Zwraca granice prostokąta elementu OLE.|
|[COleClientItem:: GetIconFromRegistry](#geticonfromregistry)|Pobiera dojście do ikony skojarzonej z serwerem określonego identyfikatora CLSID.|
|[COleClientItem:: GetIconicMetafile](#geticonicmetafile)|Pobiera metaplik używany do rysowania ikony elementu.|
|[COleClientItem:: GetInPlaceWindow](#getinplacewindow)|Zwraca wskaźnik do okna edycji w miejscu elementu.|
|[COleClientItem:: GetItemState](#getitemstate)|Pobiera bieżący stan elementu.|
|[COleClientItem:: GetLastStatus](#getlaststatus)|Zwraca stan ostatniej operacji OLE.|
|[COleClientItem:: GetLinkUpdateOptions](#getlinkupdateoptions)|Zwraca tryb aktualizacji dla połączonego elementu (funkcja zaawansowana).|
|[COleClientItem:: GetType](#gettype)|Zwraca typ (osadzony, połączony lub statyczny) elementu OLE.|
|[COleClientItem:: GetUserType](#getusertype)|Pobiera ciąg opisujący typ elementu.|
|[COleClientItem:: IsInPlaceActive](#isinplaceactive)|Zwraca wartość PRAWDA, jeśli element jest aktywny.|
|[COleClientItem:: IsLinkUpToDate](#islinkuptodate)|Zwraca wartość TRUE, jeśli połączony element jest aktualny z jego dokumentem źródłowym.|
|[COleClientItem:: IsModified](#ismodified)|Zwraca wartość TRUE, jeśli element został zmodyfikowany od czasu ostatniego zapisywania.|
|[COleClientItem:: IsOpen](#isopen)|Zwraca wartość PRAWDA, jeśli element jest aktualnie otwarty w aplikacji serwera.|
|[COleClientItem:: IsRunning](#isrunning)|Zwraca wartość PRAWDA, jeśli aplikacja serwera elementu jest uruchomiona.|
|[COleClientItem:: OnActivate](#onactivate)|Wywoływane przez platformę, by powiadomić element, który został aktywowany.|
|[COleClientItem:: OnActivateUI](#onactivateui)|Wywoływane przez platformę, aby powiadomić element, że został aktywowany, i powinien wyświetlać jego interfejs użytkownika.|
|[COleClientItem:: OnChange](#onchange)|Wywoływana, gdy serwer zmienia element OLE. Wymagana implementacja.|
|[COleClientItem:: OnDeactivate](#ondeactivate)|Wywoływane przez platformę, gdy element zostanie zdezaktywowany.|
|[COleClientItem:: OnDeactivateUI](#ondeactivateui)|Wywoływane przez platformę, gdy serwer usunął swój interfejs użytkownika w miejscu.|
|[COleClientItem:: OnGetClipboardData](#ongetclipboarddata)|Wywoływane przez platformę, by pobrać dane do Schowka.|
|[COleClientItem:: OnInsertMenus](#oninsertmenus)|Wywoływane przez platformę w celu utworzenia menu złożonego.|
|[COleClientItem:: OnRemoveMenus](#onremovemenus)|Wywoływane przez platformę, aby usunąć menu kontenera z menu złożonego.|
|[COleClientItem:: OnSetMenu](#onsetmenu)|Wywoływane przez platformę w celu zainstalowania i usunięcia menu złożonego.|
|[COleClientItem:: OnShowControlBars](#onshowcontrolbars)|Wywoływane przez platformę, aby pokazać i ukryć paski kontroli.|
|[COleClientItem:: OnUpdateFrameTitle](#onupdateframetitle)|Wywoływane przez platformę, aby zaktualizować pasek tytułu okna ramki.|
|[COleClientItem:: ReactivateAndUndo](#reactivateandundo)|Ponownie uaktywnia element i Cofa ostatnią operację edycji w miejscu.|
|[COleClientItem:: Release](#release)|Zwalnia połączenie z połączonym elementem OLE i zamyka je, jeśli było otwarte. Nie niszczy elementu klienta.|
|[COleClientItem:: reload](#reload)|Ponownie ładuje element po wywołaniu `ActivateAs` .|
|[COleClientItem:: Run](#run)|Uruchamia aplikację skojarzoną z elementem.|
|[COleClientItem:: SetDrawAspect](#setdrawaspect)|Ustawia bieżący widok elementu do renderowania.|
|[COleClientItem:: setzakres](#setextent)|Ustawia prostokąt ograniczenia elementu OLE.|
|[COleClientItem:: SetHostNames](#sethostnames)|Ustawia nazwy wyświetlane na serwerze podczas edytowania elementu OLE.|
|[COleClientItem:: SetIconicMetafile](#seticonicmetafile)|Buforuje metaplik używany do rysowania ikony elementu.|
|[COleClientItem:: SetItemRects](#setitemrects)|Ustawia prostokąt obwiedni elementu.|
|[COleClientItem:: SetLinkUpdateOptions](#setlinkupdateoptions)|Ustawia tryb aktualizacji dla połączonego elementu (funkcja zaawansowana).|
|[COleClientItem:: SetPrintDevice](#setprintdevice)|Ustawia urządzenie drukowania dla tego elementu klienta.|
|[COleClientItem:: UpdateLink](#updatelink)|Aktualizuje pamięć podręczną prezentacji elementu.|

### <a name="protected-methods"></a>Metody chronione

|Nazwa|Opis|
|----------|-----------------|
|[COleClientItem:: unactivate](#canactivate)|Wywoływane przez platformę, aby określić, czy aktywacja w miejscu jest dozwolona.|
|[COleClientItem:: OnChangeItemPosition](#onchangeitemposition)|Wywoływane przez platformę, gdy zmienia się pozycja elementu.|
|[COleClientItem:: OnDeactivateAndUndo](#ondeactivateandundo)|Wywoływane przez platformę, aby cofnąć po aktywacji.|
|[COleClientItem:: OnDiscardUndoState](#ondiscardundostate)|Wywoływane przez platformę, by odrzucić informacje o stanie cofania elementu.|
|[COleClientItem:: OnGetClipRect](#ongetcliprect)|Wywoływane przez platformę, aby uzyskać współrzędne prostokąta wycinka elementu.|
|[COleClientItem:: OnGetItemPosition](#ongetitemposition)|Wywoływane przez platformę, aby uzyskać położenie elementu względem widoku.|
|[COleClientItem:: OnGetWindowContext](#ongetwindowcontext)|Wywoływane przez platformę, gdy element jest aktywowany.|
|[COleClientItem:: OnScrollBy](#onscrollby)|Wywoływane przez platformę, aby przewinąć element do widoku.|
|[COleClientItem:: OnShowItem](#onshowitem)|Wywoływane przez platformę, by wyświetlić element OLE.|

## <a name="remarks"></a>Uwagi

Element OLE reprezentuje dane, utworzone i obsługiwane przez aplikację serwera, które mogą być "bezproblemowo" zawarte w dokumencie, aby był on widoczny dla użytkownika jako pojedynczy dokument. Wynikiem jest "złożone dokumenty" składające się z elementu OLE i dokumentu zawierającego.

Element OLE może być osadzony lub połączony. Jeśli jest osadzony, jego dane są przechowywane jako część dokumentu złożonego. Jeśli jest on połączony, jego dane są przechowywane jako część oddzielnego pliku utworzonego przez aplikację serwera, a tylko link do tego pliku jest przechowywany w dokumencie złożonym. Wszystkie elementy OLE zawierają informacje określające aplikację serwera, która ma zostać wywołana w celu ich edycji.

`COleClientItem` definiuje kilka funkcji, które są wywoływane w odpowiedzi na żądania z aplikacji serwera; te zastąpienia zwykle działają jako powiadomienia. Umożliwia to aplikacji serwerowej informowanie kontenera o zmianach wprowadzonych przez użytkownika podczas edytowania elementu OLE lub do pobierania informacji potrzebnych podczas edytowania.

`COleClientItem` może być używany z klasą [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)lub [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) . Aby użyć `COleClientItem` , należy utworzyć klasy od niej i zaimplementować funkcję członkowską [onchangi](#onchange) , która definiuje, w jaki sposób kontener reaguje na zmiany wprowadzone do elementu. Aby zapewnić obsługę aktywacji w miejscu, Zastąp funkcję elementu członkowskiego [OnGetItemPosition](#ongetitemposition) . Ta funkcja udostępnia informacje o wyświetlanej pozycji elementu OLE.

Aby uzyskać więcej informacji na temat korzystania z interfejsu kontenera, zobacz artykuły [kontenery: implementowanie kontenera](../../mfc/containers-implementing-a-container.md) i [Aktywacja](../../mfc/activation-cpp.md).

> [!NOTE]
> Windows SDK odnosi się do elementów osadzonych i połączonych jako "obiekty" i odwołuje się do typów elementów jako "klasy". To odwołanie używa terminu "Item" do odróżnienia jednostki OLE od odpowiedniego obiektu C++ i terminu "Type" w celu odróżnienia kategorii OLE od klasy języka C++.

## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Wymagania

**Nagłówek:** Afxole. h

## <a name="coleclientitemactivate"></a><a name="activate"></a> COleClientItem:: Activate

Wywołaj tę funkcję, aby wykonać określone zlecenie zamiast [DoVerb](#doverb) , tak aby można było wykonać własne przetwarzanie, gdy zostanie zgłoszony wyjątek.

```cpp
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nVerb*<br/>
Określa zlecenie do wykonania. Może być jedną z następujących czynności:

|Wartość|Znaczenie|Symbol|
|-----------|-------------|------------|
|-0|Primary — Zlecenie|OLEIVERB_PRIMARY|
|-1|Zlecenie pomocnicze|(Brak)|
|-1|Wyświetl element do edycji|OLEIVERB_SHOW|
|-2|Edytuj element w osobnym oknie|OLEIVERB_OPEN|
|-3|Ukryj element|OLEIVERB_HIDE|

Wartość-1 jest zwykle aliasem dla innego zlecenia. Jeśli Edycja Open nie jest obsługiwana, wartość-2 ma ten sam skutek co-1. Aby uzyskać dodatkowe wartości, zobacz [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) w Windows SDK.

*pView*<br/>
Wskaźnik do okna widoku kontenera zawierającego element OLE; jest on używany przez aplikację serwera do aktywacji w miejscu. Ten parametr powinien mieć wartość NULL, jeśli kontener nie obsługuje aktywacji w miejscu.

*lpMsg*<br/>
Wskaźnik na komunikat, który spowodował aktywowanie elementu.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja serwera została zapisywana przy użyciu biblioteka MFC, ta funkcja powoduje wykonanie funkcji elementu członkowskiego [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) odpowiedniego `COleServerItem` obiektu.

Jeśli zlecenie podstawowe jest edytowane i wartość zero jest określona w parametrze *nVerb* , aplikacja serwera zostanie uruchomiona, aby umożliwić edytowanie elementu OLE. Jeśli aplikacja kontenera obsługuje aktywację w miejscu, edytowanie można przeprowadzić na miejscu. Jeśli kontener nie obsługuje aktywacji w miejscu (lub jeśli określono otwarte zlecenie), serwer jest uruchamiany w osobnym oknie i można tam wykonać edycję. Zazwyczaj, gdy użytkownik aplikacji kontenera dwukrotnie klika element OLE, wartość zlecenia podstawowego w parametrze *nVerb* określa akcję, którą może wykonać użytkownik. Jeśli jednak serwer obsługuje tylko jedną akcję, wykonuje tę akcję niezależnie od tego, która wartość jest określona w parametrze *nVerb* .

Aby uzyskać więcej informacji, zobacz [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) w Windows SDK.

## <a name="coleclientitemactivateas"></a><a name="activateas"></a> COleClientItem:: ActivateAs

Używa obiektów konwersji obiektów OLE do uaktywnienia elementu, tak jakby był elementem typu określonego przez *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*lpszUserType*<br/>
Wskaźnik do ciągu reprezentującego docelowy typ użytkownika, na przykład "dokument programu Word".

*clsidOld*<br/>
Odwołanie do bieżącego identyfikatora klasy elementu. Identyfikator klasy powinien reprezentować Typ rzeczywistego obiektu, jako zapisany, chyba że jest to link. W takim przypadku powinna to być identyfikator CLSID elementu, do którego odwołuje się łącze. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) automatycznie udostępnia prawidłowy identyfikator klasy dla elementu.

*clsidNew*<br/>
Odwołanie do identyfikatora klasy docelowej.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jest to wywoływane automatycznie przez [COleConvertDialog::D oconvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Nie jest on zazwyczaj wywoływany bezpośrednio.

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a> COleClientItem:: AttachDataObject

Wywołaj tę funkcję, aby zainicjować [COleDataObject](../../mfc/reference/coledataobject-class.md) do uzyskiwania dostępu do danych w elemencie OLE.

```cpp
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parametry

*rDataObject*<br/>
Odwołanie do `COleDataObject` obiektu, który zostanie zainicjowany, aby zezwolić na dostęp do danych w elemencie OLE.

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a> COleClientItem:: unactivate

Wywoływane przez platformę, gdy użytkownik zażąda aktywacji w miejscu elementu OLE; wartość zwracana przez tę funkcję określa, czy aktywacja w miejscu jest dozwolona.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli jest dozwolona aktywacja w miejscu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja zezwala na aktywację w miejscu, jeśli kontener ma prawidłowe okno. Zastąp tę funkcję, aby zaimplementować specjalną logikę do akceptowania lub odmowy żądania aktywacji. Na przykład można odrzucić żądanie aktywacji, jeśli element OLE jest zbyt mały lub nie jest aktualnie widoczny.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite:: CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) w Windows SDK.

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a> COleClientItem:: CanCreateFromData

Sprawdza, czy aplikacja kontenera może utworzyć osadzony obiekt z danego `COleDataObject` obiektu.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do obiektu [COleDataObject](../../mfc/reference/coledataobject-class.md) , z którego ma zostać utworzony element OLE.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli kontener może utworzyć osadzony obiekt z `COleDataObject` obiektu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

`COleDataObject`Klasa jest używana podczas transferów danych do pobierania danych w różnych formatach ze schowka poprzez przeciąganie i upuszczanie lub z osadzonego elementu OLE.

Kontenery mogą korzystać z tej funkcji w celu podjęcia decyzji o włączeniu lub wyłączeniu edycji Wklej i edytuj specjalne polecenia.

Aby uzyskać więcej informacji, zobacz [obiekty danych artykułu i źródła danych (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a> COleClientItem:: CanCreateLinkFromData

Sprawdza, czy aplikacja kontenera może utworzyć obiekt połączony z danego `COleDataObject` obiektu.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do obiektu [COleDataObject](../../mfc/reference/coledataobject-class.md) , z którego ma zostać utworzony element OLE.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli kontener może utworzyć obiekt połączony z `COleDataObject` obiektu.

### <a name="remarks"></a>Uwagi

`COleDataObject`Klasa jest używana podczas transferów danych do pobierania danych w różnych formatach ze schowka poprzez przeciąganie i upuszczanie lub z osadzonego elementu OLE.

Kontenery mogą korzystać z tej funkcji w celu podjęcia decyzji o włączeniu lub wyłączeniu poleceń Edytuj specjalne i Edytuj Wklej łącze.

Aby uzyskać więcej informacji, zobacz [obiekty danych artykułu i źródła danych (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a> COleClientItem:: Ostatnia próba

Wywołaj tę funkcję, aby sprawdzić, czy osadzony element OLE można wkleić ze schowka.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli osadzony element OLE można wkleić ze schowka; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) i [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) w Windows SDK.

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a> COleClientItem:: CanPasteLink

Wywołaj tę funkcję, aby sprawdzić, czy połączony element OLE można wkleić ze schowka.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli połączony element OLE można wkleić ze schowka; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) i [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) w Windows SDK.

## <a name="coleclientitemclose"></a><a name="close"></a> COleClientItem:: Close

Wywołaj tę funkcję, aby zmienić stan elementu OLE z stanu uruchomionego na załadowany, który jest ładowany wraz z jego obsługą w pamięci, ale serwer nie jest uruchomiony.

```cpp
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Flaga określająca, w jaki sposób element OLE jest zapisywany po powrocie do stanu załadowanego. Może mieć jedną z następujących wartości:

- OLECLOSE_SAVEIFDIRTY zapisać elementu OLE.

- OLECLOSE_NOSAVE nie zapisuj elementu OLE.

- OLECLOSE_PROMPTSAVE monitować użytkownika o to, czy element OLE ma być zapisany.

### <a name="remarks"></a>Uwagi

Ta funkcja nie działa, gdy element OLE nie jest uruchomiony.

Aby uzyskać więcej informacji, zobacz [IOleObject:: Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) w Windows SDK.

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a> COleClientItem:: COleClientItem

Konstruuje `COleClientItem` obiekt i dodaje go do kolekcji elementów dokumentu kontenera dokumentu, która konstruuje tylko obiekt C++ i nie wykonuje żadnych inicjalizacji OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parametry

*pContainerDoc*<br/>
Wskaźnik do dokumentu kontenera, który będzie zawierać ten element. Może to być dowolny pochodny [COleDocument](../../mfc/reference/coledocument-class.md) .

### <a name="remarks"></a>Uwagi

Jeśli przeszedł wskaźnik o wartości NULL, nie zostanie dodany do dokumentu kontenera. Musisz jawnie wywołać [COleDocument:: AddItem](../../mfc/reference/coledocument-class.md#additem).

Przed użyciem elementu OLE należy wywołać jedną z następujących funkcji elementów członkowskich tworzenia:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a> COleClientItem:: ConvertTo

Wywołaj tę funkcję elementu członkowskiego, aby przekonwertować element na typ określony przez *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametry

*clsidNew*<br/>
Identyfikator klasy typu docelowego.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta nazwa jest wywoływana automatycznie przez [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Nie jest konieczne bezpośrednie wywoływanie go.

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a> COleClientItem:: CopyToClipboard

Wywołaj tę funkcję, aby skopiować element OLE do Schowka.

```cpp
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
Ma wartość TRUE, jeśli informacje o linku powinny zostać skopiowane do schowka, co pozwoli na wklejenie połączonego elementu; w przeciwnym razie FALSE.

### <a name="remarks"></a>Uwagi

Zazwyczaj należy wywołać tę funkcję podczas pisania obsługi komunikatów dla poleceń Kopiuj lub Wytnij z menu Edycja. Aby zaimplementować polecenie kopiowania lub wycinania, należy zaimplementować zaznaczenie elementu w aplikacji kontenera.

Aby uzyskać więcej informacji, zobacz [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) w Windows SDK.

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a> COleClientItem:: CreateCloneFrom

Wywołaj tę funkcję, aby utworzyć kopię określonego elementu OLE.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parametry

*pSrcItem*<br/>
Wskaźnik na element OLE, który ma być zduplikowany.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Kopia jest identyczna z elementem źródłowym. Za pomocą tej funkcji można obsługiwać operacje cofania.

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a> COleClientItem:: CreateFromClipboard

Wywołaj tę funkcję, aby utworzyć element osadzony na podstawie zawartości Schowka.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w Windows SDK.

*cfFormat*<br/>
Określa format danych schowka, który ma zostać zbuforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używany, jeśli *Render* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie spoza formatu Schowka określonego przez *cfFormat*. W przypadku pominięcia tego parametru wartości domyślne są używane dla innych pól `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zazwyczaj wywoływana jest ta funkcja z programu obsługi komunikatów dla polecenia Wklej w menu Edycja. (Wklej polecenie jest włączane przez platformę, jeśli [Ostatnia](#canpaste) funkcja członkowska zwraca wartość różną od zera).

Aby uzyskać więcej informacji, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w Windows SDK.

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a> COleClientItem:: CreateFromData

Wywołaj tę funkcję, aby utworzyć element osadzony na podstawie `COleDataObject` obiektu.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do obiektu [COleDataObject](../../mfc/reference/coledataobject-class.md) , z którego ma zostać utworzony element OLE.

*renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w Windows SDK.

*cfFormat*<br/>
Określa format danych schowka, który ma zostać zbuforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używany, jeśli *Render* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie spoza formatu Schowka określonego przez *cfFormat*. W przypadku pominięcia tego parametru wartości domyślne są używane dla innych pól `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Operacje transferu danych, takie jak wklejanie ze schowka lub operacje przeciągania i upuszczania, zapewniają `COleDataObject` obiekty zawierające informacje oferowane przez aplikację serwera. Jest zazwyczaj używany w przesłonięciu [CView:: OnDrop](../../mfc/reference/cview-class.md#ondrop).

Aby uzyskać więcej informacji, zobacz [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w Windows SDK.

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a> COleClientItem:: CreateFromFile

Wywołaj tę funkcję, aby utworzyć osadzony element OLE z pliku.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Wskaźnik na nazwę pliku, z którego ma zostać utworzony element OLE.

*Identyfikator*<br/>
Zarezerwowane do użytku w przyszłości.

*renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w Windows SDK.

*cfFormat*<br/>
Określa format danych schowka, który ma zostać zbuforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używany, jeśli *Render* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie spoza formatu Schowka określonego przez *cfFormat*. W przypadku pominięcia tego parametru wartości domyślne są używane dla innych pól `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Struktura wywołuje tę funkcję z [COleInsertDialog::](../../mfc/reference/coleinsertdialog-class.md#createitem) myFunction, jeśli użytkownik wybierze OK z okna dialogowego Wstawianie obiektu po wybraniu przycisku Utwórz z pliku.

Aby uzyskać więcej informacji, zobacz [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w Windows SDK.

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a> COleClientItem:: CreateLinkFromClipboard

Wywołaj tę funkcję, aby utworzyć połączony element z zawartości Schowka.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w Windows SDK.

*cfFormat*<br/>
Określa format danych schowka, który ma zostać zbuforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używany, jeśli *Render* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie spoza formatu Schowka określonego przez *cfFormat*. W przypadku pominięcia tego parametru wartości domyślne są używane dla innych pól `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Zazwyczaj wywoływana jest ta funkcja z obsługi komunikatów dla polecenia Wklej łącze w menu Edycja. (Polecenie Wklej łącze jest włączone w domyślnej implementacji [COleDocument](../../mfc/reference/coledocument-class.md) , jeśli Schowek zawiera element OLE, który może być połączony z.)

Aby uzyskać więcej informacji, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w Windows SDK.

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a> COleClientItem:: CreateLinkFromData

Wywołaj tę funkcję, aby utworzyć połączony element z `COleDataObject` obiektu.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do obiektu [COleDataObject](../../mfc/reference/coledataobject-class.md) , z którego ma zostać utworzony element OLE.

*renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w Windows SDK.

*cfFormat*<br/>
Określa format danych schowka, który ma zostać zbuforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używany, jeśli *Render* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie spoza formatu Schowka określonego przez *cfFormat*. W przypadku pominięcia tego parametru wartości domyślne są używane dla innych pól `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Wywołaj to w trakcie operacji Drop, gdy użytkownik wskazuje link, który ma zostać utworzony. Można go również użyć do obsługi polecenia Edytuj Wklej. Jest wywoływana przez platformę w `COleClientItem::CreateLinkFromClipboard` i w [COlePasteSpecialDialog:: SetItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) , gdy wybrano opcję link.

Aby uzyskać więcej informacji, zobacz [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w Windows SDK.

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a> COleClientItem:: CreateLinkFromFile

Wywołaj tę funkcję, aby utworzyć połączony element OLE z pliku.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
Wskaźnik na nazwę pliku, z którego ma zostać utworzony element OLE.

*renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w Windows SDK.

*cfFormat*<br/>
Określa format danych schowka, który ma zostać zbuforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używany, jeśli *Render* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie spoza formatu Schowka określonego przez *cfFormat*. W przypadku pominięcia tego parametru wartości domyślne są używane dla innych pól `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Struktura wywołuje tę funkcję, jeśli użytkownik wybierze OK z okna dialogowego Wstawianie obiektu po zaznaczeniu przycisku Utwórz z pliku, a pole wyboru link jest zaznaczone. Jest wywoływana z [COleInsertDialog::](../../mfc/reference/coleinsertdialog-class.md#createitem)elementu.

Aby uzyskać więcej informacji, zobacz [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w Windows SDK.

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a> COleClientItem:: CreateNewItem

Wywołaj tę funkcję, aby utworzyć element osadzony; Ta funkcja uruchamia aplikację serwerową, która umożliwia użytkownikowi tworzenie elementu OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*Identyfikator*<br/>
Identyfikator, który jednoznacznie identyfikuje typ elementu OLE, który ma zostać utworzony.

*renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w Windows SDK.

*cfFormat*<br/>
Określa format danych schowka, który ma zostać zbuforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używany, jeśli *Render* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie spoza formatu Schowka określonego przez *cfFormat*. W przypadku pominięcia tego parametru wartości domyślne są używane dla innych pól `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Struktura wywołuje tę funkcję, jeśli użytkownik wybierze OK z okna dialogowego Wstawianie obiektu po wybraniu przycisku Utwórz nowy.

Aby uzyskać więcej informacji, zobacz [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w Windows SDK.

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a> COleClientItem:: CreateStaticFromClipboard

Wywołaj tę funkcję, aby utworzyć element statyczny na podstawie zawartości Schowka.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w Windows SDK.

*cfFormat*<br/>
Określa format danych schowka, który ma zostać zbuforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używany, jeśli *Render* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie spoza formatu Schowka określonego przez *cfFormat*. W przypadku pominięcia tego parametru wartości domyślne są używane dla innych pól `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Element statyczny zawiera dane prezentacji, ale nie dane natywne; w związku z tym nie można go edytować. Ta funkcja jest zazwyczaj wywoływana, jeśli funkcja członkowska [CreateFromClipboard](#createfromclipboard) nie powiedzie się.

Aby uzyskać więcej informacji, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w Windows SDK.

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a> COleClientItem:: CreateStaticFromData

Wywołaj tę funkcję, aby utworzyć statyczny element z `COleDataObject` obiektu.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametry

*pDataObject*<br/>
Wskaźnik do obiektu [COleDataObject](../../mfc/reference/coledataobject-class.md) , z którego ma zostać utworzony element OLE.

*renderowania*<br/>
Flaga określająca sposób renderowania elementu OLE przez serwer. Aby uzyskać możliwe wartości, zobacz [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) w Windows SDK.

*cfFormat*<br/>
Określa format danych schowka, który ma zostać zbuforowany podczas tworzenia elementu OLE.

*lpFormatEtc*<br/>
Wskaźnik do struktury [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) używany, jeśli *Render* jest OLERENDER_FORMAT lub OLERENDER_DRAW. Podaj wartość dla tego parametru tylko wtedy, gdy chcesz określić dodatkowe informacje o formacie spoza formatu Schowka określonego przez *cfFormat*. W przypadku pominięcia tego parametru wartości domyślne są używane dla innych pól `FORMATETC` struktury.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Element statyczny zawiera dane prezentacji, ale nie dane natywne; w związku z tym nie można go edytować. Jest to zasadniczo takie samo jak [CreateStaticFromClipboard](#createstaticfromclipboard) , z tą różnicą, że element statyczny można utworzyć z dowolnego elementu `COleDataObject` , a nie tylko ze schowka.

Używany w [COlePasteSpecialDialog:: SetItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) , gdy wybrano element static.

Aby uzyskać więcej informacji, zobacz [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)i [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) w Windows SDK.

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a> COleClientItem::D eactivate

Wywołaj tę funkcję, aby dezaktywować element OLE i zwolnić wszystkie skojarzone zasoby.

```cpp
void Deactivate();
```

### <a name="remarks"></a>Uwagi

Jeśli użytkownik kliknie myszą w obszarze klienta poza granicami elementu, jest zazwyczaj dezaktywowany aktywny element OLE. Należy pamiętać, że dezaktywowanie elementu OLE spowoduje odrzucenie jego stanu cofania, uniemożliwiając wywołanie funkcji składowej [ReactivateAndUndo](#reactivateandundo) .

Jeśli aplikacja obsługuje cofanie, nie wywołuj `Deactivate` ; zamiast tego wywołaj [DeactivateUI](#deactivateui).

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) w Windows SDK.

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a> COleClientItem::D eactivateUI

Wywołaj tę funkcję, gdy użytkownik dezaktywuje element, który został aktywowany.

```cpp
void DeactivateUI();
```

### <a name="remarks"></a>Uwagi

Ta funkcja przywraca interfejs użytkownika aplikacji kontenera do jego oryginalnego stanu, ukrywając wszystkie menu i inne kontrolki, które zostały utworzone dla aktywacji w miejscu.

Ta funkcja nie opróżnia informacji o stanie cofania dla elementu. Te informacje są zachowywane, tak aby [ReactivateAndUndo](#reactivateandundo) można było później użyć do wykonania polecenia Cofnij w aplikacji serwera, w przypadku gdy polecenie cofnięcia kontenera jest wybierane natychmiast po zdezaktywowaniu elementu.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) w Windows SDK.

## <a name="coleclientitemdelete"></a><a name="delete"></a> COleClientItem::D Usuń

Wywołaj tę funkcję, aby usunąć element OLE z dokumentu kontenera.

```cpp
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parametry

*bAutoDelete*<br/>
Określa, czy element ma zostać usunięty z dokumentu.

### <a name="remarks"></a>Uwagi

Ta funkcja wywołuje funkcję członkowską [wydania](#release) , która z kolei usuwa obiekt C++ dla elementu, trwale usuwając element OLE z dokumentu. Jeśli element OLE jest osadzony, dane natywne dla elementu są usuwane. Zawsze zamyka uruchomiony serwer; w związku z tym, jeśli element jest otwartym łączem, ta funkcja go zamknie.

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a> COleClientItem::D oDragDrop

Wywołaj `DoDragDrop` funkcję elementu członkowskiego, aby wykonać operację przeciągania i upuszczania.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parametry

*lpItemRect*<br/>
Prostokąt elementu na ekranie w współrzędnej klienta (w pikselach).

*ptOffset*<br/>
Przesunięcie od *lpItemRect* , w którym położenie myszy było w czasie przeciągania.

*bIncludeLink*<br/>
Ustaw tę wartość na TRUE (prawda), jeśli dane łącza mają zostać skopiowane do Schowka. Ustaw wartość FALSE, jeśli aplikacja serwera nie obsługuje linków.

*dwEffects*<br/>
Określa skutki, przez które źródło przeciągane będzie dozwolone w operacji przeciągania.

*lpRectStartDrag*<br/>
Wskaźnik do prostokąta, który definiuje, gdzie w rzeczywistości zostanie rozpoczęte przeciąganie. Aby uzyskać więcej informacji zobacz następujące sekcji uwag.

### <a name="return-value"></a>Wartość zwracana

Wartość DROPEFFECT. W przypadku DROPEFFECT_MOVE należy usunąć oryginalne dane.

### <a name="remarks"></a>Uwagi

Operacja przeciągania i upuszczania nie rozpocznie się natychmiast. Czeka, aż kursor myszy opuści prostokąt określony przez *lpRectStartDrag* lub dopóki nie upłynie określona liczba milisekund. Jeśli *lpRectStartDrag* ma wartość null, rozmiar prostokąta wynosi jeden piksel.

Czas opóźnienia jest określany przez ustawienie klucza rejestru. Można zmienić czas opóźnienia przez wywołanie [CWinApp:: WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) lub [CWinApp:: WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Jeśli czas opóźnienia nie zostanie określony, zostanie użyta wartość domyślna 200 milisekund. Czas opóźnienia przeciągania jest przechowywany w następujący sposób:

- Czas opóźnienia przeciągania systemu Windows NT jest przechowywany w HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini \Windows\DragDelay.

- Czas opóźnienia przeciągania systemu Windows 3. x jest przechowywany w pliku WIN.INI w sekcji [Windows}.

- Czas opóźnienia przeciągania systemu Windows 95/98 jest przechowywany w buforowanej wersji WIN.INI.

Aby uzyskać więcej informacji na temat sposobu przechowywania informacji o opóźnieniu przeciągania w rejestrze lub. Plik INI, zobacz [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) w Windows SDK.

## <a name="coleclientitemdoverb"></a><a name="doverb"></a> COleClientItem::D oVerb

Wywołanie `DoVerb` do wykonania określonego zlecenia.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametry

*nVerb*<br/>
Określa zlecenie do wykonania. Może zawierać jedną z następujących czynności:

|Wartość|Znaczenie|Symbol|
|-----------|-------------|------------|
|-0|Primary — Zlecenie|OLEIVERB_PRIMARY|
|-1|Zlecenie pomocnicze|(Brak)|
|-1|Wyświetl element do edycji|OLEIVERB_SHOW|
|-2|Edytuj element w osobnym oknie|OLEIVERB_OPEN|
|-3|Ukryj element|OLEIVERB_HIDE|

Wartość-1 jest zwykle aliasem dla innego zlecenia. Jeśli Edycja Open nie jest obsługiwana, wartość-2 ma ten sam skutek co-1. Aby uzyskać dodatkowe wartości, zobacz [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) w Windows SDK.

*pView*<br/>
Wskaźnik do okna widoku; jest on używany przez serwer do aktywacji w miejscu. Ten parametr powinien mieć wartość NULL, jeśli aplikacja kontenera nie zezwala na aktywację w miejscu.

*lpMsg*<br/>
Wskaźnik na komunikat, który spowodował aktywowanie elementu.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli zlecenie zostało wykonane pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja wywołuje funkcję [aktywowania](#activate) elementu członkowskiego, aby wykonać zlecenie. Przechwytuje również wyjątki i wyświetla okno komunikatu dla użytkownika, jeśli został zgłoszony.

Jeśli zlecenie podstawowe jest edytowane i wartość zero jest określona w parametrze *nVerb* , aplikacja serwera zostanie uruchomiona, aby umożliwić edytowanie elementu OLE. Jeśli aplikacja kontenera obsługuje aktywację w miejscu, edytowanie można przeprowadzić na miejscu. Jeśli kontener nie obsługuje aktywacji w miejscu (lub jeśli określono otwarte zlecenie), serwer jest uruchamiany w osobnym oknie i można tam wykonać edycję. Zazwyczaj, gdy użytkownik aplikacji kontenera dwukrotnie klika element OLE, wartość zlecenia podstawowego w parametrze *nVerb* określa akcję, którą może wykonać użytkownik. Jeśli jednak serwer obsługuje tylko jedną akcję, wykonuje tę akcję niezależnie od tego, która wartość jest określona w parametrze *nVerb* .

## <a name="coleclientitemdraw"></a><a name="draw"></a> COleClientItem::D RAW

Wywołaj tę funkcję, aby narysować element OLE w określonym prostokącie obwiedni przy użyciu określonego kontekstu urządzenia.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*Domeny*<br/>
Wskaźnik [do obiektu](../../mfc/reference/cdc-class.md) przerzutowania używany do rysowania elementu OLE.

*lpBounds*<br/>
Wskaźnik do obiektu [CRect](../../atl-mfc-shared/reference/crect-class.md) lub `RECT` struktury, który definiuje prostokąt ograniczenia, w którym ma być rysowany element OLE (w jednostkach logicznych określonych przez kontekst urządzenia).

*nDrawAspect*<br/>
Określa aspekt elementu OLE, czyli sposób wyświetlania. Jeśli *nDrawAspect* to-1, używany jest ostatni aspekt ustawiony przy użyciu [SetDrawAspect](#setdrawaspect) . Aby uzyskać więcej informacji na temat możliwych wartości dla tej flagi, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Funkcja może używać reprezentowania metapliku elementu OLE utworzonego przez funkcję elementu członkowskiego [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) `COleServerItem` .

Zwykle używany `Draw` do wyświetlania ekranu, przekazanie kontekstu urządzenia ekranu jako *PDC*. W takim przypadku należy określić tylko pierwsze dwa parametry.

Parametr *lpBounds* identyfikuje prostokąt w kontekście urządzenia docelowego (względem bieżącego trybu mapowania). Renderowanie może polegać na skalowaniu obrazu i może być używane przez aplikacje kontenera do nakładania widoku, który skaluje widok wyświetlania i końcowy obraz.

Aby uzyskać więcej informacji, zobacz temat [IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) w Windows SDK.

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a> COleClientItem:: GetActiveView

Zwraca widok, w którym aktywowano element w miejscu.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do widoku; w przeciwnym razie wartość NULL, jeśli element nie jest aktywowany w miejscu.

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a> COleClientItem:: GetCachedExtent

Wywołaj tę funkcję, aby pobrać rozmiar elementu OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametry

*lpSize*<br/>
Wskaźnik do `SIZE` struktury lub obiektu [CSize](../../atl-mfc-shared/reference/csize-class.md) , który otrzyma informacje o rozmiarze.

*nDrawAspect*<br/>
Określa aspekt elementu OLE, którego granice mają zostać pobrane. Aby uzyskać możliwe wartości, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; 0, jeśli element OLE jest pusty.

### <a name="remarks"></a>Uwagi

Ta funkcja udostępnia te same informacje co [getzakres](#getextent). Można jednak wywołać, `GetCachedExtent` Aby uzyskać informacje o zakresie podczas przetwarzania innych programów obsługi OLE, takich jak [OnChange](#onchange). Wymiary znajdują się w jednostkach MM_HIMETRIC.

Jest to możliwe `GetCachedExtent` , ponieważ używa interfejsu [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) zamiast używania interfejsu [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) w celu uzyskania zakresu tego elementu. `IViewObject2`Obiekt com przechowuje w pamięci podręcznej informacje o zakresie, które są używane w poprzednim wywołaniu [widoku IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Aby uzyskać więcej informacji, zobacz [IViewObject2:: GetStop](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) w Windows SDK.

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a> COleClientItem:: GetClassID

Zwraca identyfikator klasy elementu do pamięci wskazywanej przez *pClassId*.

```cpp
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parametry

*pClassID*<br/>
Wskaźnik do identyfikatora typu [CLSID](/windows/win32/com/clsid-key-hklm) do pobrania identyfikatora klasy. Aby uzyskać informacje na temat identyfikatora CLSID, zobacz Windows SDK.

### <a name="remarks"></a>Uwagi

Identyfikator klasy jest numerem 128-bitowym, który jednoznacznie identyfikuje aplikację, która edytuje element.

Aby uzyskać więcej informacji, zobacz [IPersist:: GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) w Windows SDK.

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a> COleClientItem:: GetClipboardData

Wywołaj tę funkcję, aby uzyskać `COleDataSource` obiekt zawierający wszystkie dane, które zostaną umieszczone w schowku przez wywołanie funkcji składowej [CopyToClipboard](#copytoclipboard) .

```cpp
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parametry

*pDataSource*<br/>
Wskaźnik do obiektu [by uzyskać COleDataSource](../../mfc/reference/coledatasource-class.md) , który będzie otrzymywał dane zawarte w elemencie OLE.

*bIncludeLink*<br/>
Ma wartość TRUE, jeśli należy uwzględnić dane linku; w przeciwnym razie FALSE.

*lpOffset*<br/>
Przesunięcie kursora myszy od początku obiektu w pikselach.

*lpSize*<br/>
Rozmiar obiektu w pikselach.

### <a name="remarks"></a>Uwagi

`GetClipboardData` jest wywoływana jako domyślna implementacja [OnGetClipboardData](#ongetclipboarddata). Przesłoń `OnGetClipboardData` tylko wtedy, gdy chcesz zaoferować formaty danych oprócz tych oferowanych przez program `CopyToClipboard` . Umieść te formaty w `COleDataSource` obiekcie przed wywołaniem lub po `CopyToClipboard` nim, a następnie Przekaż `COleDataSource` obiekt do funkcji [by uzyskać COleDataSource:: setClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) . Na przykład, jeśli chcesz, aby pozycja elementu OLE w jego dokumencie kontenera była dołączona do schowka, zdefiniuj własny format do przekazywania tych informacji i umieść go w `COleDataSource` przed wywołaniem `CopyToClipboard` .

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a> COleClientItem:: GetDocument

Wywołaj tę funkcję, aby uzyskać wskaźnik do dokumentu zawierającego element OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do dokumentu zawierającego element OLE. Wartość NULL, jeśli element nie jest częścią dokumentu.

### <a name="remarks"></a>Uwagi

Ten wskaźnik umożliwia dostęp do `COleDocument` obiektu, który został przesłany jako argument do `COleClientItem` konstruktora.

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a> COleClientItem:: GetDrawAspect

Wywołaj `GetDrawAspect` funkcję członkowską, aby określić bieżący "aspekt" lub widok elementu.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość z wyliczenia DVASPECT, której wartości są wymienione w odwołaniu dla [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Uwagi

Aspekt określa sposób renderowania elementu.

## <a name="coleclientitemgetextent"></a><a name="getextent"></a> COleClientItem:: getzakres

Wywołaj tę funkcję, aby pobrać rozmiar elementu OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parametry

*lpSize*<br/>
Wskaźnik do `SIZE` struktury lub `CSize` obiektu, który otrzyma informacje o rozmiarze.

*nDrawAspect*<br/>
Określa aspekt elementu OLE, którego granice mają zostać pobrane. Aby uzyskać możliwe wartości, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; 0, jeśli element OLE jest pusty.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja serwera została zapisywana przy użyciu biblioteka MFC, ta funkcja powoduje wywołanie funkcji elementu członkowskiego [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) odpowiedniego `COleServerItem` obiektu. Należy zauważyć, że pobrany rozmiar może się różnić od rozmiaru ostatniego ustawionego [przez funkcję elementu](#setextent) Członkowskiego setSize; rozmiar określony przez `SetExtent` jest traktowany jako sugestia. Wymiary znajdują się w jednostkach MM_HIMETRIC.

> [!NOTE]
> Nie wywołuj `GetExtent` podczas przetwarzania procedury obsługi OLE, np. [OnChange](#onchange). Zamiast tego wywołaj [GetCachedExtent](#getcachedextent) .

Aby uzyskać więcej informacji, zobacz [IOleObject:: GetStop](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) w Windows SDK.

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a> COleClientItem:: GetIconFromRegistry

Wywołaj tę funkcję elementu członkowskiego, aby pobrać uchwyt do zasobu ikony skojarzonego z serwerem o określonym identyfikatorze CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parametry

*Identyfikator*<br/>
Odwołanie do identyfikatora CLSID dla serwera skojarzonego ze ikoną.

### <a name="return-value"></a>Wartość zwracana

Nie można znaleźć prawidłowego dojścia do zasobu ikony lub wartości NULL, jeśli jest to ikona serwera lub ikona domyślna.

### <a name="remarks"></a>Uwagi

Ta funkcja członkowska nie będzie uruchamiać serwera lub uzyskać ikony dynamicznie, nawet jeśli serwer jest już uruchomiony. Zamiast tego funkcja członkowska otwiera obraz wykonywalny serwera i Pobiera ikonę statyczną skojarzoną z serwerem, gdy został zarejestrowany.

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a> COleClientItem:: GetIconicMetafile

Pobiera metaplik używany do rysowania ikony elementu.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Wartość zwracana

Dojście do metapliku, jeśli się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

Jeśli nie ma bieżącej ikony, zwracana jest ikona domyślna. Ta wartość jest wywoływana automatycznie przez okna dialogowe MFC/OLE i zwykle nie jest wywoływana bezpośrednio.

Ta funkcja wywołuje również [SetIconicMetafile](#seticonicmetafile) do buforowania metapliku do późniejszego użycia.

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a> COleClientItem:: GetInPlaceWindow

Wywołaj `GetInPlaceWindow` funkcję członkowską, aby uzyskać wskaźnik do okna, w którym element został otwarty do edycji w miejscu.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do okna edycji w miejscu elementu; Wartość NULL, jeśli element nie jest aktywny lub jeśli jego serwer jest niedostępny.

### <a name="remarks"></a>Uwagi

Ta funkcja powinna być wywoływana tylko dla elementów, które są aktywne.

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a> COleClientItem:: GetItemState

Wywołaj tę funkcję, aby pobrać bieżący stan elementu OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Wartość zwracana

`COleClientItem::ItemState`Wartość wyliczana, która może być jedną z następujących wartości: `emptyState` ,, `loadedState` , `openState` `activeState` , `activeUIState` . Aby uzyskać informacje o tych Stanach, zobacz [kontenery artykułów: Client-Item Stany](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Uwagi

Aby otrzymywać powiadomienia o zmianie stanu elementu OLE, należy użyć funkcji członkowskiej [OnChange](#onchange) .

Aby uzyskać więcej informacji, zobacz [kontenery artykułów: Client-Item Stany](../../mfc/containers-client-item-states.md).

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a> COleClientItem:: GetLastStatus

Zwraca kod stanu ostatniej operacji OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość SCODE.

### <a name="remarks"></a>Uwagi

Dla funkcji Członkowskich, które zwracają wartość logiczną FAŁSZ lub innych funkcji członkowskich zwracających wartość NULL, `GetLastStatus` zwraca bardziej szczegółowe informacje o niepowodzeniu. Należy pamiętać, że większość funkcji składowych OLE generuje wyjątki dla bardziej poważnych błędów. Określone informacje dotyczące interpretacji SCODE są zależne od źródłowego wywołania OLE, które ostatnio zwróciło wartość SCODE.

Aby uzyskać więcej informacji na temat SCODE, zobacz [struktury kodów błędów modelu COM](/windows/win32/com/structure-of-com-error-codes) w dokumentacji Windows SDK.

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a> COleClientItem:: GetLinkUpdateOptions

Wywołaj tę funkcję, aby uzyskać bieżącą wartość opcji link-Update dla elementu OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Wartość zwracana

Jedna z następujących wartości:

- Jeśli to możliwe, OLEUPDATE_ALWAYS aktualizować połączony element. Ta opcja obsługuje przycisk radiowy Połącz automatycznie z automatyczną aktualizacją w oknie dialogowym linki.

- OLEUPDATE_ONCALL zaktualizować połączonego elementu tylko w żądaniu z aplikacji kontenera (gdy wywoływana jest funkcja członkowska [UpdateLink](#updatelink) ). Ta opcja obsługuje ręczny przycisk radiowy link do aktualizacji w oknie dialogowym linki.

### <a name="remarks"></a>Uwagi

Jest to operacja zaawansowana.

Ta funkcja jest wywoływana automatycznie przez klasę [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Aby uzyskać więcej informacji, zobacz [IOleLink:: GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) w Windows SDK.

## <a name="coleclientitemgettype"></a><a name="gettype"></a> COleClientItem:: GetType

Wywołaj tę funkcję, aby określić, czy element OLE jest osadzony lub połączony, czy statyczny.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Wartość zwracana

Liczba całkowita bez znaku z jedną z następujących wartości:

- OT_LINK element OLE jest łączem.

- OT_EMBEDDED element OLE jest osadzony.

- OT_STATIC element OLE jest statyczny, czyli zawiera tylko dane prezentacji, nie dane natywne i dlatego nie można go edytować.

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a> COleClientItem:: GetUserType

Wywołaj tę funkcję, aby uzyskać ciąg widoczny dla użytkownika opisujący typ elementu OLE, taki jak "dokument programu Word".

```cpp
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parametry

*nUserClassType*<br/>
Wartość wskazująca żądany wariant ciągu opisującego typ elementu OLE. Może to być jedna z następujących wartości:

- USERCLASSTYPE_FULL pełna nazwa typu wyświetlana użytkownikowi.

- USERCLASSTYPE_SHORT krótką nazwę (maksymalnie 15 znaków) do użycia w menu podręcznym i oknie dialogowym Edytowanie linków.

- USERCLASSTYPE_APPNAME nazwę aplikacji obsługującej klasę.

*rString*<br/>
Odwołanie do obiektu [CString](../../atl-mfc-shared/reference/cstringt-class.md) , do którego ma zostać zwrócony ciąg opisujący typ elementu OLE.

### <a name="remarks"></a>Uwagi

Jest to często wpis w bazie danych rejestracji systemu.

Jeśli zażądano pełnej nazwy typu, ale nie jest ona dostępna, zamiast tego zostanie użyta krótka nazwa. Jeśli w bazie danych rejestracji nie zostanie znaleziony żaden wpis dla typu elementu OLE, lub jeśli dla typu elementu OLE nie zarejestrowano żadnych typów użytkownika, zostanie użyty typ użytkownika aktualnie przechowywany w elemencie OLE. Jeśli nazwa tego typu użytkownika jest ciągiem pustym, zostanie użyty komunikat "nieznany obiekt".

Aby uzyskać więcej informacji, zobacz [IOleObject:: GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) w Windows SDK.

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a> COleClientItem:: IsInPlaceActive

Wywołaj tę funkcję, aby sprawdzić, czy element OLE jest aktywny.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli element OLE jest aktywny. w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Często można wykonać inną logikę w zależności od tego, czy element jest edytowany w miejscu. Funkcja sprawdza, czy bieżący stan elementu jest równy parametrowi `activeState` lub `activeUIState` .

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a> COleClientItem:: IsLinkUpToDate

Wywołaj tę funkcję, aby sprawdzić, czy element OLE jest aktualny.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli element OLE jest aktualny; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Połączony element może być nieaktualny, jeśli jego dokument źródłowy został zaktualizowany. Element osadzony zawierający linki w nim może być w podobny sposób nieaktualny. Funkcja wykonuje cykliczne sprawdzanie elementu OLE. Należy zauważyć, że określenie, czy element OLE jest nieaktualny, może być tak kosztowny, jak rzeczywista aktualizacja.

Jest to wywoływane automatycznie przez implementację [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Aby uzyskać więcej informacji, zobacz [IOleObject:: IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) w Windows SDK.

## <a name="coleclientitemismodified"></a><a name="ismodified"></a> COleClientItem:: IsModified

Wywołaj tę funkcję, aby sprawdzić, czy element OLE jest zanieczyszczony (zmodyfikowany od czasu ostatniego zapisywania).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli element OLE jest zanieczyszczony; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [IPersistStorage:: IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) in the Windows SDK.

## <a name="coleclientitemisopen"></a><a name="isopen"></a> COleClientItem:: IsOpen

Wywołaj tę funkcję, aby sprawdzić, czy element OLE jest otwarty; to jest otwarty w wystąpieniu aplikacji serwerowej działającej w osobnym oknie.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli element OLE jest otwarty; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Służy do określania, kiedy należy narysować obiekt za pomocą wzorca wylęgu. Otwarty obiekt powinien mieć wzorzec kreskowania rysowany na górze obiektu. Aby to zrobić, możesz użyć obiektu [CRectTracker](../../mfc/reference/crecttracker-class.md) .

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a> COleClientItem:: IsRunning

Wywołaj tę funkcję, aby sprawdzić, czy element OLE jest uruchomiony; oznacza to, czy element jest ładowany i uruchomiony w aplikacji serwerowej.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli element OLE jest uruchomiony; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Aby uzyskać więcej informacji, zobacz [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) w Windows SDK.

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a> COleClientItem:: OnActivate

Wywoływane przez platformę, aby powiadomić element, który właśnie został aktywowany.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Uwagi

Należy zauważyć, że ta funkcja jest wywoływana, aby wskazać, że serwer jest uruchomiony, a nie wskazuje, że interfejs użytkownika został zainstalowany w aplikacji kontenera. W tym momencie obiekt nie ma aktywnego interfejsu użytkownika (nie jest `activeUIState` ). Nie zainstalowano jej menu ani paska narzędzi. Funkcja członkowska [OnActivateUI](#onactivateui) jest wywoływana, gdy wystąpi.

Domyślna implementacja wywołuje funkcję członkowską [Onchangi](#onchange) z OLE_CHANGEDSTATE jako parametr. Przesłoń tę funkcję, aby wykonać przetwarzanie niestandardowe, gdy element zostanie aktywny w miejscu.

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a> COleClientItem:: OnActivateUI

Struktura wywołuje się, `OnActivateUI` gdy obiekt został wprowadzony w stanie aktywny interfejs użytkownika.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Uwagi

Obiekt został teraz zainstalowany na pasku narzędzi i w menu.

Domyślna implementacja zapamiętuje Właściwość HWND serwera dla późniejszych `GetServerWindow` wywołań.

## <a name="coleclientitemonchange"></a><a name="onchange"></a> COleClientItem:: OnChange

Wywoływane przez platformę, gdy użytkownik modyfikuje, zapisze lub zamkuje element OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parametry

*nCode*<br/>
Przyczyna zmiany tego elementu przez serwer. Może mieć jedną z następujących wartości:

- OLE_CHANGED wygląd elementu OLE został zmieniony.

- OLE_SAVED element OLE został zapisany.

- OLE_CLOSED element OLE został zamknięty.

- OLE_CHANGED_STATE element OLE został zmieniony z jednego stanu na inny.

*dwParam*<br/>
Jeśli *nCode* jest OLE_SAVED lub OLE_CLOSED, ten parametr nie jest używany. Jeśli *nCode* jest OLE_CHANGED, ten parametr określa aspekt elementu OLE, który został zmieniony. Aby uzyskać możliwe wartości, zobacz parametr *dwParam* w [COleClientItem::D RAW](#draw). Jeśli *nCode* jest OLE_CHANGED_STATE, ten parametr jest `COleClientItem::ItemState` wartością wyliczaną i opisuje wprowadzony stan. Może mieć jedną z następujących wartości: `emptyState` ,,, `loadedState` `openState` `activeState` lub `activeUIState` .

### <a name="remarks"></a>Uwagi

(Jeśli aplikacja serwera jest zapisywana przy użyciu biblioteka MFC, ta funkcja jest wywoływana w odpowiedzi na `Notify` funkcje składowe `COleServerDoc` lub `COleServerItem` .) Domyślna implementacja oznacza dokument kontenera jako zmodyfikowany, jeśli *nCode* jest OLE_CHANGED lub OLE_SAVED.

W przypadku OLE_CHANGED_STATE bieżący stan zwrócony z [GetItemState](#getitemstate) będzie nadal stary, co oznacza stan bieżący przed zmianą stanu.

Przesłoń tę funkcję, aby odpowiedzieć na zmiany stanu elementu OLE. Zazwyczaj aktualizuje się wygląd elementu przez unieważnienie obszaru, w którym jest wyświetlany element. Wywołaj implementację klasy bazowej na początku przesłonięcia.

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a> COleClientItem:: OnChangeItemPosition

Wywoływane przez platformę w celu powiadomienia kontenera o zmianie zakresu elementu OLE podczas aktywacji w miejscu.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parametry

*rectPos*<br/>
Wskazuje położenie elementu względem obszaru klienckiego aplikacji kontenera.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli pozycja elementu została pomyślnie zmieniona; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja określa nowy widoczny prostokąt elementu OLE i wywołuje [SetItemRects](#setitemrects) z nowymi wartościami. Domyślna implementacja oblicza widoczny prostokąt dla elementu i przekazuje te informacje na serwer.

Przesłoń tę funkcję, aby zastosować reguły specjalne do operacji zmiany rozmiaru/przenoszenia. Jeśli aplikacja jest zapisywana w MFC, wyniki tego wywołania wynikają z faktu, że serwer o nazwie [COleServerDoc:: RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a> COleClientItem:: OnDeactivate

Wywoływane przez platformę, gdy element OLE przechodzi ze stanu aktywnego w miejscu ( `activeState` ) do stanu załadowanego, co oznacza, że jest dezaktywowany po aktywacji w miejscu.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Uwagi

Należy zauważyć, że ta funkcja jest wywoływana, aby wskazać, że element OLE jest zamknięty, a jego interfejs użytkownika został usunięty z aplikacji kontenera. W takim przypadku wywoływana jest funkcja członkowska [OnDeactivateUI](#ondeactivateui) .

Domyślna implementacja wywołuje funkcję członkowską [Onchangi](#onchange) z OLE_CHANGEDSTATE jako parametr. Przesłoń tę funkcję, aby przeprowadzić przetwarzanie niestandardowe w przypadku dezaktywowania aktywnego elementu. Na przykład jeśli w aplikacji kontenera jest obsługiwane polecenie Cofnij, można zastąpić tę funkcję, aby odrzucić stan cofnięcia, co oznacza, że ostatnią operację wykonywaną na elemencie OLE nie można cofnąć Po zdezaktywowaniu elementu.

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a> COleClientItem:: OnDeactivateAndUndo

Wywoływane przez platformę, gdy użytkownik wywołuje polecenie Cofnij po aktywowaniu elementu OLE na miejscu.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Uwagi

Domyślne wywołania implementacji [DeactivateUI](#deactivateui) do dezaktywowania interfejsu użytkownika serwera. Zastąp tę funkcję, jeśli implementujesz polecenie Cofnij w aplikacji kontenera. W zastąpieniu Wywołaj wersję klasy bazowej funkcji, a następnie Cofnij ostatnie polecenie wykonane w aplikacji.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::D eactivateandundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) w Windows SDK.

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a> COleClientItem:: OnDeactivateUI

Wywoływana, gdy użytkownik dezaktywuje element, który został aktywowany w miejscu.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parametry

*bUndoable*<br/>
Określa, czy zmiany edycyjne są cofane.

### <a name="remarks"></a>Uwagi

Ta funkcja przywraca interfejs użytkownika aplikacji kontenera do jego oryginalnego stanu, ukrywając wszystkie menu i inne kontrolki, które zostały utworzone dla aktywacji w miejscu.

Jeśli *bUndoable* ma wartość false, kontener powinien wyłączyć polecenie Cofnij, w efekcie odrzucając stan cofania kontenera, ponieważ wskazuje, że ostatnią operacją wykonywaną przez serwer nie można cofnąć.

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a> COleClientItem:: OnDiscardUndoState

Wywoływane przez platformę, gdy użytkownik wykonuje akcję, która odrzuca stan cofania podczas edycji elementu OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Uwagi

Domyślna implementacja nie robi nic. Zastąp tę funkcję, jeśli implementujesz polecenie Cofnij w aplikacji kontenera. W zastąpieniu Odrzuć stan wycofywania aplikacji kontenera.

Jeśli serwer został zapisany przy użyciu biblioteka MFC, serwer może spowodować wywołanie tej funkcji przez wywołanie [COleServerDoc::D iscardundostate](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite::D iscardundostate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) w Windows SDK.

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a> COleClientItem:: OnGetClipboardData

Wywoływane przez platformę, aby uzyskać `COleDataSource` obiekt zawierający wszystkie dane, które byłyby umieszczane w schowku przez wywołanie elementu członkowskiego [CopyToClipboard](#copytoclipboard) lub [DoDragDrop](#dodragdrop) .

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parametry

*bIncludeLink*<br/>
Ustaw tę wartość na TRUE, jeśli dane łącza mają zostać skopiowane do Schowka. Ustaw tę wartość na FALSE, jeśli aplikacja serwera nie obsługuje linków.

*lpOffset*<br/>
Wskaźnik na przesunięcie kursora myszy od początku obiektu w pikselach.

*lpSize*<br/>
Wskaźnik na rozmiar obiektu w pikselach.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do obiektu [by uzyskać COleDataSource](../../mfc/reference/coledatasource-class.md) zawierającego dane ze schowka.

### <a name="remarks"></a>Uwagi

Domyślna implementacja tej funkcji wywołuje [GetClipboardData](#getclipboarddata).

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a> COleClientItem:: OnGetClipRect

Struktura wywołuje `OnGetClipRect` funkcję członkowską, aby uzyskać współrzędne tego elementu, który jest edytowany w miejscu.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parametry

*rClipRect*<br/>
Wskaźnik do obiektu klasy [CRect](../../atl-mfc-shared/reference/crect-class.md) , który będzie zawierać współrzędne prostokąta wycinka elementu.

### <a name="remarks"></a>Uwagi

Współrzędne są w pikselach względem obszaru klienckiego okna aplikacji kontenera.

Domyślna implementacja po prostu zwraca prostokąt klienta widoku, w którym element jest aktywny.

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a> COleClientItem:: OnGetItemPosition

Struktura wywołuje `OnGetItemPosition` funkcję członkowską, aby uzyskać współrzędne elementu, który jest edytowany w miejscu.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parametry

*Elemencie rPosition*<br/>
Odwołanie do obiektu [CRect](../../atl-mfc-shared/reference/crect-class.md) , który będzie zawierać Współrzędne położenia elementu.

### <a name="remarks"></a>Uwagi

Współrzędne są w pikselach względem obszaru klienckiego okna aplikacji kontenera.

Domyślna implementacja tej funkcji nic nie robi. Aplikacje obsługujące edycję w miejscu wymagają implementacji.

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a> COleClientItem:: OnGetWindowContext

Wywoływane przez platformę, gdy element jest aktywowany.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parametry

*ppMainFrame*<br/>
Wskaźnik na wskaźnik do okna głównego ramki.

*ppDocFrame*<br/>
Wskaźnik na wskaźnik do okna ramki dokumentu.

*lpFrameInfo*<br/>
Wskaźnik do struktury [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) , która będzie odbierać informacje o oknie ramek.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja służy do pobierania informacji o oknie nadrzędnym elementu OLE.

Jeśli kontener jest aplikacją MDI, domyślna implementacja zwraca wskaźnik do obiektu [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) w *ppMainFrame* i wskaźnik do aktywnego obiektu [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) w *ppDocFrame*. Jeśli kontener jest aplikacją SDI, domyślna implementacja zwraca wskaźnik do obiektu [obiektu CFrameWnd](../../mfc/reference/cframewnd-class.md) w *ppMainFrame* i zwraca wartość null w *ppDocFrame*. Domyślna implementacja również wypełnia elementy członkowskie *lpFrameInfo*.

Przesłoń tę funkcję tylko wtedy, gdy domyślna implementacja nie odpowiada aplikacji; na przykład jeśli aplikacja ma model interfejsu użytkownika, który różni się od SDI lub MDI. Jest to zaawansowany możliwy do zaawansowania.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite:: GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) i strukturę [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) w Windows SDK.

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a> COleClientItem:: OnInsertMenus

Wywoływane przez platformę w trakcie aktywacji w miejscu, aby wstawić menu aplikacji kontenera do pustego menu.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Wskazuje na puste menu.

*lpMenuWidths*<br/>
Wskazuje tablicę zawierającą sześć długich wartości wskazujących, ile menu znajduje się w każdej z następujących grup menu: plik, Edycja, kontener, obiekt, okno, pomoc. Aplikacja kontenera jest odpowiedzialna za grupy menu plik, kontener i okno, odpowiadające elementom 0, 2 i 4 tej tablicy.

### <a name="remarks"></a>Uwagi

To menu jest następnie przesyłane do serwera, który wstawia własne menu, tworząc menu złożone. Tę funkcję można wywołać wielokrotnie, aby skompilować kilka menu złożonych.

Domyślna implementacja wstawia do *pMenuShared* menu kontenerów w miejscu; oznacza to, że grupy menu plik, kontener i okno. [CDocTemplate:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) służy do ustawiania tego zasobu menu. Domyślna implementacja również przypisuje odpowiednie wartości do elementów 0, 2 i 4 w *lpMenuWidths*, w zależności od zasobów menu. Przesłoń tę funkcję, jeśli domyślna implementacja nie jest odpowiednia dla danej aplikacji; na przykład jeśli aplikacja nie korzysta z szablonów dokumentów do kojarzenia zasobów z typami dokumentów. Jeśli zastąpisz tę funkcję, należy również przesłonić [OnSetMenu](#onsetmenu) i [OnRemoveMenus](#onremovemenus). Jest to zaawansowany możliwy do zaawansowania.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceFrame:: InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) w Windows SDK.

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a> COleClientItem:: OnRemoveMenus

Wywoływane przez platformę, aby usunąć menu kontenera z określonego menu złożonego po zakończeniu aktywacji w miejscu.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Wskazuje menu złożone zbudowane przez wywołania funkcji składowej [OnInsertMenus](#oninsertmenus) .

### <a name="remarks"></a>Uwagi

Domyślna implementacja eliminuje z *pMenuShared* menu kontenerów w miejscu, czyli grup menu plików, kontenerów i okien. Przesłoń tę funkcję, jeśli domyślna implementacja nie jest odpowiednia dla danej aplikacji; na przykład jeśli aplikacja nie korzysta z szablonów dokumentów do kojarzenia zasobów z typami dokumentów. Jeśli zastąpisz tę funkcję, prawdopodobnie należy również przesłonić [OnInsertMenus](#oninsertmenus) i [OnSetMenu](#onsetmenu) . Jest to zaawansowany możliwy do zaawansowania.

Podmenu w *pMenuShared* może być współużytkowane przez więcej niż jedno menu złożone, jeśli serwer jest wielokrotnie wywoływany `OnInsertMenus` . W związku z tym nie należy usuwać żadnych podmenu w przesłonięciu `OnRemoveMenus` ; należy je odłączyć.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceFrame:: RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) w Windows SDK.

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a> COleClientItem:: OnScrollBy

Wywoływane przez platformę, aby przewinąć element OLE w odpowiedzi na żądania z serwera.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parametry

*sizeExtent*<br/>
Określa odległość (w pikselach) przewijania w kierunkach x i y.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli element został przewinięty; 0, jeśli nie można przewinąć elementu.

### <a name="remarks"></a>Uwagi

Na przykład jeśli element OLE jest częściowo widoczny i użytkownik przemieszcza się poza widocznym regionem podczas przeprowadzania edycji w miejscu, ta funkcja jest wywoływana, aby zachować widoczność kursora. Domyślna implementacja nie robi nic. Przesłoń tę funkcję, aby przewijać element o określoną liczbę. Należy zauważyć, że w wyniku przewijania widoczna część elementu OLE może się zmienić. Wywołaj [SetItemRects](#setitemrects) , aby zaktualizować widoczny prostokąt elementu.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceSite:: Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) in the Windows SDK.

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a> COleClientItem:: OnSetMenu

Wywoływane przez platformę dwa razy, gdy aktywacja w miejscu rozpocznie się i skończy; pierwszy raz, aby zainstalować menu złożone i drugi raz (z *holemenu* równym null), aby go usunąć.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parametry

*pMenuShared*<br/>
Wskaźnik do menu złożonego zbudowane przez wywołania funkcji składowej [OnInsertMenus](#oninsertmenus) i `InsertMenu` funkcji.

*holemenu*<br/>
Dojście do deskryptora menu zwróconego przez `OleCreateMenuDescriptor` funkcję lub wartość null, jeśli wysłanie kodu ma zostać usunięte.

*hwndActiveObject*<br/>
Dojście do okna edycji elementu OLE. To jest okno, które będzie odbierać polecenia edycji z OLE.

### <a name="remarks"></a>Uwagi

Domyślna implementacja instaluje lub usuwa menu złożone, a następnie wywołuje funkcję [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) , aby zainstalować lub usunąć kod wysyłania. Zastąp tę funkcję, jeśli domyślna implementacja nie jest odpowiednia dla Twojej aplikacji. Jeśli zastąpisz tę funkcję, prawdopodobnie należy również przesłonić [OnInsertMenus](#oninsertmenus) i [OnRemoveMenus](#onremovemenus) . Jest to zaawansowany możliwy do zaawansowania.

Aby uzyskać więcej informacji, zobacz [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)i [IOleInPlaceFrame:: SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) w Windows SDK.

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a> COleClientItem:: OnShowControlBars

Wywoływane przez platformę, aby pokazać i ukryć paski sterowania aplikacji kontenera.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parametry

*pFrameWnd*<br/>
Wskaźnik do okna ramki aplikacji kontenera. Może to być okno główne ramki lub podrzędne okno MDI.

*bShow*<br/>
Określa, czy paski kontroli mają być wyświetlane czy ukryte.

### <a name="return-value"></a>Wartość zwracana

Różne od zera, jeśli wywołanie funkcji powoduje zmianę stanu pasków sterowania; 0, jeśli wywołanie nie powoduje zmiany lub jeśli *pFrameWnd* nie wskazuje okna ramki kontenera.

### <a name="remarks"></a>Uwagi

Ta funkcja zwraca wartość 0, jeśli paski sterowania znajdują się już w stanie określonym przez *bShow.* Taka sytuacja może wystąpić, jeśli na przykład paski sterowania są ukryte i *bShow* ma wartość false.

Implementacja domyślna usuwa pasek narzędzi z okna ramki najwyższego poziomu.

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a> COleClientItem:: OnShowItem

Wywoływane przez platformę, by wyświetlić element OLE, dzięki czemu jest on całkowicie widoczny podczas edytowania.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Uwagi

Jest on używany, gdy aplikacja kontenera obsługuje linki do elementów osadzonych (to oznacza, że Klasa dokumentu pochodzi z [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Ta funkcja jest wywoływana podczas aktywacji w miejscu lub gdy element OLE jest źródłem linku, a użytkownik chce go edytować. Domyślna implementacja aktywuje pierwszy widok w dokumencie kontenera. Przesłoń tę funkcję, aby przewijać dokument w taki sposób, aby element OLE był widoczny.

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a> COleClientItem:: OnUpdateFrameTitle

Wywoływane przez platformę podczas aktywacji w miejscu, aby zaktualizować pasek tytułu okna ramki.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli ta funkcja pomyślnie zaktualizowała tytuł ramki, w przeciwnym razie zero.

### <a name="remarks"></a>Uwagi

Domyślna implementacja nie zmienia tytułu okna ramki. Zastąp tę funkcję, jeśli chcesz użyć innego tytułu ramki dla aplikacji, na przykład " *element aplikacji serwera*  -   w *docName*" (w "Microsoft Excel-arkusz kalkulacyjny in REPORT.DOC"). Jest to zaawansowany możliwy do zaawansowania.

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a> COleClientItem:: ReactivateAndUndo

Wywołaj tę funkcję, aby ponownie uaktywnić element OLE i cofnąć ostatnią operację wykonywaną przez użytkownika podczas edycji w miejscu.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja kontenera obsługuje polecenie Cofnij, Wywołaj tę funkcję, jeśli użytkownik wybierze polecenie Cofnij natychmiast po zdezaktywowaniu elementu OLE.

Jeśli aplikacja serwera jest zapisywana w bibliotekach klas Microsoft Foundation, ta funkcja sprawia, że serwer wywoła [COleServerDoc:: OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject:: ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) w Windows SDK.

## <a name="coleclientitemrelease"></a><a name="release"></a> COleClientItem:: Release

Wywołaj tę funkcję, aby wyczyścić zasoby używane przez element OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parametry

*dwCloseOption*<br/>
Flaga określająca, w jaki sposób element OLE jest zapisywany po powrocie do stanu załadowanego. Aby uzyskać listę możliwych wartości, zobacz [COleClientItem:: Close](#close).

### <a name="remarks"></a>Uwagi

`Release` jest wywoływany przez `COleClientItem` destruktor.

Aby uzyskać więcej informacji, zobacz [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) w Windows SDK.

## <a name="coleclientitemreload"></a><a name="reload"></a> COleClientItem:: reload

Zamyka i ponownie ładuje element.

```
BOOL Reload();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Wywołaj `Reload` funkcję po aktywowaniu elementu jako elementu innego typu przez wywołanie do [ActivateAs](#activateas).

## <a name="coleclientitemrun"></a><a name="run"></a> COleClientItem:: Run

Uruchamia aplikację skojarzoną z tym elementem.

```cpp
void Run();
```

### <a name="remarks"></a>Uwagi

`Run`Przed aktywowaniem elementu wywołaj funkcję członkowską w celu uruchomienia aplikacji serwera. Jest to wykonywane automatycznie przez [aktywację](#activate) i [DoVerb](#doverb), więc zwykle nie jest to konieczne do wywołania tej funkcji. Wywołaj tę funkcję, jeśli konieczne jest uruchomienie serwera w celu ustawienia atrybutu elementu, takiego jak [setstop](#setextent), przed wykonaniem [DoVerb](#doverb).

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a> COleClientItem:: SetDrawAspect

Wywołaj `SetDrawAspect` funkcję członkowską, aby ustawić "aspekt" lub widok elementu.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parametry

*nDrawAspect*<br/>
Wartość z wyliczenia DVASPECT. Ten parametr może mieć jedną z następujących wartości:

- Element DVASPECT_CONTENT jest reprezentowany w taki sposób, że może być wyświetlany jako osadzony obiekt wewnątrz jego kontenera.

- Element DVASPECT_THUMBNAIL jest renderowany w reprezentacji "miniatury", dzięki czemu będzie można go wyświetlić w narzędziu do przeglądania.

- Element DVASPECT_ICON jest reprezentowany przez ikonę.

- Element DVASPECT_DOCPRINT jest reprezentowany tak, jakby był wydrukowany przy użyciu polecenia Drukuj z menu plik.

### <a name="remarks"></a>Uwagi

Aspekt określa sposób, w jaki element ma być renderowany przez [rysowanie](#draw) , gdy zostanie użyta wartość domyślna dla argumentu *nDrawAspect* tej funkcji.

Ta funkcja jest wywoływana automatycznie przez ikonę zmiany (i inne okna dialogowe, które wywołują okno dialogowe zmiany ikony, bezpośrednio), aby umożliwić wyświetlenie ikony na żądanie użytkownika.

## <a name="coleclientitemsetextent"></a><a name="setextent"></a> COleClientItem:: setzakres

Wywołaj tę funkcję, aby określić ilość dostępnego miejsca dla elementu OLE.

```cpp
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parametry

*zmienia*<br/>
Obiekt [CSize](../../atl-mfc-shared/reference/csize-class.md) , który zawiera informacje o rozmiarze.

*nDrawAspect*<br/>
Określa aspekt elementu OLE, którego granice mają być ustawione. Aby uzyskać możliwe wartości, zobacz [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Uwagi

Jeśli aplikacja serwera została zapisywana przy użyciu biblioteka MFC, spowoduje to wywołanie funkcji elementu członkowskiego [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) odpowiedniego `COleServerItem` obiektu. Element OLE może następnie odpowiednio dostosować jego wyświetlanie. Wymiary muszą znajdować się w jednostkach MM_HIMETRIC. Wywołaj tę funkcję, gdy użytkownik zmienia rozmiar elementu OLE lub obsługuje pewną formę negocjacji układu.

Aby uzyskać więcej informacji, zobacz [IOleObject:: setstop](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) w Windows SDK.

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a> COleClientItem:: SetHostNames

Wywołaj tę funkcję, aby określić nazwę aplikacji kontenera i nazwę kontenera dla osadzonego elementu OLE.

```cpp
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parametry

*lpszHost*<br/>
Wskaźnik do nazwy widocznej dla użytkownika aplikacji kontenera.

*lpszHostObj*<br/>
Wskaźnik na identyfikujący ciąg kontenera, który zawiera element OLE.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja serwera została zapisywana przy użyciu biblioteka MFC, ta funkcja wywołuje funkcję członkowską [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) `COleServerDoc` dokumentu zawierającego element OLE. Te informacje są używane w tytułach okien podczas edytowania elementu OLE. Za każdym razem, gdy ładowany jest dokument kontenera, struktura wywołuje tę funkcję dla wszystkich elementów OLE w dokumencie. `SetHostNames` ma zastosowanie tylko do elementów osadzonych. Nie jest konieczne Wywołaj tę funkcję za każdym razem, gdy osadzony element OLE jest aktywowany do edycji.

Ta opcja jest również wywoływana automatycznie z nazwą aplikacji i nazwą dokumentu podczas ładowania obiektu lub gdy plik zostanie zapisany pod inną nazwą. W związku z tym nie jest zwykle konieczne bezpośrednie wywołanie tej funkcji.

Aby uzyskać więcej informacji, zobacz [IOleObject:: SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) w Windows SDK.

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a> COleClientItem:: SetIconicMetafile

Buforuje metaplik używany do rysowania ikony elementu.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parametry

*hMetaPict*<br/>
Uchwyt do metapliku używanego do rysowania ikony elementu.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Użyj [GetIconicMetafile](#geticonicmetafile) , aby pobrać metaplik.

Parametr *hMetaPict* jest kopiowany do elementu; w związku z tym *hMetaPict* musi zostać zwolniony przez wywołującego.

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a> COleClientItem:: SetItemRects

Wywołaj tę funkcję, aby ustawić prostokąt ograniczenia lub widoczny prostokąt elementu OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametry

*lprcPosRect*<br/>
Wskaźnik do prostokąta zawierającego granice elementu OLE względem jego okna nadrzędnego, we współrzędnych klienta.

*lprcClipRect*<br/>
Wskaźnik do prostokąta zawierającego granice widocznej części elementu OLE względem jego okna nadrzędnego, we współrzędnych klienta.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli pomyślne; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja jest wywoływana przez domyślną implementację funkcji składowej [OnChangeItemPosition](#onchangeitemposition) . Należy wywołać tę funkcję przy każdej zmianie położenia lub widocznej części elementu OLE. Zazwyczaj oznacza to, że wywołujesz go z funkcji elementów członkowskich [OnSize](../../mfc/reference/cwnd-class.md#onsize) i [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) widoku.

Aby uzyskać więcej informacji, zobacz [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) w Windows SDK.

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a> COleClientItem:: SetLinkUpdateOptions

Wywołaj tę funkcję, aby ustawić opcję link-Update dla prezentacji określonego połączonego elementu.

```cpp
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parametry

*dwUpdateOpt*<br/>
Wartość opcji link-Update dla tego elementu. Ta wartość musi być jedną z następujących wartości:

- Jeśli to możliwe, OLEUPDATE_ALWAYS aktualizować połączony element. Ta opcja obsługuje przycisk radiowy Połącz automatycznie z automatyczną aktualizacją w oknie dialogowym linki.

- OLEUPDATE_ONCALL zaktualizować połączonego elementu tylko w żądaniu z aplikacji kontenera (gdy wywoływana jest funkcja członkowska [UpdateLink](#updatelink) ). Ta opcja obsługuje ręczny przycisk radiowy link do aktualizacji w oknie dialogowym linki.

### <a name="remarks"></a>Uwagi

Zazwyczaj nie należy zmieniać opcji aktualizacji wybranych przez użytkownika w oknie dialogowym linki.

Aby uzyskać więcej informacji, zobacz [IOleLink:: SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) w Windows SDK.

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a> COleClientItem:: SetPrintDevice

Wywołaj tę funkcję, aby zmienić urządzenie drukowania dla tego elementu.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parametry

*ptd*<br/>
Wskaźnik do struktury danych [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , która zawiera informacje o nowym urządzeniu drukowania. Może mieć wartość NULL.

*PPD*<br/>
Wskaźnik do struktury danych [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) , która zawiera informacje o nowym urządzeniu drukowania. Może mieć wartość NULL.

### <a name="return-value"></a>Wartość zwracana

Niezerowe, jeśli funkcja zakończyła się pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja aktualizuje urządzenie drukowania dla elementu, ale nie odświeża pamięci podręcznej prezentacji. Aby zaktualizować pamięć podręczną prezentacji dla elementu, wywołaj [UpdateLink](#updatelink).

Argumenty tej funkcji zawierają informacje używane przez system OLE do identyfikowania urządzenia docelowego. `PRINTDLG`Struktura zawiera informacje używane przez system Windows do zainicjowania wspólnego okna dialogowego drukowania. Gdy użytkownik zamknie okno dialogowe, system Windows zwróci informacje o wyborach użytkownika w tej strukturze. `m_pd`Element członkowski obiektu [CPrintDialog](../../mfc/reference/cprintdialog-class.md) jest `PRINTDLG` strukturą.

Aby uzyskać więcej informacji na temat tej struktury, zobacz [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) w Windows SDK.

Aby uzyskać więcej informacji, zobacz [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) w Windows SDK.

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a> COleClientItem:: UpdateLink

Wywołaj tę funkcję, aby natychmiastowo zaktualizować dane prezentacji elementu OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Wartość zwracana

Niezerowe po powodzeniu; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

W przypadku połączonych elementów funkcja znajduje źródło linku, aby uzyskać nową prezentację dla elementu OLE. Ten proces może wymagać uruchomienia co najmniej jednej aplikacji serwera, co może być czasochłonne. Dla elementów osadzonych funkcja działa cyklicznie, sprawdzając, czy element osadzony zawiera linki, które mogą być nieaktualne i aktualizować. Użytkownik może również ręcznie zaktualizować poszczególne linki przy użyciu okna dialogowego linki.

Aby uzyskać więcej informacji, zobacz [IOleLink:: Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) w Windows SDK.

## <a name="see-also"></a>Zobacz też

[Przykład MFCBIND MFC](../../overview/visual-cpp-samples.md)<br/>
[Przykład OCLIENT MFC](../../overview/visual-cpp-samples.md)<br/>
[Klasa CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Wykres hierarchii](../../mfc/hierarchy-chart.md)<br/>
[Klasa COleServerItem](../../mfc/reference/coleserveritem-class.md)
