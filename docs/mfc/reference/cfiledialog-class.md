---
title: Klasa CFileDialog
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: c301766b64af7fc1523b39adad91d9b52a5e88f7
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/15/2019
ms.locfileid: "69506592"
---
# <a name="cfiledialog-class"></a>Klasa CFileDialog

Hermetyzuje wspólne okno dialogowe używane do operacji otwierania plików lub zapisywania plików.

## <a name="syntax"></a>Składnia

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Elementy członkowskie

### <a name="public-constructors"></a>Konstruktory publiczne

|Nazwa|Opis|
|----------|-----------------|
|[CFileDialog:: CFileDialog](#cfiledialog)|Konstruuje `CFileDialog` obiekt.|

### <a name="public-methods"></a>Metody publiczne

|Nazwa|Opis|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Dodaje przycisk wyboru do okna dialogowego.|
|[CFileDialog::AddComboBox](#addcombobox)|Dodaje pole kombi do okna dialogowego.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Dodaje element do kontrolki kontenera w oknie dialogowym.|
|[CFileDialog::AddEditBox](#addeditbox)|Dodaje pole edycji do okna dialogowego.|
|[CFileDialog:: Add— menu](#addmenu)|Dodaje menu do okna dialogowego.|
|[CFileDialog::AddPlace](#addplace)|Przeciążone. Dodaje folder do listy miejsc dostępnych dla użytkownika w celu otwierania lub zapisywania elementów.|
|[CFileDialog:: addprzycisk](#addpushbutton)|Dodaje przycisk do okna dialogowego.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Dodaje do okna dialogowego przycisk opcji (znany również jako przycisk radiowy).|
|[CFileDialog::AddSeparator](#addseparator)|Dodaje separator do okna dialogowego.|
|[CFileDialog::AddText](#addtext)|Dodaje zawartość tekstową do okna dialogowego.|
|[CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog)|Aktualizuje stan `CFileDialog` w celu dopasowania parametrów i flag przechowywanych `m_ofn` w zmiennej składowej.|
|[CFileDialog::D oModal](#domodal)|Wyświetla okno dialogowe i umożliwia użytkownikowi wybranie.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Włącza listę rozwijaną na przycisku **Otwórz** lub **Zapisz** w oknie dialogowym.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Wyłącza dodawanie elementów do grupy wizualizacji w oknie dialogowym.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Pobiera bieżący stan przycisku wyboru (pole wyboru) w oknie dialogowym.|
|[CFileDialog:: GetControlItemState](#getcontrolitemstate)|Pobiera bieżący stan elementu w formancie kontenera znalezionym w oknie dialogowym.|
|[CFileDialog:: GetControlState](#getcontrolstate)|Pobiera bieżące widoczność i włączone Stany danej kontrolki.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Pobiera bieżący tekst w kontrolce pola edycji.|
|[CFileDialog:: GetFileExt](#getfileext)|Zwraca rozszerzenie wybranego pliku.|
|[CFileDialog::GetFileName](#getfilename)|Zwraca nazwę wybranego pliku.|
|[CFileDialog:: GetFileTitle](#getfiletitle)|Zwraca tytuł wybranego pliku.|
|[CFileDialog:: GetFolderPath](#getfolderpath)|Pobiera ścieżkę do aktualnie otwartego folderu lub katalogu dla okna dialogowego **Otwórz** lub **Zapisz jako** wspólne w stylu Eksploratora.|
|[CFileDialog:: GetIFileDialogCustomize](#getifiledialogcustomize)|Pobiera wewnętrzny obiekt com dla niestandardowego `CFileDialog` obiektu.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Pobiera wewnętrzny obiekt com dla elementu `CFileDialog` , który jest używany jako okno dialogowe **Otwórz** plik.|
|[CFileDialog:: GetIFileSaveDialog](#getifilesavedialog)|Pobiera wewnętrzny obiekt com dla elementu `CFileDialog` , który jest używany jako okno dialogowe **Zapisz** plik.|
|[CFileDialog:: GetNextPathName](#getnextpathname)|Zwraca pełną ścieżkę następnego wybranego pliku.|
|[CFileDialog::GetOFN](#getofn)|`OPENFILENAME` Pobiera strukturę`CFileDialog` obiektu.|
|[CFileDialog:: getPathname](#getpathname)|Zwraca pełną ścieżkę wybranego pliku.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Zwraca stan tylko do odczytu dla wybranego pliku.|
|[CFileDialog:: GetResult](#getresult)|Pobiera wybór utworzony przez użytkownika w oknie dialogowym.|
|[CFileDialog:: GetResults](#getresults)|Pobiera opcje użytkownika w oknie dialogowym umożliwiającym wybór wielokrotny.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Pobiera określony element z określonych kontrolek kontenera w oknie dialogowym.|
|[CFileDialog:: GetStartPosition](#getstartposition)|Zwraca pozycję pierwszego elementu listy nazw plików.|
|[CFileDialog:: HideControl](#hidecontrol)|Ukrywa określony formant w oknie dialogowym **Otwórz** lub **Zapisz jako** wspólne w stylu Eksploratora.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Określa, czy bieżące okno dialogowe w trybie selektora folderów.|
|[CFileDialog:: MakeProminent](#makeprominent)|Umieszcza kontrolkę w oknie dialogowym, aby dowiedzieć się, w porównaniu do innych dodanych kontrolek.|
|[CFileDialog:: RemoveControlItem](#removecontrolitem)|Usuwa element z kontrolki kontenera w oknie dialogowym.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Ustawia bieżący stan przycisku wyboru (pole wyboru) w oknie dialogowym.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Ustawia bieżący stan elementu w formancie kontenera znalezionym w oknie dialogowym.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Ustawia tekst elementu kontrolki. Na przykład tekst, który towarzyszy przycisk radiowy lub element w menu.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Ustawia tekst skojarzony z kontrolką, taki jak tekst przycisku lub Etykieta pola edycji.|
|[CFileDialog::SetControlState](#setcontrolstate)|Ustawia bieżące widoczność i włączone Stany danej kontrolki.|
|[CFileDialog::SetControlText](#setcontroltext)|Ustawia tekst dla określonej kontrolki w oknie dialogowym **Otwórz** lub **Zapisz jako** wspólne w stylu Eksploratora.|
|[CFileDialog::SetDefExt](#setdefext)|Ustawia domyślne rozszerzenie nazwy pliku dla okna dialogowego **Otwórz** lub **Zapisz jako** wspólne.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Ustawia bieżący tekst w kontrolce pola edycji.|
|[CFileDialog::SetProperties](#setproperties)|Udostępnia magazyn właściwości, który definiuje wartości domyślne, które mają być używane dla zapisywanego elementu.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Ustawia wybrany stan określonego elementu w grupie przycisków opcji lub polu kombi znalezionym w oknie dialogowym.|
|[CFileDialog::SetTemplate](#settemplate)|Ustawia szablon okna dialogowego dla `CFileDialog` obiektu.|
|[CFileDialog:: StartVisualGroup](#startvisualgroup)|Deklaruje grupę wizualizacji w oknie dialogowym. Kolejne wywołania metody "Add" powodują dodanie tych elementów do tej grupy.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Aktualizuje dane przechowywane w `m_ofn` zmiennej składowej w celu dopasowania ich do bieżącego stanu okna dialogowego plik.|

### <a name="protected-methods"></a>Metody chronione

|Nazwa|Opis|
|----------|-----------------|
|[CFileDialog:: OnButtonClicked](#onbuttonclicked)|Wywoływana, gdy przycisk zostanie kliknięty.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Wywołuje się, gdy pole wyboru jest zaznaczone/niezaznaczone.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Wywoływana, gdy formant jest aktywny.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Obsługuje komunikat CDN_SELCHANGE WM_NOTIFY.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Sprawdza poprawność nazwy pliku wprowadzonej w oknie dialogowym.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Obsługuje komunikat CDN_FOLDERCHANGE WM_NOTIFY.|
|[CFileDialog::OnInitDone](#oninitdone)|Obsługuje komunikat CDN_INITDONE WM_NOTIFY.|
|[CFileDialog::OnItemSelected](#onitemselected)|Wywoływana, gdy element kontenera jest wybierany.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Umożliwia wykonywanie akcji niestandardowych po zmianie zaznaczenia pliku.|
|[CFileDialog:: OnShareViolation](#onshareviolation)|Obsługuje naruszenia udziałów.|
|[CFileDialog::OnTypeChange](#ontypechange)|Obsługuje komunikat CDN_TYPECHANGE WM_NOTIFY.|

### <a name="public-data-members"></a>Publiczne elementy członkowskie danych

|Nazwa|Opis|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|Struktura systemu `OPENFILENAME` Windows. Zapewnia dostęp do podstawowych parametrów okna dialogowego pliku.|

## <a name="remarks"></a>Uwagi

Wspólne okna dialogowe plików umożliwiają implementowanie okien dialogowych wyboru plików, na przykład **otwieranie plików** i **Zapisywanie jako**, w sposób zgodny ze standardami systemu Windows.

Możesz użyć `CFileDialog` jako z dostarczonego konstruktora lub można utworzyć własną klasę okna dialogowego z `CFileDialog` i napisać konstruktora zgodnie z potrzebami. W obu przypadkach te okna dialogowe będą zachowywać się jak standardowe okna dialogowe MFC, ponieważ pochodzą one z [klasy CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog`opiera się na COMMDLG. Plik DLL, który jest zawarty w systemie Windows.

Zarówno wygląd, jak i funkcjonalność `CFileDialog` systemu Windows Vista lub nowszego, różnią się od wcześniejszych wersji systemu Windows. Domyślnie `CFileDialog` automatycznie używa nowego stylu systemu Windows Vista lub nowszego bez zmiany kodu, jeśli program jest kompilowany i uruchamiany w systemie Windows Vista lub nowszym. Użyj parametru *bVistaStyle* w konstruktorze, aby ręcznie przesłonić tę automatyczną aktualizację. Wyjątek automatycznej aktualizacji to dostosowane okna dialogowe. Nie zostaną one przekonwertowane na nowy styl. Aby uzyskać więcej informacji na temat konstruktora, zobacz [CFileDialog:: CFileDialog](#cfiledialog).

> [!NOTE]
>  System identyfikatora sterowania różni się w systemie Windows Vista lub nowszym z wcześniejszych wersji systemu Windows podczas korzystania z `CFileDialog`programu. Przed przystąpieniem do przenoszenia `CFileDialog` projektu ze starszej wersji systemu Windows należy zaktualizować wszystkie odwołania do formantów w kodzie.

Niektóre `CFileDialog` metody nie są obsługiwane w systemie Windows Vista lub nowszym. Zapoznaj się z tematem poszczególne metody, aby uzyskać informacje o tym, czy metoda jest obsługiwana. Ponadto następujące dziedziczone funkcje nie są obsługiwane w systemie Windows Vista lub nowszym:

- [CDialog:: OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog:: OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Komunikaty systemu Windows dotyczące `CFileDialog` klasy różnią się w zależności od używanego systemu operacyjnego. Na przykład system Windows XP nie obsługuje [CDialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel) i [CDialog:: OnOK —](../../mfc/reference/cdialog-class.md#onok) dla `CFileDialog` klasy. Jednak systemy operacyjne Windows Vista i nowsze obsługują je. Aby uzyskać więcej informacji na temat różnych generowanych komunikatów i kolejności ich otrzymywania, zobacz [przykład CFileDialog: Rejestrowanie kolejności](../../overview/visual-cpp-samples.md)zdarzeń.

Aby użyć `CFileDialog` obiektu, należy najpierw utworzyć obiekt przy `CFileDialog` użyciu konstruktora. Po skonstruowaniu okna dialogowego można ustawić lub zmodyfikować wszystkie wartości w strukturze [CFileDialog:: m_ofn](#m_ofn) , aby zainicjować wartości lub Stany kontrolek okna dialogowego. Struktura jest typu `OPENFILENAME`. `m_ofn` Aby uzyskać więcej informacji, zapoznaj się ze strukturą [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) w Windows SDK.

Po zainicjowaniu kontrolek okna dialogowego Wywołaj metodę [CFileDialog::D omodal](#domodal) , aby wyświetlić okno dialogowe, w którym użytkownik może wpisać ścieżkę i nazwę pliku. `DoModal`Zwraca czy użytkownik kliknął przycisk OK (IDOK), czy przycisku Anuluj (IDCANCEL). Jeśli `DoModal` zwraca IDOK, można użyć jednej `CFileDialog` z publicznych funkcji Członkowskich do pobrania informacji umieszczanych przez użytkownika.

> [!NOTE]
> W systemie Windows Vista lub nowszym wielokrotne wywołania [IFileDialog::](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) setfiles powodują wystąpienie błędu. Drugie wywołanie `SetFileTypes` dla dowolnego wystąpienia a zwróci wartość `CFileDialog` E_UNEXPECTED w systemie Windows Vista lub nowszym. Niektóre `CFileDialog` funkcje metody wywołania `SetFileTypes`. Na przykład dwa wywołania `CFileDialog::DoModal` dla tego samego wystąpienia `CFileDialog` generowanego [potwierdzenia](diagnostic-services.md#assert).

`CFileDialog`zawiera kilka chronionych elementów członkowskich, które umożliwiają niestandardową obsługę naruszeń udziałów, walidację nazw plików i powiadomienia o zmianie w polu listy. Te chronione elementy członkowskie są funkcjami wywołania zwrotnego, których nie trzeba używać w przypadku większości aplikacji, ponieważ domyślna obsługa jest wykonywana automatycznie. Wpisy mapy komunikatów dla tych funkcji nie są wymagane, ponieważ są to standardowe funkcje wirtualne.

Można użyć funkcji [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) systemu Windows, aby określić, czy wystąpił błąd podczas inicjowania okna dialogowego i dowiedzieć się więcej o błędzie.

Niszczenie `CFileDialog` obiektów jest obsługiwane automatycznie. Nie ma potrzeby wywoływania [CDialog:: zdarzenie EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Aby pozwolić użytkownikowi na wybranie wielu plików, Ustaw flagę OFN_ALLOWMULTISELECT przed wywołaniem `DoModal`. Musisz podać własny bufor nazw plików, aby uwzględnić zwracaną listę wielu nazw plików. W tym celu należy `m_ofn.lpstrFile` zastąpić wskaźnikiem do przydzielonego bufora po utworzeniu `CFileDialog`elementu, ale przed wywołaniem `DoModal`.

Ponadto należy ustawić `m_ofn.nMaxFile` przy użyciu liczby znaków w buforze wskazywanym przez `m_ofn.lpstrFile`. Jeśli ustawisz maksymalną liczbę plików do wybrania `n`, wymagany rozmiar buforu to. `n * (_MAX_PATH + 1) + 1` Pierwszy element zwrócony w buforze jest ścieżką do folderu, w którym zostały wybrane pliki. W przypadku okien dialogowych z systemem Windows Vista lub nowszym, ciągi katalogów i nazw plików są kończone null, z dodatkowym znakiem null po ostatniej nazwie pliku. Ten format umożliwia korzystanie z okien dialogowych w stylu Eksploratora w celu zwrócenia długich nazw plików zawierających spacje. W przypadku okien dialogowych starego stylu ciągi nazw katalogów i plików są oddzielone spacjami, a funkcja używa krótkich nazw plików dla nazw plików ze spacjami.

W poniższym przykładzie pokazano, jak za pomocą buforu pobrać i wyświetlić listę wielu nazw plików.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Aby zmienić rozmiar buforu w odpowiedzi na użytkownika z wybraniem wielu nazw plików, należy utworzyć nową klasę z `CFileDialog` i zastąpić metodę [CFileDialog:: OnFileNameChange](#onfilenamechange) .

W przypadku uzyskania nowej klasy z `CFileDialog`programu można użyć mapy komunikatów do obsługi wszelkich komunikatów. Aby zwiększyć domyślną obsługę komunikatów, należy utworzyć klasę z `CFileDialog`, dodać do nowej klasy mapę komunikatów i udostępnić funkcje członkowskie dla nowych komunikatów. Nie trzeba podawać funkcji podłączania w celu dostosowania okna dialogowego.

Aby dostosować okno dialogowe, wyprowadzić klasę z `CFileDialog`, udostępnić niestandardowy szablon okna dialogowego i dodać mapę komunikatów do przetwarzania komunikatów powiadomień z formantów rozszerzonych. Przekaż wszystkie nieprzetworzone komunikaty do klasy podstawowej. Nie trzeba dostosowywać funkcji Hook.

W przypadku korzystania z stylu `CFileDialog`systemu Windows Vista lub nowszego nie można używać map komunikatów i szablonów okien dialogowych. Zamiast tego należy użyć interfejsów COM dla podobnych funkcji.

Aby uzyskać więcej informacji o sposobach `CFileDialog`korzystania z programu, zobacz [wspólne klasy okien dialogowych](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Wymagania

**Nagłówek:** afxdlgs. h

##  <a name="addcheckbutton"></a>CFileDialog:: AddCheckButton

Dodaje przycisk wyboru do okna dialogowego.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator przycisku wyboru, który ma zostać dodany.

*strLabel*<br/>
Nazwa przycisku wyboru.

*bChecked*<br/>
Wartość logiczna wskazująca bieżący stan przycisku wyboru. PRAWDA, jeśli zaznaczone; FAŁSZ w przeciwnym razie

### <a name="remarks"></a>Uwagi

##  <a name="addcombobox"></a>CFileDialog:: AddComboBox

Dodaje pole kombi do okna dialogowego.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator pola kombi do dodania.

### <a name="remarks"></a>Uwagi

##  <a name="addcontrolitem"></a>CFileDialog:: AddControlItem

Dodaje element do kontrolki kontenera w oknie dialogowym.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator formantu kontenera, do którego ma zostać dodany element.

*dwIDItem*<br/>
Identyfikator elementu.

*strLabel*<br/>
Tekst elementu.

### <a name="remarks"></a>Uwagi

##  <a name="addeditbox"></a>CFileDialog:: AddEditBox

Dodaje pole edycji do okna dialogowego.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator pola edycji do dodania.

*strText*<br/>
Nazwa pola edycji.

### <a name="remarks"></a>Uwagi

##  <a name="addmenu"></a>CFileDialog:: Add— menu

Dodaje menu do okna dialogowego.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator menu do dodania.

*strLabel*<br/>
Nazwa menu.

### <a name="remarks"></a>Uwagi

##  <a name="addplace"></a>CFileDialog:: addplace

Dodaje folder do listy miejsc dostępnych dla użytkownika w celu otwierania lub zapisywania elementów.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parametry

*lpszFolder*<br/>
Ścieżka do folderu, który ma zostać udostępniony użytkownikowi. Może to być tylko folder.

*fdap*<br/>
Określa, gdzie folder znajduje się na liście.

*interfejsu*<br/>
Wskaźnik do elementu IShellItem, który reprezentuje folder, który ma zostać udostępniony użytkownikowi. Może to być tylko folder.

### <a name="remarks"></a>Uwagi

##  <a name="addpushbutton"></a>CFileDialog:: addprzycisk

Dodaje przycisk do okna dialogowego.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator przycisku do dodania.

*strLabel*<br/>
Nazwa przycisku.

### <a name="remarks"></a>Uwagi

##  <a name="addradiobuttonlist"></a>CFileDialog:: AddRadioButtonList

Dodaje do okna dialogowego przycisk opcji (znany również jako przycisk radiowy).

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator grupy przycisków opcji do dodania.

### <a name="remarks"></a>Uwagi

##  <a name="addseparator"></a>CFileDialog:: AddSeparator

Dodaje separator do okna dialogowego.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
IDENTYFIKATOR dodawanego separatora.

### <a name="remarks"></a>Uwagi

##  <a name="addtext"></a>CFileDialog:: AddText

Dodaje tekst do okna dialogowego.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator tekstu do dodania.

*strText*<br/>
Nazwa tekstu.

### <a name="remarks"></a>Uwagi

##  <a name="applyofntoshelldialog"></a>CFileDialog:: ApplyOFNToShellDialog

Aktualizuje bieżący stan [CFileDialog](../../mfc/reference/cfiledialog-class.md) na podstawie wartości przechowywanych w `m_ofn` strukturze danych.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Uwagi

W wersjach systemu Windows starszych niż Windows Vista, składowa [](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) struktury danych programu OPENFILENAME była stale synchronizowana ze stanem `CFileDialog`. Wszelkie zmiany zmiennej składowej [m_ofn](#m_ofn) zostały natychmiast odzwierciedlone w stanie okna dialogowego. Ponadto wszelkie zmiany stanu okna dialogowego natychmiast aktualizują `m_ofn` zmienną elementu członkowskiego.

W systemie Windows Vista lub nowszym wartości w `m_ofn` zmiennej składowej i stanie `CFileDialog` nie są gwarantowane do synchronizacji. Ta funkcja wymusza zaktualizowanie stanu `CFileDialog` programu w celu `m_ofn` dopasowania go do struktury. System Windows automatycznie wywołuje tę funkcję podczas [CFileDialog::D omodal](#domodal).

Aby uzyskać więcej informacji na temat używania `CFileDialog` klasy w systemie Windows Vista lub nowszym, zobacz [CFileDialog class](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Przykład

  Zobacz przykład dla [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>CFileDialog:: CFileDialog

Wywołaj tę funkcję, aby utworzyć standardowy plik systemu Windows okno dialogowe.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parametry

*bOpenFileDialog*<br/>
podczas Parametr, który określa typ okna dialogowego, który ma zostać utworzony. Ustaw wartość na TRUE, aby utworzyć okno dialogowe **Otwórz plik** . Ustaw na wartość FALSE, aby utworzyć okno dialogowe **Zapisz jako** .

*lpszDefExt*<br/>
podczas Domyślne rozszerzenie nazwy pliku. Jeśli użytkownik nie zawiera znanego rozszerzenia (takiego, które ma skojarzenie na komputerze użytkownika) w polu filename, rozszerzenie określone przez *lpszDefExt* jest automatycznie dołączane do nazwy pliku. Jeśli ten parametr ma wartość NULL, żadne rozszerzenie nie jest dołączane.

*lpszFileName*<br/>
podczas Początkowa nazwa pliku, która pojawia się w polu Nazwa pliku. Jeśli wartość jest równa NULL, nie zostanie wyświetlona początkowa nazwa pliku.

*flagiDW*<br/>
podczas Kombinacja jednej lub więcej flag, których można użyć do dostosowania okna dialogowego. Aby uzyskać opis tych flag, zobacz strukturę [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) w Windows SDK. Jeśli zmodyfikujesz `m_ofn.Flags` element członkowski struktury, użyj operatora bitowego lub w zmianach, aby zachować zachowanie domyślne bez zmian.

*lpszFilter*<br/>
podczas Seria par ciągów, które określają filtry, które można zastosować do pliku. W przypadku określenia filtrów plików na liście pliki będą wyświetlane tylko te pliki, które pasują do kryteriów filtrowania. Zobacz sekcję Uwagi, aby uzyskać więcej informacji na temat pracy z filtrami plików.

*pParentWnd*<br/>
podczas Wskaźnik do okna nadrzędnego lub właściciela pliku okna dialogowego.

*dwSize*<br/>
podczas Rozmiar `OPENFILENAME` struktury. Ta wartość jest zależna od wersji systemu operacyjnego. MFC użył tego parametru, aby określić odpowiedni rodzaj okna dialogowego do utworzenia. Domyślny rozmiar 0 oznacza, że kod MFC określi prawidłowy rozmiar okna dialogowego do użycia na podstawie wersji systemu operacyjnego, na której jest uruchamiany program.

*bVistaStyle*<br/>
podczas **Uwaga** Ten parametr jest dostępny w programie Visual Studio 2008 lub nowszym i powoduje, że okno dialogowe nowego stylu może być używane tylko w przypadku korzystania z systemu Windows Vista lub nowszego.

Parametr określający styl okna dialogowego pliku. Ustaw wartość na TRUE, aby użyć nowych okien dialogowych stylu systemu Vista. W przeciwnym razie zostanie użyty stary styl okien dialogowych. Zobacz sekcję Uwagi, aby uzyskać więcej informacji na temat uruchamiania w systemie Vista.

### <a name="remarks"></a>Uwagi

Zostanie skonstruowane okno dialogowe **otwieranie pliku** lub **Zapisywanie jako pliku** , w zależności od wartości *bOpenFileDialog*.

Określenie domyślnego rozszerzenia przy użyciu *lpszDefExt* może nie dawać oczekiwanego zachowania, ponieważ jest rzadko przewidywalna, jakie rozszerzenia mają skojarzenia plików na komputerze użytkownika. Jeśli potrzebujesz większej kontroli nad dołączeniem rozszerzenia domyślnego, możesz utworzyć własną klasę z `CFileDialog`i `CFileDialog::OnFileNameOK` zastąpić metodę, aby przeprowadzić obsługę rozszerzenia.

Aby umożliwić użytkownikowi wybranie wielu plików, Ustaw flagę OFN_ALLOWMULTISELECT przed wywołaniem [DoModal](#domodal). Należy podać własny bufor nazw plików, aby przechowywać zwracaną listę wielu nazw plików. W tym celu należy `m_ofn.lpstrFile` zastąpić wskaźnikiem do przydzielonego bufora po utworzeniu [CFileDialog](../../mfc/reference/cfiledialog-class.md), ale przed wywołaniem `DoModal`. Ponadto należy ustawić `m_ofn.nMaxFile` z liczbą znaków w buforze wskazywanym przez `m_ofn.lpstrFile`. Jeśli ustawisz maksymalną liczbę plików do wybrania na *n*, wymagany rozmiar buforu to `n`* (_MAX_PATH + 1) + 1. Na przykład:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Aby umożliwić użytkownikowi zmianę rozmiaru okna dialogowego stylu Eksploratora przy użyciu myszy lub klawiatury, Ustaw flagę OFN_ENABLESIZING. Ustawienie tej flagi jest niezbędne tylko wtedy, gdy podajesz procedurę haka lub szablon niestandardowy. Flaga działa tylko za pomocą okna dialogowego stylu Eksploratora; nie można zmienić rozmiaru okien dialogowych starego stylu.

Parametr *lpszFilter* służy do określania typu nazwy pliku, który musi być wyświetlany na liście plików. Pierwszy ciąg w parze ciągów opisuje filtr; drugi ciąg wskazuje rozszerzenie nazwy pliku do użycia. Można określić wiele rozszerzeń przy użyciu średnika (znaku ";") jako ogranicznika. Ciąg ma dwa znaki "&#124;", po którym następuje znak null. Dla tego parametru można także użyć obiektu [CString](../../atl-mfc-shared/using-cstring.md) .

Na przykład program Microsoft Excel umożliwia użytkownikom otwieranie plików z rozszerzeniami. xlc (Chart) lub xls (arkusz), między innymi. Filtr dla programu Excel może być zapisany jako:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Jeśli jednak planujesz używać tego ciągu do bezpośredniego aktualizowania `OPENFILENAME` struktury, należy rozdzielić ciągi znakiem null, "\ 0" zamiast pionowych słupków ("&#124;").

Parametr *bVistaStyle* ma zastosowanie tylko w przypadku uruchamiania w systemie Windows Vista lub nowszym. W starszych wersjach systemu Windows ten parametr jest ignorowany. Jeśli *bVistaStyle* ma wartość true, podczas kompilowania programu z programem Visual Studio 2008 lub nowszym zostanie użyte nowe **okno dialogowe pliku** stylu systemu Vista. W przeciwnym razie zostanie użyte **okno dialogowe poprzedni plik** stylu MFC.

Szablony okien dialogowych nie są obsługiwane w oknach dialogowych opartych na *bVistaStyle*

### <a name="example"></a>Przykład

  Zobacz przykład dla [CFileDialog::D omodal](#domodal).

##  <a name="domodal"></a>CFileDialog::D oModal

Wywołaj tę funkcję, aby wyświetlić okno dialogowe typowy plik systemu Windows i umożliwić użytkownikowi przeglądanie plików i katalogów i wprowadzanie nazwy pliku.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Wartość zwracana

IDOK lub IDCANCEL. Jeśli IDCANCEL jest zwracany, wywołaj funkcję Windows [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) , aby określić, czy wystąpił błąd.

IDOK i IDCANCEL są stałymi, które wskazują, czy użytkownik zaznaczył przycisk OK lub Anuluj.

### <a name="remarks"></a>Uwagi

Jeśli chcesz zainicjować różne opcje okna dialogowego plików przez ustawienie elementów członkowskich `m_ofn` struktury, należy to zrobić przed wywołaniem `DoModal`, ale po skonstruowaniu obiektu okna dialogowego.

Na przykład jeśli chcesz zezwolić użytkownikowi na wybranie wielu plików, Ustaw flagę OFN_ALLOWMULTISELECT przed wywołaniem `DoModal`, jak pokazano w przykładzie kodu w tym temacie.

Gdy użytkownik kliknie przycisk OK lub anuluje przyciski lub wybierze opcję Zamknij z menu sterowania okna dialogowego, formant jest zwracany do aplikacji. Następnie można wywołać inne funkcje członkowskie, aby pobrać ustawienia lub informacje wejściowe użytkownika w oknie dialogowym.

`DoModal`jest funkcją wirtualną przesłoniętą z `CDialog`klasy.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>CFileDialog:: EnableOpenDropDown

Włącza listę rozwijaną na przycisku Otwórz lub Zapisz w oknie dialogowym.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator listy rozwijanej.

### <a name="remarks"></a>Uwagi

##  <a name="endvisualgroup"></a>CFileDialog:: EndVisualGroup

Wyłącza dodawanie elementów do grupy wizualizacji w oknie dialogowym.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Wartość zwracana

Zwraca S_OK, jeśli pomyślne; w przeciwnym razie wartość błędu.

### <a name="remarks"></a>Uwagi

##  <a name="getcheckbuttonstate"></a>CFileDialog:: GetCheckButtonState

Pobiera bieżący stan przycisku wyboru (pole wyboru) w oknie dialogowym.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator pola wyboru.

*bChecked*<br/>
Stan pola wyboru. Wartość TRUE oznacza zaznaczenie pola wyboru; Wartość FALSE wskazuje, że nie jest zaznaczona.

### <a name="remarks"></a>Uwagi

##  <a name="getcontrolitemstate"></a>CFileDialog:: GetControlItemState

Pobiera bieżący stan elementu w formancie kontenera znalezionym w oknie dialogowym.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki kontenera.

*dwIDItem*<br/>
Identyfikator elementu.

*dwState*<br/>
Odwołanie do zmiennej, która otrzymuje jedną z więcej wartości z wyliczenia CDCONTROLSTATE, która wskazuje bieżący stan formantu.

### <a name="remarks"></a>Uwagi

##  <a name="getcontrolstate"></a>CFileDialog:: GetControlState

Pobiera bieżące widoczność i włączone Stany danej kontrolki.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki.

*dwState*<br/>
Odwołanie do zmiennej, która otrzymuje co najmniej jedną wartość z wyliczenia CDCONTROLSTATE, która wskazuje bieżący stan formantu.

### <a name="remarks"></a>Uwagi

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

Pobiera bieżący tekst w kontrolce pola edycji.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator pola edycji.

*strText*<br/>
Wartość tekstowa.

### <a name="remarks"></a>Uwagi

##  <a name="getfileext"></a>CFileDialog:: GetFileExt

Wywołaj tę funkcję, aby pobrać rozszerzenie nazwy pliku wprowadzonej do okna dialogowego.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Wartość zwracana

Rozszerzenie nazwy pliku.

### <a name="remarks"></a>Uwagi

Na przykład, Jeśli wprowadzona nazwa pliku ma wartość DATA. `GetFileExt` Txt zwraca wartość "txt".

Jeśli `m_ofn.Flags` ma ustawioną flagę OFN_ALLOWMULTISELECT, ten ciąg zawiera sekwencję ciągów zakończonych znakiem null, z pierwszym ciągiem ścieżki katalogu wybranej grupy plików, a następnie nazwy wszystkich plików wybranych przez użytkownika. Aby pobrać nazwy ścieżek plików, użyj funkcji składowych [GetStartPosition](#getstartposition) i [GetNextPathName](#getnextpathname) .

##  <a name="getfilename"></a>CFileDialog:: GetFileName

Wywołaj tę funkcję, aby pobrać nazwę nazwy pliku wprowadzonej w oknie dialogowym.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Wartość zwracana

Nazwa pliku.

### <a name="remarks"></a>Uwagi

Nazwa pliku zawiera zarówno prefiks, jak i rozszerzenie. Na przykład `GetFileName` zwróci wartość "text". DAT "dla pliku C:\FILES\TEXT.DAT.

Jeśli `m_ofn.Flags` [](#getstartposition) [](#getnextpathname) ma ustawioną flagę, należy wywołać GetStartPosition i GetNextPathName, aby pobrać nazwę ścieżki pliku. `OFN_ALLOWMULTISELECT`

##  <a name="getfiletitle"></a>CFileDialog:: GetFileTitle

Wywołaj tę funkcję, aby pobrać tytuł pliku wprowadzonego w oknie dialogowym.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Wartość zwracana

Tytuł pliku.

### <a name="remarks"></a>Uwagi

Tytuł pliku zawiera tylko jego prefiks, bez ścieżki lub rozszerzenia. Na przykład `GetFileTitle` zwróci "text" dla pliku C:\FILES\TEXT.dat.

Jeśli `m_ofn.Flags` ma ustawioną flagę OFN_ALLOWMULTISELECT, ten ciąg zawiera sekwencję ciągów zakończonych znakiem null, z pierwszym ciągiem ścieżki katalogu wybranej grupy plików, a następnie nazwy wszystkich plików wybranych przez użytkownika. Z tego powodu Użyj funkcji składowych [GetStartPosition](#getstartposition) i [GetNextPathName](#getnextpathname) , aby pobrać następną nazwę pliku z listy.

### <a name="example"></a>Przykład

  Zobacz przykład dla [CFileDialog::D omodal](#domodal).

##  <a name="getfolderpath"></a>CFileDialog:: GetFolderPath

Wywołaj tę funkcję elementu członkowskiego, aby pobrać ścieżkę do aktualnie otwartego folderu lub katalogu dla okna dialogowego Otwórz lub Zapisz jako wspólne w stylu Eksploratora.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Wartość zwracana

Obiekt [CString](../../atl-mfc-shared/reference/cstringt-class.md) zawierający aktualnie otwarty folder lub katalog.

### <a name="remarks"></a>Uwagi

Okno dialogowe musi być utworzone przy użyciu stylu OFN_EXPLORER; w przeciwnym razie metoda zakończy się niepowodzeniem z potwierdzeniem.

Tę metodę można wywołać tylko wtedy, gdy okno dialogowe jest wyświetlane. Gdy okno dialogowe zostało zamknięte, ta funkcja przestanie działać, a metoda zakończy się niepowodzeniem z potwierdzeniem.

##  <a name="getifiledialogcustomize"></a>CFileDialog:: GetIFileDialogCustomize

Pobiera wskaźnik do wewnętrznego obiektu COM dla danego [CFileDialog](../../mfc/reference/cfiledialog-class.md).

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do wewnętrznego obiektu COM dla `CFileDialog`. Ponosisz odpowiedzialność za odpowiednie wydanie tego wskaźnika.

### <a name="remarks"></a>Uwagi

Tej funkcji należy używać tylko w systemie Windows Vista lub nowszym z obiektem, który ma *bVistaStyle* USTAWIONĄ wartość true. Jeśli użyjesz tej funkcji, gdy *bVistaStyle* ma wartość false, zwróci wartość null w trybie wydania i zgłosi potwierdzenie w trybie debugowania.

Aby uzyskać więcej informacji o `IFileDialogCustomize` interfejsie, zobacz [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Przykład

Ten przykład pobiera wewnętrzny obiekt COM. Aby uruchomić ten przykład kodu, należy skompilować go w systemie Windows Vista lub nowszym.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>CFileDialog:: GetIFileOpenDialog

Pobiera wskaźnik do wewnętrznego obiektu COM dla danego `CFileDialog`elementu.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do wewnętrznego obiektu COM dla `CFileDialog`. Ponosisz odpowiedzialność za odpowiednie wydanie tego wskaźnika.

### <a name="remarks"></a>Uwagi

Tej funkcji należy używać tylko w systemie Windows Vista lub nowszym z obiektem, który ma *bVistaStyle* USTAWIONĄ wartość true. Ta funkcja zwraca wartość null, `CFileDialog` Jeśli nie jest **otwartym** oknem dialogowym lub jeśli *bVistaStyle* jest ustawiona na wartość false. W tym przypadku, funkcja zwraca tylko wartość NULL w trybie wydania — w trybie debugowania zostanie wygeneruje potwierdzenie.

Aby uzyskać więcej informacji o `IFileOpenDialog` interfejsie, zobacz [IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Przykład

Ten przykład pobiera wewnętrzny obiekt COM. Aby uruchomić ten kod, należy go skompilować w systemie Windows Vista lub nowszym.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>CFileDialog:: GetIFileSaveDialog

Pobiera wskaźnik do wewnętrznego obiektu COM dla danego `CFileDialog`elementu.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do wewnętrznego obiektu COM dla `CFileDialog`. Ponosisz odpowiedzialność za odpowiednie wydanie tego wskaźnika.

### <a name="remarks"></a>Uwagi

Tej funkcji należy używać tylko w systemie Windows Vista lub nowszym z obiektem, który ma *bVistaStyle* USTAWIONĄ wartość true. Ta funkcja zwróci wartość null, `CFileDialog` Jeśli nie jest oknem dialogowym **zapisywania** lub jeśli *bVistaStyle* jest ustawiona na wartość false. W tym przypadku, funkcja zwraca tylko wartość NULL w trybie wydania — w trybie debugowania zostanie wygeneruje potwierdzenie.

Aby uzyskać więcej informacji o `IFileSaveDialog` interfejsie, zobacz [IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Przykład

Ten przykład pobiera wewnętrzny obiekt COM. Aby uruchomić ten przykład kodu, należy skompilować go w systemie Windows Vista lub nowszym.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>CFileDialog:: GetNextPathName

Wywołaj tę funkcję, aby pobrać następną nazwę pliku z grupy wybranej w oknie dialogowym.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parametry

*Terminal*<br/>
Odwołanie do wartości pozycji zwróconej przez poprzednie `GetNextPathName` lub `GetStartPosition` wywołanie funkcji. Wartość NULL, jeśli osiągnięto koniec listy.

### <a name="return-value"></a>Wartość zwracana

Pełna ścieżka pliku.

### <a name="remarks"></a>Uwagi

Ścieżka do pliku zawiera tytuł pliku oraz całą ścieżkę do katalogu. Na przykład `GetNextPathName` zwróci wartość "C:\FILES\TEXT. DAT "dla pliku C:\FILES\TEXT.DAT. Można użyć `GetNextPathName` w pętli iteracji do przodu, jeśli ustanowi początkową pozycję z wywołaniem do `GetStartPosition`.

Jeśli zaznaczenie składa się tylko z jednego pliku, nazwa tego pliku zostanie zwrócona.

##  <a name="getofn"></a>CFileDialog:: GetOFN

Pobiera skojarzoną `OPENFILENAME` strukturę.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Wartość zwracana

Struktura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) .

### <a name="remarks"></a>Uwagi

Użyj drugiej wersji tej funkcji w celu zainicjowania wyglądu **pliku otwartego** lub **zapisywania jako pliku** okna dialogowego, gdy zostanie on skonstruowany, ale zanim zostanie `DoModal` wyświetlony z funkcją składową. Na przykład można ustawić `lpstrTitle` `m_ofn` element członkowski do podpisu, który ma mieć okno dialogowe.

##  <a name="getpathname"></a>CFileDialog:: getPathname

Wywołaj tę funkcję, aby pobrać pełną ścieżkę pliku wprowadzonego w oknie dialogowym.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Wartość zwracana

Pełna ścieżka pliku.

### <a name="remarks"></a>Uwagi

Ścieżka do pliku zawiera tytuł pliku oraz całą ścieżkę do katalogu. Na przykład `GetPathName` zwróci wartość "C:\FILES\TEXT. DAT "dla pliku C:\FILES\TEXT.DAT.

Jeśli `m_ofn.Flags` ma ustawioną flagę OFN_ALLOWMULTISELECT, ten ciąg zawiera sekwencję ciągów o wartości null teminated, z których pierwszy ciąg jest ścieżką katalogu wybranej grupy plików, a następnie nazwy wszystkich plików wybranych przez użytkownika. Z tego powodu Użyj funkcji składowych [GetStartPosition](#getstartposition) i [GetNextPathName](#getnextpathname) , aby pobrać następną nazwę pliku z listy.

### <a name="example"></a>Przykład

  Zobacz przykład dla [CFileDialog::D omodal](#domodal).

##  <a name="getreadonlypref"></a>CFileDialog:: GetReadOnlyPref

Wywołaj tę funkcję, aby określić, czy pole wyboru tylko do odczytu zostało zaznaczone w oknach dialogowych Otwórz plik i Zapisz jako w systemie Windows.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Wartość zwracana

Inne niż zero, jeśli pole wyboru tylko do odczytu w oknie dialogowym jest zaznaczone; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Można ukryć pole wyboru tylko do odczytu przez ustawienie stylu OFN_HIDEREADONLY w `CFileDialog` konstruktorze.

> [!NOTE]
> Obiekty stylu `CFileDialog` systemu Windows Vista lub nowszego nie obsługują tej funkcji. Próba użycia tej funkcji w stylu `CFileDialog` systemu Windows Vista lub nowszego spowoduje zgłoszenie [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="getresult"></a>CFileDialog:: GetResult

Pobiera wybór utworzony przez użytkownika w oknie dialogowym.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do elementu IShellItem, który reprezentuje wybór użytkownika.

### <a name="remarks"></a>Uwagi

##  <a name="getresults"></a>CFileDialog:: GetResults

Pobiera wybory użytkownika w oknie dialogowym, które umożliwia wybór wielokrotny.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do elementu IShellItemArray, za pomocą którego można uzyskać dostęp do elementów wybranych w oknie dialogowym.

### <a name="remarks"></a>Uwagi

##  <a name="getselectedcontrolitem"></a>CFileDialog:: GetSelectedControlItem

Pobiera określony element z określonej kontrolki kontenera w oknie dialogowym.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki kontenera.

*dwIDItem*<br/>
Identyfikator elementu wybranego przez użytkownika w kontrolce.

### <a name="remarks"></a>Uwagi

##  <a name="getstartposition"></a>CFileDialog:: GetStartPosition

Wywołaj tę funkcję elementu członkowskiego, aby pobrać pozycję pierwszej nazwy ścieżki pliku na liście, `m_ofn.Flags` Jeśli ma ustawioną flagę OFN_ALLOWMULTISELECT.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość pozycji, która może być używana do iteracji; Wartość NULL, jeśli lista jest pusta.

##  <a name="hidecontrol"></a>CFileDialog:: HideControl

Wywołaj tę funkcję elementu członkowskiego, aby ukryć określony formant w oknie dialogowym Otwórz lub Zapisz jako wspólne w stylu Eksploratora.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Parametry

*nID*<br/>
Identyfikator kontrolki do ukrycia.

### <a name="remarks"></a>Uwagi

Okno dialogowe musi być utworzone przy użyciu stylu OFN_EXPLORER; w przeciwnym razie funkcja zakończy się niepowodzeniem z potwierdzeniem.

##  <a name="ispickfoldersmode"></a>CFileDialog:: IsPickFoldersMode

Określa, czy bieżące okno dialogowe jest w trybie selektora folderów.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Wartość zwracana

PRAWDA, jeśli okno dialogowe jest w trybie selektora folderów; w przeciwnym razie FALSE.

### <a name="remarks"></a>Uwagi

##  <a name="m_ofn"></a>CFileDialog:: m_ofn

`m_ofn`jest strukturą typu `OPENFILENAME`. Dane w tej strukturze reprezentują bieżący stan `CFileDialog`.

### <a name="remarks"></a>Uwagi

Użyj tej struktury do zainicjowania wyglądu **pliku Otwórz plik** lub **Zapisz jako** , gdy zostanie on skonstruowany, ale przed wyświetleniem go przy użyciu metody [DoModal](#domodal) . Na przykład można ustawić element członkowski `m_ofn` *lpstrTitle* do podpisu, który ma mieć okno dialogowe.

W przypadku stylu systemu Windows Vista lub nowszego [CFileDialog](../../mfc/reference/cfiledialog-class.md)nie jest gwarantowane, `m_ofn` że zawsze pasuje do stanu okna dialogowego. Jest on synchronizowany z oknem dialogowym we wcześniejszych wersjach systemu Windows. Aby uzyskać więcej informacji na temat `m_ofn` synchronizowania struktury i stanu w systemie Windows Vista lub nowszym, `CFileDialog` zobacz [CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog) i [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog) .

Okna dialogowe pliku stylu systemu Windows Vista lub nowszego nie obsługują niektórych elementów członkowskich i flag `CFileDialog`. W związku z tym nie będą one miały zastosowania.

Poniżej znajduje się lista elementów członkowskich, które nie są obsługiwane w systemie Windows Vista lub nowszym:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Poniższe flagi nie są obsługiwane i w związku z `CFileDialog`tym nie mają zastosowania w przypadku używania stylu systemu Windows Vista lub nowszego:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES — zawsze włączone w systemie Windows Vista lub nowszym

- OFN_NOLONGNAMES — zawsze wyłączone w systemie Windows Vista lub nowszym

- OFN_NONETWORKBUTTON — zawsze włączone w systemie Windows Vista lub nowszym

- OFN_READONLY

- OFN_SHOWHELP

Aby uzyskać więcej informacji na temat tej struktury, [](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) zapoznaj się ze strukturą OPENFILENAME w Windows SDK.

##  <a name="makeprominent"></a>CFileDialog:: MakeProminent

Umieszcza formant w oknie dialogowym, aby można go było rozprowadzić w porównaniu do innych kontrolek.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki.

### <a name="remarks"></a>Uwagi

##  <a name="onbuttonclicked"></a>CFileDialog:: OnButtonClicked

Wywoływana, gdy przycisk zostanie kliknięty.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator przycisku.

### <a name="remarks"></a>Uwagi

##  <a name="oncheckbuttontoggled"></a>CFileDialog:: OnCheckButtonToggled

Wywoływana, gdy pole wyboru jest zaznaczone lub niezaznaczone.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator pola wyboru.

*bChecked*<br/>
Zaznaczone lub niezaznaczone.

### <a name="remarks"></a>Uwagi

##  <a name="oncontrolactivating"></a>CFileDialog:: OnControlActivating

Wywoływana, gdy formant jest aktywowany.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki.

### <a name="remarks"></a>Uwagi

##  <a name="onfilenamechange"></a>CFileDialog:: OnFileNameChange

Zastąp tę metodę, jeśli chcesz obsługiwać komunikat CDN_SELCHANGE WM_NOTIFY.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Uwagi

System wysyła komunikat CDN_SELCHANGE, gdy użytkownik wybierze nowy plik lub folder na liście plików okna dialogowego **Otwórz** lub **Zapisz jako** . Zastąp tę metodę, jeśli chcesz wykonać dowolne akcje w odpowiedzi na tę wiadomość.

System wysyła ten komunikat tylko wtedy, gdy okno dialogowe zostało utworzone z włączoną flagą OFN_EXPLORER. Aby uzyskać więcej informacji na temat powiadomienia, zobacz [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange). Aby uzyskać informacje na temat flagi OFN_EXPLORER, zapoznaj się z oknem dialogowym Tworzenie struktury [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) i [otwieranie i zapisywanie jako](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="onfilenameok"></a>CFileDialog:: OnFileNameOK

Przesłoń tę funkcję tylko wtedy, gdy chcesz zapewnić niestandardową weryfikację nazw plików, które są wprowadzane do okna dialogowego wspólnego pliku.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Wartość zwracana

1, jeśli nazwa pliku nie jest prawidłową nazwą pliku; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja umożliwia odrzucanie nazwy pliku dla każdej przyczyny specyficznej dla aplikacji. Zwykle nie trzeba używać tej funkcji, ponieważ struktura zapewnia domyślną weryfikację nazw plików i wyświetla okno komunikatu, jeśli wprowadzono nieprawidłową nazwę pliku.

Jeśli zostanie zwrócona wartość 1, okno dialogowe pozostanie wyświetlane dla użytkownika, aby wprowadzić inną nazwę pliku. Procedura okna dialogowego powoduje odrzucenie okna dialogowego, jeśli wartość zwracana wynosi 0. Inne niezerowe wartości zwracane są obecnie zarezerwowane i nie powinny być używane.

##  <a name="onfolderchange"></a>CFileDialog:: OnFolderChange

Przesłoń tę funkcję, aby obsłużyć komunikat WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Uwagi

Komunikat powiadomienia jest wysyłany po otwarciu nowego folderu w oknie dialogowym Otwórz lub Zapisz jako.

Powiadomienie jest wysyłane tylko wtedy, gdy okno dialogowe zostało utworzone przy użyciu stylu OFN_EXPLORER. Aby uzyskać więcej informacji na temat powiadomienia, zobacz [CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange). Aby uzyskać informacje na temat stylu OFN_EXPLORER, zapoznaj się z oknem dialogowym Tworzenie struktury [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) i [otwieranie i zapisywanie jako](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="oninitdone"></a>CFileDialog:: OnInitDone

Przesłoń tę funkcję, aby obsłużyć komunikat CDN_INITDONE WM_NOTIFY.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Uwagi

System wysyła ten komunikat z powiadomieniem, gdy system zakończył rozmieszczanie kontrolek w oknie dialogowym **Otwórz** lub **Zapisz jako** , aby zwolnić miejsce dla kontrolek podrzędnego okna dialogowego.

System wysyła to tylko wtedy, gdy okno dialogowe zostało utworzone przy użyciu stylu OFN_EXPLORER. Aby uzyskać więcej informacji na temat powiadomienia, zobacz [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone). Aby uzyskać informacje na temat stylu OFN_EXPLORER, zapoznaj się z oknem dialogowym Tworzenie struktury [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) i [otwieranie i zapisywanie jako](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> Okna dialogowe pliku stylu systemu Windows Vista lub nowszego nie obsługują tej funkcji. Próba użycia tej funkcji w oknie dialogowym plików w systemie Windows Vista lub nowszym spowoduje zgłoszenie [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="onitemselected"></a>CFileDialog:: OnItemSelected

Wywołuje się, gdy wybrano element kontenera.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki kontenera.

*dwIDItem*<br/>
Identyfikator elementu.

### <a name="remarks"></a>Uwagi

##  <a name="onlbselchangednotify"></a>CFileDialog:: OnLBSelChangedNotify

Ta funkcja jest wywoływana za każdym razem, gdy bieżące zaznaczenie w polu listy ma zostać zmienione.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parametry

*nIDBox*<br/>
Identyfikator pola listy lub pola kombi, w którym wystąpiło zaznaczenie.

*iCurSel*<br/>
Indeks bieżącego zaznaczenia.

*nCode*<br/>
Kod powiadomienia sterującego. Ten parametr musi mieć jedną z następujących wartości:

- CD_LBSELCHANGE określa, że *iCurSel* jest wybranym elementem w polu listy z pojedynczym wyborem.

- CD_LBSELSUB określa, że *iCurSel* nie jest już zaznaczona w polu listy wielozaznaczania.

- CD_LBSELADD określa, że *iCurSel* jest zaznaczone w polu listy wielozaznaczania.

- CD_LBSELNOITEMS określa, że w polu listy wieloselekcji nie istnieje żadna opcja.

### <a name="remarks"></a>Uwagi

Zastąp tę funkcję, aby zapewnić niestandardową obsługę zmian wybranych w polu listy. Można na przykład użyć tej funkcji, aby wyświetlić prawa dostępu lub datę ostatniej modyfikacji każdego pliku wybieranego przez użytkownika.

##  <a name="onshareviolation"></a>CFileDialog:: OnShareViolation

Zastąp tę funkcję, aby zapewnić niestandardową obsługę naruszeń udziałów.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parametry

*lpszPathName*<br/>
Ścieżka pliku, w którym wystąpiło naruszenie udziału.

### <a name="return-value"></a>Wartość zwracana

Jedna z następujących wartości:

- OFN_SHAREFALLTHROUGH nazwa pliku jest zwracana z okna dialogowego.

- OFN_SHARENOWARN nie trzeba wykonywać dalszych czynności.

- OFN_SHAREWARN użytkownik otrzymuje standardowy komunikat ostrzegawczy dotyczący tego błędu.

### <a name="remarks"></a>Uwagi

Zwykle nie trzeba używać tej funkcji, ponieważ struktura zapewnia domyślne sprawdzanie naruszeń udziałów i wyświetla okno komunikatu w przypadku wystąpienia naruszenia udziałów.

Jeśli chcesz wyłączyć sprawdzanie naruszenia udziałów, użyj operatora bitowego or, aby połączyć flagę OFN_SHAREAWARE z `m_ofn.Flags`.

##  <a name="ontypechange"></a>CFileDialog:: OnTypeChange

Przesłoń tę funkcję, aby obsłużyć komunikat WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Uwagi

Komunikat powiadomienia jest wysyłany, gdy użytkownik wybierze nowy typ pliku z listy typów plików w oknie dialogowym Otwórz lub Zapisz jako.

Powiadomienie jest wysyłane tylko wtedy, gdy okno dialogowe zostało utworzone przy użyciu stylu OFN_EXPLORER. Aby uzyskać więcej informacji na temat powiadomienia, zobacz [CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange). Aby uzyskać informacje na temat stylu OFN_EXPLORER, zapoznaj się z oknem dialogowym Tworzenie struktury [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) i [otwieranie i zapisywanie jako](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="removecontrolitem"></a>CFileDialog:: RemoveControlItem

Usuwa element z kontrolki kontenera w oknie dialogowym.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki kontenera, z której ma zostać usunięty element.

*dwIDItem*<br/>
Identyfikator elementu.

### <a name="remarks"></a>Uwagi

##  <a name="setcheckbuttonstate"></a>CFileDialog:: SetCheckButtonState

Ustawia bieżący stan przycisku wyboru (pole wyboru) w oknie dialogowym.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator pola wyboru.

*bChecked*<br/>
Stan pola wyboru. Wartość TRUE oznacza zaznaczenie pola wyboru; Wartość FALSE wskazuje, że nie jest zaznaczona.

### <a name="remarks"></a>Uwagi

##  <a name="setcontrolitemstate"></a>CFileDialog:: SetControlItemState

Ustawia bieżący stan elementu w formancie kontenera znalezionym w oknie dialogowym.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki kontenera.

*dwIDItem*<br/>
Identyfikator elementu.

*dwState*<br/>
Co najmniej jedna wartość z wyliczenia CDCONTROLSTATE, która wskazuje nowy stan formantu.

### <a name="remarks"></a>Uwagi

##  <a name="setcontrolitemtext"></a>CFileDialog:: SetControlItemText

Ustawia tekst elementu kontrolki. Na przykład tekst, który towarzyszy przycisk radiowy lub element w menu.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki kontenera.

*dwIDItem*<br/>
Identyfikator elementu.

*strLabel*<br/>
Tekst elementu.

### <a name="remarks"></a>Uwagi

##  <a name="setcontrollabel"></a>CFileDialog:: SetControlLabel

Ustawia tekst skojarzony z kontrolką, taki jak tekst przycisku lub Etykieta pola edycji.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki.

*strLabel*<br/>
Nazwa formantu.

### <a name="remarks"></a>Uwagi

##  <a name="setcontrolstate"></a>CFileDialog:: SetControlState

Ustawia bieżące widoczność i włączone Stany danej kontrolki.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki.

*dwState*<br/>
Co najmniej jedna wartość z wyliczenia CDCONTROLSTATE, która wskazuje bieżący stan formantu.

### <a name="remarks"></a>Uwagi

##  <a name="setcontroltext"></a>CFileDialog:: SetControlText

Wywołaj tę metodę, aby ustawić tekst dla określonej kontrolki w oknie dialogowym **Otwórz** lub **Zapisz jako** w stylu Eksploratora.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parametry

*nID*<br/>
podczas Identyfikator formantu, dla którego ma zostać ustawiony tekst.

*lpsz*<br/>
podczas Wskaźnik do ciągu, który zawiera tekst do ustawienia dla kontrolki.

### <a name="remarks"></a>Uwagi

Obie wersje tej funkcji są prawidłowe dla aplikacji korzystających ze standardu Unicode. Jednak tylko wersja z typem LPCSTR jest prawidłowa dla aplikacji korzystających z ANSI.

Aby użyć tej metody, należy utworzyć okno dialogowe z stylem OFN_EXPLORER. W przeciwnym razie funkcja zakończy się niepowodzeniem z potwierdzeniem.

##  <a name="setdefext"></a>CFileDialog:: SetDefExt

Wywołaj tę funkcję, aby ustawić domyślne rozszerzenie nazwy pliku dla okna dialogowego Otwórz lub Zapisz jako wspólne.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parametry

*lpsz*<br/>
Wskaźnik do ciągu zawierającego rozszerzenie domyślne do użycia dla obiektu okna dialogowego. Ten ciąg nie może zawierać kropki (.).

### <a name="remarks"></a>Uwagi

Okno dialogowe musi być utworzone przy użyciu stylu OFN_EXPLORER; w przeciwnym razie funkcja zakończy się niepowodzeniem z potwierdzeniem.

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

Ustawia bieżący tekst w kontrolce pola edycji.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator pola edycji.

*strText*<br/>
Wartość tekstowa.

### <a name="remarks"></a>Uwagi

##  <a name="setproperties"></a>CFileDialog:: SetProperties

Udostępnia magazyn właściwości, który definiuje wartości domyślne, które mają być używane dla zapisywanego elementu.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parametry

*lpszPropList*<br/>
Lista wstępnie zdefiniowanych właściwości rozdzielonych znakami ";". Aby uzyskać listę flag, zobacz sekcję flags obiektu OPENFILENAME [](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Uwagi

##  <a name="setselectedcontrolitem"></a>CFileDialog:: SetSelectedControlItem

Ustawia wybrany stan określonego elementu w grupie przycisków opcji lub polu kombi znalezionym w oknie dialogowym.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator kontrolki kontenera.

*dwIDItem*<br/>
Identyfikator elementu wybranego przez użytkownika w kontrolce.

### <a name="remarks"></a>Uwagi

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

Ustawia szablon okna dialogowego dla obiektu [CFileDialog](../../mfc/reference/cfiledialog-class.md) .

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parametry

*nWin3ID*<br/>
podczas Zawiera numer identyfikatora zasobu szablonu dla obiektu spoza Eksploratora `CFileDialog` . Ten szablon jest używany tylko w systemie Windows NT 3,51 lub w przypadku nieobecności stylu OFN_EXPLORER.

*nWin4ID*<br/>
podczas Zawiera numer identyfikatora zasobu szablonu dla obiektu Eksploratora `CFileDialog` . Ten szablon jest używany tylko w systemie Windows NT 4,0 i nowszych wersjach, Windows 95 i nowszych oraz w przypadku obecności stylu OFN_EXPLORER.

*lpWin3ID*<br/>
podczas Zawiera nazwę zasobu szablonu dla obiektu spoza Eksploratora `CFileDialog` . Ten szablon jest używany tylko w systemie Windows NT 3,51 lub w przypadku nieobecności stylu OFN_EXPLORER.

*lpWin4ID*<br/>
podczas Zawiera nazwę zasobu szablonu obiektu Eksploratora `CFileDialog` . Ten szablon jest używany tylko w systemie Windows NT 4,0 i nowszych wersjach, Windows 95 i nowszych oraz w przypadku obecności stylu OFN_EXPLORER.

### <a name="remarks"></a>Uwagi

System będzie używać tylko jednego z określonych szablonów. System Określa szablon do użycia na podstawie obecności stylu OFN_EXPLORER i systemu operacyjnego, w którym działa aplikacja. Określając szablon bez Eksploratora i Eksploratora, można łatwo obsługiwać systemy Windows NT 3,51, Windows NT 4,0 i nowsze oraz system Windows 95 i nowsze wersje.

> [!NOTE]
> Okna dialogowe pliku stylu systemu Windows Vista lub nowszego nie obsługują tej funkcji. Próba użycia tej funkcji w oknie dialogowym plik stylu systemu Windows Vista lub nowszego spowoduje zgłoszenie [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Alternatywą jest użycie niestandardowego okna dialogowego. Aby uzyskać więcej informacji o używaniu `CFileDialog`niestandardowego, zobacz [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>CFileDialog:: StartVisualGroup

Deklaruje grupę wizualizacji w oknie dialogowym. Kolejne wywołania metody "Add" powodują dodanie tych elementów do tej grupy.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parametry

*dwIDCtl*<br/>
Identyfikator grupy wizualnej.

*strLabel*<br/>
Nazwa grupy.

### <a name="remarks"></a>Uwagi

##  <a name="updateofnfromshelldialog"></a>CFileDialog:: UpdateOFNFromShellDialog

Aktualizuje strukturę danych CFileDialog w oparciu o bieżący stan obiektu wewnętrznego. [](../../mfc/reference/cfiledialog-class.md) `m_ofn`

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Uwagi

W wersjach systemu Windows starszych niż Windows Vista, składowa [](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) struktury danych programu OPENFILENAME była stale synchronizowana ze stanem `CFileDialog`. Wszystkie zmiany zmiennej składowej [m_ofn](#m_ofn) bezpośrednio wpływają na stan okna dialogowego. Ponadto wszelkie zmiany stanu okna dialogowego są od razu aktualizowane zmienną członkowską m_ofn.

W systemie Windows Vista lub nowszym `m_ofn` struktura danych nie jest aktualizowana automatycznie. Aby zagwarantować dokładność danych w `m_ofn` zmiennej składowej, należy `UpdateOFNFromShellDialog` wywołać funkcję przed uzyskaniem dostępu do danych. System Windows automatycznie wywołuje tę funkcję podczas przetwarzania [IFileDialog:: OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Aby uzyskać więcej informacji na temat używania `CFileDialog` klasy w systemie Windows Vista lub nowszym, zobacz [CFileDialog class](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Przykład

Ten przykład aktualizuje `CFileDialog` program przed wyświetleniem go. Przed zaktualizowaniem `m_ofn` zmiennej składowej musimy ją zsynchronizować z bieżącym stanem okna dialogowego.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Zobacz także

[Klasa CCommonDialog](../../mfc/reference/ccommondialog-class.md)<br/>
[Wykres hierarchii](../../mfc/hierarchy-chart.md)
