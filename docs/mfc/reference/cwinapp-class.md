---
title: Klasa CWinApp | Dokumentacja firmy Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CWinApp
- AFXWIN/CWinApp
- AFXWIN/CWinApp::CWinApp
- AFXWIN/CWinApp::AddDocTemplate
- AFXWIN/CWinApp::AddToRecentFileList
- AFXWIN/CWinApp::ApplicationRecoveryCallback
- AFXWIN/CWinApp::CloseAllDocuments
- AFXWIN/CWinApp::CreatePrinterDC
- AFXWIN/CWinApp::DelRegTree
- AFXWIN/CWinApp::DoMessageBox
- AFXWIN/CWinApp::DoWaitCursor
- AFXWIN/CWinApp::EnableD2DSupport
- AFXWIN/CWinApp::EnableHtmlHelp
- AFXWIN/CWinApp::EnableTaskbarInteraction
- AFXWIN/CWinApp::ExitInstance
- AFXWIN/CWinApp::GetApplicationRecoveryParameter
- AFXWIN/CWinApp::GetApplicationRecoveryPingInterval
- AFXWIN/CWinApp::GetApplicationRestartFlags
- AFXWIN/CWinApp::GetAppRegistryKey
- AFXWIN/CWinApp::GetDataRecoveryHandler
- AFXWIN/CWinApp::GetFirstDocTemplatePosition
- AFXWIN/CWinApp::GetHelpMode
- AFXWIN/CWinApp::GetNextDocTemplate
- AFXWIN/CWinApp::GetPrinterDeviceDefaults
- AFXWIN/CWinApp::GetProfileBinary
- AFXWIN/CWinApp::GetProfileInt
- AFXWIN/CWinApp::GetProfileString
- AFXWIN/CWinApp::GetSectionKey
- AFXWIN/CWinApp::HideApplication
- AFXWIN/CWinApp::HtmlHelp
- AFXWIN/CWinApp::InitInstance
- AFXWIN/CWinApp::IsTaskbarInteractionEnabled
- AFXWIN/CWinApp::LoadCursor
- AFXWIN/CWinApp::LoadIcon
- AFXWIN/CWinApp::LoadOEMCursor
- AFXWIN/CWinApp::LoadOEMIcon
- AFXWIN/CWinApp::LoadStandardCursor
- AFXWIN/CWinApp::LoadStandardIcon
- AFXWIN/CWinApp::OnDDECommand
- AFXWIN/CWinApp::OnIdle
- AFXWIN/CWinApp::OpenDocumentFile
- AFXWIN/CWinApp::ParseCommandLine
- AFXWIN/CWinApp::PreTranslateMessage
- AFXWIN/CWinApp::ProcessMessageFilter
- AFXWIN/CWinApp::ProcessShellCommand
- AFXWIN/CWinApp::ProcessWndProcException
- AFXWIN/CWinApp::Register
- AFXWIN/CWinApp::RegisterWithRestartManager
- AFXWIN/CWinApp::ReopenPreviousFilesAtRestart
- AFXWIN/CWinApp::RestartInstance
- AFXWIN/CWinApp::RestoreAutosavedFilesAtRestart
- AFXWIN/CWinApp::Run
- AFXWIN/CWinApp::RunAutomated
- AFXWIN/CWinApp::RunEmbedded
- AFXWIN/CWinApp::SaveAllModified
- AFXWIN/CWinApp::SelectPrinter
- AFXWIN/CWinApp::SetHelpMode
- AFXWIN/CWinApp::SupportsApplicationRecovery
- AFXWIN/CWinApp::SupportsAutosaveAtInterval
- AFXWIN/CWinApp::SupportsAutosaveAtRestart
- AFXWIN/CWinApp::SupportsRestartManager
- AFXWIN/CWinApp::Unregister
- AFXWIN/CWinApp::WinHelp
- AFXWIN/CWinApp::WriteProfileBinary
- AFXWIN/CWinApp::WriteProfileInt
- AFXWIN/CWinApp::WriteProfileString
- AFXWIN/CWinApp::EnableShellOpen
- AFXWIN/CWinApp::LoadStdProfileSettings
- AFXWIN/CWinApp::OnContextHelp
- AFXWIN/CWinApp::OnFileNew
- AFXWIN/CWinApp::OnFileOpen
- AFXWIN/CWinApp::OnFilePrintSetup
- AFXWIN/CWinApp::OnHelp
- AFXWIN/CWinApp::OnHelpFinder
- AFXWIN/CWinApp::OnHelpIndex
- AFXWIN/CWinApp::OnHelpUsing
- AFXWIN/CWinApp::RegisterShellFileTypes
- AFXWIN/CWinApp::SetAppID
- AFXWIN/CWinApp::SetRegistryKey
- AFXWIN/CWinApp::UnregisterShellFileTypes
- AFXWIN/CWinApp::m_bHelpMode
- AFXWIN/CWinApp::m_eHelpType
- AFXWIN/CWinApp::m_hInstance
- AFXWIN/CWinApp::m_lpCmdLine
- AFXWIN/CWinApp::m_nCmdShow
- AFXWIN/CWinApp::m_pActiveWnd
- AFXWIN/CWinApp::m_pszAppID
- AFXWIN/CWinApp::m_pszAppName
- AFXWIN/CWinApp::m_pszExeName
- AFXWIN/CWinApp::m_pszHelpFilePath
- AFXWIN/CWinApp::m_pszProfileName
- AFXWIN/CWinApp::m_pszRegistryKey
- AFXWIN/CWinApp::m_dwRestartManagerSupportFlags
- AFXWIN/CWinApp::m_nAutosaveInterval
- AFXWIN/CWinApp::m_pDataRecoveryHandler
dev_langs:
- C++
helpviewer_keywords:
- CWinApp [MFC], CWinApp
- CWinApp [MFC], AddDocTemplate
- CWinApp [MFC], AddToRecentFileList
- CWinApp [MFC], ApplicationRecoveryCallback
- CWinApp [MFC], CloseAllDocuments
- CWinApp [MFC], CreatePrinterDC
- CWinApp [MFC], DelRegTree
- CWinApp [MFC], DoMessageBox
- CWinApp [MFC], DoWaitCursor
- CWinApp [MFC], EnableD2DSupport
- CWinApp [MFC], EnableHtmlHelp
- CWinApp [MFC], EnableTaskbarInteraction
- CWinApp [MFC], ExitInstance
- CWinApp [MFC], GetApplicationRecoveryParameter
- CWinApp [MFC], GetApplicationRecoveryPingInterval
- CWinApp [MFC], GetApplicationRestartFlags
- CWinApp [MFC], GetAppRegistryKey
- CWinApp [MFC], GetDataRecoveryHandler
- CWinApp [MFC], GetFirstDocTemplatePosition
- CWinApp [MFC], GetHelpMode
- CWinApp [MFC], GetNextDocTemplate
- CWinApp [MFC], GetPrinterDeviceDefaults
- CWinApp [MFC], GetProfileBinary
- CWinApp [MFC], GetProfileInt
- CWinApp [MFC], GetProfileString
- CWinApp [MFC], GetSectionKey
- CWinApp [MFC], HideApplication
- CWinApp [MFC], HtmlHelp
- CWinApp [MFC], InitInstance
- CWinApp [MFC], IsTaskbarInteractionEnabled
- CWinApp [MFC], LoadCursor
- CWinApp [MFC], LoadIcon
- CWinApp [MFC], LoadOEMCursor
- CWinApp [MFC], LoadOEMIcon
- CWinApp [MFC], LoadStandardCursor
- CWinApp [MFC], LoadStandardIcon
- CWinApp [MFC], OnDDECommand
- CWinApp [MFC], OnIdle
- CWinApp [MFC], OpenDocumentFile
- CWinApp [MFC], ParseCommandLine
- CWinApp [MFC], PreTranslateMessage
- CWinApp [MFC], ProcessMessageFilter
- CWinApp [MFC], ProcessShellCommand
- CWinApp [MFC], ProcessWndProcException
- CWinApp [MFC], Register
- CWinApp [MFC], RegisterWithRestartManager
- CWinApp [MFC], ReopenPreviousFilesAtRestart
- CWinApp [MFC], RestartInstance
- CWinApp [MFC], RestoreAutosavedFilesAtRestart
- CWinApp [MFC], Run
- CWinApp [MFC], RunAutomated
- CWinApp [MFC], RunEmbedded
- CWinApp [MFC], SaveAllModified
- CWinApp [MFC], SelectPrinter
- CWinApp [MFC], SetHelpMode
- CWinApp [MFC], SupportsApplicationRecovery
- CWinApp [MFC], SupportsAutosaveAtInterval
- CWinApp [MFC], SupportsAutosaveAtRestart
- CWinApp [MFC], SupportsRestartManager
- CWinApp [MFC], Unregister
- CWinApp [MFC], WinHelp
- CWinApp [MFC], WriteProfileBinary
- CWinApp [MFC], WriteProfileInt
- CWinApp [MFC], WriteProfileString
- CWinApp [MFC], EnableShellOpen
- CWinApp [MFC], LoadStdProfileSettings
- CWinApp [MFC], OnContextHelp
- CWinApp [MFC], OnFileNew
- CWinApp [MFC], OnFileOpen
- CWinApp [MFC], OnFilePrintSetup
- CWinApp [MFC], OnHelp
- CWinApp [MFC], OnHelpFinder
- CWinApp [MFC], OnHelpIndex
- CWinApp [MFC], OnHelpUsing
- CWinApp [MFC], RegisterShellFileTypes
- CWinApp [MFC], SetAppID
- CWinApp [MFC], SetRegistryKey
- CWinApp [MFC], UnregisterShellFileTypes
- CWinApp [MFC], m_bHelpMode
- CWinApp [MFC], m_eHelpType
- CWinApp [MFC], m_hInstance
- CWinApp [MFC], m_lpCmdLine
- CWinApp [MFC], m_nCmdShow
- CWinApp [MFC], m_pActiveWnd
- CWinApp [MFC], m_pszAppID
- CWinApp [MFC], m_pszAppName
- CWinApp [MFC], m_pszExeName
- CWinApp [MFC], m_pszHelpFilePath
- CWinApp [MFC], m_pszProfileName
- CWinApp [MFC], m_pszRegistryKey
- CWinApp [MFC], m_dwRestartManagerSupportFlags
- CWinApp [MFC], m_nAutosaveInterval
- CWinApp [MFC], m_pDataRecoveryHandler
ms.assetid: e426a3cd-0d15-40d6-bd55-beaa5feb2343
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 86adc1e2337b32ced77cafda92229ed9724ba548
ms.sourcegitcommit: a738519aa491a493a8f213971354356c0e6a5f3a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/05/2018
ms.locfileid: "48821520"
---
# <a name="cwinapp-class"></a>Klasa CWinApp

Klasa bazowa, z której pochodzi obiekt aplikacji Windows.

## <a name="syntax"></a>Składnia

```
class CWinApp : public CWinThread
```

## <a name="members"></a>Elementy członkowskie

### <a name="public-constructors"></a>Konstruktory publiczne

|Nazwa|Opis|
|----------|-----------------|
|[CWinApp::CWinApp](#cwinapp)|Konstruuje `CWinApp` obiektu.|

### <a name="public-methods"></a>Metody publiczne

|Nazwa|Opis|
|----------|-----------------|
|[CWinApp::AddDocTemplate](#adddoctemplate)|Dodaje szablon dokumentu do listy szablonów dokumentów dostępnych w aplikacji.|
|[CWinApp::AddToRecentFileList](#addtorecentfilelist)|Dodaje nazwę pliku do listy ostatnio używanych plików (MRU).|
|[CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback)|Wywoływane przez platformę, gdy aplikacja niespodziewanie kończy pracę.|
|[CWinApp::CloseAllDocuments](#closealldocuments)|Zamyka wszystkie otwarte dokumenty.|
|[CWinApp::CreatePrinterDC](#createprinterdc)|Tworzy kontekst urządzenia drukarki.|
|[CWinApp::DelRegTree](#delregtree)|Usuwa określony klucz i wszystkich jego podkluczy.|
|[CWinApp::DoMessageBox](#domessagebox)|Implementuje [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox) dla aplikacji.|
|[CWinApp::DoWaitCursor](#dowaitcursor)|Włącza kursor oczekiwania i wyłącza.|
|[CWinApp::EnableD2DSupport](#enabled2dsupport)|Włącza obsługę D2D aplikacji. Wywołaj tę metodę, zanim okno główne jest zainicjowany.|
|[CWinApp::EnableHtmlHelp](#enablehtmlhelp)|Implementuje HTMLHelp dla aplikacji, a nie pomocy systemu Windows.|
|[CWinApp::EnableTaskbarInteraction](#enabletaskbarinteraction)|Umożliwia interakcję z paska zadań.|
|[CWinApp::ExitInstance](#exitinstance)|Należy przesłonić, aby wyczyścić, gdy kończy działanie aplikacji.|
|[CWinApp::GetApplicationRecoveryParameter](#getapplicationrecoveryparameter)|Pobiera parametr wejściowy metody odzyskiwania aplikacji.|
|[CWinApp::GetApplicationRecoveryPingInterval](#getapplicationrecoverypinginterval)|Zwraca długość czas oczekiwania menedżera ponownego uruchamiania dla funkcji wywołania zwrotnego odzyskiwania do zwrócenia.|
|[CWinApp::GetApplicationRestartFlags](#getapplicationrestartflags)|Zwraca wartość flagi dla Menedżera ponownego uruchamiania.|
|[CWinApp::GetAppRegistryKey](#getappregistrykey)|Zwraca klucz HKEY_CURRENT_USER\\\RegistryKey\ProfileName "Oprogramowanie".|
|[CWinApp::GetDataRecoveryHandler](#getdatarecoveryhandler)|Pobiera program obsługi odzyskiwania danych dla tego wystąpienia aplikacji.|
|[CWinApp::GetFirstDocTemplatePosition](#getfirstdoctemplateposition)|Pobiera położenie pierwszego szablonu dokumentu.|
|[CWinApp::GetHelpMode](#gethelpmode)|Pobiera rodzaj pomocy używanych przez aplikację.|
|[CWinApp::GetNextDocTemplate](#getnextdoctemplate)|Pobiera położenie szablonu dokumentu. Mogą być używane cyklicznie.|
|[CWinApp::GetPrinterDeviceDefaults](#getprinterdevicedefaults)|Pobiera ustawienia domyślne urządzenia drukarki.|
|[CWinApp::GetProfileBinary](#getprofilebinary)|Pobiera dane binarne z wpisu w aplikacji. Pliku INI.|
|[CWinApp::GetProfileInt](#getprofileint)|Pobiera liczbę całkowitą z wpisu w aplikacji. Pliku INI.|
|[CWinApp::GetProfileString](#getprofilestring)|Pobiera ciąg z wpisu w aplikacji. Pliku INI.|
|[CWinApp::GetSectionKey](#getsectionkey)|Zwraca klucz HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection "Oprogramowanie".|
|[CWinApp::HideApplication](#hideapplication)|Ukrywa aplikację przed zamknięciem wszystkich dokumentów.|
|[CWinApp::HtmlHelp](#htmlhelp)|Wywołania `HTMLHelp` funkcji Windows.|
|[CWinApp::InitInstance](#initinstance)|Należy przesłonić, aby wykonać inicjowania wystąpienia Windows, takich jak tworzenie obiektów okna.|
|[CWinApp::IsTaskbarInteractionEnabled](#istaskbarinteractionenabled)|Informuje, czy włączono interakcji Windows 7 z paska zadań.|
|[CWinApp::LoadCursor](#loadcursor)|Ładuje zasobu kursora.|
|[CWinApp::LoadIcon](#loadicon)|Ładuje zasobu ikony.|
|[CWinApp::LoadOEMCursor](#loadoemcursor)|Ładunki Windows OEM wstępnie zdefiniowane kursora, **OCR_** stałe, określ w systemie WINDOWS. H.|
|[CWinApp::LoadOEMIcon](#loadoemicon)|Ładuje ikoną wstępnie zdefiniowanych Windows OEM, **OIC_** stałe, określ w systemie WINDOWS. H.|
|[CWinApp::LoadStandardCursor](#loadstandardcursor)|Ładunki Windows wstępnie zdefiniowane kursora, **IDC_** stałe, określ w systemie WINDOWS. H.|
|[CWinApp::LoadStandardIcon](#loadstandardicon)|Ładuje ikoną wstępnie zdefiniowanych Windows, **IDI_** stałe, określ w systemie WINDOWS. H.|
|[CWinApp::OnDDECommand](#onddecommand)|Wywoływane przez platformę w odpowiedzi na dynamiczne dane programu exchange (DDE) wykonaj polecenie.|
|[CWinApp::OnIdle](#onidle)|Należy przesłonić, aby wykonać przetwarzanie specyficzne dla aplikacji w czasie bezczynności (%).|
|[CWinApp::OpenDocumentFile](#opendocumentfile)|Metoda wywoływana przez platformę, by otworzyć dokument z pliku.|
|[CWinApp::ParseCommandLine](#parsecommandline)|Analizuje poszczególne parametry i flagi w wierszu polecenia.|
|[CWinApp::PreTranslateMessage](#pretranslatemessage)|Filtry komunikatów przed ich wysłaniem do funkcji Windows [TranslateMessage](/windows/desktop/api/winuser/nf-winuser-translatemessage) i [DispatchMessage](/windows/desktop/api/winuser/nf-winuser-dispatchmessage).|
|[CWinApp::ProcessMessageFilter](#processmessagefilter)|Przechwytuje niektóre komunikaty zanim osiągną one aplikację.|
|[CWinApp::ProcessShellCommand](#processshellcommand)|Obsługuje argumenty wiersza polecenia i flagi.|
|[CWinApp::ProcessWndProcException](#processwndprocexception)|Przechwytuje wszystkie nieobsługiwane wyjątki rzucane przez komunikat aplikacji i programy obsługi poleceń.|
|[CWinApp::Register](#register)|Wykonuje dostosowane rejestracji.|
|[CWinApp::RegisterWithRestartManager](#registerwithrestartmanager)|Rejestruje aplikację za pomocą Menedżera ponownego uruchamiania.|
|[CWinApp::ReopenPreviousFilesAtRestart](#reopenpreviousfilesatrestart)|Określa, czy Menedżera ponownego uruchamiania ponownie otwiera pliki, które były otwarte podczas nieoczekiwanie zakończył działanie aplikacji.|
|[CWinApp::RestartInstance](#restartinstance)|Obsługuje inicjowane przez Menedżera ponownego uruchamiania ponowne uruchomienie aplikacji.|
|[CWinApp::RestoreAutosavedFilesAtRestart](#restoreautosavedfilesatrestart)|Określa, czy Menedżera ponownego uruchamiania przywraca pliki, zapisana automatycznie po jej ponownym uruchomieniu aplikacji.|
|[CWinApp::Run](#run)|Uruchamia domyślną pętlę komunikatów. Należy przesłonić, aby dostosować pętli komunikatów.|
|[CWinApp::RunAutomated](#runautomated)|Testy z wiersza polecenia aplikacji **/Automation** opcji. Nieaktualne. Zamiast tego należy użyć wartości w [CCommandLineInfo::m_bRunAutomated](../../mfc/reference/ccommandlineinfo-class.md#m_brunautomated) po wywołaniu [ParseCommandLine](#parsecommandline).|
|[CWinApp::RunEmbedded](#runembedded)|Testy z wiersza polecenia aplikacji **/Embedding** opcji. Nieaktualne. Zamiast tego należy użyć wartości w [CCommandLineInfo::m_bRunEmbedded](../../mfc/reference/ccommandlineinfo-class.md#m_brunembedded) po wywołaniu [ParseCommandLine](#parsecommandline).|
|[CWinApp::SaveAllModified](#saveallmodified)|Monituje użytkownika o Zapisz wszystkie zmodyfikowane dokumenty.|
|[CWinApp::SelectPrinter](#selectprinter)|Wybiera drukarki z wcześniej wskazanego przez użytkownika za pomocą okna dialogowego drukowania.|
|[CWinApp::SetHelpMode](#sethelpmode)|Ustawia i inicjuje rodzaj pomocy używanych przez aplikację.|
|[CWinApp::SupportsApplicationRecovery](#supportsapplicationrecovery)|Określa, czy Menedżera ponownego uruchamiania przywraca aplikację, która został nieoczekiwanie zakończony.|
|[CWinApp::SupportsAutosaveAtInterval](#supportsautosaveatinterval)|Określa, czy automatycznie zapisuje Menedżera ponownego uruchamiania otwieranie dokumentów w regularnych odstępach czasu.|
|[CWinApp::SupportsAutosaveAtRestart](#supportsautosaveatrestart)|Określa, czy automatycznie zapisuje Menedżera ponownego uruchomienia wszelkich otwartych dokumentów, po ponownym uruchomieniu aplikacji.|
|[CWinApp::SupportsRestartManager](#supportsrestartmanager)|Określa, czy aplikacja obsługuje Menedżera ponownego uruchamiania.|
|[CWinApp::Unregister](#unregister)|Wyrejestrowuje wszystko, który został zarejestrowany przez `CWinApp` obiektu.|
|[CWinApp::WinHelp](#winhelp)|Wywołania `WinHelp` funkcji Windows.|
|[CWinApp::WriteProfileBinary](#writeprofilebinary)|Zapisuje dane binarne do zapisu w aplikacji. Pliku INI.|
|[CWinApp::WriteProfileInt](#writeprofileint)|Zapisuje liczbę całkowitą do zapisu w aplikacji. Pliku INI.|
|[CWinApp::WriteProfileString](#writeprofilestring)|Zapisuje ciąg do zapisu w aplikacji. Pliku INI.|

### <a name="protected-methods"></a>Metody chronione

|Nazwa|Opis|
|----------|-----------------|
|[CWinApp::EnableShellOpen](#enableshellopen)|Umożliwia użytkownikowi otwieranie plików danych z Menedżera plików Windows.|
|[CWinApp::LoadStdProfileSettings](#loadstdprofilesettings)|Standard obciążeń. Ustawienia pliku INI i umożliwia Przypinać pliku funkcji listy.|
|[CWinApp::OnContextHelp](#oncontexthelp)|Obsługuje SHIFT + F1 Pomoc w obrębie aplikacji.|
|[CWinApp::OnFileNew](#onfilenew)|Implementuje id_file_new — polecenie.|
|[CWinApp::OnFileOpen](#onfileopen)|Implementuje id_file_open — polecenie.|
|[CWinApp::OnFilePrintSetup](#onfileprintsetup)|Implementuje id_file_print_setup — polecenie.|
|[CWinApp::OnHelp](#onhelp)|Obsługuje pomocy F1 w aplikacji (przy użyciu bieżącego kontekstu).|
|[CWinApp::OnHelpFinder](#onhelpfinder)|Obsługuje polecenia ID_HELP_FINDER i id_default_help —.|
|[CWinApp::OnHelpIndex](#onhelpindex)|Id_help_index — polecenie obsługuje i udostępnia domyślny temat pomocy.|
|[CWinApp::OnHelpUsing](#onhelpusing)|Obsługuje id_help_using — polecenie.|
|[CWinApp::RegisterShellFileTypes](#registershellfiletypes)|Rejestruje wszystkie aplikacji typy dokumentów za pomocą Menedżera plików Windows.|
|[CWinApp::SetAppID](#setappid)|Jawnie Ustawia identyfikator modelu użytkownika aplikacji dla aplikacji. Ta metoda powinna być wywoływana przed żadnego interfejsu użytkownika są prezentowane użytkownikowi (najlepiej jest konstruktor aplikacji).|
|[CWinApp::SetRegistryKey](#setregistrykey)|Powoduje, że ustawienia aplikacji, które mają być przechowywane w rejestrze, a nie. Pliki INI.|
|[CWinApp::UnregisterShellFileTypes](#unregistershellfiletypes)|Wyrejestrowuje typy dokumentów wszystkich aplikacji za pomocą Menedżera plików Windows.|

### <a name="public-data-members"></a>Publiczne elementy członkowskie danych

|Nazwa|Opis|
|----------|-----------------|
|[CWinApp::m_bHelpMode](#m_bhelpmode)|Wskazuje, czy użytkownik jest w trybie kontekstu pomocy (zwykle wywoływani za pomocą SHIFT + F1).|
|[CWinApp::m_eHelpType](#m_ehelptype)|Określa typ pomocy używanych przez aplikację.|
|[CWinApp::m_hInstance](#m_hinstance)|Określa bieżące wystąpienie aplikacji.|
|[CWinApp::m_lpCmdLine](#m_lpcmdline)|Wskazuje ciąg zakończony znakiem null, który określa wiersz polecenia dla aplikacji.|
|[CWinApp::m_nCmdShow](#m_ncmdshow)|Określa, jak ma być wyświetlana w początkowym oknie.|
|[CWinApp::m_pActiveWnd](#m_pactivewnd)|Wskaźnik do głównego okna aplikacji kontenera, gdy jest aktywny w miejscu.|
|[CWinApp::m_pszAppID](#m_pszappid)|Identyfikator modelu użytkownika aplikacji|
|[CWinApp::m_pszAppName](#m_pszappname)|Określa nazwę aplikacji.|
|[CWinApp::m_pszExeName](#m_pszexename)|Nazwa modułu w aplikacji.|
|[CWinApp::m_pszHelpFilePath](#m_pszhelpfilepath)|Ścieżka do pliku pomocy w aplikacji.|
|[CWinApp::m_pszProfileName](#m_pszprofilename)|Aplikacji. Nazwa pliku INI.|
|[CWinApp::m_pszRegistryKey](#m_pszregistrykey)|Używany do określenia klucza rejestru pełną do przechowywania ustawień profilu aplikacji.|

### <a name="protected-data-members"></a>Chronione elementy członkowskie danych

|Nazwa|Opis|
|----------|-----------------|
|[CWinApp::m_dwRestartManagerSupportFlags](#m_dwrestartmanagersupportflags)|Flagi określające sposób działania Menedżera ponownego uruchamiania.|
|[CWinApp::m_nAutosaveInterval](#m_nautosaveinterval)|Długość czasu w milisekundach między automatycznie zapisuje.|
|[CWinApp::m_pDataRecoveryHandler](#m_pdatarecoveryhandler)|Wskaźnik do obsługi odzyskiwania danych aplikacji.|

## <a name="remarks"></a>Uwagi

Obiekt aplikacji dostarcza funkcji elementów członkowskich, do uruchamiania aplikacji i Inicjowanie aplikacji (i każde wystąpienie).

Każda aplikacja, która używa klas Microsoft Foundation może zawierać tylko jeden obiekt pochodzący od `CWinApp`. Ten obiekt jest tworzony, gdy są konstruowane na inne obiekty globalne w C++ i już jest dostępna, gdy wywołuje Windows `WinMain` funkcji, która jest dostarczana przez bibliotekę Microsoft Foundation Class. Zadeklaruj swoje pochodnej `CWinApp` obiektów na poziomie globalnym.

Po utworzeniu klasy pochodnej klasy aplikacji z `CWinApp`, Zastąp [InitInstance](#initinstance) funkcji elementu członkowskiego, aby utworzyć obiekt okna głównego aplikacji.

Oprócz `CWinApp` funkcji elementów członkowskich, biblioteki klas Microsoft Foundation udostępnia następujące funkcje globalne, aby uzyskać dostęp do Twojego `CWinApp` obiektu i inne informacje globalne:

- [Afxgetapp —](application-information-and-management.md#afxgetapp) uzyskuje wskaźnik do `CWinApp` obiektu.

- [Afxgetinstancehandle —](application-information-and-management.md#afxgetinstancehandle) uzyskuje obsługę bieżącego wystąpienia aplikacji.

- [Afxgetresourcehandle —](application-information-and-management.md#afxgetresourcehandle) uzyskuje obsługę zasobów aplikacji.

- [Afxgetappname —](application-information-and-management.md#afxgetappname) uzyskuje wskaźnik do ciągu zawierającego nazwę aplikacji. Alternatywnie Jeśli masz wskaźnik do `CWinApp` obiektu, należy użyć `m_pszExeName` można pobrać nazwy aplikacji.

Zobacz [CWinApp: klasa aplikacji](../../mfc/cwinapp-the-application-class.md) Aby uzyskać więcej informacji na temat `CWinApp` klasy, łącznie z omówieniem następujące czynności:

- `CWinApp`-pochodnych kodu napisanego przez Kreatora aplikacji.

- `CWinApp`w roli w kolejności wykonywania aplikacji.

- `CWinApp`jego domyślnej implementacji funkcji elementu członkowskiego.

- `CWinApp`dla klucza / / overridables.

`m_hPrevInstance` Element członkowski danych już nie istnieje. Aby uzyskać informacje na temat wykrywania poprzednie wystąpienie `CWinApp`, zobacz artykuł bazy wiedzy Knowledge Base "Jak do identyfikowania poprzedniego wystąpienia z Application" (KB106385) na [ http://support.microsoft.com/default.aspxscid=kb; 106385](http://support.microsoft.com/default.aspxscid=kb;106385).

## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

`CWinApp`

## <a name="requirements"></a>Wymagania

**Nagłówek:** afxwin.h

##  <a name="adddoctemplate"></a>  CWinApp::AddDocTemplate

Wywołaj tę funkcję elementu członkowskiego, aby dodać szablon dokumentu do listy szablonów dostępnych dokumentów, które obsługuje aplikacja.

```
void AddDocTemplate(CDocTemplate* pTemplate);
```

### <a name="parameters"></a>Parametry

*pTemplate*<br/>
Wskaźnik do `CDocTemplate` ma zostać dodana.

### <a name="remarks"></a>Uwagi

Należy dodać wszystkie szablony dla aplikacji dokumentów, przed wywołaniem [registershellfiletypes —](#registershellfiletypes).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#35](../../mfc/reference/codesnippet/cpp/cwinapp-class_1.cpp)]

##  <a name="addtorecentfilelist"></a>  CWinApp::AddToRecentFileList

Wywołaj tę funkcję elementu członkowskiego, aby dodać *lpszPathName* do listy ostatnio używanych plików.

```
virtual void AddToRecentFileList(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parametry

*lpszPathName*<br/>
Ścieżka pliku.

### <a name="remarks"></a>Uwagi

Należy wywołać [loadstdprofilesettings —](#loadstdprofilesettings) funkcja elementu członkowskiego do załadowania bieżącej listy ostatnio używanych elementów w pliku, zanim użyjesz tej funkcji elementu członkowskiego.

Struktura wywołuje tej funkcji elementu członkowskiego, gdy otworzy plik lub wykonuje polecenie Zapisz jako, aby zapisać plik pod nową nazwą.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#36](../../mfc/reference/codesnippet/cpp/cwinapp-class_2.cpp)]

##  <a name="applicationrecoverycallback"></a>  CWinApp::ApplicationRecoveryCallback

Wywoływane przez platformę, gdy aplikacja niespodziewanie kończy pracę.

```
virtual DWORD ApplicationRecoveryCallback(LPVOID lpvParam);
```

### <a name="parameters"></a>Parametry

*lpvParam*<br/>
[in] Zarezerwowane do użytku w przyszłości.

### <a name="return-value"></a>Wartość zwracana

0, jeśli ta metoda się powiedzie; różna od zera, jeśli wystąpi błąd.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja obsługuje Menedżera ponownego uruchamiania, struktura wywołuje tę funkcję, jeśli aplikacja niespodziewanie kończy pracę.

Domyślna implementacja klasy `ApplicationRecoveryCallback` używa `CDataRecoveryHandler` można zapisać rejestru listę aktualnie otwartych dokumentów. Ta metoda nie nie zapisywania wszystkich plików.

Aby dostosować zachowanie, należy przesłonić tę funkcję, w pochodnej [klasa CWinApp](../../mfc/reference/cwinapp-class.md) lub Przekaż swoją własną metodę odzyskiwania aplikacji jako parametr do [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).

##  <a name="closealldocuments"></a>  CWinApp::CloseAllDocuments

Wywołaj tę funkcję elementu członkowskiego, aby zamknąć wszystkie otwarte dokumenty przed zamknięciem.

```
void CloseAllDocuments(BOOL bEndSession);
```

### <a name="parameters"></a>Parametry

*bEndSession*<br/>
Określa, czy sesja Windows zostanie zakończona. Ma wartość TRUE, jeśli sesja zostanie zakończona; w przeciwnym razie wartość FALSE.

### <a name="remarks"></a>Uwagi

Wywołaj [HideApplication](#hideapplication) przed wywołaniem `CloseAllDocuments`.

##  <a name="createprinterdc"></a>  CWinApp::CreatePrinterDC

Wywołaj tę funkcję elementu członkowskiego, aby utworzyć drukarki kontekstu urządzenia (DC) na podstawie wybranej drukarki.

```
BOOL CreatePrinterDC(CDC& dc);
```

### <a name="parameters"></a>Parametry

*Kontroler domeny*<br/>
Odwołanie do kontekstu urządzenia drukarki.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli kontekst urządzenia drukarek został utworzony pomyślnie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

`CreatePrinterDC` inicjalizuje kontekst urządzenia, przekazywaną przez odwołanie, aby można było używać do drukowania.

Jeśli funkcja się powiedzie, po zakończeniu drukowania, użytkownik musi zniszczyć kontekstu urządzenia. Można pozwolić destruktor [CDC](../../mfc/reference/cdc-class.md) obiektu to zrobić, lub możesz zrobić to jawnie przez wywołanie metody [CDC::DeleteDC](../../mfc/reference/cdc-class.md#deletedc).

##  <a name="cwinapp"></a>  CWinApp::CWinApp

Konstruuje `CWinApp` obiektu i przekazuje *lpszAppName* mają być przechowywane jako nazwa aplikacji.

```
CWinApp(LPCTSTR lpszAppName = NULL);
```

### <a name="parameters"></a>Parametry

*lpszAppName*<br/>
Ciąg zakończony znakiem null, który zawiera nazwę aplikacji, która korzysta z Windows. Jeśli ten argument nie jest podany lub ma wartość NULL, `CWinApp` używa ciągu zasobu AFX_IDS_APP_TITLE lub nazwę pliku wykonywalnego.

### <a name="remarks"></a>Uwagi

Należy utworzyć jeden obiekt globalny swojej `CWinApp`-klasy pochodnej. Może mieć tylko jeden `CWinApp` obiektu w aplikacji. Konstruktor przechowuje wskaźnik do `CWinApp` obiektu, aby `WinMain` można wywołać elementu członkowskiego obiektu funkcji do zainicjowania i uruchomienia aplikacji.

##  <a name="delregtree"></a>  CWinApp::DelRegTree

Usuwa określonego klucza rejestru i wszystkich jego podkluczy.

```
LONG DelRegTree(
    HKEY hParentKey,
    const CString& strKeyName);

LONG DelRegTree(
    HKEY hParentKey,
    const CString& strKeyName,
    CAtlTransactionManager* pTM = NULL);
```

### <a name="parameters"></a>Parametry

*hParentKey*<br/>
Dojście do klucza rejestru.

*strKeyName*<br/>
Nazwa klucza rejestru do usunięcia.

*pTM*<br/>
Wskaźnik do obiektu CAtlTransactionManager.

### <a name="return-value"></a>Wartość zwracana

Jeśli funkcja się powiedzie, wartością zwracaną jest ERROR_SUCCESS. Jeśli funkcja zawiedzie, wartość zwracana jest kod błędu różny od zera określonych w pliku Winerror.h.

### <a name="remarks"></a>Uwagi

Wywołaj tę funkcję, aby usunąć określony klucz i jego podkluczach.

##  <a name="domessagebox"></a>  CWinApp::DoMessageBox

Struktura wywołuje tę funkcję elementu członkowskiego, aby zaimplementować okno komunikatu dla globalnych funkcji [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox).

```
virtual int DoMessageBox(
    LPCTSTR lpszPrompt,
    UINT nType,
    UINT nIDPrompt);
```

### <a name="parameters"></a>Parametry

*lpszPrompt*<br/>
Adres tekstu w oknie komunikatu.

*nNie*<br/>
W oknie komunikatu [styl](../../mfc/reference/styles-used-by-mfc.md#message-box-styles).

*nIDPrompt*<br/>
Indeks ciągu kontekstu pomocy.

### <a name="return-value"></a>Wartość zwracana

Zwraca takie same wartości jak `AfxMessageBox`.

### <a name="remarks"></a>Uwagi

Nie wywołuj tej funkcji elementu członkowskiego, aby otworzyć okno komunikatu; Użyj `AfxMessageBox` zamiast tego.

Zastąpienie tej funkcji elementu członkowskiego, aby dostosować przetwarzania całej aplikacji `AfxMessageBox` wywołania.

##  <a name="dowaitcursor"></a>  CWinApp::DoWaitCursor

Ta funkcja członkowska jest wywoływana przez platformę, by zaimplementować [CWaitCursor](../../mfc/reference/cwaitcursor-class.md), [CCmdTarget::BeginWaitCursor](../../mfc/reference/ccmdtarget-class.md#beginwaitcursor), [CCmdTarget::EndWaitCursor](../../mfc/reference/ccmdtarget-class.md#endwaitcursor), i [ CCmdTarget::RestoreWaitCursor](../../mfc/reference/ccmdtarget-class.md#restorewaitcursor).

```
virtual void DoWaitCursor(int nCode);
```

### <a name="parameters"></a>Parametry

*nCode*<br/>
Jeśli ten parametr ma wartość 1, pojawi się kursor oczekiwania. Jeśli jest to 0, kursor oczekiwania zostanie przywrócony bez zwiększania licznika odwołań. Jeśli wartość-1, kończy się kursor oczekiwania.

### <a name="remarks"></a>Uwagi

Domyślnie implementuje klepsydry kursora. `DoWaitCursor` przechowuje licznik odwołań. Gdy jest to dodatnia, wyświetlany jest klepsydry kursora.

Gdy użytkownik nie może wywołać zwykle `DoWaitCursor` bezpośrednio, możesz zastąpić tej funkcji elementu członkowskiego, aby zmienić kursor oczekiwania lub w celu dodatkowego przetwarzania, kiedy pojawi się kursor oczekiwania.

Łatwiejsze i usprawnić sposób implementacji kursor oczekiwania, można użyć `CWaitCursor`.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#37](../../mfc/reference/codesnippet/cpp/cwinapp-class_3.cpp)]

##  <a name="enabled2dsupport"></a>  CWinApp::EnableD2DSupport

Wymagany jest dodatek SP1 dla programu Visual Studio 2010.

Włącza obsługę D2D aplikacji. Wywołaj tę metodę, zanim okno główne jest zainicjowany.

```
BOOL EnableD2DSupport(
    D2D1_FACTORY_TYPE d2dFactoryType = D2D1_FACTORY_TYPE_SINGLE_THREADED,
    DWRITE_FACTORY_TYPE writeFactoryType = DWRITE_FACTORY_TYPE_SHARED);
```

### <a name="parameters"></a>Parametry

*d2dFactoryType*<br/>
Model wątkowości fabryki D2D i zasoby, które tworzy.

*writeFactoryType*<br/>
Wartość, która określa, czy obiekt fabryki zapisu zostaną udostępnione lub izolowany

### <a name="return-value"></a>Wartość zwracana

Zwraca wartość PRAWDA, jeśli obsługa D2D zostało włączone, wartość FALSE — w przeciwnym razie

##  <a name="enablehtmlhelp"></a>  CWinApp::EnableHtmlHelp

Wywołanie tej funkcji elementu członkowskiego z w Konstruktorze typu usługi `CWinApp`-pochodne klasy HTMLHelp pomocy Twojej aplikacji.

```
void EnableHtmlHelp();
```

### <a name="remarks"></a>Uwagi

##  <a name="enableshellopen"></a>  CWinApp::EnableShellOpen

Wywołaj tę funkcję, zazwyczaj z Twojej `InitInstance` zastąpienia, aby umożliwić użytkownikom otwieranie plików danych podczas ich pliki z Menedżera plików w Windows kliknij dwukrotnie ikonę aplikacji.

```
void EnableShellOpen();
```

### <a name="remarks"></a>Uwagi

Wywołaj `RegisterShellFileTypes` element członkowski funkcji w połączeniu z tej funkcji lub podaj. Plik REG za pomocą aplikacji do ręcznej rejestracji typów dokumentów.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#38](../../mfc/reference/codesnippet/cpp/cwinapp-class_4.cpp)]

##  <a name="enabletaskbarinteraction"></a>  CWinApp::EnableTaskbarInteraction

Umożliwia interakcję z paska zadań.

```
BOOL EnableTaskbarInteraction(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parametry

*bWłączenie*<br/>
Określa, czy interakcji z paska zadań Windows 7 powinny być włączone (TRUE) lub wyłączony (FALSE).

### <a name="return-value"></a>Wartość zwracana

Zwraca wartość PRAWDA, jeśli interakcji z paska zadań można włączać lub wyłączać.

### <a name="remarks"></a>Uwagi

Ta metoda musi zostać wywołana przed utworzeniem okna głównego, w przeciwnym razie jego potwierdzenia i zwraca wartość FALSE.

##  <a name="exitinstance"></a>  CWinApp::ExitInstance

Wywoływane przez platformę, z poziomu `Run` funkcję elementu członkowskiego, aby wyjść z tego wystąpienia aplikacji.

```
virtual int ExitInstance();
```

### <a name="return-value"></a>Wartość zwracana

Kod zakończenia aplikacji; 0 oznacza brak błędów i wartości jest większa niż 0 wskazuje błąd. Ta wartość jest używana jako wartość zwrotną z elementu `WinMain`.

### <a name="remarks"></a>Uwagi

Nie wywołuj tej funkcji elementu członkowskiego z dowolnego miejsca ale poziomu `Run` funkcja elementu członkowskiego.

Domyślna implementacja tej funkcji zapisuje opcje struktury aplikacji. Pliku INI. Należy przesłonić tę funkcję, aby wyczyścić, gdy kończy działanie aplikacji.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#39](../../mfc/reference/codesnippet/cpp/cwinapp-class_5.cpp)]

##  <a name="getapplicationrecoveryparameter"></a>  CWinApp::GetApplicationRecoveryParameter

Pobiera parametr wejściowy metody odzyskiwania aplikacji.

```
virtual LPVOID GetApplicationRecoveryParameter();
```

### <a name="return-value"></a>Wartość zwracana

Domyślnego parametru wejściowego dla metody odzyskiwania aplikacji.

### <a name="remarks"></a>Uwagi

Domyślne zachowanie to funkcja zwraca wartość NULL.

Aby uzyskać więcej informacji, zobacz [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).

##  <a name="getapplicationrecoverypinginterval"></a>  CWinApp::GetApplicationRecoveryPingInterval

Zwraca długość czas oczekiwania menedżera ponownego uruchamiania dla funkcji wywołania zwrotnego odzyskiwania do zwrócenia.

```
virtual DWORD GetApplicationRecoveryPingInterval();
```

### <a name="return-value"></a>Wartość zwracana

Długość czasu w milisekundach.

### <a name="remarks"></a>Uwagi

Gdy aplikacja, która jest zarejestrowana nieoczekiwanie wyjścia Menedżera ponownego uruchamiania, aplikacja próbuje zapisać otwarte dokumenty i wywołuje funkcję wywołania zwrotnego odzyskiwania. Domyślnej funkcji wywołania zwrotnego odzyskiwania jest [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).

Czas oczekiwania w ramach funkcji wywołania zwrotnego odzyskiwania powrócić jest interwałem ping. Interwał ping można dostosować poprzez zastąpienie `CWinApp::GetApplicationRecoveryPingInterval` lub dodając niestandardową wartość do `RegisterWithRestartManager`.

##  <a name="getapplicationrestartflags"></a>  CWinApp::GetApplicationRestartFlags

Zwraca wartość flagi dla Menedżera ponownego uruchamiania.

```
virtual DWORD GetApplicationRestartFlags();
```

### <a name="return-value"></a>Wartość zwracana

Flagi dla Menedżera ponownego uruchamiania. Domyślna implementacja zwraca wartość 0.

### <a name="remarks"></a>Uwagi

Flagi dla Menedżera ponownego uruchamiania nie mają wpływu implementacją domyślną. Są one udostępniane do użycia w przyszłości.

Ustaw flagi podczas rejestrowania aplikacji za pomocą Menedżera ponownego uruchamiania przy użyciu [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).

Możliwe wartości dla flag Menedżera ponownego uruchamiania są następujące:

- RESTART_NO_CRASH

- RESTART_NO_HANG

- RESTART_NO_PATCH

- RESTART_NO_REBOOT

##  <a name="getappregistrykey"></a>  CWinApp::GetAppRegistryKey

Zwraca klucz HKEY_CURRENT_USER\\\RegistryKey\ProfileName "Oprogramowanie".

```
HKEY GetAppRegistryKey(CAtlTransactionManager* pTM = NULL);
```

### <a name="parameters"></a>Parametry

*pTM*<br/>
Wskaźnik do `CAtlTransactionManager` obiektu.

### <a name="return-value"></a>Wartość zwracana

Klucz aplikacji, jeśli funkcja się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

##  <a name="getdatarecoveryhandler"></a>  CWinApp::GetDataRecoveryHandler

Pobiera program obsługi odzyskiwania danych dla tego wystąpienia aplikacji.

```
virtual CDataRecoveryHandler *GetDataRecoveryHandler();
```

### <a name="return-value"></a>Wartość zwracana

Obsługa odzyskiwania danych dla tego wystąpienia aplikacji.

### <a name="remarks"></a>Uwagi

Każda aplikacja, który używa Menedżera ponownego uruchamiania musi mieć jedno wystąpienie [klasa CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md). Ta klasa jest odpowiedzialny za monitorowanie otwarte dokumenty i automatyczne zapisywanie plików. Zachowanie `CDataRecoveryHandler` zależy od konfiguracji Menedżera ponownego uruchamiania. Aby uzyskać więcej informacji, zobacz [klasa CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md).

Ta metoda zwraca wartość NULL w systemach operacyjnych starszych niż Windows Vista. Menedżera ponownego uruchamiania nie jest obsługiwana w systemach operacyjnych starszych niż Windows Vista.

Jeśli aplikacja nie ma obecnie Obsługa odzyskiwania danych, ta metoda tworzy i zwraca wskaźnik do niego.

##  <a name="getfirstdoctemplateposition"></a>  CWinApp::GetFirstDocTemplatePosition

Pobiera położenie pierwszego szablonu dokumentu w aplikacji.

```
POSITION GetFirstDocTemplatePosition() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość pozycji, która może służyć do iteracji lub pobieranie wskaźnika obiektu; Wartość NULL, jeśli lista jest pusta.

### <a name="remarks"></a>Uwagi

Użyj zwracana wartość pozycji w wywołaniu [GetNextDocTemplate](#getnextdoctemplate) można pobrać pierwszy [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) obiektu.

##  <a name="gethelpmode"></a>  CWinApp::GetHelpMode

Pobiera rodzaj pomocy używanych przez aplikację.

```
AFX_HELP_TYPE GetHelpMode();
```

### <a name="return-value"></a>Wartość zwracana

Typ pomocy używanych przez aplikację. Zobacz [CWinApp::m_eHelpType](#m_ehelptype) Aby uzyskać więcej informacji.

##  <a name="getnextdoctemplate"></a>  CWinApp::GetNextDocTemplate

Pobiera szablon dokument identyfikowany przez *pos*, następnie ustawia *pos* wartości pozycji.

```
CDocTemplate* GetNextDocTemplate(POSITION& pos) const;
```

### <a name="parameters"></a>Parametry

*punktu sprzedaży*<br/>
Odwołanie do wartości pozycji, zwrócony przez poprzednie wywołanie `GetNextDocTemplate` lub [GetFirstDocTemplatePosition](#getfirstdoctemplateposition). Wartość jest aktualizowana do następnej pozycji przez to wywołanie.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) obiektu.

### <a name="remarks"></a>Uwagi

Możesz użyć `GetNextDocTemplate` w pętli do przodu iteracji, jeśli ustanowisz początkowe położenie w wyniku wywołania `GetFirstDocTemplatePosition`.

Należy się upewnić, że wartość pozycji jest prawidłowy. Jeśli jest nieprawidłowy, deklaracji rozkazujących wersję debugowania biblioteki klas Microsoft Foundation.

Jeśli szablon pobrany dokumentu, który jest ostatnim dostępne, następnie nowa wartość *pos* ma wartość NULL.

##  <a name="getprinterdevicedefaults"></a>  CWinApp::GetPrinterDeviceDefaults

Wywołaj tę funkcję elementu członkowskiego, aby przygotować drukarki kontekst urządzenia do drukowania.

```
BOOL GetPrinterDeviceDefaults(struct tagPDA* pPrintDlg);
```

### <a name="parameters"></a>Parametry

*pPrintDlg*<br/>
Wskaźnik do [PRINTDLG](/windows/desktop/api/commdlg/ns-commdlg-tagpda) struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Pobiera bieżące ustawienia domyślne drukarki z Windows. Plik INI jako wymagane lub korzysta z ostatnią konfiguracją drukarki ustawiony przez użytkownika w Instalatorze drukowania.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#40](../../mfc/reference/codesnippet/cpp/cwinapp-class_6.cpp)]

##  <a name="getprofilebinary"></a>  CWinApp::GetProfileBinary

Wywołaj tę funkcję elementu członkowskiego do pobierania danych binarnych z wpisu w określonej sekcji rejestru w aplikacji lub. Pliku INI.

```
BOOL GetProfileBinary(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parametry

*lpszSection*<br/>
Wskazuje ciąg zakończony znakiem null określa sekcję zawierającą wpis.

*lpszEntry*<br/>
Wskazuje ciąg zakończony wartością null zawierający wpis, którego wartość ma zostać pobrane.

*ppData*<br/>
Wskazuje na wskaźnik, który będą wysyłane na adres danych.

*pBytes*<br/>
Wskazuje UINT, który będzie otrzymywał rozmiar danych (w bajtach).

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Ta funkcja elementu członkowskiego nie jest wielkość liter, dlatego ciągów w *lpszSection* i *lpszEntry* parametry mogą się różnić w przypadku.

> [!NOTE]
> `GetProfileBinary` przydziela bufor i zwraca jego adres w \* *ppData*. Obiekt wywołujący jest odpowiedzialny za zwalniania bufora, za pomocą **delete []**.

> [!IMPORTANT]
> Dane zwracane przez tę funkcję, nie jest zawsze wartość NULL zakończone i obiekt wywołujący musi wykonać sprawdzanie poprawności. Aby uzyskać więcej informacji, zobacz [unikanie przepełnień bufora](/windows/desktop/SecBP/avoiding-buffer-overruns).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#41](../../mfc/reference/codesnippet/cpp/cwinapp-class_7.cpp)]

Na przykład dodatkowe zobacz [CWinApp::WriteProfileBinary](#writeprofilebinary).

##  <a name="getprofileint"></a>  CWinApp::GetProfileInt

Wywołaj tę funkcję elementu członkowskiego, aby pobrać wartość liczby całkowitej z wpisu w określonej sekcji rejestru w aplikacji lub. Pliku INI.

```
UINT GetProfileInt(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    int nDefault);
```

### <a name="parameters"></a>Parametry

*lpszSection*<br/>
Wskazuje ciąg zakończony znakiem null określa sekcję zawierającą wpis.

*lpszEntry*<br/>
Wskazuje ciąg zakończony wartością null zawierający wpis, którego wartość ma zostać pobrane.

*nDefault*<br/>
Określa domyślną wartość do zwrócenia, jeśli struktura nie może znaleźć wpisu.

### <a name="return-value"></a>Wartość zwracana

Wartość liczby całkowitej, ciągu, który następuje po określonego wpisu, jeśli funkcja się powiedzie. Wartość zwracana jest wartość *nDefault* parametru, jeśli funkcja nie może znaleźć wpisu. Wartość zwracana to 0, jeśli wartość, która odnosi się do określonego wpisu nie jest liczbą całkowitą.

Ta funkcja elementu członkowskiego obsługę wartości w zapisie szesnastkowym. Pliku INI. Po pobraniu liczba całkowita ze znakiem, należy rzutować wartości do **int**.

### <a name="remarks"></a>Uwagi

Ta funkcja elementu członkowskiego nie jest wielkość liter, dlatego ciągów w *lpszSection* i *lpszEntry* parametry mogą się różnić w przypadku.

> [!IMPORTANT]
> Dane zwracane przez tę funkcję, nie jest zawsze wartość NULL zakończone i obiekt wywołujący musi wykonać sprawdzanie poprawności. Aby uzyskać więcej informacji, zobacz [unikanie przepełnień bufora](/windows/desktop/SecBP/avoiding-buffer-overruns).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#42](../../mfc/reference/codesnippet/cpp/cwinapp-class_8.cpp)]

Na przykład dodatkowe zobacz [CWinApp::WriteProfileInt](#writeprofileint).

##  <a name="getprofilestring"></a>  CWinApp::GetProfileString

Wywołaj tę funkcję elementu członkowskiego, można pobrać ciągu skojarzonego z wpisu w określonej sekcji w rejestrze aplikacji lub. Pliku INI.

```
CString GetProfileString(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = NULL);
```

### <a name="parameters"></a>Parametry

*lpszSection*<br/>
Wskazuje ciąg zakończony znakiem null określa sekcję zawierającą wpis.

*lpszEntry*<br/>
Wskazuje ciąg zakończony wartością null zawierający wpis, w ciągu którego ma być pobrana. Ta wartość nie może być równa NULL.

*lpszDefault*<br/>
Wskazuje domyślną wartość ciągu dla danego wpisu, jeśli nie można odnaleźć wpisu w pliku inicjującym.

### <a name="return-value"></a>Wartość zwracana

Wartość zwracana jest ciąg, z aplikacji. Plik INI lub *lpszDefault* Jeśli nie można odnaleźć ciągu. Maksymalna długość ciągu obsługiwany przez platformę, jest _MAX_PATH. Jeśli *lpszDefault* ma wartość NULL, wartość zwracana jest ciągiem pustym.

### <a name="remarks"></a>Uwagi

> [!IMPORTANT]
> Dane zwracane przez tę funkcję, nie jest zawsze wartość NULL zakończone i obiekt wywołujący musi wykonać sprawdzanie poprawności. Aby uzyskać więcej informacji, zobacz [unikanie przepełnień bufora](/windows/desktop/SecBP/avoiding-buffer-overruns).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]

Inny przykład, zobacz przykład [CWinApp::GetProfileInt](#getprofileint).

##  <a name="getsectionkey"></a>  CWinApp::GetSectionKey

Zwraca klucz HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection "Oprogramowanie".

```
HKEY GetSectionKey(
    LPCTSTR lpszSection,
    CAtlTransactionManager* pTM = NULL);
```

### <a name="parameters"></a>Parametry

*lpszSection*<br/>
Nazwa klucza, które mają zostać uzyskane.

*pTM*<br/>
Wskaźnik do `CAtlTransactionManager` obiektu.

### <a name="return-value"></a>Wartość zwracana

Klucz sekcji, jeśli funkcja się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

##  <a name="hideapplication"></a>  CWinApp::HideApplication

Wywołaj tę funkcję elementu członkowskiego, aby ukryć aplikacji przed zamknięciem otwartych dokumentów.

```
void HideApplication();
```

##  <a name="htmlhelp"></a>  CWinApp::HtmlHelp

Wywołaj tę funkcję elementu członkowskiego, aby wywołać aplikacji HTMLHelp.

```
virtual void HtmlHelp(
    DWORD_PTR dwData,
    UINT nCmd = 0x000F);
```

### <a name="parameters"></a>Parametry

*dwData*<br/>
Określa dodatkowe dane. Wartość zależy od wartości *nCmd* parametru.

*nCmd*<br/>
Określa typ żądanego pomocy. Aby uzyskać listę możliwych wartości i ich wpływ *dwData* parametrów, zobacz *uCommand* parametru opisanego w o HTMLHelp funkcji interfejsu API w zestawie Windows SDK.

### <a name="remarks"></a>Uwagi

Struktura również wywołuje tę funkcję, aby wywołać aplikacji HTMLHelp.

Struktura zostanie automatycznie zamknięte aplikacji HTMLHelp, gdy kończy działanie aplikacji.

##  <a name="initinstance"></a>  CWinApp::InitInstance

Windows umożliwia wiele kopii tych samych program do uruchomienia w tym samym czasie.

```
virtual BOOL InitInstance();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli inicjowanie zakończy się; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Inicjowanie aplikacji pod względem koncepcyjnym jest podzielona na dwie sekcje: inicjowanie jednorazowe aplikacji, którą można wykonać tylko pierwszy czasu program zostanie uruchomiony, a następnie inicjowanie wystąpienia uruchamia każdego czasu kopię program zostanie uruchomiony, w tym po raz pierwszy. Implementacja struktury `WinMain` wywołuje tę funkcję.

Zastąp `InitInstance` zainicjować każde nowe wystąpienie aplikacji uruchomionej w obszarze Windows. Zazwyczaj można zastąpić `InitInstance` do konstruowania obiektu głównego okna i ustaw `CWinThread::m_pMainWnd` element członkowski danych wskaż tego okna. Aby uzyskać więcej informacji w przypadku przesłaniania tej funkcji elementu członkowskiego, zobacz [CWinApp: klasa aplikacji](../../mfc/cwinapp-the-application-class.md).

> [!NOTE]
> Aplikacji MFC muszą być zainicjowane w formacie komórek wielowątkowych pojedynczego (STA). Jeśli wywołasz [CoInitializeEx](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) w swojej `InitInstance` zastąpienia, określ COINIT_APARTMENTTHREADED (zamiast COINIT_MULTITHREADED). Aby uzyskać więcej informacji, zobacz PRB: Aplikacja MFC przestaje odpowiadać podczas inicjowania aplikacji jako wielowątkowe apartamentu (828643) na [ http://support.microsoft.com/default.aspxscid=kb; 828643](http://support.microsoft.com/default.aspxscid=kb;828643).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCListView#9](../../atl/reference/codesnippet/cpp/cwinapp-class_10.cpp)]

##  <a name="istaskbarinteractionenabled"></a>  CWinApp::IsTaskbarInteractionEnabled

Informuje, czy włączono interakcji Windows 7 z paska zadań.

```
virtual BOOL IsTaskbarInteractionEnabled();
```

### <a name="return-value"></a>Wartość zwracana

Zwraca wartość PRAWDA, jeśli `EnableTaskbarInteraction` została wywołana i systemu operacyjnego jest Windows 7 lub nowszy.

### <a name="remarks"></a>Uwagi

Interakcja paska zadań oznacza, że aplikacja MDI Wyświetla zawartość elementów podrzędnych MDI w oddzielnych miniatur z kartami, które są wyświetlane, gdy wskaźnik myszy znajduje się nad przycisk na pasku zadań aplikacji.

##  <a name="loadcursor"></a>  CWinApp::LoadCursor

Ładuje zasobu kursora o nazwie określonej przez *lpszResourceName* lub został określony przez *nIDResource* z bieżącego pliku wykonywalnego.

```
HCURSOR LoadCursor(LPCTSTR lpszResourceName) const;  HCURSOR LoadCursor(UINT nIDResource) const;
```

### <a name="parameters"></a>Parametry

*lpszResourceName*<br/>
Wskazuje ciąg zakończony znakiem null, który zawiera nazwę zasobu kursora. Możesz użyć `CString` dla tego argumentu.

*nIDResource*<br/>
Identyfikator zasobu kursora. Aby uzyskać listę zasobów, zobacz [LoadCursor](/windows/desktop/api/winuser/nf-winuser-loadcursora) w zestawie Windows SDK.

### <a name="return-value"></a>Wartość zwracana

Dojście do kursora, jeśli to się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

`LoadCursor` ładuje kursor do pamięci tylko wtedy, gdy nie został wcześniej załadowany; w przeciwnym razie pobiera uchwyt istniejącego zasobu.

Użyj [LoadStandardCursor](#loadstandardcursor) lub [LoadOEMCursor](#loadoemcursor) funkcja elementu członkowskiego na dostęp do wstępnie zdefiniowanych kursory Windows.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#44](../../mfc/reference/codesnippet/cpp/cwinapp-class_11.cpp)]

##  <a name="loadicon"></a>  CWinApp::LoadIcon

Ładuje zasobu ikony o nazwie określonej przez *lpszResourceName* lub został określony przez *nIDResource* z pliku wykonywalnego.

```
HICON LoadIcon(LPCTSTR lpszResourceName) const;  HICON LoadIcon(UINT nIDResource) const;
```

### <a name="parameters"></a>Parametry

*lpszResourceName*<br/>
Wskazuje ciąg zakończony znakiem null, który zawiera nazwę zasobu ikony. Można również użyć `CString` dla tego argumentu.

*nIDResource*<br/>
Identyfikator zasobu ikony.

### <a name="return-value"></a>Wartość zwracana

Dojście do ikony, jeśli to się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

`LoadIcon` ładuje ikonę tylko wtedy, gdy nie został wcześniej załadowany; w przeciwnym razie pobiera uchwyt istniejącego zasobu.

Możesz użyć [LoadStandardIcon](#loadstandardicon) lub [LoadOEMIcon](#loadoemicon) funkcja elementu członkowskiego, aby uzyskać dostęp do wstępnie zdefiniowanych ikon Windows.

> [!NOTE]
> Ta funkcja elementu członkowskiego wywołuje funkcję Win32 API [LoadIcon](/windows/desktop/api/winuser/nf-winuser-loadicona), który może ładować wyłącznie ikony, którego rozmiar jest zgodny z wartości metryk systemu SM_CXICON i SM_CYICON.

##  <a name="loadoemcursor"></a>  CWinApp::LoadOEMCursor

Ładunki Windows wstępnie zdefiniowane kursora zasób określony przez *nIDCursor*.

```
HCURSOR LoadOEMCursor(UINT nIDCursor) const;
```

### <a name="parameters"></a>Parametry

*nIDCursor*<br/>
**OCR_** manifestu stałych identyfikatora, który określa wstępnie zdefiniowanych kursora Windows. Konieczne jest posiadanie `#define OEMRESOURCE` przed `#include \<afxwin.h>` do uzyskania dostępu do **OCR_** stałe w systemie WINDOWS. H.

### <a name="return-value"></a>Wartość zwracana

Dojście do kursora, jeśli to się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

Użyj `LoadOEMCursor` lub [LoadStandardCursor](#loadstandardcursor) funkcja elementu członkowskiego na dostęp do wstępnie zdefiniowanych kursory Windows.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#45](../../mfc/reference/codesnippet/cpp/cwinapp-class_12.h)]

[!code-cpp[NVC_MFCWindowing#46](../../mfc/reference/codesnippet/cpp/cwinapp-class_13.cpp)]

##  <a name="loadoemicon"></a>  CWinApp::LoadOEMIcon

Ładunki Windows wstępnie zdefiniowane zasobu ikony określony przez *nIDIcon*.

```
HICON LoadOEMIcon(UINT nIDIcon) const;
```

### <a name="parameters"></a>Parametry

*nIDIcon*<br/>
**OIC_** manifestu stałych identyfikatora, który określa wstępnie zdefiniowanych ikonę Windows. Konieczne jest posiadanie `#define OEMRESOURCE` przed `#include \<afxwin.h>` dostęp do **OIC_** stałe w systemie WINDOWS. H.

### <a name="return-value"></a>Wartość zwracana

Dojście do ikony, jeśli to się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

Użyj `LoadOEMIcon` lub [LoadStandardIcon](#loadstandardicon) funkcja elementu członkowskiego, aby uzyskać dostęp do wstępnie zdefiniowanych ikon Windows.

##  <a name="loadstandardcursor"></a>  CWinApp::LoadStandardCursor

Ładunki Windows wstępnie zdefiniowane zasobu kursora, *lpszCursorName* określa.

```
HCURSOR LoadStandardCursor(LPCTSTR lpszCursorName) const;
```

### <a name="parameters"></a>Parametry

*lpszCursorName*<br/>
**IDC_** manifestu stałych identyfikatora, który określa wstępnie zdefiniowanych kursora Windows. Te identyfikatory są definiowane w systemie WINDOWS. H. Na poniższej liście przedstawiono możliwe wartości wstępnie zdefiniowane i znaczenie dla *lpszCursorName*:

- Standardowa IDC_ARROW kursora strzałkę

- Standardowa IDC_IBEAM kursora Wstawianie tekstu

- Kursor Klepsydra IDC_WAIT używany, gdy Windows wykonuje czasochłonne zadanie

- Kursor krzyżyk IDC_CROSS dla zaznaczenia

- Strzałka w IDC_UPARROW górę

- Przestarzałe IDC_SIZE i nieobsługiwane; Użyj IDC_SIZEALL

- IDC_SIZEALL element wskazywany przez cztery strzałki. Kursor służące do zmiany rozmiaru okna.

- Przestarzałe IDC_ICON i nieobsługiwane. Użyj IDC_ARROW.

- IDC_SIZENWSE Podwójna strzałka z punktami końcowymi, w lewym górnym rogu i prawym dolnym

- IDC_SIZENESW Podwójna strzałka z punktami końcowymi, w lewym górnym rogu i niższy

- Strzałki dwukierunkowej IDC_SIZEWE poziome

- Strzałki dwukierunkowej IDC_SIZENS pionowy

### <a name="return-value"></a>Wartość zwracana

Dojście do kursora, jeśli to się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

Użyj `LoadStandardCursor` lub [LoadOEMCursor](#loadoemcursor) funkcja elementu członkowskiego na dostęp do wstępnie zdefiniowanych kursory Windows.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#47](../../mfc/reference/codesnippet/cpp/cwinapp-class_14.cpp)]

##  <a name="loadstandardicon"></a>  CWinApp::LoadStandardIcon

Ładunki Windows wstępnie zdefiniowane zasobu ikony, *lpszIconName* określa.

```
HICON LoadStandardIcon(LPCTSTR lpszIconName) const;
```

### <a name="parameters"></a>Parametry

*lpszIconName*<br/>
Manifestu identyfikator stałej określa wstępnie zdefiniowanych ikonę Windows. Te identyfikatory są definiowane w systemie WINDOWS. H. Aby uzyskać listę możliwych wartości wstępnie zdefiniowane i ich opisów, zobacz *lpIconName* parametru w [LoadIcon](/windows/desktop/api/winuser/nf-winuser-loadicona) w zestawie Windows SDK.

### <a name="return-value"></a>Wartość zwracana

Dojście do ikony, jeśli to się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

Użyj `LoadStandardIcon` lub [LoadOEMIcon](#loadoemicon) funkcja elementu członkowskiego, aby uzyskać dostęp do wstępnie zdefiniowanych ikon Windows.

##  <a name="loadstdprofilesettings"></a>  CWinApp::LoadStdProfileSettings

Wywołaj tę funkcję elementu członkowskiego z poziomu [InitInstance](#initinstance) funkcja elementu członkowskiego, aby włączyć i załadować listy ostatnio używanych plików (MRU) i ostatniej wersji zapoznawczej stanu.

```
void LoadStdProfileSettings(UINT nMaxMRU = _AFX_MRU_COUNT);
```

### <a name="parameters"></a>Parametry

*nMaxMRU*<br/>
Liczba ostatnio używanych plików do śledzenia.

### <a name="remarks"></a>Uwagi

Jeśli *nMaxMRU* wynosi 0, zostaną zachowane bez listy ostatnio używanych elementów.

##  <a name="m_bhelpmode"></a>  CWinApp::m_bHelpMode

Wartość TRUE, jeśli aplikacja jest w trybie kontekstu pomocy (tradycyjnie wywołana z SHIFT + F1); w przeciwnym razie wartość FALSE.

```
BOOL m_bHelpMode;
```

### <a name="remarks"></a>Uwagi

W trybie kontekstu pomocy kursor staje się znak zapytania, a użytkownik może przemieszczać go o ekranu. Sprawdź tę flagę, jeśli chcesz zaimplementować specjalnej obsługi w trybie pomocy. `m_bHelpMode` jest publiczną zmienną typu wartość logiczna.

##  <a name="m_dwrestartmanagersupportflags"></a>  CWinApp::m_dwRestartManagerSupportFlags

Flagi określające sposób działania Menedżera ponownego uruchamiania.

```
DWORD m_dwRestartManagerSupportFlags;
```

### <a name="remarks"></a>Uwagi

Aby włączyć Menedżera ponownego uruchamiania, ustaw `m_dwRestartManagerSupportFlags` zachowanie, który ma. W poniższej tabeli przedstawiono flagi, które są dostępne.

|||
|-|-|
|Flaga|Opis|
|AFX_RESTART_MANAGER_SUPPORT_RESTART|Aplikacja jest zarejestrowana za pomocą [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager). Menedżera ponownego uruchamiania jest odpowiedzialny za ponowne uruchomienie aplikacji, jeśli jego niespodziewanie kończy pracę.|
|-AFX_RESTART_MANAGER_SUPPORT_RECOVERY|Aplikacja jest zarejestrowana przy użyciu Menedżera ponownego uruchamiania i Menedżera ponownego uruchamiania wywołuje funkcję wywołania zwrotnego odzyskiwania, po jej ponownym uruchomieniu aplikacji. Domyślnej funkcji wywołania zwrotnego odzyskiwania jest [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|
|-AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART|Włączono automatyczne zapisywanie i automatycznie zapisuje Menedżera ponownego uruchomienia wszelkich otwartych dokumentów, po ponownym uruchomieniu aplikacji.|
|-AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL|Włączono automatyczne zapisywanie i automatycznie zapisuje Menedżera ponownego uruchamiania dowolnego otwieranie dokumentów w regularnych odstępach czasu. Interwał jest definiowany przez [CWinApp::m_nAutosaveInterval](#m_nautosaveinterval).|
|-AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES|Menedżera ponownego uruchamiania otwiera wcześniej otwartych dokumentów po ponownym uruchomieniu aplikacji z nieoczekiwanego zakończenia. [Klasa CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md) obsługuje przechowywanie listy otwartych dokumentów i ich przywracania.|
|-AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES|Menedżera ponownego uruchamiania monituje użytkownika o przywracania plików zapisana automatycznie po ponownym uruchomieniu aplikacji. `CDataRecoveryHandler` Klasy zapytania użytkownika.|
|-AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE|Złożenie AFX_RESTART_MANAGER_SUPPORT_RESTART AFX_RESTART_MANAGER_SUPPORT_RECOVER i AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES.|
|-AFX_RESTART_MANAGER_SUPPORT_ALL_ASPECTS|Złożenie AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE, AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART, AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL i AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES.|
|-AFX_RESTART_MANAGER_SUPPORT_RESTART_ASPECTS|Złożenie AFX_RESTART_MANAGER_SUPPORT_RESTART, AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART, AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES i AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES.|
|-AFX_RESTART_MANAGER_SUPPORT_RECOVERY_ASPECTS|Złożenia ofAFX_RESTART_MANAGER_SUPPORT_RECOVERY, AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL, AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES i AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES.|

##  <a name="m_ehelptype"></a>  CWinApp::m_eHelpType

Typ ten element członkowski danych jest Typ wyliczany AFX_HELP_TYPE, która jest zdefiniowana w ramach `CWinApp` klasy.

```
AFX_HELP_TYPE m_eHelpType;
```

### <a name="remarks"></a>Uwagi

Wyliczenie AFX_HELP_TYPE jest zdefiniowana w następujący sposób:

```
enum AFX_HELP_TYPE {
    afxWinHelp = 0,
    afxHTMLHelp = 1
    };
```

- Aby ustawić aplikacji ułatwiają pomocy HTML, należy wywołać [SetHelpMode](#sethelpmode) i określ `afxHTMLHelp`.

- Aby ustawić aplikacji ułatwiają WinHelp, należy wywołać `SetHelpMode` i określ `afxWinHelp`.

##  <a name="m_hinstance"></a>  CWinApp::m_hInstance

Odnosi się do *hInstance* parametr przekazywany przez Windows do `WinMain`.

```
HINSTANCE m_hInstance;
```

### <a name="remarks"></a>Uwagi

`m_hInstance` Element członkowski danych jest uchwytem do bieżącego wystąpienia aplikacji działających w ramach Windows. Ta wartość jest zwracana przez funkcję globalnego [afxgetinstancehandle —](application-information-and-management.md#afxgetinstancehandle). `m_hInstance` jest publiczną zmienną typu HINSTANCE.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#55](../../mfc/reference/codesnippet/cpp/cwinapp-class_15.cpp)]

##  <a name="m_lpcmdline"></a>  CWinApp::m_lpCmdLine

Odnosi się do *lpCmdLine* parametr przekazywany przez Windows do `WinMain`.

```
LPTSTR m_lpCmdLine;
```

### <a name="remarks"></a>Uwagi

Wskazuje ciąg zakończony znakiem null, który określa wiersz polecenia dla aplikacji. Użyj `m_lpCmdLine` do dostępu do żadnych argumentów wiersza polecenia które użytkownik wprowadził podczas uruchomienia aplikacji. `m_lpCmdLine` jest publiczną zmienną typu LPTSTR.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]

##  <a name="m_nautosaveinterval"></a>  CWinApp::m_nAutosaveInterval

Długość czasu w milisekundach między automatycznie zapisuje.

```
int m_nAutosaveInterval;
```

### <a name="remarks"></a>Uwagi

Można skonfigurować Menedżera ponownego uruchamiania do zapisywania dokumentów otwartych w ustalonych odstępach czasu. Jeśli aplikacja ma nie zapisywania plików, ten parametr nie ma wpływu.

##  <a name="m_ncmdshow"></a>  CWinApp::m_nCmdShow

Odnosi się do *nCmdShow* parametr przekazywany przez Windows do `WinMain`.

```
int m_nCmdShow;
```

### <a name="remarks"></a>Uwagi

Należy przekazać `m_nCmdShow` jako argument po wywołaniu [CWnd::ShowWindow](../../mfc/reference/cwnd-class.md#showwindow) dla okna głównego aplikacji. `m_nCmdShow` jest publiczną zmienną typu **int**.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#56](../../mfc/reference/codesnippet/cpp/cwinapp-class_17.cpp)]

##  <a name="m_pactivewnd"></a>  CWinApp::m_pActiveWnd

Ten element członkowski danych umożliwiają przechowywanie wskaźnik do głównego okna aplikacji kontenera OLE, która ma swoje OLE serwer aplikacji w miejscu aktywowane.

### <a name="remarks"></a>Uwagi

Jeśli ten element członkowski danych ma wartość NULL, aplikacja nie jest aktywny w miejscu.

Struktura ustawia ta zmienna członka, gdy okno ramowe jest aktywowany przez aplikację kontenera OLE w miejscu.

##  <a name="m_pdatarecoveryhandler"></a>  CWinApp::m_pDataRecoveryHandler

Wskaźnik do obsługi odzyskiwania danych aplikacji.

```
CDataRecoveryHandler* m_pDataRecoveryHandler;
```

### <a name="remarks"></a>Uwagi

Obsługa odzyskiwania danych aplikacji monitoruje otwarte dokumenty i automatycznie zapisuje je. Struktura używa Obsługa odzyskiwania danych do przywracania plików automatycznie zapisany, po ponownym uruchomieniu aplikacji, po jego jest nieoczekiwanie zamykany. Aby uzyskać więcej informacji, zobacz [klasa CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md).

##  <a name="m_pszappname"></a>  CWinApp::m_pszAppName

Określa nazwę aplikacji.

```
LPCTSTR m_pszAppName;
```

### <a name="remarks"></a>Uwagi

Nazwa aplikacji mogą pochodzić z przekazanego do parametru [CWinApp](#cwinapp) konstruktora, lub, jeśli nie zostanie określony, do ciągu zasobu z Identyfikatorem AFX_IDS_APP_TITLE. Jeśli nazwa aplikacji nie zostanie znaleziony w zasobie, pochodzi z tego programu. Nazwa pliku EXE.

Zwrócona przez funkcję globalnego [afxgetappname —](application-information-and-management.md#afxgetappname). `m_pszAppName` jest publiczną zmienną typu **const char**<strong>\*</strong>.

> [!NOTE]
> Jeśli przypisujesz wartość do `m_pszAppName`, muszą być dynamicznie przydzielane na stosie. `CWinApp` Wywołania destruktora **bezpłatne**() za pomocą tego wskaźnika. Wiele chcesz użyć `_tcsdup`wykonać przydzielanie funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć, o których skojarzone z bieżącym wskaźnika przed przypisaniem nowych wartości. Na przykład:

[!code-cpp[NVC_MFCWindowing#57](../../mfc/reference/codesnippet/cpp/cwinapp-class_18.cpp)]

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#65](../../mfc/reference/codesnippet/cpp/cwinapp-class_19.cpp)]

##  <a name="m_pszexename"></a>  CWinApp::m_pszExeName

Zawiera nazwę pliku wykonywalnego aplikacji bez rozszerzenia.

```
LPCTSTR m_pszExeName;
```

### <a name="remarks"></a>Uwagi

W odróżnieniu od [m_pszAppName](#m_pszappname), ta nazwa nie może zawierać spacji. `m_pszExeName` jest publiczną zmienną typu **const char**<strong>\*</strong>.

> [!NOTE]
> Jeśli przypisujesz wartość do `m_pszExeName`, muszą być dynamicznie przydzielane na stosie. `CWinApp` Wywołania destruktora **bezpłatne**() za pomocą tego wskaźnika. Wiele chcesz użyć `_tcsdup`wykonać przydzielanie funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć, o których skojarzone z bieżącym wskaźnika przed przypisaniem nowych wartości. Na przykład:

[!code-cpp[NVC_MFCWindowing#58](../../mfc/reference/codesnippet/cpp/cwinapp-class_20.cpp)]

##  <a name="m_pszhelpfilepath"></a>  CWinApp::m_pszHelpFilePath

Zawiera ścieżkę do pliku pomocy w aplikacji.

```
LPCTSTR m_pszHelpFilePath;
```

### <a name="remarks"></a>Uwagi

Domyślnie, inicjuje platformę `m_pszHelpFilePath` do nazwy aplikacji ". HLP"dołączony. Aby zmienić nazwę pliku pomocy, należy ustawić `m_pszHelpFilePath` wskaż ciąg, który zawiera pełną nazwę pliku odpowiednią pomoc. Wygodne miejsce, w tym celu znajduje się w aplikacji [InitInstance](#initinstance) funkcji. `m_pszHelpFilePath` jest publiczną zmienną typu **const char**<strong>\*</strong>.

> [!NOTE]
> Jeśli przypisujesz wartość do `m_pszHelpFilePath`, muszą być dynamicznie przydzielane na stosie. `CWinApp` Wywołania destruktora **bezpłatne**() za pomocą tego wskaźnika. Wiele chcesz użyć `_tcsdup`wykonać przydzielanie funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć, o których skojarzone z bieżącym wskaźnika przed przypisaniem nowych wartości. Na przykład:

[!code-cpp[NVC_MFCWindowing#59](../../mfc/reference/codesnippet/cpp/cwinapp-class_21.cpp)]

##  <a name="m_pszprofilename"></a>  CWinApp::m_pszProfileName

Zawiera nazwę aplikacji. Pliku INI.

```
LPCTSTR m_pszProfileName;
```

### <a name="remarks"></a>Uwagi

`m_pszProfileName` jest publiczną zmienną typu **const char**<strong>\*</strong>.

> [!NOTE]
> Jeśli przypisujesz wartość do `m_pszProfileName`, muszą być dynamicznie przydzielane na stosie. `CWinApp` Wywołania destruktora **bezpłatne**() za pomocą tego wskaźnika. Wiele chcesz użyć `_tcsdup`wykonać przydzielanie funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć, o których skojarzone z bieżącym wskaźnika przed przypisaniem nowych wartości. Na przykład:

[!code-cpp[NVC_MFCWindowing#60](../../mfc/reference/codesnippet/cpp/cwinapp-class_22.cpp)]

##  <a name="m_pszregistrykey"></a>  CWinApp::m_pszRegistryKey

Używany do określenia, gdzie, w rejestrze lub plik INI, ustawienia profilu aplikacji są przechowywane.

```
LPCTSTR m_pszRegistryKey;
```

### <a name="remarks"></a>Uwagi

Zazwyczaj ten element członkowski danych jest traktowana jako tylko do odczytu.

- Wartość jest przechowywana w kluczu rejestru. Nazwa ustawienia aplikacji w profilu jest dołączana do następującego klucza rejestru: HKEY_CURRENT_USER/Software/LocalAppWizard-wygenerowanych /.

Jeśli przypisujesz wartość do `m_pszRegistryKey`, muszą być dynamicznie przydzielane na stosie. `CWinApp` Wywołania destruktora **bezpłatne**() za pomocą tego wskaźnika. Wiele chcesz użyć `_tcsdup`wykonać przydzielanie funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć, o których skojarzone z bieżącym wskaźnika przed przypisaniem nowych wartości. Na przykład:

[!code-cpp[NVC_MFCWindowing#61](../../mfc/reference/codesnippet/cpp/cwinapp-class_23.cpp)]

##  <a name="m_pszappid"></a>  CWinApp::m_pszAppID

Identyfikator modelu użytkownika aplikacji

```
LPCTSTR m_pszAppID;
```

### <a name="remarks"></a>Uwagi

##  <a name="oncontexthelp"></a>  CWinApp::OnContextHelp

Obsługuje SHIFT + F1 Pomoc w obrębie aplikacji.

```
afx_msg void OnContextHelp();
```

### <a name="remarks"></a>Uwagi

Należy dodać `ON_COMMAND( ID_CONTEXT_HELP, OnContextHelp )` instrukcję, aby Twoje `CWinApp` klasy mapy wiadomości, a także dodać wpisu tabeli akceleratora, zwykle SHIFT + F1, aby włączyć tę funkcję elementu członkowskiego.

`OnContextHelp` umieszcza ją w trybie pomocy. Kursor zmieni się strzałka i znak zapytania, a użytkownik może następnie przesuń wskaźnik myszy i naciśnij przycisk myszy po lewej stronie, aby wybrać okno dialogowe, okna, menu lub przycisku polecenia. Ta funkcja elementu członkowskiego pobiera Pomoc kontekstowa obiektu pod kursorem i wywołuje funkcję Windows WinHelp przy użyciu tego kontekstu pomocy.

##  <a name="onddecommand"></a>  CWinApp::OnDDECommand

Wywoływane przez platformę, gdy w oknie głównym ramki otrzymuje DDE wykonania wiadomości.

```
virtual BOOL OnDDECommand(LPTSTR lpszCommand);
```

### <a name="parameters"></a>Parametry

*lpszCommand*<br/>
Wskazuje ciąg polecenia DDE odebranych przez aplikację.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli polecenie jest obsługiwane; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja sprawdza, czy polecenie to żądanie, aby otworzyć dokument i jeśli tak, otwiera określony dokument. Menedżera plików Windows zwykle wysyła takich ciągów poleceń DDE, gdy użytkownik kliknie dwukrotnie plik danych. Override tę funkcję, aby obsłużyć inne DDE wykonywanie poleceń, takich jak polecenia drukowania.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#48](../../mfc/reference/codesnippet/cpp/cwinapp-class_24.cpp)]

##  <a name="onfilenew"></a>  CWinApp::OnFileNew

Implementuje id_file_new — polecenie.

```
afx_msg void OnFileNew();
```

### <a name="remarks"></a>Uwagi

Należy dodać `ON_COMMAND( ID_FILE_NEW, OnFileNew )` instrukcję, aby Twoje `CWinApp` klasy mapy wiadomości do włączenia tej funkcji elementu członkowskiego. Jeśli włączona, ta funkcja obsługuje wykonywanie polecenia nowy plik.

Zobacz [techniczne 22 Uwaga](../../mfc/tn022-standard-commands-implementation.md) informacji na temat zachowania domyślnego i wskazówki dotyczące sposobu zastąpienia tej funkcji elementu członkowskiego.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]

[!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]

##  <a name="onfileopen"></a>  CWinApp::OnFileOpen

Implementuje id_file_open — polecenie.

```
afx_msg void OnFileOpen();
```

### <a name="remarks"></a>Uwagi

Należy dodać `ON_COMMAND( ID_FILE_OPEN, OnFileOpen )` instrukcję, aby Twoje `CWinApp` klasy mapy wiadomości do włączenia tej funkcji elementu członkowskiego. Jeśli włączona, ta funkcja obsługuje wykonywanie polecenia Otwórz plik.

Aby uzyskać informacji na temat zachowania domyślnego i wskazówki dotyczące sposobu zastąpienia tej funkcji elementu członkowskiego, zobacz [techniczne 22 Uwaga](../../mfc/tn022-standard-commands-implementation.md).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]

[!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]

##  <a name="onfileprintsetup"></a>  CWinApp::OnFilePrintSetup

Implementuje id_file_print_setup — polecenie.

```
afx_msg void OnFilePrintSetup();
```

### <a name="remarks"></a>Uwagi

Należy dodać `ON_COMMAND( ID_FILE_PRINT_SETUP, OnFilePrintSetup )` instrukcję, aby Twoje `CWinApp` klasy mapy wiadomości do włączenia tej funkcji elementu członkowskiego. Jeśli włączona, ta funkcja obsługuje wykonywanie polecenia drukowania pliku.

Aby uzyskać informacji na temat zachowania domyślnego i wskazówki dotyczące sposobu zastąpienia tej funkcji elementu członkowskiego, zobacz [techniczne 22 Uwaga](../../mfc/tn022-standard-commands-implementation.md).

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]

[!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]

##  <a name="onhelp"></a>  CWinApp::OnHelp

Obsługuje pomocy F1 w aplikacji (przy użyciu bieżącego kontekstu).

```
afx_msg void OnHelp();
```

### <a name="remarks"></a>Uwagi

Zazwyczaj należy również dodać wpisu klawisza skrótu klawisz F1. Włączenie klawisz F1 jest tylko Konwencję, nie wymagania.

Należy dodać `ON_COMMAND( ID_HELP, OnHelp )` instrukcję, aby Twoje `CWinApp` klasy mapy wiadomości do włączenia tej funkcji elementu członkowskiego. Jeśli włączona, wywoływane przez platformę, gdy użytkownik naciśnie klawisz F1.

Domyślna implementacja tej funkcji obsługi wiadomości określa pomoc kontekstowa, która odnosi się do bieżącego okna, okno dialogowe lub elementu menu, a następnie wywołuje Pomoc systemu Windows. PLIK EXE. Jeśli kontekst nie jest obecnie dostępna, funkcja używa domyślnego kontekstu.

Zastąpienie tej funkcji elementu członkowskiego, aby ustawić Pomoc kontekstowa na coś innego niż okna, okno dialogowe, element menu lub przycisku paska narzędzi, który aktualnie ma fokus. Wywołaj `WinHelp` z żądaną pomocy identyfikator kontekstu.

##  <a name="onhelpfinder"></a>  CWinApp::OnHelpFinder

Obsługuje polecenia ID_HELP_FINDER i id_default_help —.

```
afx_msg void OnHelpFinder();
```

### <a name="remarks"></a>Uwagi

Należy dodać `ON_COMMAND( ID_HELP_FINDER, OnHelpFinder )` instrukcję, aby Twoje `CWinApp` klasy mapy wiadomości do włączenia tej funkcji elementu członkowskiego. Jeśli włączone, struktura wywołuje tę funkcję obsługi wiadomości, po wybraniu aplikacji polecenie wyszukiwania pomoc do wywołania `WinHelp` ze standardem **HELP_FINDER** tematu.

##  <a name="onhelpindex"></a>  CWinApp::OnHelpIndex

Id_help_index — polecenie obsługuje i udostępnia domyślny temat pomocy.

```
afx_msg void OnHelpIndex();
```

### <a name="remarks"></a>Uwagi

Należy dodać `ON_COMMAND( ID_HELP_INDEX, OnHelpIndex )` instrukcję, aby Twoje `CWinApp` klasy mapy wiadomości do włączenia tej funkcji elementu członkowskiego. Jeśli włączone, struktura wywołuje tę funkcję obsługi wiadomości, po wybraniu aplikacji polecenie Indeks pomocy, aby wywołać `WinHelp` ze standardem **HELP_INDEX** tematu.

##  <a name="onhelpusing"></a>  CWinApp::OnHelpUsing

Obsługuje id_help_using — polecenie.

```
afx_msg void OnHelpUsing();
```

### <a name="remarks"></a>Uwagi

Należy dodać `ON_COMMAND( ID_HELP_USING, OnHelpUsing )` instrukcję, aby Twoje `CWinApp` klasy mapy wiadomości do włączenia tej funkcji elementu członkowskiego. Struktura wywołuje tę funkcję obsługi wiadomości, po wybraniu aplikacji Pomoc używając polecenie do wywołania `WinHelp` aplikacji ze standardem **HELP_HELPONHELP** tematu.

##  <a name="onidle"></a>  CWinApp::OnIdle

Zastąpienie tej funkcji elementu członkowskiego, aby wykonać przetwarzanie w czasie bezczynności (%).

```
virtual BOOL OnIdle(LONG lCount);
```

### <a name="parameters"></a>Parametry

*lCount*<br/>
Licznik jest zwiększany każdorazowo `OnIdle` jest wywoływana, gdy kolejka komunikatów aplikacji jest pusta. Ten licznik jest resetowany do 0 każdorazowo, gdy nowy komunikat jest przetwarzany. Możesz użyć *lCount* parametru, aby określić względną długość czasu aplikacji była bezczynna bez przetwarzania wiadomości.

### <a name="return-value"></a>Wartość zwracana

Różna od zera, aby otrzymać więcej przetwarzania czas bezczynności; 0, jeśli nie ma więcej czasu bezczynności nie jest konieczne.

### <a name="remarks"></a>Uwagi

`OnIdle` jest wywoływana w domyślną pętlę komunikatów, gdy kolejka komunikatów aplikacji jest pusta. Przesłonięcia umożliwia wywoływanie własne tła zadania obsługi bezczynności (%).

`OnIdle` powinien zostać zwrócony 0, aby wskazać, że nie czas bezczynności przetwarzania jest wymagane. *LCount* parametru jest zwiększany po każdej `OnIdle` jest wywoływana, gdy kolejka komunikatów jest pusta i resetuje 0 każdorazowo nowy komunikat jest przetwarzany. Można wywołać z innej procedury bezczynności na podstawie tej liczby.

Poniżej przedstawiono podsumowanie przetwarzanie pętli bezczynności:

1. Jeśli pętli komunikatów w bibliotece klas Microsoft Foundation umożliwia sprawdzenie kolejki komunikatów i nie znajdzie się oczekujących komunikatów, wywołuje metodę `OnIdle` dla obiektu aplikacji i dostarcza 0 jako *lCount* argumentu.

2. `OnIdle` wykonuje część przetwarzania i zwraca wartość różną od zera, aby wskazać jej powinna być wywoływana ponownie w celu dalszego przetwarzania.

3. Pętli komunikatów umożliwia sprawdzenie kolejki komunikatów, ponownie. Jeśli nie ma wiadomości oczekujące, wywołuje metodę `OnIdle` ponownie, zwiększając *lCount* argumentu.

4. Po pewnym czasie `OnIdle` zakończy przetwarzanie wszystkich bezczynnych zadań i zwraca wartość 0. Informuje pętli komunikatów, aby zatrzymać, wywołanie `OnIdle` otrzymanie następnego komunikatu z kolejki komunikatów w tym momencie cyklu bezczynności powoduje ponowne uruchomienie z argumentem ustawione na 0.

Nie wykonuj długich zadań podczas `OnIdle` ponieważ aplikacja nie może przetworzyć dane wejściowe użytkownika do momentu `OnIdle` zwraca.

> [!NOTE]
> Domyślna implementacja klasy `OnIdle` aktualizacje polecenia obiektów interfejsu użytkownika, takich jak elementy menu i przycisków na pasku narzędzi, a następnie wykonuje oczyszczania struktury danych wewnętrznych. W związku z tym Jeśli zastąpisz `OnIdle`, należy wywołać `CWinApp::OnIdle` z `lCount` w zgodnym z przesłoniętą wersji. Pierwsze wywołanie przetwarzanie w stanie bezczynności wszystkie klasy podstawowej (oznacza to, aż do klasy bazowej `OnIdle` zwraca wartość 0). Jeśli zachodzi potrzeba wykonania pracy przed zakończeniem przetwarzania klasy bazowej, zapoznaj się z implementacji klasy podstawowej, aby wybrać odpowiednią *lCount* w którym można wykonywać swoją pracę.

Jeśli nie chcesz `OnIdle` wywoływana zawsze wtedy, gdy komunikat jest pobierana z kolejki komunikatów, można zastąpić [CWinThreadIsIdleMessage](../../mfc/reference/cwinthread-class.md#isidlemessage). Jeśli aplikacja ma ustawioną bardzo krótkich czasomierz lub system wysyła komunikat WM_SYSTIMER następnie `OnIdle` będzie wywoływany wielokrotnie i obniżyć wydajność.

### <a name="example"></a>Przykład

Dwa poniższe przykłady pokazują, jak używać `OnIdle`. Pierwszy przykład przetwarza dwa zadania bezczynności za pomocą *lCount* argumentu, aby określić priorytety zadań. Pierwsze zadanie jest o wysokim priorytecie i należy je zawsze, gdy jest to możliwe. Drugie zadanie jest mniej ważne i powinny być wykonywane tylko wtedy, gdy długie wstrzymania w danych wejściowych użytkownika. Należy pamiętać, wywołanie klasy bazowej wersję `OnIdle`. Drugi przykład zarządza grupy bezczynnych zadań o różnych priorytetach.

[!code-cpp[NVC_MFCWindowing#51](../../mfc/reference/codesnippet/cpp/cwinapp-class_27.cpp)]

##  <a name="opendocumentfile"></a>  CWinApp::OpenDocumentFile

Struktura wywołuje tę metodę, aby otworzyć nazwany [CDocument](../../mfc/reference/cdocument-class.md) pliku dla aplikacji.

```
virtual CDocument* OpenDocumentFile(
    LPCTSTR lpszFileName
    BOOL bAddToMRU = TRUE);
```

### <a name="parameters"></a>Parametry

*lpszFileName*<br/>
[in] Nazwa pliku, który ma zostać otwarty.

*bAddToMRU*<br/>
[in] Wartość TRUE wskazuje, że dokument jest jeden z najnowszych plików; Wartość FALSE wskazuje, że dokument nie jest jednym z najbardziej aktualne pliki.

### <a name="return-value"></a>Wartość zwracana

Wskaźnik do `CDocument` Jeśli operacja się powiedzie; w przeciwnym razie wartość NULL.

### <a name="remarks"></a>Uwagi

Jeśli dokument o tej nazwie jest już otwarty, pierwsze okno ramki, który zawiera dany dokument otrzyma fokus. Jeśli aplikacja obsługuje wielu szablonów dokumentów, środowisko wykorzystuje rozszerzenie nazwy pliku można znaleźć szablonu odpowiednie dokumentu, aby spróbować załadować dokument. Jeśli to się powiedzie, szablon dokumentu, który następnie tworzy okno ramek i Widok dokumentu.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]

##  <a name="parsecommandline"></a>  CWinApp::ParseCommandLine

Wywołaj tę funkcję elementu członkowskiego, Analizuj wiersz polecenia i wysyłać do parametrów, jedno w danej chwili [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam).

```
void ParseCommandLine(CCommandLineInfo& rCmdInfo);
```

### <a name="parameters"></a>Parametry

*rCmdInfo*<br/>
Odwołanie do [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) obiektu.

### <a name="remarks"></a>Uwagi

Po uruchomieniu nowego projektu MFC przy użyciu Kreatora aplikacji, Kreator aplikacji spowoduje utworzenie lokalnego wystąpienia programu `CCommandLineInfo`, a następnie wywołaj `ProcessShellCommand` i `ParseCommandLine` w [InitInstance](#initinstance) funkcja elementu członkowskiego. Wiersz polecenia następujące trasy opisane poniżej:

1. Po tworzonych w `InitInstance`, `CCommandLineInfo` obiekt jest przekazywany do `ParseCommandLine`.

2. `ParseCommandLine` następnie wywołuje `CCommandLineInfo::ParseParam` wielokrotnie, jeden raz dla każdego parametru.

3. `ParseParam` wypełnia `CCommandLineInfo` obiektu, który jest następnie przekazywany do [elemencie ProcessShellCommand](#processshellcommand).

4. `ProcessShellCommand` obsługuje argumenty wiersza polecenia i flagi.

Należy zauważyć, że można wywołać `ParseCommandLine` bezpośrednio, zgodnie z potrzebami.

Aby uzyskać opis flag wiersza polecenia, zobacz [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand).

##  <a name="pretranslatemessage"></a>  CWinApp::PreTranslateMessage

Zastąp tę funkcję, aby przefiltrować komunikaty okna, zanim zostaną rozesłane do funkcji Windows [TranslateMessage](/windows/desktop/api/winuser/nf-winuser-translatemessage) i [DispatchMessage](/windows/desktop/api/winuser/nf-winuser-dispatchmessage) Domyślna implementacja wykonuje klawisza skrótu tłumaczenie, więc należy wywołać `CWinApp::PreTranslateMessage` funkcja elementu członkowskiego w zgodnym z przesłoniętą wersji.

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>Parametry

*pMsg*<br/>
Wskaźnik do [MSG](../../mfc/reference/msg-structure1.md) strukturę, która zawiera komunikat, który ma przetwarzać.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli w pełnym przetworzeniem komunikat `PreTranslateMessage` i nie powinny być dalej przetwarzane. Zero, jeśli komunikat mają być przetwarzane w zwykły sposób.

##  <a name="processmessagefilter"></a>  CWinApp::ProcessMessageFilter

Funkcja podłączania struktury wywołania tej funkcji elementu członkowskiego, filtrować i reagować na niektórych komunikatów Windows.

```
virtual BOOL ProcessMessageFilter(
    int code,
    LPMSG lpMsg);
```

### <a name="parameters"></a>Parametry

*Kod*<br/>
Określa kod punktów zaczepienia. Ta funkcja członkowska używa kodu, aby określić sposób przetwarzania *lpMsg.*

*lpMsg*<br/>
Wskaźnik do Windows [MSG](../../mfc/reference/msg-structure1.md) struktury.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli komunikat jest przetwarzany; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Funkcja podłączania przetwarza zdarzenia przed wysłaniem ich do aplikacji normalny komunikat dotyczący przetwarzania.

Jeśli zastąpisz tę funkcję zaawansowanej, pamiętaj wywołać wersji klasy podstawowej, aby zachować struktury utworzenie punktu zaczepienia przetwarzania.

##  <a name="processshellcommand"></a>  CWinApp::ProcessShellCommand

Ta funkcja członkowska jest wywoływana przez [InitInstance](#initinstance) aby akceptować parametry przekazywane z `CCommandLineInfo` identyfikowane za pomocą obiektu *rCmdInfo*i wykonaj wskazane działania.

```
BOOL ProcessShellCommand(CCommandLineInfo& rCmdInfo);
```

### <a name="parameters"></a>Parametry

*rCmdInfo*<br/>
Odwołanie do [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) obiektu.

### <a name="return-value"></a>Wartość zwracana

Różna od zera, jeśli pomyślnie przetwarzania polecenia powłoki. Jeśli zwraca wartość FALSE z, 0, [InitInstance](#initinstance).

### <a name="remarks"></a>Uwagi

Po uruchomieniu nowego projektu MFC przy użyciu Kreatora aplikacji, Kreator aplikacji spowoduje utworzenie lokalnego wystąpienia programu `CCommandLineInfo`, a następnie wywołaj `ProcessShellCommand` i [ParseCommandLine](#parsecommandline) w `InitInstance` funkcja elementu członkowskiego. Wiersz polecenia następujące trasy opisane poniżej:

1. Po tworzonych w `InitInstance`, `CCommandLineInfo` obiekt jest przekazywany do `ParseCommandLine`.

2. `ParseCommandLine` następnie wywołuje [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam) wielokrotnie, jeden raz dla każdego parametru.

3. `ParseParam` wypełnia `CCommandLineInfo` obiektu, który jest następnie przekazywany do `ProcessShellCommand`.

4. `ProcessShellCommand` obsługuje argumenty wiersza polecenia i flagi.

Członkowie danych `CCommandLineInfo` obiektu, identyfikowane przez [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand), są następujące typu wyliczeniowego jest zdefiniowana w `CCommandLineInfo` klasy.

```
enum {
    FileNew,
    FileOpen,
    FilePrint,
    FilePrintTo,
    FileDDE
    };
```

Aby uzyskać krótki opis każdego z tych wartości, zobacz `CCommandLineInfo::m_nShellCommand`.

##  <a name="processwndprocexception"></a>  CWinApp::ProcessWndProcException

Struktura wywołuje tej funkcji elementu członkowskiego, w każdym przypadku, gdy program obsługi nie przechwytuje wyjątek zgłoszony w jednej z aplikacji wiadomość lub programy obsługi poleceń.

```
virtual LRESULT ProcessWndProcException(
    CException* e,
    const MSG* pMsg);
```

### <a name="parameters"></a>Parametry

*e*<br/>
Wskaźnik do nieprzechwycony wyjątek.

*pMsg*<br/>
A [MSG](../../mfc/reference/msg-structure1.md) strukturę, która zawiera informacje dotyczące komunikatów systemu windows, które spowodowało platformę, aby zgłosić wyjątek.

### <a name="return-value"></a>Wartość zwracana

Wartość, która powinna zostać zwrócona do Windows. Zazwyczaj są to 0L dla komunikatów systemu windows, 1L (TRUE) komunikaty poleceń.

### <a name="remarks"></a>Uwagi

Nie wywołuj tej funkcji elementu członkowskiego bezpośrednio.

Domyślna implementacja tej funkcji elementu członkowskiego tworzy okno komunikatu. Jeśli nieprzechwycony wyjątek pochodzi z menu, pasek narzędzi lub błąd polecenia klawiszy skrótów, okno komunikatu wyświetla komunikat "Polecenie nie powiodło się."; w przeciwnym razie wyświetla komunikat "wewnętrzny błąd aplikacji".

Zastąpienie tej funkcji elementu członkowskiego w celu zapewnienia obsługi globalnej listy wyjątków. Podstawowe funkcje należy wywoływać tylko, jeśli chcesz, aby okno komunikatu, które mają być wyświetlane.

##  <a name="register"></a>  CWinApp::Register

Wykonuje wszelkie zadania rejestracji nie są obsługiwane przez `RegisterShellFileTypes`.

```
virtual BOOL Register();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera w przypadku powodzenia; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Domyślna implementacja po prostu zwraca wartość TRUE. Należy przesłonić tę funkcję, aby podać wszystkie kroki rejestracji dostosowane.

##  <a name="registershellfiletypes"></a>  CWinApp::RegisterShellFileTypes

Wywołaj tę funkcję elementu członkowskiego, aby zarejestrować wszystkie typy dokumentów aplikacji za pomocą Menedżera plików Windows.

```
void RegisterShellFileTypes(BOOL bCompat = FALSE);
```

### <a name="parameters"></a>Parametry

*bCompat*<br/>
[in] PRAWDA Dodaje wpisy rejestracyjne dla poleceń powłoki wydruku i wydrukować do, pozwalając użytkownikom na drukowanie plików bezpośrednio z poziomu powłoki lub przeciągając go do obiektu drukarki. Dodaje klucz DefaultIcon. Domyślnie ten parametr ma wartość FALSE dla zgodności z poprzednimi wersjami.

### <a name="remarks"></a>Uwagi

Dzięki temu użytkownikowi otwieranie pliku danych tworzone przez testowaną aplikację, klikając dwukrotnie plik go w Menedżerze plików. Wywołaj `RegisterShellFileTypes` po wywołaniu metody [AddDocTemplate](#adddoctemplate) dla każdego z szablonów dokumentów w aplikacji. Również wywołać [enableshellopen —](#enableshellopen) funkcja elementu członkowskiego, gdy wywołujesz `RegisterShellFileTypes`.

`RegisterShellFileTypes` wykonuje iterację na liście [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) obiektów, że aplikacja zachowuje i dla każdego szablonu dokumentu, dodaje wpisy do Windows obsługuje dla skojarzenia plików bazy danych rejestracji. Menedżer plików używa tych wpisów, można otworzyć pliku danych, gdy użytkownik kliknie dwukrotnie. Eliminuje to potrzebę do wysłania. Plik REG za pomocą aplikacji.

> [!NOTE]
> `RegisterShellFileTypes` tylko wtedy, gdy użytkownik uruchamia program z uprawnieniami administratora. Jeśli program nie ma uprawnienia administratora, nie można dokonać zmian kluczy rejestru.

Jeśli baza danych rejestracji już skojarzony z rozszerzeniem nazwy pliku w danym z innym typem pliku, nie nowe skojarzenie zostanie utworzony. Zobacz `CDocTemplate` klasy format ciągów, które są niezbędne zarejestrować te informacje.

##  <a name="registerwithrestartmanager"></a>  CWinApp::RegisterWithRestartManager

Rejestruje aplikację za pomocą Menedżera ponownego uruchamiania.

```
virtual HRESULT RegisterWithRestartManager(
    BOOL bRegisterRecoveryCallback,
    const CString& strRestartIdentifier);

virtual HRESULT RegisterWithRestartManager(
    LPCWSTR pwzCommandLineArgs,
    DWORD dwRestartFlags,
    APPLICATION_RECOVERY_CALLBACK pRecoveryCallback,
    LPVOID lpvParam,
    DWORD dwPingInterval,
    DWORD dwCallbackFlags);
```

### <a name="parameters"></a>Parametry

|||
|-|-|
|Parametr|Opis|
|*bRegisterRecoveryCallback*|[in] Wartość TRUE wskazuje, że to wystąpienie aplikacji używa funkcji wywołania zwrotnego odzyskiwania; Wartość FALSE wskazuje, czy nie. Struktura wywołuje funkcję wywołania zwrotnego odzyskiwania, gdy aplikacja jest nieoczekiwanie zamykany. Aby uzyskać więcej informacji, zobacz [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|
|*strRestartIdentifier*|[in] Unikatowy ciąg, który identyfikuje tego wystąpienia Menedżera ponownego uruchamiania. Identyfikator Menedżera ponownego uruchamiania jest unikatowy dla każdego wystąpienia aplikacji.|
|*pwzCommandLineArgs*|[in] Ciąg, który zawiera wszelkie dodatkowe argumenty z wiersza polecenia.|
|*dwRestartFlags*|[in] Flagi opcjonalne dla Menedżera ponownego uruchamiania. Aby uzyskać więcej informacji, zobacz sekcję: Uwagi.|
|*pRecoveryCallback*|[in] Funkcja wywołania zwrotnego odzyskiwania. Ta funkcja musi przyjmować parametr LPVoid — jako dane wejściowe i zwraca wartość typu DWORD. Domyślnej funkcji wywołania zwrotnego odzyskiwania jest `CWinApp::ApplicationRecoveryCallback`.|
|*lpvParam*|[in] Parametr wejściowy funkcji wywołania zwrotnego odzyskiwania. Aby uzyskać więcej informacji, zobacz [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|
|*dwPingInterval*|[in] Długość Czas oczekiwania menedżera ponownego uruchamiania dla funkcji wywołania zwrotnego odzyskiwania do zwrócenia. Ten parametr jest w milisekundach.|
|*dwCallbackFlags*|[in] Flagi przekazywane do funkcji wywołania zwrotnego odzyskiwania. Zarezerwowane do użytku w przyszłości.|

### <a name="return-value"></a>Wartość zwracana

S_OK, jeśli metoda się powiedzie; w przeciwnym razie kod błędu.

### <a name="remarks"></a>Uwagi

Jeśli aplikacja używa Domyślna implementacja MFC, automatyczne zapisywanie plików, należy użyć prosta wersja `RegisterWithRestartManager`. Przy użyciu wersji złożonych `RegisterWithRestartManager` Jeśli chcesz dostosować zachowanie automatycznego zapisywania aplikacji.

Jeśli wywołanie tej metody za pomocą ciągu pustego *strRestartIdentifier*, `RegisterWithRestartManager` tworzy ciąg unikatowy identyfikator dla tego wystąpienia o ponownym uruchomieniu menedżera.

Gdy aplikacja nieoczekiwanie Menedżera ponownego uruchamiania powoduje ponowne uruchomienie aplikacji z poziomu wiersza polecenia i zapewnia to unikatowy identyfikator jako opcjonalny argument ponownego uruchomienia. W tym scenariuszu struktura wywołuje `RegisterWithRestartManager` dwa razy. Pierwsze wywołanie pochodzi z [CWinApp::InitInstance](#initinstance) z pustym ciągiem identyfikatora ciągu. Następnie metoda [CWinApp::ProcessShellCommand](#processshellcommand) wywołania `RegisterWithRestartManager` o identyfikatorze unikatowy ponownego uruchomienia.

Po zarejestrowaniu aplikacji za pomocą Menedżera ponownego uruchamiania Menedżera ponownego uruchamiania monitoruje aplikację. Jeśli aplikacja niespodziewanie kończy działanie, Menedżera ponownego uruchamiania wywołuje funkcję wywołania zwrotnego odzyskiwania podczas procesu zamykanie systemu. Czeka Menedżera ponownego uruchamiania *dwPingInterval* na odpowiedź od funkcji wywołania zwrotnego odzyskiwania. Jeśli funkcja wywołania zwrotnego odzyskiwania nie odpowie w tym czasie, aplikacja kończy działanie bez wykonywania funkcji wywołania zwrotnego odzyskiwania.

Domyślnie dwRestartFlags nie są obsługiwane, ale są dostarczane do użytku w przyszłości. Możliwe wartości parametru *dwRestartFlags* są następujące:

- RESTART_NO_CRASH

- RESTART_NO_HANG

- RESTART_NO_PATCH

- RESTART_NO_REBOOT

##  <a name="reopenpreviousfilesatrestart"></a>  CWinApp::ReopenPreviousFilesAtRestart

Określa, czy Menedżera ponownego uruchamiania ponownie otwiera pliki, które były otwarte podczas nieoczekiwanie zakończył działanie aplikacji.

```
virtual BOOL ReopenPreviousFilesAtRestart() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość TRUE wskazuje, że Menedżera ponownego uruchamiania ponownie otwiera uprzednio otwartych plików; Wartość FALSE wskazuje, że nie ma Menedżera ponownego uruchamiania.

##  <a name="restartinstance"></a>  CWinApp::RestartInstance

Obsługuje inicjowane przez Menedżera ponownego uruchamiania ponowne uruchomienie aplikacji.

```
virtual BOOL CWinApp::RestartInstance();
```

### <a name="return-value"></a>Wartość zwracana

Wartość TRUE, jeśli program obsługi danych odzyskiwania otwiera wcześniej otwartych dokumentów; Wartość FALSE, jeśli program obsługi odzyskiwania danych ma błąd lub jeśli nie ma żadnych wcześniej otwartych dokumentów.

### <a name="remarks"></a>Uwagi

Po uruchomieniu Menedżera ponownego uruchamiania aplikacji w ramach wywołuje tę metodę. Ta metoda pobiera program obsługi odzyskiwania danych i przywraca pliki automatycznie zapisany. Ta metoda wywołuje [CDataRecoveryHandler::RestoreAutosavedDocuments](../../mfc/reference/cdatarecoveryhandler-class.md#restoreautosaveddocuments) do określenia, czy użytkownik chce, aby przywrócić pliki automatycznie zapisany.

Ta metoda zwraca wartość FALSE, jeśli [CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md) Określa, czy nie było żadnych otwartych dokumentów. Jeśli nie było żadnych otwartych dokumentów, zazwyczaj uruchamiania aplikacji.

##  <a name="restoreautosavedfilesatrestart"></a>  CWinApp::RestoreAutosavedFilesAtRestart

Określa, czy Menedżera ponownego uruchamiania przywraca pliki, zapisana automatycznie po jej ponownym uruchomieniu aplikacji.

```
virtual BOOL RestoreAutosavedFilesAtRestart() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość TRUE wskazuje, że Menedżera ponownego uruchamiania przywraca pliki automatycznie zapisany; Wartość FALSE wskazuje, że nie ma Menedżera ponownego uruchamiania.

##  <a name="run"></a>  CWinApp::Run

Udostępnia domyślną pętlę komunikatów.

```
virtual int Run();
```

### <a name="return-value"></a>Wartość zwracana

**Int** wartość, która jest zwracana przez `WinMain`.

### <a name="remarks"></a>Uwagi

`Run` uzyskuje i wysyła komunikaty Windows, aż aplikacja otrzymuje komunikat WM_QUIT. Jeśli kolejka komunikatów aplikacji zawiera już żadnych wiadomości `Run` wywołania [OnIdle](#onidle) do wykonywania przetwarzania w czasie bezczynności (%). Komunikaty przychodzące, przejdź do [pretranslatemessage —](#pretranslatemessage) funkcja elementu członkowskiego dla specjalnego przetwarzania, a następnie do funkcji Windows `TranslateMessage` standardowy interfejs użytkownika translacji; na koniec `DispatchMessage` Windows funkcja jest wywoływana.

`Run` rzadko zostanie zastąpiona, ale można ją zastąpić, aby zapewnić specjalne zachowanie.

##  <a name="runautomated"></a>  CWinApp::RunAutomated

Wywołaj tę funkcję, aby określić, czy " **/Automation**"or" **— Automation**" opcja jest obecny, która wskazuje, czy aplikacja została uruchomiona przez aplikację kliencką.

```
BOOL RunAutomated();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli opcja została odnaleziona; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli jest obecny, opcją jest usuwany z wiersza polecenia. Aby uzyskać więcej informacji na temat automatyzacji OLE, zobacz artykuł [serwerów automatyzacji](../../mfc/automation-servers.md).

##  <a name="runembedded"></a>  CWinApp::RunEmbedded

Wywołaj tę funkcję, aby określić, czy " **/Embedding**"or" **— osadzanie**" opcja jest obecny, która wskazuje, czy aplikacja została uruchomiona przez aplikację kliencką.

```
BOOL RunEmbedded();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli opcja została odnaleziona; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

Jeśli jest obecny, opcją jest usuwany z wiersza polecenia. Aby uzyskać więcej informacji na temat osadzania, zobacz artykuł [serwery: Implementowanie serwera](../../mfc/servers-implementing-a-server.md).

##  <a name="saveallmodified"></a>  CWinApp::SaveAllModified

Wywoływane przez platformę, by zapamiętać wszystkie dokumenty w przypadku aplikacji głównej ramki okna zostanie zamknięty lub za pośrednictwem wiadomości WM_QUERYENDSESSION.

```
virtual BOOL SaveAllModified();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli jest to bezpieczne zakończyć działanie aplikacji; 0, jeśli nie można bezpiecznie zakończyć aplikację.

### <a name="remarks"></a>Uwagi

Domyślna implementacja tej funkcji elementu członkowskiego wywołuje [CDocument::SaveModified](../../mfc/reference/cdocument-class.md#savemodified) funkcję członkowską z kolei wszystkie zmodyfikowane dokumenty w aplikacji.

##  <a name="selectprinter"></a>  CWinApp::SelectPrinter

Wywołaj tę funkcję elementu członkowskiego, aby wybrać drukarkę, a następnie zwolnij drukarki, która wcześniej została wybrana w oknie dialogowym drukowania.

```
void SelectPrinter(
    HANDLE hDevNames,
    HANDLE hDevMode,
    BOOL bFreeOld = TRUE);
```

### <a name="parameters"></a>Parametry

*hDevNames*<br/>
Dojście do [DEVNAMES](../../mfc/reference/devnames-structure.md) struktura, która identyfikuje sterownika, urządzenia i dane wyjściowe nazwy portu określonej drukarki.

*pole hDevMode*<br/>
Dojście do [DEVMODE](/windows/desktop/api/wingdi/ns-wingdi-_devicemodea) strukturę, która określa informacje dotyczące inicjowania urządzenia i środowiska drukarki.

*bFreeOld*<br/>
Zwalnia wcześniej wybrane drukarki.

### <a name="remarks"></a>Uwagi

Jeśli oba *pole hDevMode* i *hDevNames* ma wartość NULL, `SelectPrinter` używa bieżącej domyślnej drukarki.

##  <a name="sethelpmode"></a>  CWinApp::SetHelpMode

Ustawia typ pomocy w aplikacji.

```
void SetHelpMode(AFX_HELP_TYPE eHelpType);
```

### <a name="parameters"></a>Parametry

*eHelpType*<br/>
Określa typ pomocy do użycia. Zobacz [CWinApp::m_eHelpType](#m_ehelptype) Aby uzyskać więcej informacji.

### <a name="remarks"></a>Uwagi

Ustawia typ pomocy w aplikacji.

Aby ustawić automatyczny typ pomocy aplikacji HTMLHelp, można wywołać [EnableHTMLHelp](#enablehtmlhelp). Gdy wywołujesz `EnableHTMLHelp`, aplikacja musi używać HTMLHelp jako swojej aplikacji pomocy. Jeśli chcesz zmienić, aby korzystać z pomocy systemu Windows, można wywołać `SetHelpMode` i ustaw *eHelpType* do `afxWinHelp`.

##  <a name="setregistrykey"></a>  CWinApp::SetRegistryKey

Powoduje, że ustawienia aplikacji, które mają być przechowywane w rejestrze, a nie plików INI.

```
void SetRegistryKey(LPCTSTR lpszRegistryKey);
void SetRegistryKey(UINT nIDRegistryKey);
```

### <a name="parameters"></a>Parametry

*lpszRegistryKey*<br/>
Wskaźnik do ciągu zawierającego nazwę klucza.

*nIDRegistryKey*<br/>
Identyfikator zasobu ciągu zawierającego nazwę klucza rejestru.

### <a name="remarks"></a>Uwagi

Funkcja ta ustawia *m_pszRegistryKey*, który jest następnie używany przez `GetProfileInt`, `GetProfileString`, `WriteProfileInt`, i `WriteProfileString` funkcje elementów członkowskich `CWinApp`. Jeśli ta funkcja została wywołana, listę najbardziej niedawno używanych plików (MRU) również są przechowywane w rejestrze. Klucz rejestru jest zazwyczaj nazwę firmy. Są przechowywane w kluczu następującą postać: HKEY_CURRENT_USER\Software\\< nazwa firmy\>\\< nazwa aplikacji\>\\< nazwa sekcji\>\\< wartość Nazwa\>.

##  <a name="supportsapplicationrecovery"></a>  CWinApp::SupportsApplicationRecovery

Określa, czy Menedżera ponownego uruchamiania przywraca aplikację, która został nieoczekiwanie zakończony.

```
virtual BOOL SupportsApplicationRecovery() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość TRUE wskazuje, że Menedżera ponownego uruchamiania odzyskuje aplikacji; Wartość FALSE wskazuje, że nie ma Menedżera ponownego uruchamiania.

##  <a name="supportsautosaveatinterval"></a>  CWinApp::SupportsAutosaveAtInterval

Określa, czy automatycznie zapisuje Menedżera ponownego uruchamiania otwieranie dokumentów w regularnych odstępach czasu.

```
virtual BOOL SupportsAutosaveAtInterval() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość TRUE wskazuje, że automatycznie zapisuje Menedżera ponownego uruchamiania otwieranie dokumentów; Wartość FALSE wskazuje, że nie ma Menedżera ponownego uruchamiania.

##  <a name="supportsautosaveatrestart"></a>  CWinApp::SupportsAutosaveAtRestart

Określa, czy automatycznie zapisuje Menedżera ponownego uruchomienia wszelkich otwartych dokumentów, po ponownym uruchomieniu aplikacji.

```
virtual BOOL SupportsAutosaveAtRestart() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość TRUE wskazuje, że automatycznie zapisuje Menedżera ponownego uruchamiania otwieranie dokumentów, po ponownym uruchomieniu aplikacji; Wartość FALSE wskazuje, że nie ma Menedżera ponownego uruchamiania.

##  <a name="supportsrestartmanager"></a>  CWinApp::SupportsRestartManager

Określa, czy aplikacja obsługuje Menedżera ponownego uruchamiania.

```
virtual BOOL SupportsRestartManager() const;
```

### <a name="return-value"></a>Wartość zwracana

Wartość TRUE wskazuje, że aplikacja obsługuje Menedżera ponownego uruchamiania; Wartość FALSE wskazuje, że nie ma aplikacji.

##  <a name="unregister"></a>  CWinApp::Unregister

Wyrejestrowuje wszystkie pliki zarejestrowane przez obiekt aplikacji.

```
virtual BOOL Unregister();
```

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera w przypadku powodzenia; w przeciwnym razie 0.

### <a name="remarks"></a>Uwagi

`Unregister` Funkcja cofa rejestracji wykonywanych przez obiekt aplikacji i [zarejestrować](#register) funkcji. Zwykle obu tych funkcji są nazywane niejawnie przez MFC i dlatego nie będą widoczne w kodzie.

Należy przesłonić tę funkcję, aby wykonać kroki wyrejestrowanie niestandardowych.

##  <a name="unregistershellfiletypes"></a>  CWinApp::UnregisterShellFileTypes

Wywołaj tę funkcję elementu członkowskiego, aby wyrejestrować wszystkie typy dokumentów aplikacji za pomocą Menedżera plików Windows.

```
void UnregisterShellFileTypes();
```

##  <a name="winhelp"></a>  CWinApp::WinHelp

Wywołaj tę funkcję elementu członkowskiego do wywołania, by wyświetlić WinHelp aplikacji.

```
virtual void WinHelp(
    DWORD_PTR dwData,
    UINT nCmd = HELP_CONTEXT);
```

### <a name="parameters"></a>Parametry

*dwData*<br/>
Określa dodatkowe dane. Wartość zależy od wartości *nCmd* parametru.

*nCmd*<br/>
Określa typ żądanego pomocy. Aby uzyskać listę możliwych wartości i ich wpływ *dwData* parametrów, zobacz [WinHelp](/windows/desktop/api/winuser/nf-winuser-winhelpa) funkcji Windows.

### <a name="remarks"></a>Uwagi

Struktura wywołuje również tej funkcji do wywołania, by wyświetlić WinHelp aplikacji.

Struktura zostanie automatycznie zamknięte by wyświetlić WinHelp aplikacji, gdy kończy działanie aplikacji.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#53](../../mfc/reference/codesnippet/cpp/cwinapp-class_28.cpp)]

##  <a name="writeprofilebinary"></a>  CWinApp::WriteProfileBinary

Wywołaj tę funkcję elementu członkowskiego do zapisywania danych binarnych w określonej sekcji rejestru w aplikacji lub. Pliku INI.

```
BOOL WriteProfileBinary(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parametry

*lpszSection*<br/>
Wskazuje ciąg zakończony znakiem null określa sekcję zawierającą wpis. Jeśli sekcja nie istnieje, zostanie utworzony. Nazwa sekcji jest przypadek, niezależnie od; ciąg może być w dowolnej kombinacji wielkich i małych liter.

*lpszEntry*<br/>
Wskazuje ciąg zakończony wartością null zawierający wpis, w którym wartość ma być zapisywane. Jeśli wpis nie istnieje w określonej sekcji, zostanie utworzony.

*pData*<br/>
Punkty danych, które ma zostać zapisany.

*nBytes*<br/>
Zawiera liczbę bajtów do zapisania.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="example"></a>Przykład

W tym przykładzie użyto `CWinApp* pApp = AfxGetApp();` można pobrać w klasie CWinApp pokazujący sposób który `WriteProfileBinary` i `GetProfileBinary` można używać z dowolną funkcję w aplikacji MFC.

[!code-cpp[NVC_MFCWindowing#54](../../mfc/reference/codesnippet/cpp/cwinapp-class_29.cpp)]

Inny przykład, zobacz przykład [CWinApp::GetProfileBinary](#getprofilebinary).

##  <a name="writeprofileint"></a>  CWinApp::WriteProfileInt

Wywołaj tę funkcję elementu członkowskiego do zapisu określoną wartość do określonej sekcji rejestru w aplikacji lub. Pliku INI.

```
BOOL WriteProfileInt(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parametry

*lpszSection*<br/>
Wskazuje ciąg zakończony znakiem null określa sekcję zawierającą wpis. Jeśli sekcja nie istnieje, zostanie utworzony. Nazwa sekcji jest przypadek, niezależnie od; ciąg może być w dowolnej kombinacji wielkich i małych liter.

*lpszEntry*<br/>
Wskazuje ciąg zakończony wartością null zawierający wpis, w którym wartość ma być zapisywane. Jeśli wpis nie istnieje w określonej sekcji, zostanie utworzony.

*nWartość:*<br/>
Zawiera wartość, która ma zostać zapisany.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="example"></a>Przykład

W tym przykładzie użyto `CWinApp* pApp = AfxGetApp();` można pobrać w klasie CWinApp pokazujący sposób który `WriteProfileString`, `WriteProfileInt`, `GetProfileString`, i `GetProfileInt` można używać z dowolną funkcję w aplikacji MFC.

[!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]

Inny przykład, zobacz przykład [CWinApp::GetProfileInt](#getprofileint).

##  <a name="writeprofilestring"></a>  CWinApp::WriteProfileString

Wywołaj tę funkcję elementu członkowskiego do zapisu określonego ciągu do określonej sekcji rejestru w aplikacji lub. Pliku INI.

```
BOOL WriteProfileString(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parametry

*lpszSection*<br/>
Wskazuje ciąg zakończony znakiem null określa sekcję zawierającą wpis. Jeśli sekcja nie istnieje, zostanie utworzony. Nazwa sekcji jest przypadek, niezależnie od; ciąg może być w dowolnej kombinacji wielkich i małych liter.

*lpszEntry*<br/>
Wskazuje ciąg zakończony wartością null zawierający wpis, w którym wartość ma być zapisywane. Jeśli wpis nie istnieje w określonej sekcji, zostanie utworzony. Jeśli ten parametr ma wartość NULL, sekcji określony przez *lpszSection* zostanie usunięty.

*lpszValue*<br/>
Wskazuje ciąg, który ma zostać zapisany. Jeśli ten parametr ma wartość NULL, wpis określony przez *lpszEntry* parametr zostanie usunięty.

### <a name="return-value"></a>Wartość zwracana

Wartość różną od zera, jeśli to się powiedzie; w przeciwnym razie 0.

### <a name="example"></a>Przykład

[!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]

Inny przykład, zobacz przykład [CWinApp::GetProfileInt](#getprofileint).

##  <a name="setappid"></a>  CWinApp::SetAppID

Jawnie Ustawia identyfikator modelu użytkownika aplikacji dla aplikacji. Ta metoda powinna być wywoływana przed żadnego interfejsu użytkownika są prezentowane użytkownikowi (najlepiej jest konstruktor aplikacji).

```
void SetAppID(LPCTSTR lpcszAppID);
```

### <a name="parameters"></a>Parametry

*lpcszAppID*<br/>
Określa identyfikator modelu użytkownika aplikacji.

### <a name="remarks"></a>Uwagi

## <a name="see-also"></a>Zobacz też

[Klasa CWinThread](../../mfc/reference/cwinthread-class.md)<br/>
[Wykres hierarchii](../../mfc/hierarchy-chart.md)<br/>
[Instrukcje: dodawanie obsługi menedżera ponownego uruchamiania](../../mfc/how-to-add-restart-manager-support.md)
