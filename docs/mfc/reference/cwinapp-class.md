---
title: "Cwinapp — klasa | Dokumentacja firmy Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CWinApp
- AFXWIN/CWinApp
- AFXWIN/CWinApp::CWinApp
- AFXWIN/CWinApp::AddDocTemplate
- AFXWIN/CWinApp::AddToRecentFileList
- AFXWIN/CWinApp::ApplicationRecoveryCallback
- AFXWIN/CWinApp::CloseAllDocuments
- AFXWIN/CWinApp::CreatePrinterDC
- AFXWIN/CWinApp::DelRegTree
- AFXWIN/CWinApp::DoMessageBox
- AFXWIN/CWinApp::DoWaitCursor
- AFXWIN/CWinApp::EnableD2DSupport
- AFXWIN/CWinApp::EnableHtmlHelp
- AFXWIN/CWinApp::EnableTaskbarInteraction
- AFXWIN/CWinApp::ExitInstance
- AFXWIN/CWinApp::GetApplicationRecoveryParameter
- AFXWIN/CWinApp::GetApplicationRecoveryPingInterval
- AFXWIN/CWinApp::GetApplicationRestartFlags
- AFXWIN/CWinApp::GetAppRegistryKey
- AFXWIN/CWinApp::GetDataRecoveryHandler
- AFXWIN/CWinApp::GetFirstDocTemplatePosition
- AFXWIN/CWinApp::GetHelpMode
- AFXWIN/CWinApp::GetNextDocTemplate
- AFXWIN/CWinApp::GetPrinterDeviceDefaults
- AFXWIN/CWinApp::GetProfileBinary
- AFXWIN/CWinApp::GetProfileInt
- AFXWIN/CWinApp::GetProfileString
- AFXWIN/CWinApp::GetSectionKey
- AFXWIN/CWinApp::HideApplication
- AFXWIN/CWinApp::HtmlHelp
- AFXWIN/CWinApp::InitInstance
- AFXWIN/CWinApp::IsTaskbarInteractionEnabled
- AFXWIN/CWinApp::LoadCursor
- AFXWIN/CWinApp::LoadIcon
- AFXWIN/CWinApp::LoadOEMCursor
- AFXWIN/CWinApp::LoadOEMIcon
- AFXWIN/CWinApp::LoadStandardCursor
- AFXWIN/CWinApp::LoadStandardIcon
- AFXWIN/CWinApp::OnDDECommand
- AFXWIN/CWinApp::OnIdle
- AFXWIN/CWinApp::OpenDocumentFile
- AFXWIN/CWinApp::ParseCommandLine
- AFXWIN/CWinApp::PreTranslateMessage
- AFXWIN/CWinApp::ProcessMessageFilter
- AFXWIN/CWinApp::ProcessShellCommand
- AFXWIN/CWinApp::ProcessWndProcException
- AFXWIN/CWinApp::Register
- AFXWIN/CWinApp::RegisterWithRestartManager
- AFXWIN/CWinApp::ReopenPreviousFilesAtRestart
- AFXWIN/CWinApp::RestartInstance
- AFXWIN/CWinApp::RestoreAutosavedFilesAtRestart
- AFXWIN/CWinApp::Run
- AFXWIN/CWinApp::RunAutomated
- AFXWIN/CWinApp::RunEmbedded
- AFXWIN/CWinApp::SaveAllModified
- AFXWIN/CWinApp::SelectPrinter
- AFXWIN/CWinApp::SetHelpMode
- AFXWIN/CWinApp::SupportsApplicationRecovery
- AFXWIN/CWinApp::SupportsAutosaveAtInterval
- AFXWIN/CWinApp::SupportsAutosaveAtRestart
- AFXWIN/CWinApp::SupportsRestartManager
- AFXWIN/CWinApp::Unregister
- AFXWIN/CWinApp::WinHelp
- AFXWIN/CWinApp::WriteProfileBinary
- AFXWIN/CWinApp::WriteProfileInt
- AFXWIN/CWinApp::WriteProfileString
- AFXWIN/CWinApp::EnableShellOpen
- AFXWIN/CWinApp::LoadStdProfileSettings
- AFXWIN/CWinApp::OnContextHelp
- AFXWIN/CWinApp::OnFileNew
- AFXWIN/CWinApp::OnFileOpen
- AFXWIN/CWinApp::OnFilePrintSetup
- AFXWIN/CWinApp::OnHelp
- AFXWIN/CWinApp::OnHelpFinder
- AFXWIN/CWinApp::OnHelpIndex
- AFXWIN/CWinApp::OnHelpUsing
- AFXWIN/CWinApp::RegisterShellFileTypes
- AFXWIN/CWinApp::SetAppID
- AFXWIN/CWinApp::SetRegistryKey
- AFXWIN/CWinApp::UnregisterShellFileTypes
- AFXWIN/CWinApp::m_bHelpMode
- AFXWIN/CWinApp::m_eHelpType
- AFXWIN/CWinApp::m_hInstance
- AFXWIN/CWinApp::m_lpCmdLine
- AFXWIN/CWinApp::m_nCmdShow
- AFXWIN/CWinApp::m_pActiveWnd
- AFXWIN/CWinApp::m_pszAppID
- AFXWIN/CWinApp::m_pszAppName
- AFXWIN/CWinApp::m_pszExeName
- AFXWIN/CWinApp::m_pszHelpFilePath
- AFXWIN/CWinApp::m_pszProfileName
- AFXWIN/CWinApp::m_pszRegistryKey
- AFXWIN/CWinApp::m_dwRestartManagerSupportFlags
- AFXWIN/CWinApp::m_nAutosaveInterval
- AFXWIN/CWinApp::m_pDataRecoveryHandler
dev_langs: C++
helpviewer_keywords:
- CWinApp [MFC], CWinApp
- CWinApp [MFC], AddDocTemplate
- CWinApp [MFC], AddToRecentFileList
- CWinApp [MFC], ApplicationRecoveryCallback
- CWinApp [MFC], CloseAllDocuments
- CWinApp [MFC], CreatePrinterDC
- CWinApp [MFC], DelRegTree
- CWinApp [MFC], DoMessageBox
- CWinApp [MFC], DoWaitCursor
- CWinApp [MFC], EnableD2DSupport
- CWinApp [MFC], EnableHtmlHelp
- CWinApp [MFC], EnableTaskbarInteraction
- CWinApp [MFC], ExitInstance
- CWinApp [MFC], GetApplicationRecoveryParameter
- CWinApp [MFC], GetApplicationRecoveryPingInterval
- CWinApp [MFC], GetApplicationRestartFlags
- CWinApp [MFC], GetAppRegistryKey
- CWinApp [MFC], GetDataRecoveryHandler
- CWinApp [MFC], GetFirstDocTemplatePosition
- CWinApp [MFC], GetHelpMode
- CWinApp [MFC], GetNextDocTemplate
- CWinApp [MFC], GetPrinterDeviceDefaults
- CWinApp [MFC], GetProfileBinary
- CWinApp [MFC], GetProfileInt
- CWinApp [MFC], GetProfileString
- CWinApp [MFC], GetSectionKey
- CWinApp [MFC], HideApplication
- CWinApp [MFC], HtmlHelp
- CWinApp [MFC], InitInstance
- CWinApp [MFC], IsTaskbarInteractionEnabled
- CWinApp [MFC], LoadCursor
- CWinApp [MFC], LoadIcon
- CWinApp [MFC], LoadOEMCursor
- CWinApp [MFC], LoadOEMIcon
- CWinApp [MFC], LoadStandardCursor
- CWinApp [MFC], LoadStandardIcon
- CWinApp [MFC], OnDDECommand
- CWinApp [MFC], OnIdle
- CWinApp [MFC], OpenDocumentFile
- CWinApp [MFC], ParseCommandLine
- CWinApp [MFC], PreTranslateMessage
- CWinApp [MFC], ProcessMessageFilter
- CWinApp [MFC], ProcessShellCommand
- CWinApp [MFC], ProcessWndProcException
- CWinApp [MFC], Register
- CWinApp [MFC], RegisterWithRestartManager
- CWinApp [MFC], ReopenPreviousFilesAtRestart
- CWinApp [MFC], RestartInstance
- CWinApp [MFC], RestoreAutosavedFilesAtRestart
- CWinApp [MFC], Run
- CWinApp [MFC], RunAutomated
- CWinApp [MFC], RunEmbedded
- CWinApp [MFC], SaveAllModified
- CWinApp [MFC], SelectPrinter
- CWinApp [MFC], SetHelpMode
- CWinApp [MFC], SupportsApplicationRecovery
- CWinApp [MFC], SupportsAutosaveAtInterval
- CWinApp [MFC], SupportsAutosaveAtRestart
- CWinApp [MFC], SupportsRestartManager
- CWinApp [MFC], Unregister
- CWinApp [MFC], WinHelp
- CWinApp [MFC], WriteProfileBinary
- CWinApp [MFC], WriteProfileInt
- CWinApp [MFC], WriteProfileString
- CWinApp [MFC], EnableShellOpen
- CWinApp [MFC], LoadStdProfileSettings
- CWinApp [MFC], OnContextHelp
- CWinApp [MFC], OnFileNew
- CWinApp [MFC], OnFileOpen
- CWinApp [MFC], OnFilePrintSetup
- CWinApp [MFC], OnHelp
- CWinApp [MFC], OnHelpFinder
- CWinApp [MFC], OnHelpIndex
- CWinApp [MFC], OnHelpUsing
- CWinApp [MFC], RegisterShellFileTypes
- CWinApp [MFC], SetAppID
- CWinApp [MFC], SetRegistryKey
- CWinApp [MFC], UnregisterShellFileTypes
- CWinApp [MFC], m_bHelpMode
- CWinApp [MFC], m_eHelpType
- CWinApp [MFC], m_hInstance
- CWinApp [MFC], m_lpCmdLine
- CWinApp [MFC], m_nCmdShow
- CWinApp [MFC], m_pActiveWnd
- CWinApp [MFC], m_pszAppID
- CWinApp [MFC], m_pszAppName
- CWinApp [MFC], m_pszExeName
- CWinApp [MFC], m_pszHelpFilePath
- CWinApp [MFC], m_pszProfileName
- CWinApp [MFC], m_pszRegistryKey
- CWinApp [MFC], m_dwRestartManagerSupportFlags
- CWinApp [MFC], m_nAutosaveInterval
- CWinApp [MFC], m_pDataRecoveryHandler
ms.assetid: e426a3cd-0d15-40d6-bd55-beaa5feb2343
caps.latest.revision: "27"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: 07c01988c3bd70f6889a687111cca162b180407b
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/24/2017
---
# <a name="cwinapp-class"></a>Cwinapp — klasa
Klasa podstawowa, z którego pochodzi obiektu aplikacji systemu Windows.  
  
## <a name="syntax"></a>Składnia  
  
```  
class CWinApp : public CWinThread  
```  
  
## <a name="members"></a>Elementy członkowskie  
  
### <a name="public-constructors"></a>Konstruktory publiczne  
  
|Nazwa|Opis|  
|----------|-----------------|  
|[CWinApp::CWinApp](#cwinapp)|Konstruuje `CWinApp` obiektu.|  
  
### <a name="public-methods"></a>Metody publiczne  
  
|Nazwa|Opis|  
|----------|-----------------|  
|[CWinApp::AddDocTemplate](#adddoctemplate)|Dodaje szablonu dokumentu do listy szablonów dokumentów dostępnych aplikacji.|  
|[CWinApp::AddToRecentFileList](#addtorecentfilelist)|Dodaje nazwę pliku do listy plików ostatnio używanych (MRU).|  
|[CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback)|Wywoływane przez platformę po nieoczekiwanym zamknięciu aplikacji.|  
|[CWinApp::CloseAllDocuments](#closealldocuments)|Zamyka wszystkie otwarte dokumenty.|  
|[CWinApp::CreatePrinterDC](#createprinterdc)|Tworzy kontekstu urządzenia drukarki.|  
|[CWinApp::DelRegTree](#delregtree)|Usuwa określony klucz i wszystkich jego podkluczy.|  
|[CWinApp::DoMessageBox](#domessagebox)|Implementuje [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox) dla aplikacji.|  
|[CWinApp::DoWaitCursor](#dowaitcursor)|Włącza kursora oczekiwania i wyłącza.|  
|[CWinApp::EnableD2DSupport](#enabled2dsupport)|Umożliwia aplikacji `D2D` obsługuje. Tę metodę należy wywołać przed zainicjowaniem głównego okna.|  
|[CWinApp::EnableHtmlHelp](#enablehtmlhelp)|Implementuje HTMLHelp dla aplikacji, a nie WinHelp.|  
|[CWinApp::EnableTaskbarInteraction](#enabletaskbarinteraction)|Umożliwia interakcję paska zadań.|  
|[CWinApp::ExitInstance](#exitinstance)|Należy przesłonić, aby wyczyścić, gdy zakończenie aplikacji.|  
|[CWinApp::GetApplicationRecoveryParameter](#getapplicationrecoveryparameter)|Pobiera parametru wejściowego dla metody odzyskiwania aplikacji.|  
|[CWinApp::GetApplicationRecoveryPingInterval](#getapplicationrecoverypinginterval)|Zwraca czas oczekiwania menedżera ponownego uruchamiania dla funkcji wywołania zwrotnego odzyskiwania do zwrócenia.|  
|[CWinApp::GetApplicationRestartFlags](#getapplicationrestartflags)|Zwraca flagi Menedżer ponownego uruchamiania.|  
|[CWinApp::GetAppRegistryKey](#getappregistrykey)|Zwraca klucz HKEY_CURRENT_USER\\\RegistryKey\ProfileName "Oprogramowanie".|  
|[CWinApp::GetDataRecoveryHandler](#getdatarecoveryhandler)|Pobiera program obsługi odzyskiwania danych dla tego wystąpienia aplikacji.|  
|[CWinApp::GetFirstDocTemplatePosition](#getfirstdoctemplateposition)|Pobiera położenie pierwszego szablonu dokumentu.|  
|[CWinApp::GetHelpMode](#gethelpmode)|Pobiera rodzaj pomocy używany przez aplikację.|  
|[CWinApp::GetNextDocTemplate](#getnextdoctemplate)|Pobiera położenie szablonu dokumentu. Może być używane rekursywnie.|  
|[CWinApp::GetPrinterDeviceDefaults](#getprinterdevicedefaults)|Pobiera domyślne ustawienia urządzenia drukarki.|  
|[CWinApp::GetProfileBinary](#getprofilebinary)|Pobiera dane binarne z wpisu w aplikacji. Pliku INI.|  
|[CWinApp::GetProfileInt](#getprofileint)|Pobiera liczbę całkowitą z wpisu w aplikacji. Pliku INI.|  
|[CWinApp::GetProfileString](#getprofilestring)|Pobiera ciąg z wpisu w aplikacji. Pliku INI.|  
|[CWinApp::GetSectionKey](#getsectionkey)|Zwraca klucz HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection "Oprogramowanie".|  
|[CWinApp::HideApplication](#hideapplication)|Ukrywa aplikacji przed zamknięciem wszystkie dokumenty.|  
|[CWinApp::HtmlHelp](#htmlhelp)|Wywołania `HTMLHelp` funkcji systemu Windows.|  
|[CWinApp::InitInstance](#initinstance)|Należy przesłonić, aby wykonać inicjowania wystąpienia systemu Windows, takich jak tworzenie obiektów okna.|  
|[CWinApp::IsTaskbarInteractionEnabled](#istaskbarinteractionenabled)|Informuje, czy włączono interakcji zadań systemu Windows 7.|  
|[CWinApp::LoadCursor](#loadcursor)|Ładuje zasobu kursora.|  
|[CWinApp::LoadIcon](#loadicon)|Ładuje zasobu ikony.|  
|[CWinApp::LoadOEMCursor](#loadoemcursor)|Ładunki Windows OEM wstępnie zdefiniowane kursora który **OCR_** stałe określić w systemie WINDOWS. H.|  
|[CWinApp::LoadOEMIcon](#loadoemicon)|Ładuje ikoną wstępnie zdefiniowanych przez producenta OEM systemu Windows który **OIC_** stałe określić w systemie WINDOWS. H.|  
|[CWinApp::LoadStandardCursor](#loadstandardcursor)|Obciążenia systemu Windows jest wstępnie zdefiniowane kursora który **IDC_** stałe określić w systemie WINDOWS. H.|  
|[CWinApp::LoadStandardIcon](#loadstandardicon)|Ładuje ikoną wstępnie zdefiniowanych Windows który **IDI_** stałe określić w systemie WINDOWS. H.|  
|[CWinApp::OnDDECommand](#onddecommand)|Wywoływana przez platformę w odpowiedzi na dynamiczne dane programu exchange (DDE) wykonania polecenia.|  
|[CWinApp::OnIdle](#onidle)|Należy przesłonić, aby wykonać przetwarzania czas bezczynności specyficzne dla aplikacji.|  
|[CWinApp::OpenDocumentFile](#opendocumentfile)|Wywoływane przez platformę, by otworzyć dokument z pliku.|  
|[CWinApp::ParseCommandLine](#parsecommandline)|Analizuje poszczególnych parametrów i flagi w wierszu polecenia.|  
|[CWinApp::PreTranslateMessage](#pretranslatemessage)|Filtry komunikatów przed ich wysłaniem z funkcjami systemu Windows [TranslateMessage](http://msdn.microsoft.com/library/windows/desktop/ms644955) i [DispatchMessage](http://msdn.microsoft.com/library/windows/desktop/ms644934).|  
|[CWinApp::ProcessMessageFilter](#processmessagefilter)|Przechwytuje komunikatów przed dotarciem aplikacji.|  
|[CWinApp::ProcessShellCommand](#processshellcommand)|Obsługuje flagi i argumenty wiersza polecenia.|  
|[CWinApp::ProcessWndProcException](#processwndprocexception)|Przechwytuje wszystkie nieobsługiwane wyjątki rzucane przez komunikat aplikacji i programy obsługi poleceń.|  
|[CWinApp::Register](#register)|Wykonuje dostosowane rejestracji.|  
|[CWinApp::RegisterWithRestartManager](#registerwithrestartmanager)|Rejestruje aplikację przy użyciu Menedżera ponownego uruchomienia.|  
|[CWinApp::ReopenPreviousFilesAtRestart](#reopenpreviousfilesatrestart)|Określa, czy Menedżer ponownego uruchamiania ponownie otwiera pliki, które były otwarte podczas aplikacji został nieoczekiwanie zakończony.|  
|[CWinApp::RestartInstance](#restartinstance)|Obsługuje inicjowane przez ponowne uruchomienie Menedżera ponownego uruchamiania aplikacji.|  
|[CWinApp::RestoreAutosavedFilesAtRestart](#restoreautosavedfilesatrestart)|Określa, czy Menedżer ponownego uruchamiania przywraca pliki zapisana automatycznie po jego ponownym uruchomieniu aplikacji.|  
|[CWinApp::Run](#run)|Uruchamia domyślną pętlę komunikatów. Należy przesłonić, aby dostosować pętli komunikatów.|  
|[CWinApp::RunAutomated](#runautomated)|Testy aplikacji wiersza polecenia dla **/Automation** opcji. Nieaktualne. Zamiast tego należy użyć wartości w [CCommandLineInfo::m_bRunAutomated](../../mfc/reference/ccommandlineinfo-class.md#m_brunautomated) po wywołaniu [ParseCommandLine](#parsecommandline).|  
|[CWinApp::RunEmbedded](#runembedded)|Testy aplikacji wiersza polecenia dla **/osadzanie** opcji. Nieaktualne. Zamiast tego należy użyć wartości w [CCommandLineInfo::m_bRunEmbedded](../../mfc/reference/ccommandlineinfo-class.md#m_brunembedded) po wywołaniu [ParseCommandLine](#parsecommandline).|  
|[CWinApp::SaveAllModified](#saveallmodified)|Monituje użytkownika o Zapisz wszystkie zmodyfikowane dokumenty.|  
|[CWinApp::SelectPrinter](#selectprinter)|Wybiera drukarki wcześniej wskazanych przez użytkownika za pomocą okna dialogowego drukowania.|  
|[CWinApp::SetHelpMode](#sethelpmode)|Ustawia i inicjuje rodzaj pomocy używany przez aplikację.|  
|[CWinApp::SupportsApplicationRecovery](#supportsapplicationrecovery)|Określa, czy Menedżer ponownego uruchamiania odzyskuje aplikację, która został nieoczekiwanie zakończony.|  
|[CWinApp::SupportsAutosaveAtInterval](#supportsautosaveatinterval)|Określa, czy ponowne uruchomienie autosaves Menedżera otwieranie dokumentów w regularnych odstępach czasu.|  
|[CWinApp::SupportsAutosaveAtRestart](#supportsautosaveatrestart)|Określa, czy autosaves Menedżera ponownego uruchomienia wszelkich otwartych dokumentów po ponownym uruchomieniu aplikacji.|  
|[CWinApp::SupportsRestartManager](#supportsrestartmanager)|Określa, czy aplikacja obsługuje Menedżer ponownego uruchamiania.|  
|[CWinApp::Unregister](#unregister)|Wyrejestrowuje wszystko, który został zarejestrowany przez `CWinApp` obiektu.|  
|[CWinApp::WinHelp](#winhelp)|Wywołania `WinHelp` funkcji systemu Windows.|  
|[CWinApp::WriteProfileBinary](#writeprofilebinary)|Zapisuje dane binarne do zapisu w aplikacji. Pliku INI.|  
|[CWinApp::WriteProfileInt](#writeprofileint)|Zapisuje całkowitą wpis w aplikacji. Pliku INI.|  
|[CWinApp::WriteProfileString](#writeprofilestring)|Zapisuje ciąg do zapisu w aplikacji. Pliku INI.|  
  
### <a name="protected-methods"></a>Metody chronione  
  
|Nazwa|Opis|  
|----------|-----------------|  
|[CWinApp::EnableShellOpen](#enableshellopen)|Umożliwia użytkownikowi otwieranie plików danych, Menedżera plików z systemu Windows.|  
|[CWinApp::LoadStdProfileSettings](#loadstdprofilesettings)|Standard obciążeń. Ustawienia pliku INI i umożliwia MRU plików funkcji z listy.|  
|[CWinApp::OnContextHelp](#oncontexthelp)|Obsługuje SHIFT + F1 Pomoc w aplikacji.|  
|[CWinApp::OnFileNew](#onfilenew)|Implementuje `ID_FILE_NEW` polecenia.|  
|[CWinApp::OnFileOpen](#onfileopen)|Implementuje `ID_FILE_OPEN` polecenia.|  
|[CWinApp::OnFilePrintSetup](#onfileprintsetup)|Implementuje `ID_FILE_PRINT_SETUP` polecenia.|  
|[CWinApp::OnHelp](#onhelp)|Obsługuje pomocy F1 w aplikacji (przy użyciu bieżącego kontekstu).|  
|[CWinApp::OnHelpFinder](#onhelpfinder)|Obsługuje `ID_HELP_FINDER` i `ID_DEFAULT_HELP` poleceń.|  
|[CWinApp::OnHelpIndex](#onhelpindex)|Obsługuje `ID_HELP_INDEX` poleceń i udostępnia domyślny temat pomocy.|  
|[CWinApp::OnHelpUsing](#onhelpusing)|Obsługuje `ID_HELP_USING` polecenia.|  
|[CWinApp::RegisterShellFileTypes](#registershellfiletypes)|Rejestruje wszystkie aplikacji typów dokumentów przy użyciu Menedżera plików systemu Windows.|  
|[CWinApp::SetAppID](#setappid)|Jawnie Ustawia identyfikator modelu użytkownika aplikacji dla aplikacji. Ta metoda powinna być wywoływana przed interfejs użytkownika jest widoczne dla użytkowników (najlepiej jest konstruktor aplikacji).|  
|[CWinApp::SetRegistryKey](#setregistrykey)|Powoduje, że ustawienia aplikacji, które mają być przechowywane w rejestrze, a. Pliki INI.|  
|[CWinApp::UnregisterShellFileTypes](#unregistershellfiletypes)|Wyrejestrowuje typów dokumentów wszystkich aplikacji przy użyciu Menedżera plików systemu Windows.|  
  
### <a name="public-data-members"></a>Publiczne elementy członkowskie danych  
  
|Nazwa|Opis|  
|----------|-----------------|  
|[CWinApp::m_bHelpMode](#m_bhelpmode)|Wskazuje, czy użytkownik jest w trybie kontekstu pomocy (zazwyczaj wywoływana z SHIFT + F1).|  
|[CWinApp::m_eHelpType](#m_ehelptype)|Określa rodzaj pomocy używany przez aplikację.|  
|[CWinApp::m_hInstance](#m_hinstance)|Określa bieżące wystąpienie aplikacji.|  
|[CWinApp::m_lpCmdLine](#m_lpcmdline)|Wskazuje zerem ciąg, który określa wiersz polecenia dla aplikacji.|  
|[CWinApp::m_nCmdShow](#m_ncmdshow)|Określa, jaki ma być wyświetlana początkowo okna.|  
|[CWinApp::m_pActiveWnd](#m_pactivewnd)|Wskaźnik do głównego okna aplikacji kontenera, gdy jest aktywny w miejscu.|  
|[CWinApp::m_pszAppID](#m_pszappid)|Identyfikator aplikacji użytkownika modelu.|  
|[CWinApp::m_pszAppName](#m_pszappname)|Określa nazwę aplikacji.|  
|[CWinApp::m_pszExeName](#m_pszexename)|Nazwa modułu aplikacji.|  
|[CWinApp::m_pszHelpFilePath](#m_pszhelpfilepath)|Ścieżka do pliku pomocy w aplikacji.|  
|[CWinApp::m_pszProfileName](#m_pszprofilename)|Aplikacji. Nazwa pliku INI.|  
|[CWinApp::m_pszRegistryKey](#m_pszregistrykey)|Używany do określenia klucza rejestru pełnego do przechowywania ustawień profilu aplikacji.|  
  
### <a name="protected-data-members"></a>Dane chronione elementy członkowskie  
  
|Nazwa|Opis|  
|----------|-----------------|  
|[CWinApp::m_dwRestartManagerSupportFlags](#m_dwrestartmanagersupportflags)|Flagi, które określają sposób zachowania Menedżer ponownego uruchamiania.|  
|[CWinApp::m_nAutosaveInterval](#m_nautosaveinterval)|Długość czasu w milisekundach między autosaves.|  
|[CWinApp::m_pDataRecoveryHandler](#m_pdatarecoveryhandler)|Wskaźnik do obsługi odzyskiwania danych aplikacji.|  
  
## <a name="remarks"></a>Uwagi  
 Obiekt application zapewnia funkcje Członkowskie inicjowania aplikacji (i każde wystąpienie) oraz uruchamiania aplikacji.  
  
 Każdej aplikacji, która używa Microsoft Foundation classes może zawierać tylko jeden obiekt pochodzący od `CWinApp`. Ten obiekt jest tworzony w przypadku innych obiektów globalnych C++ są konstruowane i już jest dostępna, gdy system Windows wywołuje `WinMain` funkcji, która jest dostarczana przez Microsoft Foundation Class Library. Zadeklarować Twojej pochodnej `CWinApp` obiektów na poziomie globalnym.  
  
 Jeśli pochodzi klasy aplikacji z `CWinApp`, Zastąp [InitInstance](#initinstance) funkcji członkowskiej można utworzyć obiektu głównego okna aplikacji.  
  
 Oprócz `CWinApp` funkcje Członkowskie Microsoft Foundation Class Library udostępnia następujące funkcje globalnego dostępu do sieci `CWinApp` obiektu i inne informacje globalne:  
  
- [Afxgetapp —](application-information-and-management.md#afxgetapp) uzyskuje wskaźnik do `CWinApp` obiektu.  
  
- [Afxgetinstancehandle —](application-information-and-management.md#afxgetinstancehandle) uzyskuje obsługę bieżącego wystąpienia aplikacji.  
  
- [Afxgetresourcehandle —](application-information-and-management.md#afxgetresourcehandle) uzyskuje obsługę zasoby aplikacji.  
  
- [Afxgetappname —](application-information-and-management.md#afxgetappname) uzyskuje wskaźnik do ciąg zawierający nazwę aplikacji. Alternatywnie Jeśli masz wskaźnik do `CWinApp` obiektów, użyj `m_pszExeName` można pobrać nazwy aplikacji.  
  
 Zobacz [CWinApp: klasa aplikacji](../../mfc/cwinapp-the-application-class.md) Aby uzyskać więcej informacji na temat `CWinApp` klasy, w tym omówienie z następujących czynności:  
  
- `CWinApp`-pochodnych kodu napisanego przez Kreatora aplikacji.  
  
- `CWinApp`w roli w kolejności wykonania aplikacji.  
  
- `CWinApp`przez domyślnej implementacji funkcji Członkowskich.  
  
- `CWinApp`tego klucza z możliwością zastąpienia.  
  
 **M_hPrevInstance** element członkowski danych już nie istnieje. Aby uzyskać informacje na temat wykrywania poprzednie wystąpienie `CWinApp`, zobacz artykuł bazy wiedzy Knowledge Base "Jak do identyfikowania poprzednie wystąpienie z aplikacji" (KB106385) w [http://support.microsoft.com/default.aspxscid=kb;en-us;106385](http://support.microsoft.com/default.aspxscid=kb;en-us;106385).  
  
## <a name="inheritance-hierarchy"></a>Hierarchia dziedziczenia  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget —](../../mfc/reference/ccmdtarget-class.md)  
  
 [Cwinthread —](../../mfc/reference/cwinthread-class.md)  
  
 `CWinApp`  
  
## <a name="requirements"></a>Wymagania  
 **Nagłówek:** afxwin.h  
  
##  <a name="adddoctemplate"></a>CWinApp::AddDocTemplate  
 Wywołanie tej funkcji elementu członkowskiego, aby dodać szablon dokumentu do listy dokumentów dostępnych szablonów, które obsługuje aplikację.  
  
```  
void AddDocTemplate(CDocTemplate* pTemplate);
```  
  
### <a name="parameters"></a>Parametry  
 `pTemplate`  
 Wskaźnik do `CDocTemplate` do dodania.  
  
### <a name="remarks"></a>Uwagi  
 Należy dodać wszystkie szablony do aplikacji dokumentów przed wywołaniem [RegisterShellFileTypes](#registershellfiletypes).  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#35](../../mfc/reference/codesnippet/cpp/cwinapp-class_1.cpp)]  
  
##  <a name="addtorecentfilelist"></a>CWinApp::AddToRecentFileList  
 Wywołanie tej funkcji Członkowskich, aby dodać `lpszPathName` do listy ostatnio używanych plików.  
  
```  
virtual void AddToRecentFileList(LPCTSTR lpszPathName);
```  
  
### <a name="parameters"></a>Parametry  
 `lpszPathName`  
 Ścieżka pliku.  
  
### <a name="remarks"></a>Uwagi  
 Należy wywołać [LoadStdProfileSettings](#loadstdprofilesettings) funkcji członkowskiej załadować bieżącej listy plików przed użyciem tej funkcji Członkowskich.  
  
 Struktura wywołuje funkcji członkowskiej, gdy otworzy plik lub wykonuje polecenia Zapisz jako, aby zapisać plik z nową nazwą.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#36](../../mfc/reference/codesnippet/cpp/cwinapp-class_2.cpp)]  
  
##  <a name="applicationrecoverycallback"></a>CWinApp::ApplicationRecoveryCallback  
 Wywoływane przez platformę po nieoczekiwanym zamknięciu aplikacji.  
  
```  
virtual DWORD ApplicationRecoveryCallback(LPVOID lpvParam);
```  
  
### <a name="parameters"></a>Parametry  
 [in]`lpvParam`  
 Zarezerwowane do użytku w przyszłości.  
  
### <a name="return-value"></a>Wartość zwracana  
 0, jeśli ta metoda zakończy się pomyślnie; różna od zera, jeśli wystąpi błąd.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli aplikacja obsługuje Menedżer ponownego uruchamiania, struktura wywołuje tej funkcji, gdy aplikacja nieoczekiwanie kończy.  
  
 Domyślna implementacja `ApplicationRecoveryCallback` używa `CDataRecoveryHandler` zapisać listę aktualnie otwarte dokumenty do rejestru. Ta metoda nie nie autosave żadnych plików.  
  
 Aby dostosować zachowanie, należy przesłonić tę funkcję w pochodnym [cwinapp — klasa](../../mfc/reference/cwinapp-class.md) lub Przekaż własnej metody odzyskiwania aplikacji jako parametr [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).  
  
##  <a name="closealldocuments"></a>CWinApp::CloseAllDocuments  
 Wywołanie tej funkcji elementu członkowskiego, aby zamknąć wszystkie otwarte dokumenty przed zakończeniem.  
  
```  
void CloseAllDocuments(BOOL bEndSession);
```  
  
### <a name="parameters"></a>Parametry  
 `bEndSession`  
 Określa, czy zakończenia sesji systemu Windows. Jest **TRUE** Jeśli w sesji jest zakończone, w przeciwnym **FALSE**.  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie [HideApplication](#hideapplication) przed wywołaniem `CloseAllDocuments`.  
  
##  <a name="createprinterdc"></a>CWinApp::CreatePrinterDC  
 Wywołanie tej funkcji elementu członkowskiego, aby utworzyć drukarki kontekstu urządzenia (DC) na podstawie wybranej drukarki.  
  
```  
BOOL CreatePrinterDC(CDC& dc);
```  
  
### <a name="parameters"></a>Parametry  
 `dc`  
 Odwołanie do kontekstu urządzenia drukarki.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli kontekst urządzenia drukarki został utworzony pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 `CreatePrinterDC`inicjalizuje kontekst urządzenia, który jest przekazywany w przez odwołanie, aby można było ich użyć do drukowania.  
  
 Jeśli funkcja zakończy się pomyślnie, po zakończeniu drukowania, należy zniszczyć kontekst urządzenia. Możesz pozwolić, aby destruktor [CDC](../../mfc/reference/cdc-class.md) obiektu to zrobić, lub możesz zrobić to jawnie przez wywołanie metody [CDC::DeleteDC](../../mfc/reference/cdc-class.md#deletedc).  
  
##  <a name="cwinapp"></a>CWinApp::CWinApp  
 Konstruuje `CWinApp` obiekt i przekazuje `lpszAppName` mają być przechowywane jako nazwa aplikacji.  
  
```  
CWinApp(LPCTSTR lpszAppName = NULL);
```  
  
### <a name="parameters"></a>Parametry  
 `lpszAppName`  
 Ciąg zerem, który zawiera nazwę aplikacji, która korzysta z systemu Windows. Jeśli ten argument nie jest podany lub jest **NULL**, `CWinApp` używa ciągu zasobu **AFX_IDS_APP_TITLE** lub nazwę pliku wykonywalnego.  
  
### <a name="remarks"></a>Uwagi  
 Należy utworzyć jedną globalnego obiektu z `CWinApp`-klasy. Może mieć tylko jeden `CWinApp` obiektów w aplikacji. Konstruktor przechowuje wskaźnik do `CWinApp` obiekt, aby `WinMain` można wywołać elementu członkowskiego obiektu funkcje do zainicjowania i uruchomienia aplikacji.  
  
##  <a name="delregtree"></a>CWinApp::DelRegTree  
 Usuwa określonego klucza rejestru i wszystkich jego podkluczy.  
  
```  
LONG DelRegTree(
    HKEY hParentKey,  
    const CString& strKeyName);

 
LONG DelRegTree(
    HKEY hParentKey,
    const CString& strKeyName,
    CAtlTransactionManager* pTM = NULL);
```  
  
### <a name="parameters"></a>Parametry  
 *hParentKey*  
 Dojście do klucza rejestru.  
  
 *strKeyName*  
 Nazwa klucza rejestru do usunięcia.  
  
 *pTM*  
 Wskaźnik do obiektu CAtlTransactionManager.  
  
### <a name="return-value"></a>Wartość zwracana  
 Jeśli funkcja zakończy się powodzeniem, wartość zwracana jest ERROR_SUCCESS. Jeśli funkcja nie powiedzie się, wartość zwracana jest zdefiniowane w pliku Winerror.h kod błędu różną od zera.  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie tej funkcji do usunięcia określonego klucza i jego podkluczach.  
  
##  <a name="domessagebox"></a>CWinApp::DoMessageBox  
 Struktura wywołuje tę funkcję elementu członkowskiego, aby zaimplementować okno komunikatu dla funkcji globalnej [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox).  
  
```  
virtual int DoMessageBox(
    LPCTSTR lpszPrompt,  
    UINT nType,  
    UINT nIDPrompt);
```  
  
### <a name="parameters"></a>Parametry  
 *lpszPrompt*  
 Adres tekst w oknie komunikatu.  
  
 `nType`  
 W oknie komunikatu [styl](../../mfc/reference/styles-used-by-mfc.md#message-box-styles).  
  
 `nIDPrompt`  
 Indeks ciąg kontekstu pomocy.  
  
### <a name="return-value"></a>Wartość zwracana  
 Zwraca takie same wartości jak `AfxMessageBox`.  
  
### <a name="remarks"></a>Uwagi  
 Nie wywołuj tej funkcji członkowskiej, aby otworzyć okno komunikatu; Użyj `AfxMessageBox` zamiast tego.  
  
 Przesłonić tę funkcję elementu członkowskiego, aby dostosować przetwarzania całej aplikacji `AfxMessageBox` wywołania.  
  
##  <a name="dowaitcursor"></a>CWinApp::DoWaitCursor  
 Ta funkcja elementu członkowskiego jest wywoływana przez platformę, by zaimplementować [CWaitCursor](../../mfc/reference/cwaitcursor-class.md), [CCmdTarget::BeginWaitCursor](../../mfc/reference/ccmdtarget-class.md#beginwaitcursor), [CCmdTarget::EndWaitCursor](../../mfc/reference/ccmdtarget-class.md#endwaitcursor), i [ CCmdTarget::RestoreWaitCursor](../../mfc/reference/ccmdtarget-class.md#restorewaitcursor).  
  
```  
virtual void DoWaitCursor(int nCode);
```  
  
### <a name="parameters"></a>Parametry  
 `nCode`  
 Jeśli ten parametr ma wartość 1, zostanie wyświetlony kursora oczekiwania. W przypadku wartości 0 kursora oczekiwania został przywrócony bez zwiększania liczby odwołania. Jeśli wartość-1, kończy się kursor oczekiwania.  
  
### <a name="remarks"></a>Uwagi  
 Wartość domyślna implementuje klepsydry kursora. `DoWaitCursor`przechowuje liczba odwołań. Gdy dodatni, zostanie wyświetlony klepsydry kursora.  
  
 Gdy nie będzie zwykle wywoływać `DoWaitCursor` bezpośrednio, można przesłonić tę funkcję elementu członkowskiego, aby zmienić kursora oczekiwania lub dodatkowego przetwarzania podczas wyświetlania kursora oczekiwania.  
  
 Łatwiejsze, uproszczony sposób implementowania kursora oczekiwania, można użyć `CWaitCursor`.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#37](../../mfc/reference/codesnippet/cpp/cwinapp-class_3.cpp)]  
  
##  <a name="enabled2dsupport"></a>CWinApp::EnableD2DSupport  
 [!INCLUDE[dev10_sp1required](../../mfc/reference/includes/dev10_sp1required_md.md)]  
  
 Włącza obsługę D2D aplikacji. Tę metodę należy wywołać przed zainicjowaniem głównego okna.  
  
```  
BOOL EnableD2DSupport(
D2D1_FACTORY_TYPE d2dFactoryType = D2D1_FACTORY_TYPE_SINGLE_THREADED,  
DWRITE_FACTORY_TYPE writeFactoryType = DWRITE_FACTORY_TYPE_SHARED);
```  
  
### <a name="parameters"></a>Parametry  
 `d2dFactoryType`  
 Model wątkowości fabryki D2D i zasoby, które tworzy.  
  
 `writeFactoryType`  
 Wartość określająca, czy obiekt fabryki zapisu zostaną udostępnione lub samodzielnie  
  
### <a name="return-value"></a>Wartość zwracana  
 Zwraca wartość PRAWDA, jeśli obsługa D2D został włączony, FALSE — w przeciwnym razie  
  
##  <a name="enablehtmlhelp"></a>CWinApp::EnableHtmlHelp  
 Wywołanie tej funkcji Członkowskich z wewnątrz konstruktora z `CWinApp`-klasy HTMLHelp na potrzeby aplikacji pomocy.  
  
```  
void EnableHtmlHelp();
```  
  
### <a name="remarks"></a>Uwagi  
  
##  <a name="enableshellopen"></a>CWinApp::EnableShellOpen  
 Zazwyczaj wywołanie tej funkcji, z Twojego `InitInstance` zastąpienia, aby umożliwić użytkownikom otwieranie plików danych podczas ich pliki z Menedżera plików w ramach systemu Windows kliknij dwukrotnie ikonę aplikacji.  
  
```  
void EnableShellOpen();
```  
  
### <a name="remarks"></a>Uwagi  
 Wywołanie `RegisterShellFileTypes` elementu członkowskiego działać w połączeniu z tej funkcji, lub Udostępnij. Plik REG o aplikacji ręcznej rejestracji typów dokumentów.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#38](../../mfc/reference/codesnippet/cpp/cwinapp-class_4.cpp)]  
  
##  <a name="enabletaskbarinteraction"></a>CWinApp::EnableTaskbarInteraction  
 Umożliwia interakcję paska zadań.  
  
```  
BOOL EnableTaskbarInteraction(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>Parametry  
 `bEnable`  
 Określa, czy powinno być włączone interakcji z paska zadań systemu Windows 7 ( `TRUE`), lub wyłączona ( `FALSE`).  
  
### <a name="return-value"></a>Wartość zwracana  
 Zwraca `TRUE` Jeśli interakcji zadań można można włączać lub wyłączać.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda musi zostać wywołana przed utworzeniem okna głównego, w przeciwnym razie potwierdzeń i zwraca `FALSE`.  
  
##  <a name="exitinstance"></a>CWinApp::ExitInstance  
 Wywoływane przez platformę z poziomu **Uruchom** funkcji członkowskiej, aby zakończyć pracę tego wystąpienia aplikacji.  
  
```  
virtual int ExitInstance();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Kod zakończenia aplikacji; 0 oznacza brak błędów, a wartości większe od 0 wskazuje błąd. Ta wartość jest używana jako wartość zwrotną z elementu `WinMain`.  
  
### <a name="remarks"></a>Uwagi  
 Nie wywołuj tej funkcji członkowskiej z dowolnego miejsca ale poziomu **Uruchom** funkcję elementu członkowskiego.  
  
 Domyślna implementacja tej funkcji zapisuje framework opcje do aplikacji. Pliku INI. Należy przesłonić tę funkcję, aby wyczyścić, gdy zakończenie aplikacji.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#39](../../mfc/reference/codesnippet/cpp/cwinapp-class_5.cpp)]  
  
##  <a name="getapplicationrecoveryparameter"></a>CWinApp::GetApplicationRecoveryParameter  
 Pobiera parametru wejściowego dla metody odzyskiwania aplikacji.  
  
```  
virtual LPVOID GetApplicationRecoveryParameter();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Domyślną parametru wejściowego dla metody odzyskiwania aplikacji.  
  
### <a name="remarks"></a>Uwagi  
 Zwraca domyślne zachowanie tej funkcji `NULL`.  
  
 Aby uzyskać więcej informacji, zobacz [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).  
  
##  <a name="getapplicationrecoverypinginterval"></a>CWinApp::GetApplicationRecoveryPingInterval  
 Zwraca czas oczekiwania menedżera ponownego uruchamiania dla funkcji wywołania zwrotnego odzyskiwania do zwrócenia.  
  
```  
virtual DWORD GetApplicationRecoveryPingInterval();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Długość czasu w milisekundach.  
  
### <a name="remarks"></a>Uwagi  
 Gdy aplikacja, która jest zarejestrowana nieoczekiwanie wyjścia Menedżera ponownego uruchomienia, aplikacja próbuje zapisać otwarte dokumenty i wywołuje funkcję wywołania zwrotnego odzyskiwania. Funkcja wywołania zwrotnego odzyskiwania domyślny jest [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).  
  
 Czas oczekiwania w ramach funkcji wywołania zwrotnego odzyskiwania do zwrócenia jest interwałem ping. Możesz dostosować interwał ping przez zastąpienie `CWinApp::GetApplicationRecoveryPingInterval` lub poprzez świadczenie niestandardowej wartości do `RegisterWithRestartManager`.  
  
##  <a name="getapplicationrestartflags"></a>CWinApp::GetApplicationRestartFlags  
 Zwraca flagi Menedżer ponownego uruchamiania.  
  
```  
virtual DWORD GetApplicationRestartFlags();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Flagi Menedżera ponownego uruchomienia. Domyślna implementacja zwraca wartość 0.  
  
### <a name="remarks"></a>Uwagi  
 Flagi Menedżera ponownego uruchomienia nie obowiązują z domyślną implementację. Są one udostępniane do użytku w przyszłości.  
  
 Ustaw flagi podczas rejestrowania aplikacji przy użyciu Menedżera ponownego uruchomienia przy użyciu [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).  
  
 Możliwe wartości flag Menedżera ponownego uruchomienia komputera są następujące:  
  
- `RESTART_NO_CRASH`  
  
- `RESTART_NO_HANG`  
  
- `RESTART_NO_PATCH`  
  
- `RESTART_NO_REBOOT`  
  
##  <a name="getappregistrykey"></a>CWinApp::GetAppRegistryKey  
 Zwraca klucz HKEY_CURRENT_USER\\\RegistryKey\ProfileName "Oprogramowanie".  
  
```  
HKEY GetAppRegistryKey(CAtlTransactionManager* pTM = NULL);
```  
  
### <a name="parameters"></a>Parametry  
 `pTM`  
 Wskaźnik do `CAtlTransactionManager` obiektu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Klucz aplikacji, jeśli funkcja zakończy się pomyślnie; w przeciwnym razie `NULL`.  
  
### <a name="remarks"></a>Uwagi  
  
##  <a name="getdatarecoveryhandler"></a>CWinApp::GetDataRecoveryHandler  
 Pobiera program obsługi odzyskiwania danych dla tego wystąpienia aplikacji.  
  
```  
virtual CDataRecoveryHandler *GetDataRecoveryHandler();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Obsługa odzyskiwania danych dla tego wystąpienia aplikacji.  
  
### <a name="remarks"></a>Uwagi  
 Każda aplikacja, który używa Menedżera ponownego uruchomienia musi mieć jedno wystąpienie [CDataRecoveryHandler klasy](../../mfc/reference/cdatarecoveryhandler-class.md). Ta klasa jest odpowiedzialny za monitorowanie otwarte dokumenty i pliki autozapisywanie. Zachowanie `CDataRecoveryHandler` zależy od konfiguracji Menedżera ponownego uruchomienia. Aby uzyskać więcej informacji, zobacz [CDataRecoveryHandler klasy](../../mfc/reference/cdatarecoveryhandler-class.md).  
  
 Ta metoda zwraca `NULL` w systemach operacyjnych starszych niż [!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]. Menedżer ponownego uruchamiania nie jest obsługiwana w systemach operacyjnych starszych niż [!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)].  
  
 Jeśli aplikacja nie ma obecnie Obsługa odzyskiwania danych, ta metoda tworzy i zwraca wskaźnik do niego.  
  
##  <a name="getfirstdoctemplateposition"></a>CWinApp::GetFirstDocTemplatePosition  
 Pobiera położenie pierwszego szablonu dokumentu w aplikacji.  
  
```  
POSITION GetFirstDocTemplatePosition() const;  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 A **pozycji** wartość, która może służyć do iteracji lub pobieranie wskaźnika obiektu; **NULL** Jeśli lista jest pusta.  
  
### <a name="remarks"></a>Uwagi  
 Użyj **pozycji** w wywołaniu zwracana wartość [GetNextDocTemplate](#getnextdoctemplate) uzyskać pierwszy [cdoctemplate —](../../mfc/reference/cdoctemplate-class.md) obiektu.  
  
##  <a name="gethelpmode"></a>CWinApp::GetHelpMode  
 Pobiera rodzaj pomocy używany przez aplikację.  
  
```  
AFX_HELP_TYPE GetHelpMode();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Typ pomocy, używany przez aplikację. Zobacz [CWinApp::m_eHelpType](#m_ehelptype) Aby uzyskać więcej informacji.  
  
##  <a name="getnextdoctemplate"></a>CWinApp::GetNextDocTemplate  
 Pobiera identyfikowana na podstawie szablonu dokumentu `pos`, następnie ustawia `pos` do **pozycji** wartość.  
  
```  
CDocTemplate* GetNextDocTemplate(POSITION& pos) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `pos`  
 Odwołanie do **pozycji** wartość zwrócona przez poprzednie wywołanie `GetNextDocTemplate` lub [GetFirstDocTemplatePosition](#getfirstdoctemplateposition). Wartość jest aktualizowana do pozycji dalej przez to wywołanie.  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do [cdoctemplate —](../../mfc/reference/cdoctemplate-class.md) obiektu.  
  
### <a name="remarks"></a>Uwagi  
 Można użyć `GetNextDocTemplate` w pętli do przodu iteracji, jeśli ustanowić położenie początkowe w wyniku wywołania `GetFirstDocTemplatePosition`.  
  
 Upewnij się, że Twoje **pozycji** wartość jest prawidłowa. Jeśli jest nieprawidłowa wersja do debugowania programu Microsoft Foundation Class Library potwierdzeń.  
  
 Jeśli szablon pobrany dokumentu jest ostatni dostępny, następnie nowa wartość `pos` ma ustawioną wartość **NULL**.  
  
##  <a name="getprinterdevicedefaults"></a>CWinApp::GetPrinterDeviceDefaults  
 Wywołanie tej funkcji elementu członkowskiego, aby przygotować drukarki kontekst urządzenia do drukowania.  
  
```  
BOOL GetPrinterDeviceDefaults(struct tagPDA* pPrintDlg);
```  
  
### <a name="parameters"></a>Parametry  
 *pPrintDlg*  
 Wskaźnik do [PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646843) struktury.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Pobiera bieżące ustawienia domyślne drukarki z systemu Windows. Plik INI jako konieczne lub używa ostatniej konfiguracji drukarek ustawiony przez użytkownika w Instalatorze drukowania.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#40](../../mfc/reference/codesnippet/cpp/cwinapp-class_6.cpp)]  
  
##  <a name="getprofilebinary"></a>CWinApp::GetProfileBinary  
 Wywołanie tej funkcji członkowskich można pobrać danych binarnych z wpisu w ramach określonej sekcji rejestru aplikacji lub. Pliku INI.  
  
```  
BOOL GetProfileBinary(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPBYTE* ppData,  
    UINT* pBytes);
```  
  
### <a name="parameters"></a>Parametry  
 *lpszSection*  
 Wskazuje zerem ciąg, który określa sekcja zawierająca wpis.  
  
 *lpszEntry*  
 Wskazuje zerem ciąg, który zawiera wpis, którego wartość ma być pobrana.  
  
 *ppData*  
 Wskazuje wskaźnika, które będą otrzymywać adresy danych.  
  
 *pBytes*  
 Wskazuje UINT, który będzie otrzymywał rozmiar danych (w bajtach).  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Funkcji członkowskiej nie jest uwzględniana wielkość liter, więc ciągów w *lpszSection* i *lpszEntry* parametry mogą się różnić w przypadku.  
  
> [!NOTE]
> **GetProfileBinary** przydziela buforu i zwraca jego adresu w \* *ppData*. Element wywołujący jest odpowiedzialny za zwalnianie przy użyciu buforu **delete []**.  
  
> [!IMPORTANT]
>  Danych zwróconych przez tę funkcję nie jest zawsze NULL zakończone i obiekt wywołujący musi przeprowadzić weryfikacji. Aby uzyskać więcej informacji, zobacz [unikanie Overruns buforu](http://msdn.microsoft.com/library/windows/desktop/ms717795).  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#41](../../mfc/reference/codesnippet/cpp/cwinapp-class_7.cpp)]  
  
 Na przykład dodatkowe zobacz [CWinApp::WriteProfileBinary](#writeprofilebinary).  
  
##  <a name="getprofileint"></a>CWinApp::GetProfileInt  
 Wywołanie tej funkcji członkowskich można pobrać wartość całkowitą z wpisu w ramach określonej sekcji rejestru aplikacji lub. Pliku INI.  
  
```  
UINT GetProfileInt(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    int nDefault);
```  
  
### <a name="parameters"></a>Parametry  
 `lpszSection`  
 Wskazuje zerem ciąg, który określa sekcja zawierająca wpis.  
  
 `lpszEntry`  
 Wskazuje zerem ciąg, który zawiera wpis, którego wartość ma być pobrana.  
  
 `nDefault`  
 Określa wartość domyślną do zwrócenia, jeśli w ramach nie można znaleźć wpisu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Wartość całkowitą typu ciąg, który wykonuje określonego wpisu, jeśli funkcja zakończy się pomyślnie. Wartość zwracana jest wartość `nDefault` parametru, jeśli funkcja nie może znaleźć wpisu. Zwracana wartość to 0, jeśli wartość, która odpowiada określony wpis nie jest liczbą całkowitą.  
  
 Funkcji członkowskiej obsługuje szesnastkowym na potrzeby wartości. Pliku INI. Podczas pobierania liczby całkowitej ze znakiem, należy rzutować wartości do `int`.  
  
### <a name="remarks"></a>Uwagi  
 Funkcji członkowskiej nie jest uwzględniana wielkość liter, więc ciągów w `lpszSection` i `lpszEntry` parametry mogą się różnić w przypadku.  
  
> [!IMPORTANT]
>  Danych zwróconych przez tę funkcję nie jest zawsze NULL zakończone i obiekt wywołujący musi przeprowadzić weryfikacji. Aby uzyskać więcej informacji, zobacz [unikanie Overruns buforu](http://msdn.microsoft.com/library/windows/desktop/ms717795).  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#42](../../mfc/reference/codesnippet/cpp/cwinapp-class_8.cpp)]  
  
 Na przykład dodatkowe zobacz [CWinApp::WriteProfileInt](#writeprofileint).  
  
##  <a name="getprofilestring"></a>CWinApp::GetProfileString  
 Wywołanie tej funkcji członkowskich można pobrać ciągu skojarzonego z wpisem w określonej sekcji w rejestrze aplikacji lub. Pliku INI.  
  
```  
CString GetProfileString(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPCTSTR lpszDefault = NULL);
```  
  
### <a name="parameters"></a>Parametry  
 `lpszSection`  
 Wskazuje zerem ciąg, który określa sekcja zawierająca wpis.  
  
 `lpszEntry`  
 Wskazuje zerem ciąg, który zawiera wpis w ciągu którego ma być pobrana. Ta wartość nie może być **NULL**.  
  
 `lpszDefault`  
 Wskazuje domyślną wartość ciągu dla danego wpisu, jeśli nie można odnaleźć wpisu w pliku inicjującego.  
  
### <a name="return-value"></a>Wartość zwracana  
 Zwracana wartość jest ciągiem z aplikacji. Plik INI lub `lpszDefault` Jeśli nie można odnaleźć ciągu. Maksymalna długość ciągu obsługiwana przez platformę jest `_MAX_PATH`. Jeśli `lpszDefault` jest **NULL**, zwracana wartość jest pustym ciągiem.  
  
### <a name="remarks"></a>Uwagi  
  
> [!IMPORTANT]
>  Danych zwróconych przez tę funkcję nie jest zawsze NULL zakończone i obiekt wywołujący musi przeprowadzić weryfikacji. Aby uzyskać więcej informacji, zobacz [unikanie Overruns buforu](http://msdn.microsoft.com/library/windows/desktop/ms717795).  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]  
  
 Na przykład innego, zobacz przykład [CWinApp::GetProfileInt](#getprofileint).  
  
##  <a name="getsectionkey"></a>CWinApp::GetSectionKey  
 Zwraca klucz HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection "Oprogramowanie".  
  
```  
HKEY GetSectionKey(
LPCTSTR lpszSection,  
CAtlTransactionManager* pTM = NULL);
```  
  
### <a name="parameters"></a>Parametry  
 `lpszSection`  
 Nazwa klucza, który ma być uzyskany.  
  
 `pTM`  
 Wskaźnik do `CAtlTransactionManager` obiektu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Klucz sekcji, jeśli funkcja zakończy się pomyślnie; w przeciwnym razie `NULL`.  
  
### <a name="remarks"></a>Uwagi  
  
##  <a name="hideapplication"></a>CWinApp::HideApplication  
 Wywołanie tej funkcji Członkowskich, aby ukryć aplikacji przed zamknięciem otwarte dokumenty.  
  
```  
void HideApplication();
```  
  
##  <a name="htmlhelp"></a>CWinApp::HtmlHelp  
 Wywołanie tej funkcji Członkowskich do wywołania HTMLHelp aplikacji.  
  
```  
virtual void HtmlHelp(
    DWORD_PTR dwData,  
    UINT nCmd = 0x000F);
```  
  
### <a name="parameters"></a>Parametry  
 `dwData`  
 Określa dodatkowe dane. Wartość zależy od wartości `nCmd` parametru.  
  
 `nCmd`  
 Określa typ żądanie pomocy. Listę możliwych wartości i ich wpływ na `dwData` parametrów, zobacz `uCommand` parametru opisanego w o HTMLHelp funkcja interfejsu API w zestawie Windows SDK.  
  
### <a name="remarks"></a>Uwagi  
 Struktura wywołuje również tej funkcji do wywołania HTMLHelp aplikacji.  
  
 Platformę zostanie automatycznie zamknięte HTMLHelp aplikacji, gdy zakończenie aplikacji.  
  
##  <a name="initinstance"></a>CWinApp::InitInstance  
 Systemu Windows zezwala na kilku kopiach tej samej program do uruchomienia w tym samym czasie.  
  
```  
virtual BOOL InitInstance();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli inicjowanie zakończy się pomyślnie; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Inicjowanie aplikacji jest koncepcyjnie podzielony na dwie sekcje: inicjowanie jednorazowe aplikacji, którą można wykonać pierwsze czasu program zostanie uruchomiony i inicjowania wystąpienia, wykonywana każdego czasu kopię program zostanie uruchomiony, w tym po raz pierwszy. W ramach stosowania `WinMain` wywołania tej funkcji.  
  
 Zastąpienie `InitInstance` zainicjować każde nowe wystąpienie aplikacji uruchomionej w systemie Windows. Zazwyczaj można zastąpić `InitInstance` do konstruowania obiektu głównego okna i ustawić `CWinThread::m_pMainWnd` element członkowski danych, aby wskazywał tego okna. Aby uzyskać więcej informacji na zastępowanie funkcji członkowskiej, zobacz [CWinApp: klasa aplikacji](../../mfc/cwinapp-the-application-class.md).  
  
> [!NOTE]
>  Aplikacje MFC musi zostać zainicjowany jako pojedynczy wątków typu apartment (STA). Jeśli należy wywołać [funkcja CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) w Twojej `InitInstance` zastępowania, określ `COINIT_APARTMENTTHREADED` (zamiast `COINIT_MULTITHREADED`). Aby uzyskać więcej informacji, zobacz PRB: MFC aplikacja przestaje odpowiadać podczas inicjowania aplikacji jako wielowątkowe apartamentu (828643) w [http://support.microsoft.com/default.aspxscid=kb;en-us;828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643).  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCListView#9](../../atl/reference/codesnippet/cpp/cwinapp-class_10.cpp)]  
  
##  <a name="istaskbarinteractionenabled"></a>CWinApp::IsTaskbarInteractionEnabled  
 Informuje, czy włączono interakcji zadań systemu Windows 7.  
  
```  
virtual BOOL IsTaskbarInteractionEnabled();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Zwraca `TRUE` Jeśli `EnableTaskbarInteraction` została wywołana i System operacyjny Windows 7 lub nowszy.  
  
### <a name="remarks"></a>Uwagi  
 Interakcja zadań oznacza, że aplikacji MDI zostanie wyświetlona zawartość elementów podrzędnych MDI w osobnych kartach miniatur, które są wyświetlane, gdy wskaźnik myszy znajduje się nad przyciskiem paska zadań aplikacji.  
  
##  <a name="loadcursor"></a>CWinApp::LoadCursor  
 Ładuje zasobu kursora o nazwie `lpszResourceName` lub został określony przez `nIDResource` z bieżącego pliku wykonywalnego.  
  
```  
HCURSOR LoadCursor(LPCTSTR lpszResourceName) const;  HCURSOR LoadCursor(UINT nIDResource) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `lpszResourceName`  
 Wskazuje zerem ciągu zawierającego nazwę zasobu kursora. Można użyć `CString` dla tego argumentu.  
  
 `nIDResource`  
 Identyfikator zasobu kursora. Aby uzyskać listę zasobów, zobacz [LoadCursor](http://msdn.microsoft.com/library/windows/desktop/ms648391) w zestawie Windows SDK.  
  
### <a name="return-value"></a>Wartość zwracana  
 Dojście do kursora w przypadku powodzenia; w przeciwnym razie **NULL**.  
  
### <a name="remarks"></a>Uwagi  
 `LoadCursor`ładuje kursor do pamięci tylko wtedy, gdy go nie został wcześniej załadowany; w przeciwnym razie pobiera on uchwyt istniejącego zasobu.  
  
 Użyj [LoadStandardCursor](#loadstandardcursor) lub [LoadOEMCursor](#loadoemcursor) funkcji członkowskiej do wstępnie zdefiniowanych kursory systemu Windows.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#44](../../mfc/reference/codesnippet/cpp/cwinapp-class_11.cpp)]  
  
##  <a name="loadicon"></a>CWinApp::LoadIcon  
 Ładuje zasobu ikony o nazwie `lpszResourceName` lub został określony przez `nIDResource` z pliku wykonywalnego.  
  
```  
HICON LoadIcon(LPCTSTR lpszResourceName) const;  HICON LoadIcon(UINT nIDResource) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `lpszResourceName`  
 Wskazuje zerem ciągu zawierającego nazwę zasobu ikony. Można również użyć `CString` dla tego argumentu.  
  
 `nIDResource`  
 Identyfikator zasobu ikony.  
  
### <a name="return-value"></a>Wartość zwracana  
 Dojście do ikony w przypadku powodzenia; w przeciwnym razie **NULL**.  
  
### <a name="remarks"></a>Uwagi  
 `LoadIcon`ładuje ikony tylko wtedy, gdy go nie został wcześniej załadowany; w przeciwnym razie pobiera on uchwyt istniejącego zasobu.  
  
 Można użyć [LoadStandardIcon](#loadstandardicon) lub [LoadOEMIcon](#loadoemicon) funkcji członkowskiej do wstępnie zdefiniowanych ikon systemu Windows.  
  
> [!NOTE]
>  Funkcji członkowskiej wywołania funkcji Win32 API [LoadIcon](http://msdn.microsoft.com/library/windows/desktop/ms648072), który może ładować tylko ikony, których rozmiar odpowiada **SM_CXICON** i **SM_CYICON** wartości metryki systemu.  
  
##  <a name="loadoemcursor"></a>CWinApp::LoadOEMCursor  
 Kursor zasobu określonego przez wstępnie zdefiniowane obciążeń systemu Windows `nIDCursor`.  
  
```  
HCURSOR LoadOEMCursor(UINT nIDCursor) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `nIDCursor`  
 **OCR_** manifestu stałej identyfikator, który określa wstępnie zdefiniowanych kursora systemu Windows. Musi mieć **#define OEMRESOURCE** przed **#include \<afxwin.h >** do uzyskiwania dostępu do **OCR_** stałe w systemie WINDOWS. H.  
  
### <a name="return-value"></a>Wartość zwracana  
 Dojście do kursora w przypadku powodzenia; w przeciwnym razie **NULL**.  
  
### <a name="remarks"></a>Uwagi  
 Użyj `LoadOEMCursor` lub [LoadStandardCursor](#loadstandardcursor) funkcji członkowskiej do wstępnie zdefiniowanych kursory systemu Windows.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#45](../../mfc/reference/codesnippet/cpp/cwinapp-class_12.h)]  
  
 [!code-cpp[NVC_MFCWindowing#46](../../mfc/reference/codesnippet/cpp/cwinapp-class_13.cpp)]  
  
##  <a name="loadoemicon"></a>CWinApp::LoadOEMIcon  
 Ikona zasobu określonego przez wstępnie zdefiniowane obciążeń systemu Windows `nIDIcon`.  
  
```  
HICON LoadOEMIcon(UINT nIDIcon) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `nIDIcon`  
 **OIC_** manifestu stałej identyfikator, który określa wstępnie zdefiniowanych ikony systemu Windows. Musi mieć **#define OEMRESOURCE** przed **#include \<afxwin.h >** dostępu **OIC_** stałe w systemie WINDOWS. H.  
  
### <a name="return-value"></a>Wartość zwracana  
 Dojście do ikony w przypadku powodzenia; w przeciwnym razie **NULL**.  
  
### <a name="remarks"></a>Uwagi  
 Użyj `LoadOEMIcon` lub [LoadStandardIcon](#loadstandardicon) funkcji członkowskiej do wstępnie zdefiniowanych ikon systemu Windows.  
  
##  <a name="loadstandardcursor"></a>CWinApp::LoadStandardCursor  
 Obciążenia systemu Windows jest wstępnie zdefiniowane zasobu kursora który `lpszCursorName` określa.  
  
```  
HCURSOR LoadStandardCursor(LPCTSTR lpszCursorName) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `lpszCursorName`  
 **IDC_** manifestu stałej identyfikator, który określa wstępnie zdefiniowanych kursora systemu Windows. Te identyfikatory są zdefiniowane w systemie WINDOWS. H. Na poniższej liście przedstawiono możliwe wstępnie zdefiniowanych wartości i znaczenie `lpszCursorName`:  
  
- **IDC_ARROW** standardowe strzałkę kursora  
  
- **IDC_IBEAM** kursora standardowe Wstawianie tekstu  
  
- **IDC_WAIT** kursora Klepsydra używany, gdy system Windows wykonuje czasochłonnym zadaniem  
  
- **IDC_CROSS** krzyżyk kursora dla zaznaczenia  
  
- **IDC_UPARROW** Strzałka w górę  
  
- **IDC_SIZE** przestarzałe i obsługiwane; użyj **IDC_SIZEALL**  
  
- **IDC_SIZEALL** odnosi się do czterech strzałki. Kursor, który służy do zmiany rozmiaru okna.  
  
- **IDC_ICON** przestarzałe i nieobsługiwane. Użyj **IDC_ARROW**.  
  
- **IDC_SIZENWSE** Podwójna strzałka z punktami końcowymi, w lewym górnym rogu i prawym dolnym  
  
- **IDC_SIZENESW** Podwójna strzałka z punktami końcowymi, w lewym górnym rogu prawo i dolnym  
  
- **IDC_SIZEWE** poziome Podwójna strzałka  
  
- **IDC_SIZENS** pionowy Podwójna strzałka  
  
### <a name="return-value"></a>Wartość zwracana  
 Dojście do kursora w przypadku powodzenia; w przeciwnym razie **NULL**.  
  
### <a name="remarks"></a>Uwagi  
 Użyj `LoadStandardCursor` lub [LoadOEMCursor](#loadoemcursor) funkcji członkowskiej do wstępnie zdefiniowanych kursory systemu Windows.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#47](../../mfc/reference/codesnippet/cpp/cwinapp-class_14.cpp)]  
  
##  <a name="loadstandardicon"></a>CWinApp::LoadStandardIcon  
 Obciążenia systemu Windows jest wstępnie zdefiniowane zasobu ikony który `lpszIconName` określa.  
  
```  
HICON LoadStandardIcon(LPCTSTR lpszIconName) const;  
```  
  
### <a name="parameters"></a>Parametry  
 `lpszIconName`  
 Manifestu identyfikator stałej określa wstępnie zdefiniowanych ikony systemu Windows. Te identyfikatory są zdefiniowane w systemie WINDOWS. H. Listę można wstępnie zdefiniowanych wartości i ich opisy, zobacz *lpIconName* parametru w [LoadIcon](http://msdn.microsoft.com/library/windows/desktop/ms648072) w zestawie Windows SDK.  
  
### <a name="return-value"></a>Wartość zwracana  
 Dojście do ikony w przypadku powodzenia; w przeciwnym razie **NULL**.  
  
### <a name="remarks"></a>Uwagi  
 Użyj `LoadStandardIcon` lub [LoadOEMIcon](#loadoemicon) funkcji członkowskiej do wstępnie zdefiniowanych ikon systemu Windows.  
  
##  <a name="loadstdprofilesettings"></a>CWinApp::LoadStdProfileSettings  
 Wywołanie tej funkcji Członkowskich z poziomu [InitInstance](#initinstance) funkcji członkowskiej, aby włączyć i załadować listy ostatnio używanych (MRU) plików i podgląd ostatniego stanu.  
  
```  
void LoadStdProfileSettings(UINT nMaxMRU = _AFX_MRU_COUNT);
```  
  
### <a name="parameters"></a>Parametry  
 `nMaxMRU`  
 Liczba ostatnio używanych plików do śledzenia.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli `nMaxMRU` wynosi 0, Brak listy ostatnio używanych elementów zostaną zachowane.  
  
##  <a name="m_bhelpmode"></a>CWinApp::m_bHelpMode  
 **Wartość TRUE,** , gdy aplikacja jest w trybie kontekstu pomocy (tradycyjnie wywołany z SHIFT + F1); w przeciwnym razie **FALSE**.  
  
```  
BOOL m_bHelpMode;  
```  
  
### <a name="remarks"></a>Uwagi  
 W trybie kontekstu pomocy kursor staje się znak zapytania, a użytkownik może przenieść go o ekranu. Sprawdź tę flagę, aby zaimplementować specjalnej obsługi w trybie pomocy. `m_bHelpMode`jest publiczny zmiennej typu **BOOL**.  
  
##  <a name="m_dwrestartmanagersupportflags"></a>CWinApp::m_dwRestartManagerSupportFlags  
 Flagi, które określają sposób zachowania Menedżer ponownego uruchamiania.  
  
```  
DWORD m_dwRestartManagerSupportFlags;  
```  
  
### <a name="remarks"></a>Uwagi  
 Aby włączyć Menedżer ponownego uruchamiania, ustaw `m_dwRestartManagerSupportFlags` do zachowania, które mają. W poniższej tabeli przedstawiono flagi, które są dostępne.  
  
|||  
|-|-|  
|Flaga|Opis|  
|`AFX_RESTART_MANAGER_SUPPORT_RESTART`|Aplikacja jest zarejestrowana przy użyciu [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager). Menedżer ponownego uruchamiania jest odpowiedzialny za ponowne uruchomienie aplikacji, jeśli nieoczekiwanie kończy działanie.|  
|- `AFX_RESTART_MANAGER_SUPPORT_RECOVERY`|Aplikacja jest zarejestrowana w usłudze Menedżer ponownego uruchamiania i Menedżer ponownego uruchamiania wywołuje funkcję wywołania zwrotnego odzyskiwania po jej ponownym uruchomieniu aplikacji. Funkcja wywołania zwrotnego odzyskiwania domyślny jest [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|  
|- `AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART`|Automatyczne zapisywanie jest włączona i autosaves Menedżera ponownego uruchomienia wszelkich otwartych dokumentów po ponownym uruchomieniu aplikacji.|  
|- `AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL`|Automatyczne zapisywanie jest włączona i autosaves Menedżera ponownego uruchomienia wszelkich otwartych dokumentów w regularnych odstępach czasu. Interwał jest definiowana za pomocą [CWinApp::m_nAutosaveInterval](#m_nautosaveinterval).|  
|- `AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES`|Menedżer ponownego uruchamiania otwiera wcześniej otwartych dokumentów po ponownym uruchomieniu aplikacji z nieoczekiwany zakończenia. [Klasy CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md) obsługuje przechowywanie listy otwartych dokumentów i ich przywracania.|  
|- `AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES`|Menedżer ponownego uruchamiania monituje użytkownika o przywracania plików automatycznie zapisany po ponownym uruchomieniu aplikacji. `CDataRecoveryHandler` Użytkownik wysyła zapytanie do klasy.|  
|- `AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE`|Złożenie `AFX_RESTART_MANAGER_SUPPORT_RESTART`, `AFX_RESTART_MANAGER_SUPPORT_RECOVER`, i `AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES`.|  
|- `AFX_RESTART_MANAGER_SUPPORT_ALL_ASPECTS`|Złożenie `AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE`, `AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART`, `AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL`, i `AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES`.|  
|- `AFX_RESTART_MANAGER_SUPPORT_RESTART_ASPECTS`|Złożenie `AFX_RESTART_MANAGER_SUPPORT_RESTART`, `AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART`, `AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES`, i `AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES`.|  
|- `AFX_RESTART_MANAGER_SUPPORT_RECOVERY_ASPECTS`|Złożenie `AFX_RESTART_MANAGER_SUPPORT_RECOVERY`, `AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL`, `AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES`, i `AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES`.|  
  
##  <a name="m_ehelptype"></a>CWinApp::m_eHelpType  
 Typ elementu członkowskiego danych jest typ wyliczeniowy **AFX_HELP_TYPE**, który jest zdefiniowany w ramach `CWinApp` klasy.  
  
```  
AFX_HELP_TYPE m_eHelpType;  
```  
  
### <a name="remarks"></a>Uwagi  
 **AFX_HELP_TYPE** wyliczenie zdefiniowano w następujący sposób:  
  
```  
enum AFX_HELP_TYPE {  
    afxWinHelp = 0,
    afxHTMLHelp = 1
    };  
```  
  
-   Aby ustawić aplikacji ułatwiają pomocy HTML, należy wywołać [SetHelpMode](#sethelpmode) i określ **afxHTMLHelp**.  
  
-   Aby ustawić pomocy WinHelp aplikacji, należy wywołać `SetHelpMode` i określ **afxWinHelp**.  
  
##  <a name="m_hinstance"></a>CWinApp::m_hInstance  
 Odpowiada `hInstance` parametr przekazywany przez system Windows do `WinMain`.  
  
```  
HINSTANCE m_hInstance;  
```  
  
### <a name="remarks"></a>Uwagi  
 `m_hInstance` Elementu członkowskiego danych jest dojścia do bieżącego wystąpienia aplikacja była uruchomiona w systemie Windows. Ten błąd jest zwracany przez funkcję globalne [afxgetinstancehandle —](application-information-and-management.md#afxgetinstancehandle). `m_hInstance`jest publiczny zmiennej typu `HINSTANCE`.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#55](../../mfc/reference/codesnippet/cpp/cwinapp-class_15.cpp)]  
  
##  <a name="m_lpcmdline"></a>CWinApp::m_lpCmdLine  
 Odpowiada `lpCmdLine` parametr przekazywany przez system Windows do `WinMain`.  
  
```  
LPTSTR m_lpCmdLine;  
```  
  
### <a name="remarks"></a>Uwagi  
 Wskazuje zerem ciąg, który określa wiersz polecenia dla aplikacji. Użyj `m_lpCmdLine` dostępu do żadnych argumentów wiersza polecenia użytkownika wprowadzone podczas uruchomienia aplikacji. `m_lpCmdLine`jest publiczny zmiennej typu `LPTSTR`.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]  
  
##  <a name="m_nautosaveinterval"></a>CWinApp::m_nAutosaveInterval  
 Długość czasu w milisekundach między autosaves.  
  
```  
int m_nAutosaveInterval;  
```  
  
### <a name="remarks"></a>Uwagi  
 Menedżer ponownego uruchamiania na automatyczne zapisywanie otwarte dokumenty można skonfigurować w ustalonych odstępach czasu. Jeśli aplikacja nie nie automatycznego zapisywania plików, ten parametr nie ma znaczenia.  
  
##  <a name="m_ncmdshow"></a>CWinApp::m_nCmdShow  
 Odpowiada `nCmdShow` parametr przekazywany przez system Windows do `WinMain`.  
  
```  
int m_nCmdShow;  
```  
  
### <a name="remarks"></a>Uwagi  
 Należy przekazać `m_nCmdShow` jako argument podczas wywoływania [CWnd::ShowWindow](../../mfc/reference/cwnd-class.md#showwindow) dla okna głównego aplikacji. `m_nCmdShow`jest publiczny zmiennej typu `int`.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#56](../../mfc/reference/codesnippet/cpp/cwinapp-class_17.cpp)]  
  
##  <a name="m_pactivewnd"></a>CWinApp::m_pActiveWnd  
 Użyj tego elementu członkowskiego danych do przechowywania wskaźnik do głównego okna aplikacji kontenera OLE z OLE serwera aplikacji w miejscu aktywowany.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli ten element członkowski danych jest **NULL**, aplikacja nie jest aktywny w miejscu.  
  
 Platformę ustawia tej zmiennej członkowskiej, gdy okno ramowe jest aktywowany przez aplikacje kontenera OLE w miejscu.  
  
##  <a name="m_pdatarecoveryhandler"></a>CWinApp::m_pDataRecoveryHandler  
 Wskaźnik do obsługi odzyskiwania danych aplikacji.  
  
```  
CDataRecoveryHandler* m_pDataRecoveryHandler;  
```  
  
### <a name="remarks"></a>Uwagi  
 Obsługa odzyskiwania danych aplikacji monitoruje otwarte dokumenty i autosaves je. Platformę używa Obsługa odzyskiwania danych do przywrócenia plików zapisana automatycznie po uruchomieniu aplikacji po jej jest nieoczekiwanie zamykany. Aby uzyskać więcej informacji, zobacz [CDataRecoveryHandler klasy](../../mfc/reference/cdatarecoveryhandler-class.md).  
  
##  <a name="m_pszappname"></a>CWinApp::m_pszAppName  
 Określa nazwę aplikacji.  
  
```  
LPCTSTR m_pszAppName;  
```  
  
### <a name="remarks"></a>Uwagi  
 Nazwa aplikacji może pochodzić od parametr przekazany do [CWinApp](#cwinapp) konstruktora, lub, jeśli nie zostanie określony, do ciągu zasobu o identyfikatorze **AFX_IDS_APP_TITLE**. Jeśli nazwa aplikacji nie zostanie znaleziony w zasobie, pochodzi z programu. Nazwa pliku EXE.  
  
 Zwracane przez funkcję globalne [afxgetappname —](application-information-and-management.md#afxgetappname). `m_pszAppName`jest publiczny zmiennej typu **const char\***.  
  
> [!NOTE]
>  Jeśli przypisanie wartości do `m_pszAppName`, musi być dynamicznie przydzielony na stosie. `CWinApp` Wywołania destruktora **wolnego**() z ten wskaźnik. Wiele chcesz użyć `_tcsdup`wykonać alokacji funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć skojarzona z bieżącym wskaźnika przed przypisaniem nową wartość. Na przykład:  
  
 [!code-cpp[NVC_MFCWindowing#57](../../mfc/reference/codesnippet/cpp/cwinapp-class_18.cpp)]  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#65](../../mfc/reference/codesnippet/cpp/cwinapp-class_19.cpp)]  
  
##  <a name="m_pszexename"></a>CWinApp::m_pszExeName  
 Zawiera nazwę pliku wykonywalnego aplikacji bez rozszerzenia.  
  
```  
LPCTSTR m_pszExeName;  
```  
  
### <a name="remarks"></a>Uwagi  
 W odróżnieniu od [m_pszAppName](#m_pszappname), ta nazwa nie może zawierać spacji. `m_pszExeName`jest publiczny zmiennej typu **const char\***.  
  
> [!NOTE]
>  Jeśli przypisanie wartości do `m_pszExeName`, musi być dynamicznie przydzielony na stosie. `CWinApp` Wywołania destruktora **wolnego**() z ten wskaźnik. Wiele chcesz użyć `_tcsdup`wykonać alokacji funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć skojarzona z bieżącym wskaźnika przed przypisaniem nową wartość. Na przykład:  
  
 [!code-cpp[NVC_MFCWindowing#58](../../mfc/reference/codesnippet/cpp/cwinapp-class_20.cpp)]  
  
##  <a name="m_pszhelpfilepath"></a>CWinApp::m_pszHelpFilePath  
 Zawiera ścieżkę do pliku pomocy w aplikacji.  
  
```  
LPCTSTR m_pszHelpFilePath;  
```  
  
### <a name="remarks"></a>Uwagi  
 Domyślnie inicjuje platformę `m_pszHelpFilePath` nazwy aplikacji ". HLP"dołączane. Aby zmienić nazwę pliku pomocy, ustaw `m_pszHelpFilePath` wskaż ciąg, który zawiera pełną nazwę pliku żądanego pomocy. Jest wygodne miejsce, w tym celu w aplikacji [InitInstance](#initinstance) funkcji. `m_pszHelpFilePath`jest publiczny zmiennej typu **const char\***.  
  
> [!NOTE]
>  Jeśli przypisanie wartości do `m_pszHelpFilePath`, musi być dynamicznie przydzielony na stosie. `CWinApp` Wywołania destruktora **wolnego**() z ten wskaźnik. Wiele chcesz użyć `_tcsdup`wykonać alokacji funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć skojarzona z bieżącym wskaźnika przed przypisaniem nową wartość. Na przykład:  
  
 [!code-cpp[NVC_MFCWindowing#59](../../mfc/reference/codesnippet/cpp/cwinapp-class_21.cpp)]  
  
##  <a name="m_pszprofilename"></a>CWinApp::m_pszProfileName  
 Zawiera nazwę aplikacji. Pliku INI.  
  
```  
LPCTSTR m_pszProfileName;  
```  
  
### <a name="remarks"></a>Uwagi  
 `m_pszProfileName`jest publiczny zmiennej typu **const char\***.  
  
> [!NOTE]
>  Jeśli przypisanie wartości do `m_pszProfileName`, musi być dynamicznie przydzielony na stosie. `CWinApp` Wywołania destruktora **wolnego**() z ten wskaźnik. Wiele chcesz użyć `_tcsdup`wykonać alokacji funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć skojarzona z bieżącym wskaźnika przed przypisaniem nową wartość. Na przykład:  
  
 [!code-cpp[NVC_MFCWindowing#60](../../mfc/reference/codesnippet/cpp/cwinapp-class_22.cpp)]  
  
##  <a name="m_pszregistrykey"></a>CWinApp::m_pszRegistryKey  
 Używany do określenia, gdzie w rejestrze lub plik INI, ustawienia profilu aplikacji są przechowywane.  
  
```  
LPCTSTR m_pszRegistryKey;  
```  
  
### <a name="remarks"></a>Uwagi  
 Zazwyczaj ten element członkowski danych jest traktowane jako tylko do odczytu.  
  
-   Wartość jest przechowywana w kluczu rejestru. Nazwa ustawienia profilu aplikacji jest dołączany do następującego klucza rejestru: HKEY_CURRENT_USER/Software/LocalAppWizard-wygenerowanych /.  
  
 Jeśli przypisanie wartości do `m_pszRegistryKey`, musi być dynamicznie przydzielony na stosie. `CWinApp` Wywołania destruktora **wolnego**() z ten wskaźnik. Wiele chcesz użyć `_tcsdup`wykonać alokacji funkcja biblioteki wykonawczej (). Ponadto zwolnić pamięć skojarzona z bieżącym wskaźnika przed przypisaniem nową wartość. Na przykład:  
  
 [!code-cpp[NVC_MFCWindowing#61](../../mfc/reference/codesnippet/cpp/cwinapp-class_23.cpp)]  
  
##  <a name="m_pszappid"></a>CWinApp::m_pszAppID  
 Identyfikator aplikacji użytkownika modelu.  
  
```  
LPCTSTR m_pszAppID;  
```  
  
### <a name="remarks"></a>Uwagi  
  
##  <a name="oncontexthelp"></a>CWinApp::OnContextHelp  
 Obsługuje SHIFT + F1 Pomoc w aplikacji.  
  
```  
afx_msg void OnContextHelp();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy dodać `ON_COMMAND( ID_CONTEXT_HELP, OnContextHelp )` oświadczenie do użytkownika `CWinApp` klasy mapy komunikatów, a także dodać wpisu tabeli klawiszy skrótów zazwyczaj SHIFT + F1, aby włączyć tę funkcję elementu członkowskiego.  
  
 `OnContextHelp`umieszcza aplikacji do trybu pomocy. Kursor zmieni się strzałka i znak zapytania, a użytkownik może następnie przesuń wskaźnik myszy i naciśnij klawisz lewego przycisku myszy wybierz okno dialogowe, okna, menu lub przycisku polecenia. Ta funkcja członkowska pobiera kontekst pomocy obiektu pod kursorem i wywołuje funkcję Windows WinHelp z tym kontekstem pomocy.  
  
##  <a name="onddecommand"></a>CWinApp::OnDDECommand  
 Wywoływane przez platformę, gdy głównego okna ramowego otrzymuje DDE wykonania wiadomości.  
  
```  
virtual BOOL OnDDECommand(LPTSTR lpszCommand);
```  
  
### <a name="parameters"></a>Parametry  
 *lpszCommand*  
 Wskazuje ciąg polecenia DDE odebranych przez aplikację.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli polecenie jest obsługiwany; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja sprawdza, czy polecenie jest to żądanie, aby otworzyć dokument i jeśli tak, otwiera określony dokument. Menedżera plików systemu Windows wysyła takich ciągów poleceń DDE zazwyczaj, gdy użytkownik kliknie dwukrotnie plik danych. Zastąpienie tej funkcji do obsługi innych DDE wykonania polecenia, takie jak polecenie do drukowania.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#48](../../mfc/reference/codesnippet/cpp/cwinapp-class_24.cpp)]  
  
##  <a name="onfilenew"></a>CWinApp::OnFileNew  
 Implementuje `ID_FILE_NEW` polecenia.  
  
```  
afx_msg void OnFileNew();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy dodać `ON_COMMAND( ID_FILE_NEW, OnFileNew )` oświadczenie do użytkownika `CWinApp` klasy mapy wiadomości, aby włączyć tę funkcję elementu członkowskiego. Włączenie tej funkcji obsługuje wykonywanie polecenia nowy plik.  
  
 Zobacz [22 Uwaga techniczna](../../mfc/tn022-standard-commands-implementation.md) informacji na temat domyślne zachowanie i instrukcje dotyczące przesłonić tę funkcję elementu członkowskiego.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]  
  
 [!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]  
  
##  <a name="onfileopen"></a>CWinApp::OnFileOpen  
 Implementuje `ID_FILE_OPEN` polecenia.  
  
```  
afx_msg void OnFileOpen();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy dodać `ON_COMMAND( ID_FILE_OPEN, OnFileOpen )` oświadczenie do użytkownika `CWinApp` klasy mapy wiadomości, aby włączyć tę funkcję elementu członkowskiego. Włączenie tej funkcji obsługuje wykonywanie polecenia Otwórz plik.  
  
 Informacji dotyczących zachowania domyślnego i instrukcje dotyczące przesłonić tę funkcję elementu członkowskiego, zobacz [22 Uwaga techniczna](../../mfc/tn022-standard-commands-implementation.md).  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]  
  
 [!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]  
  
##  <a name="onfileprintsetup"></a>CWinApp::OnFilePrintSetup  
 Implementuje **id_file_print_setup —** polecenia.  
  
```  
afx_msg void OnFilePrintSetup();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy dodać `ON_COMMAND( ID_FILE_PRINT_SETUP, OnFilePrintSetup )` oświadczenie do użytkownika `CWinApp` klasy mapy wiadomości, aby włączyć tę funkcję elementu członkowskiego. Włączenie tej funkcji obsługuje wykonywanie polecenia drukowania pliku.  
  
 Informacji dotyczących zachowania domyślnego i instrukcje dotyczące przesłonić tę funkcję elementu członkowskiego, zobacz [22 Uwaga techniczna](../../mfc/tn022-standard-commands-implementation.md).  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]  
  
 [!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]  
  
##  <a name="onhelp"></a>CWinApp::OnHelp  
 Obsługuje pomocy F1 w aplikacji (przy użyciu bieżącego kontekstu).  
  
```  
afx_msg void OnHelp();
```  
  
### <a name="remarks"></a>Uwagi  
 Zwykle będzie również Dodaj wpis klawisz skrótu dla klawisz F1. Włączenie klawisza F1 jest tylko Konwencji, nie wymagane.  
  
 Należy dodać `ON_COMMAND( ID_HELP, OnHelp )` oświadczenie do użytkownika `CWinApp` klasy mapy wiadomości, aby włączyć tę funkcję elementu członkowskiego. U możliwia wywoływane przez platformę, gdy użytkownik naciśnie klawisz F1.  
  
 Domyślna implementacja tej funkcji obsługi wiadomości Określa kontekst pomocy, która odnosi się do bieżącego okna, okno dialogowe lub element menu, a następnie wywołuje WINHELP. WYWOŁANIE PLIKU EXE. Jeśli kontekst nie jest obecnie dostępna, funkcja korzysta z domyślnego kontekstu.  
  
 Przesłonić tę funkcję elementu członkowskiego, aby ustawić kontekst pomocy coś innego niż okna, okno dialogowe, element menu lub przycisku paska narzędzi, który aktualnie ma fokus. Wywołanie `WinHelp` z żądaną pomocy identyfikatora kontekstu.  
  
##  <a name="onhelpfinder"></a>CWinApp::OnHelpFinder  
 Obsługuje **ID_HELP_FINDER** i **id_default_help —** poleceń.  
  
```  
afx_msg void OnHelpFinder();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy dodać `ON_COMMAND( ID_HELP_FINDER, OnHelpFinder )` oświadczenie do użytkownika `CWinApp` klasy mapy wiadomości, aby włączyć tę funkcję elementu członkowskiego. Jeśli opcja jest włączona, struktura wywołuje tej funkcji obsługi wiadomości, po wybraniu aplikacji wyszukiwania pomocy polecenie do wywołania `WinHelp` ze standardem **HELP_FINDER** tematu.  
  
##  <a name="onhelpindex"></a>CWinApp::OnHelpIndex  
 Obsługuje **id_help_index —** poleceń i udostępnia domyślny temat pomocy.  
  
```  
afx_msg void OnHelpIndex();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy dodać `ON_COMMAND( ID_HELP_INDEX, OnHelpIndex )` oświadczenie do użytkownika `CWinApp` klasy mapy wiadomości, aby włączyć tę funkcję elementu członkowskiego. Jeśli opcja jest włączona, struktura wywołuje tej funkcji obsługi wiadomości, po wybraniu aplikacji indeksu Pomocy polecenie do wywołania `WinHelp` ze standardem **HELP_INDEX** tematu.  
  
##  <a name="onhelpusing"></a>CWinApp::OnHelpUsing  
 Obsługuje **id_help_using —** polecenia.  
  
```  
afx_msg void OnHelpUsing();
```  
  
### <a name="remarks"></a>Uwagi  
 Należy dodać `ON_COMMAND( ID_HELP_USING, OnHelpUsing )` oświadczenie do użytkownika `CWinApp` klasy mapy wiadomości, aby włączyć tę funkcję elementu członkowskiego. Struktura wywołuje tej funkcji obsługi wiadomości, po wybraniu aplikacji pomoc przy użyciu polecenie do wywołania `WinHelp` aplikacji ze standardem **HELP_HELPONHELP** tematu.  
  
##  <a name="onidle"></a>CWinApp::OnIdle  
 Przesłonić tę funkcję elementu członkowskiego do przetwarzania czas bezczynności.  
  
```  
virtual BOOL OnIdle(LONG lCount);
```  
  
### <a name="parameters"></a>Parametry  
 `lCount`  
 Licznik zwiększany po każdej `OnIdle` jest wywoływane, gdy kolejka komunikatów aplikacji jest pusta. Ten licznik jest resetowany do 0 zawsze, gdy nowy komunikat jest przetwarzany. Można użyć `lCount` parametr, aby określić względną limit czasu bezczynności aplikacji bez przetwarzania komunikatu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, aby otrzymać więcej przetwarzania czas bezczynności; 0, jeśli nie więcej czasu bezczynności nie jest konieczne.  
  
### <a name="remarks"></a>Uwagi  
 `OnIdle`jest wywoływana domyślną pętlę komunikatów, gdy kolejka komunikatów aplikacji jest pusta. Umożliwia wywołanie własnym zadania obsługi bezczynności zastąpienia.  
  
 `OnIdle`powinien zwracać wartość 0, aby wskazać, że nie czas bezczynności przetwarzania jest wymagane. `lCount` Parametru jest zwiększany po każdej `OnIdle` jest wywoływane, gdy kolejka komunikatów jest pusty i zresetowanie na 0 zawsze nowy komunikat jest przetwarzany. Można wywołać z innej procedury bezczynności na podstawie tej liczby.  
  
 Poniżej przedstawiono podsumowanie przetwarzanie pętli bezczynności:  
  
1.  Jeśli pętli komunikatów w programie Microsoft Foundation Class Library sprawdza kolejki komunikatów i nie znajduje się oczekujących komunikatów, wywołuje metodę `OnIdle` dla obiekt aplikacji i dostaw 0 jako `lCount` argumentu.  
  
2. `OnIdle`Niektóre przetwarza i zwraca wartość niezerową, aby określić, że powinna być wywoływana ponownie w celu dalszego przetwarzania.  
  
3.  Pętli komunikatów ponownie sprawdza kolejki wiadomości. Jeśli nie ma wiadomości oczekujące, wywołuje metodę `OnIdle` ponownie, zwiększając `lCount` argumentu.  
  
4.  Po pewnym czasie `OnIdle` zakończy przetwarzanie wszystkich bezczynnych zadań i zwraca wartość 0. Ta wartość informuje pętli komunikatów, aby zatrzymać wywoływania `OnIdle` do momentu otrzymania następny komunikat z kolejki wiadomości, po czym bezczynności cyklu jest uruchamiany z argumentu równa 0.  
  
 Nie wykonuj długich zadań podczas `OnIdle` ponieważ aplikacja nie może przetworzyć danych wejściowych użytkownika do `OnIdle` zwraca.  
  
> [!NOTE]
>  Domyślna implementacja `OnIdle` aktualizacje polecenia obiektów interfejsu użytkownika, takich jak elementy menu i przycisków paska narzędzi, a następnie wykonuje oczyszczania struktury danych wewnętrznych. W związku z tym jeśli można zastąpić `OnIdle`, należy wywołać `CWinApp::OnIdle` z `lCount` w wersji zastąpiona. Pierwsze wywołanie przetwarzanie w stanie bezczynności wszystkie klasy podstawowej (to znaczy do klasy podstawowej `OnIdle` zwraca wartość 0). Jeśli potrzebujesz do wykonywania pracy przed zakończeniem przetwarzania klasy podstawowej, przejrzyj implementacji klasy podstawowej, aby wybrać odpowiednią `lCount` w którym do pracy.  
  
 Jeśli nie chcesz `OnIdle` ma być wywoływana, gdy wiadomość jest pobierana z kolejki wiadomości, można zastąpić [CWinThreadIsIdleMessage](../../mfc/reference/cwinthread-class.md#isidlemessage). Jeśli aplikacja ma ustawioną bardzo krótki czasomierza lub jeśli wysyła system **WM_SYSTIMER** komunikatu, następnie `OnIdle` zostanie wywołana wielokrotnie i obniżyć wydajność.  
  
### <a name="example"></a>Przykład  
 Dwa poniższe przykłady pokazują, jak używać `OnIdle`. Pierwszym przykładzie przetwarza dwa zadania bezczynności za pomocą `lCount` argument priorytety zadań. Pierwszym zadaniem jest o wysokim priorytecie i należy go, jeśli to możliwe. Drugie zadanie jest mniej ważne i należy przypisywać tylko wtedy, gdy istnieje długa Wstrzymaj w danych wejściowych użytkownika. Należy pamiętać, wywołania do klasy podstawowej wersji `OnIdle`. Drugi przykład zarządza grupy bezczynności zadania związane z różnych priorytetów.  
  
 [!code-cpp[NVC_MFCWindowing#51](../../mfc/reference/codesnippet/cpp/cwinapp-class_27.cpp)]  
  
##  <a name="opendocumentfile"></a>CWinApp::OpenDocumentFile  
 Struktura wywołuje tę metodę, aby otworzyć nazwany [CDocument](../../mfc/reference/cdocument-class.md) pliku aplikacji.  
  
```  
virtual CDocument* OpenDocumentFile(
LPCTSTR lpszFileName  
BOOL bAddToMRU = TRUE);
```  
  
### <a name="parameters"></a>Parametry  
 [in]`lpszFileName`  
 Nazwa pliku, który ma zostać otwarty.  
  
 [in]`bAddToMRU`  
 `TRUE`Wskazuje, że dokument jest jednym z najbardziej aktualną plików; `FALSE` wskazuje dokumentu nie jest jednym z najnowszych plików.  
  
### <a name="return-value"></a>Wartość zwracana  
 Wskaźnik do `CDocument` przypadku powodzenia; w przeciwnym razie `NULL`.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli dokument o tej nazwie jest już otwarty, okno ramowe pierwszy dokument ten zawiera otrzyma fokus. Jeśli aplikacja obsługuje wielu szablonów dokumentów, platformę używa rozszerzenie nazwy pliku można znaleźć szablonu odpowiednie dokumentu, aby spróbować załadować dokument. W przypadku powodzenia szablonu dokumentu następnie tworzy ramkę okna i Widok dokumentu.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]  
  
##  <a name="parsecommandline"></a>CWinApp::ParseCommandLine  
 Wywołanie tej funkcji Członkowskich przeanalizować wiersza polecenia i wysłać do parametrów, pojedynczo, [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam).  
  
```  
void ParseCommandLine(CCommandLineInfo& rCmdInfo);
```  
  
### <a name="parameters"></a>Parametry  
 `rCmdInfo`  
 Odwołanie do [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) obiektu.  
  
### <a name="remarks"></a>Uwagi  
 Po uruchomieniu nowego projektu MFC za pomocą Kreatora aplikacji, Kreator aplikacji utworzy lokalne wystąpienie programu `CCommandLineInfo`, a następnie wywołać `ProcessShellCommand` i `ParseCommandLine` w [InitInstance](#initinstance) funkcji członkowskiej. Wiersz polecenia następujące trasy opisanych poniżej:  
  
1.  Utworzone w `InitInstance`, `CCommandLineInfo` obiekt jest przekazywany do `ParseCommandLine`.  
  
2. `ParseCommandLine`następnie wywołuje `CCommandLineInfo::ParseParam` , jeden raz dla każdego parametru.  
  
3. `ParseParam`wypełnia `CCommandLineInfo` obiektów, które są następnie przekazywane do [ProcessShellCommand](#processshellcommand).  
  
4. `ProcessShellCommand`obsługuje flagi i argumenty wiersza polecenia.  
  
 Należy pamiętać, że można wywołać `ParseCommandLine` bezpośrednio, zgodnie z potrzebami.  
  
 Aby uzyskać opis flagi wiersza polecenia, zobacz [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand).  
  
##  <a name="pretranslatemessage"></a>CWinApp::PreTranslateMessage  
 Zastąpienie tej funkcji do filtrowania wiadomości okna przed wysłaniem do funkcji systemu Windows [TranslateMessage](http://msdn.microsoft.com/library/windows/desktop/ms644955) i [DispatchMessage](http://msdn.microsoft.com/library/windows/desktop/ms644934) Domyślna implementacja wykonuje klawisz skrótu tłumaczenie, dlatego należy wywołać `CWinApp::PreTranslateMessage` funkcji członkowskiej w wersji zastąpiona.  
  
```  
virtual BOOL PreTranslateMessage(MSG* pMsg);
```  
  
### <a name="parameters"></a>Parametry  
 `pMsg`  
 Wskaźnik do [MSG](../../mfc/reference/msg-structure1.md) strukturę, która zawiera komunikat do przetworzenia.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli pełni przetworzonych komunikatów w `PreTranslateMessage` i nie powinno być dalej przetwarzane. Zero, jeśli komunikat powinien zostać przetworzony w zwykły sposób.  
  
##  <a name="processmessagefilter"></a>CWinApp::ProcessMessageFilter  
 Funkcja framework wymaga funkcji członkowskiej filtrować i reagowanie na niektórych komunikatów systemu Windows.  
  
```  
virtual BOOL ProcessMessageFilter(
    int code,  
    LPMSG lpMsg);
```  
  
### <a name="parameters"></a>Parametry  
 `code`  
 Określa kod punktu zaczepienia. Ta funkcja członkowska kod używany do określenia sposobu przetwarzania`lpMsg.`  
  
 `lpMsg`  
 Wskaźnik do systemu Windows [MSG](../../mfc/reference/msg-structure1.md) struktury.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli komunikat jest przetwarzany; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Funkcja przetwarza zdarzenia przed ich wysłaniem do normalnego komunikatu aplikacji przetwarzania.  
  
 Jeśli możesz zastąpić to zaawansowana funkcja, należy wywołać wersji klasa podstawowa do obsługi platformy utworzenie punktu zaczepienia przetwarzania.  
  
##  <a name="processshellcommand"></a>CWinApp::ProcessShellCommand  
 Ta funkcja członkowska jest wywoływana przez [InitInstance](#initinstance) przekazywany z parametrów przyjąć `CCommandLineInfo` identyfikowane przez obiekt `rCmdInfo`i wykonać akcję wskazany.  
  
```  
BOOL ProcessShellCommand(CCommandLineInfo& rCmdInfo);
```  
  
### <a name="parameters"></a>Parametry  
 `rCmdInfo`  
 Odwołanie do [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) obiektu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli pomyślnie przetworzyć polecenia powłoki. W przypadku 0, zwraca **FALSE** z [InitInstance](#initinstance).  
  
### <a name="remarks"></a>Uwagi  
 Po uruchomieniu nowego projektu MFC za pomocą Kreatora aplikacji, Kreator aplikacji utworzy lokalne wystąpienie programu `CCommandLineInfo`, a następnie wywołać `ProcessShellCommand` i [ParseCommandLine](#parsecommandline) w `InitInstance` funkcji członkowskiej. Wiersz polecenia następujące trasy opisanych poniżej:  
  
1.  Utworzone w `InitInstance`, `CCommandLineInfo` obiekt jest przekazywany do `ParseCommandLine`.  
  
2. `ParseCommandLine`następnie wywołuje [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam) , jeden raz dla każdego parametru.  
  
3. `ParseParam`wypełnia `CCommandLineInfo` obiektów, które są następnie przekazywane do `ProcessShellCommand`.  
  
4. `ProcessShellCommand`obsługuje flagi i argumenty wiersza polecenia.  
  
 Elementy członkowskie danych z `CCommandLineInfo` obiektu identyfikowane przez [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand), są następujące typu wyliczeniowego jest zdefiniowany w `CCommandLineInfo` klasy.  
  
```  
enum {
    FileNew,
    FileOpen,
    FilePrint,
    FilePrintTo,
    FileDDE
    };  
```
  
 Krótki opis każdego z tych wartości, zobacz `CCommandLineInfo::m_nShellCommand`.  
  
##  <a name="processwndprocexception"></a>CWinApp::ProcessWndProcException  
 Struktura wywołuje funkcji członkowskiej, gdy program obsługi nie przechwytuje wyjątek w jednej z aplikacji do wiadomości lub programy obsługi poleceń.  
  
```  
virtual LRESULT ProcessWndProcException(
    CException* e,  
    const MSG* pMsg);
```  
  
### <a name="parameters"></a>Parametry  
 *e*  
 Wskaźnik do nieprzechwycony wyjątek.  
  
 `pMsg`  
 A [MSG](../../mfc/reference/msg-structure1.md) struktury, który zawiera informacje o komunikatów systemu windows, który spowodował platformę, aby zgłosić wyjątek.  
  
### <a name="return-value"></a>Wartość zwracana  
 Wartość, która ma zostać zwrócony do systemu Windows. Zazwyczaj jest to 0L dla komunikatów systemu windows, 1L ( **TRUE**) dla wiadomości polecenia.  
  
### <a name="remarks"></a>Uwagi  
 Nie wywołuj tej funkcji Członkowskich bezpośrednio.  
  
 Domyślna implementacja funkcji członkowskiej tworzy okno komunikatu. Jeśli nieprzechwycony wyjątek pochodzi z menu, paska narzędzi lub błąd polecenia skrótów, w oknie komunikatu wyświetli komunikat "Polecenie nie powiodło się."; w przeciwnym razie wyświetlany komunikat "wewnętrzny błąd aplikacji".  
  
 Przesłonić tę funkcję elementu członkowskiego, aby zapewnić obsługę globalnej listy wyjątków. Podstawowe funkcje należy wywoływać tylko, jeśli chcesz, aby komunikat, który będzie wyświetlany.  
  
##  <a name="register"></a>CWinApp::Register  
 Wykonuje wszelkie zadania rejestracji nie są obsługiwane przez `RegisterShellFileTypes`.  
  
```  
virtual BOOL Register();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Domyślna implementacja po prostu zwraca wartość PRAWDA. Zastąp wszystkie kroki rejestracji dostosowane tej funkcji.  
  
##  <a name="registershellfiletypes"></a>CWinApp::RegisterShellFileTypes  
 Wywołanie tej funkcji Członkowskich zarejestrować wszystkich typów dokumentów aplikacji przy użyciu Menedżera plików systemu Windows.  
  
```  
void RegisterShellFileTypes(BOOL bCompat = FALSE);
```  
  
### <a name="parameters"></a>Parametry  
 [in]`bCompat`  
 `TRUE`Dodaje wpisy rejestracyjne dla poleceń powłoki, drukowania i drukowania do, co pozwala użytkownikowi na drukowanie plików bezpośrednio z poziomu powłoki lub przez przeciągnięcie pliku do obiektu drukarki. Dodaje klucz DefaultIcon. Domyślnie ten parametr jest `FALSE` zgodności z poprzednimi wersjami.  
  
### <a name="remarks"></a>Uwagi  
 Umożliwia użytkownikowi otwieranie pliku danych utworzonych przez aplikację za pomocą go z dwukrotnie w ramach Menedżera plików. Wywołanie `RegisterShellFileTypes` po wywołaniu metody [AddDocTemplate](#adddoctemplate) dla każdego z szablonów dokumentów w aplikacji. Także wywołać [EnableShellOpen](#enableshellopen) funkcji członkowskiej podczas wywoływania `RegisterShellFileTypes`.  
  
 `RegisterShellFileTypes`wykonuje iterację na liście [cdoctemplate —](../../mfc/reference/cdoctemplate-class.md) obiektów, że aplikacja przechowuje i dla każdego szablonu dokumentu, dodaje wpisy w bazie danych rejestracji systemu Windows obsługuje dla skojarzeń plików. Menedżer plików używa tych pozycji można otworzyć pliku danych, gdy użytkownik kliknie dwukrotnie. Eliminuje to konieczność do wysłania. Plik REG o aplikacji.  
  
> [!NOTE]
> `RegisterShellFileTypes`działa tylko, jeśli użytkownik uruchamia program z uprawnieniami administratora. Jeśli program nie ma uprawnienia administratora, nie można dokonać zmian kluczy rejestru.  
  
 Jeśli baza danych rejestracji już kojarzy podanego rozszerzenia pliku z innym typem pliku, nie nowe skojarzenie zostanie utworzony. Zobacz `CDocTemplate` klasy dla formatu ciągów, które są niezbędne zarejestrować te informacje.  
  
##  <a name="registerwithrestartmanager"></a>CWinApp::RegisterWithRestartManager  
 Rejestruje aplikację przy użyciu Menedżera ponownego uruchomienia.  
  
```  
virtual HRESULT RegisterWithRestartManager(
BOOL bRegisterRecoveryCallback,  
const CString& strRestartIdentifier);

 
virtual HRESULT RegisterWithRestartManager(
LPCWSTR pwzCommandLineArgs,  
DWORD dwRestartFlags,  
APPLICATION_RECOVERY_CALLBACK pRecoveryCallback,  
LPVOID lpvParam,  
DWORD dwPingInterval,  
DWORD dwCallbackFlags);
```  
  
### <a name="parameters"></a>Parametry  
  
|||  
|-|-|  
|Parametr|Opis|  
|[in]`bRegisterRecoveryCallback`|`TRUE`Wskazuje, czy to wystąpienie aplikacji wykorzystuje funkcję wywołania zwrotnego odzyskiwania; `FALSE` wskazuje, czy nie. Struktura wywołuje funkcję wywołania zwrotnego odzyskiwania, gdy aplikacja jest nieoczekiwanie zamykany. Aby uzyskać więcej informacji, zobacz [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|  
|[in]`strRestartIdentifier`|Unikatowy ciąg identyfikujący to wystąpienie Menedżera ponownego uruchomienia. Identyfikator menedżera ponowne uruchomienie jest unikatowy dla każdego wystąpienia aplikacji.|  
|[in]`pwzCommandLineArgs`|Ciąg, który zawiera wszelkie dodatkowe argumenty wiersza polecenia.|  
|[in]`dwRestartFlags`|Flagi opcjonalne dla Menedżera ponownego uruchomienia. Aby uzyskać więcej informacji, zobacz sekcję: Uwagi.|  
|[in]`pRecoveryCallback`|Funkcja wywołania zwrotnego odzyskiwania. Ta funkcja przyjmuje `LPVOID` parametr jako dane wejściowe i przywracać `DWORD`. Funkcja wywołania zwrotnego odzyskiwania domyślny jest `CWinApp::ApplicationRecoveryCallback`.|  
|[in]`lpvParam`|Parametr wejściowy funkcji wywołania zwrotnego odzyskiwania. Aby uzyskać więcej informacji, zobacz [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|  
|[in]`dwPingInterval`|Długość czasu, przez który Menedżer ponownego uruchomienia oczekuje na działanie funkcji wywołania zwrotnego odzyskiwania do zwrócenia. Ten parametr jest w milisekundach.|  
|[in]`dwCallbackFlags`|Flagi przekazany do funkcji wywołania zwrotnego odzyskiwania. Zarezerwowane do użytku w przyszłości.|  
  
### <a name="return-value"></a>Wartość zwracana  
 `S_OK`Jeśli metoda zakończy się pomyślnie; w przeciwnym razie kod błędu.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli aplikacja używa Domyślna implementacja MFC autozapisywanie plików, należy użyć prostego wersja `RegisterWithRestartManager`. Użyj wersji złożonych `RegisterWithRestartManager` Jeśli chcesz dostosować zachowanie automatycznego zapisywania aplikacji.  
  
 Jeśli wywołanie tej metody za pomocą ciągu pustego `strRestartIdentifier`, `RegisterWithRestartManager` tworzy ciąg unikatowy identyfikator dla tego wystąpienia o ponownym uruchomieniu menedżera.  
  
 Po nieoczekiwanym zamknięciu aplikacji Menedżer ponownego uruchamiania uruchamia ponownie aplikację z poziomu wiersza polecenia i zawiera unikatowy identyfikator jako opcjonalny argument ponownego uruchomienia. W tym scenariuszu struktura wywołuje `RegisterWithRestartManager` dwa razy. Pierwsze wywołanie pochodzi z [CWinApp::InitInstance](#initinstance) za pomocą ciągu pustego ciągu identyfikatora. Następnie metoda [CWinApp::ProcessShellCommand](#processshellcommand) wywołania `RegisterWithRestartManager` o ponowne uruchomienie Unikatowy identyfikator.  
  
 Po zarejestrowaniu aplikacji przy użyciu Menedżera ponownego uruchomienia, Menedżer ponownego uruchamiania monitoruje aplikacji. Jeśli aplikacja jest nieoczekiwanie, Menedżer ponownego uruchamiania wywołuje funkcję wywołania zwrotnego odzyskiwania podczas Zamykanie procesu. Ponowne uruchomienie czeka Menedżera `dwPingInterval` na odpowiedź od funkcji wywołania zwrotnego odzyskiwania. Jeśli funkcja wywołania zwrotnego odzyskiwania nie odpowie w tym momencie, bez wykonywania funkcji wywołania zwrotnego odzyskiwania kończy działanie aplikacji.  
  
 Domyślnie dwRestartFlags nie są obsługiwane, ale są dostarczane do użytku w przyszłości. Możliwe wartości `dwRestartFlags` są następujące:  
  
- `RESTART_NO_CRASH`  
  
- `RESTART_NO_HANG`  
  
- `RESTART_NO_PATCH`  
  
- `RESTART_NO_REBOOT`  
  
##  <a name="reopenpreviousfilesatrestart"></a>CWinApp::ReopenPreviousFilesAtRestart  
 Określa, czy Menedżer ponownego uruchamiania ponownie otwiera pliki, które były otwarte podczas aplikacji został nieoczekiwanie zakończony.  
  
```  
virtual BOOL ReopenPreviousFilesAtRestart() const;  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 `TRUE`Wskazuje, ponownie uruchom ponownie Menedżera otwierane wcześniej otwartych plików; `FALSE` wskazuje Menedżera ponownego uruchomienia nie.  
  
##  <a name="restartinstance"></a>CWinApp::RestartInstance  
 Obsługuje inicjowane przez ponowne uruchomienie Menedżera ponownego uruchamiania aplikacji.  
  
```  
virtual BOOL CWinApp::RestartInstance();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 `TRUE`Jeśli program obsługi danych odzyskiwania otwiera wcześniej otwieranie dokumentów; `FALSE` Jeśli obsługa odzyskiwania danych zawiera błąd lub nie ma żadnych wcześniej otwartych dokumentów.  
  
### <a name="remarks"></a>Uwagi  
 Po ponownym uruchomieniu aplikacji Menedżera ponownego uruchomienia w ramach wywołuje tę metodę. Ta metoda pobiera program obsługi odzyskiwania danych i przywraca pliki automatycznie zapisany. Ta metoda wywołuje [CDataRecoveryHandler::RestoreAutosavedDocuments](../../mfc/reference/cdatarecoveryhandler-class.md#restoreautosaveddocuments) do określenia, czy użytkownik chce przywrócić pliki automatycznie zapisany.  
  
 Ta metoda zwraca `FALSE` Jeśli [CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md) Określa, czy nie było żadnych otwarte dokumenty. Jeśli nie było żadnych otwarte dokumenty, zwykle uruchamiania aplikacji.  
  
##  <a name="restoreautosavedfilesatrestart"></a>CWinApp::RestoreAutosavedFilesAtRestart  
 Określa, czy Menedżer ponownego uruchamiania przywraca pliki zapisana automatycznie po jego ponownym uruchomieniu aplikacji.  
  
```  
virtual BOOL RestoreAutosavedFilesAtRestart() const;  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 `TRUE`wskazuje pliki zapisana automatycznie przywraca Menedżera ponowne uruchomienie; `FALSE` wskazuje Menedżera ponownego uruchomienia nie.  
  
##  <a name="run"></a>CWinApp::Run  
 Udostępnia domyślną pętlę komunikatów.  
  
```  
virtual int Run();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 `int` Wartość zwracana przez `WinMain`.  
  
### <a name="remarks"></a>Uwagi  
 **Uruchom** uzyskuje i wysyła komunikaty systemu Windows, do momentu otrzymania przez aplikację **WM_QUIT** wiadomości. Jeśli kolejka komunikatów aplikacji zawiera już żadnych komunikatów **Uruchom** wywołania [OnIdle](#onidle) do przetwarzania czas bezczynności. Wiadomości przychodzących, przejdź do [PreTranslateMessage](#pretranslatemessage) funkcji członkowskiej przetwarzania specjalnych funkcji systemu Windows, a następnie **TranslateMessage** translacji klawiatury standardowej; Ponadto  **DispatchMessage** została wywołana funkcja systemu Windows.  
  
 **Uruchom** rzadko zostanie zastąpiona, ale można je zastąpić zapewnienie specjalnego zachowania.  
  
##  <a name="runautomated"></a>CWinApp::RunAutomated  
 Wywołanie tej funkcji, aby określić, czy " **/Automation**"lub" **-automatyzacji**" ma opcji, która wskazuje, czy aplikacja serwera został uruchomiony przez aplikację klienta.  
  
```  
BOOL RunAutomated();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli znaleziono opcję; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli istnieje, opcja jest usuwany z wiersza polecenia. Aby uzyskać więcej informacji o automatyzacji OLE, zobacz artykuł [serwery automatyzacji](../../mfc/automation-servers.md).  
  
##  <a name="runembedded"></a>CWinApp::RunEmbedded  
 Wywołanie tej funkcji, aby określić, czy " **/osadzanie**"lub" **-Embedding**" ma opcji, która wskazuje, czy aplikacja serwera został uruchomiony przez aplikację klienta.  
  
```  
BOOL RunEmbedded();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli znaleziono opcję; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli istnieje, opcja jest usuwany z wiersza polecenia. Aby uzyskać więcej informacji na osadzanie, zobacz artykuł [serwery: Implementowanie serwera](../../mfc/servers-implementing-a-server.md).  
  
##  <a name="saveallmodified"></a>CWinApp::SaveAllModified  
 Wywoływane przez platformę, by zapisać wszystkie dokumenty w przypadku aplikacji główne okno ramowe zostanie zamknięty lub za pośrednictwem `WM_QUERYENDSESSION` wiadomości.  
  
```  
virtual BOOL SaveAllModified();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, jeśli jest to bezpieczne zakończyć działanie aplikacji; 0, jeśli nie bezpieczne zakończyć tę aplikację.  
  
### <a name="remarks"></a>Uwagi  
 Wywołuje domyślną implementację funkcji członkowskiej [CDocument::SaveModified](../../mfc/reference/cdocument-class.md#savemodified) funkcji członkowskiej z kolei dla wszystkich zmodyfikowane dokumenty w aplikacji.  
  
##  <a name="selectprinter"></a>CWinApp::SelectPrinter  
 Wywołanie tej funkcji elementu członkowskiego, aby wybrać określone drukarki, a następnie zwolnij drukarki, która wcześniej została wybrana w oknie dialogowym drukowania.  
  
```  
void SelectPrinter(
    HANDLE hDevNames,  
    HANDLE hDevMode,  
    BOOL bFreeOld = TRUE);
```  
  
### <a name="parameters"></a>Parametry  
 `hDevNames`  
 Dojście do [DEVNAMES](../../mfc/reference/devnames-structure.md) struktura, która identyfikuje sterowników, urządzenia i danych wyjściowych portu nazwy danej drukarki.  
  
 `hDevMode`  
 Dojście do [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) strukturę, która określa informacje dotyczące inicjowania urządzenia i środowiska drukarki.  
  
 *bFreeOld*  
 Zwalnia wcześniej wybrane drukarki.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli oba `hDevMode` i `hDevNames` są **NULL**, `SelectPrinter` używa bieżącej drukarki domyślnej.  
  
##  <a name="sethelpmode"></a>CWinApp::SetHelpMode  
 Ustawia typ pomocy aplikacji.  
  
```  
void SetHelpMode(AFX_HELP_TYPE eHelpType);
```  
  
### <a name="parameters"></a>Parametry  
 `eHelpType`  
 Określa rodzaj pomocy do użycia. Zobacz [CWinApp::m_eHelpType](#m_ehelptype) Aby uzyskać więcej informacji.  
  
### <a name="remarks"></a>Uwagi  
 Ustawia typ pomocy aplikacji.  
  
 Aby ustawić typ pomocy aplikacji HTMLHelp, można wywołać [EnableHTMLHelp](#enablehtmlhelp). Po wywołaniu `EnableHTMLHelp`, aplikacja musi używać HTMLHelp jako aplikacja w jego pomocy. Jeśli chcesz zmienić, aby użyć WinHelp, należy wywołać `SetHelpMode` i ustaw `eHelpType` do **afxWinHelp**.  
  
##  <a name="setregistrykey"></a>CWinApp::SetRegistryKey  
 Powoduje, że ustawienia aplikacji, które mają być przechowywane w rejestrze zamiast pliki INI.  
  
```  
void SetRegistryKey(LPCTSTR lpszRegistryKey);  
void SetRegistryKey(UINT nIDRegistryKey);
```  
  
### <a name="parameters"></a>Parametry  
 *lpszRegistryKey*  
 Wskaźnik do ciąg zawierający nazwę klucza.  
  
 *nIDRegistryKey*  
 Identyfikator zasobu ciągu zawierającego nazwę klucza rejestru.  
  
### <a name="remarks"></a>Uwagi  
 Ta funkcja ustawia *m_pszRegistryKey*, który jest następnie używany przez `GetProfileInt`, `GetProfileString`, `WriteProfileInt`, i `WriteProfileString` funkcji Członkowskich `CWinApp`. Jeśli ta funkcja została wywołana, lista plików najczęściej ostatnio używanych (MRU) jest również przechowywane w rejestrze. Klucz rejestru jest zwykle nazwa firmy. Są przechowywane w kluczu następującą postać: HKEY_CURRENT_USER\Software\\< nazwa firmy\>\\< nazwa aplikacji\>\\< nazwa sekcji\>\\< wartość Nazwa\>.  
  
##  <a name="supportsapplicationrecovery"></a>CWinApp::SupportsApplicationRecovery  
 Określa, czy Menedżer ponownego uruchamiania odzyskuje aplikację, która został nieoczekiwanie zakończony.  
  
```  
virtual BOOL SupportsApplicationRecovery() const;  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 `TRUE`Wskazuje odzyskuje Menedżera ponownego uruchomienia tej aplikacji; `FALSE` wskazuje Menedżera ponownego uruchomienia nie.  
  
##  <a name="supportsautosaveatinterval"></a>CWinApp::SupportsAutosaveAtInterval  
 Określa, czy ponowne uruchomienie autosaves Menedżera otwieranie dokumentów w regularnych odstępach czasu.  
  
```  
virtual BOOL SupportsAutosaveAtInterval() const;  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 `TRUE`Wskazuje, że autosaves Menedżera ponownego uruchomienia otwieranie dokumentów; `FALSE` wskazuje Menedżera ponownego uruchomienia nie.  
  
##  <a name="supportsautosaveatrestart"></a>CWinApp::SupportsAutosaveAtRestart  
 Określa, czy autosaves Menedżera ponownego uruchomienia wszelkich otwartych dokumentów po ponownym uruchomieniu aplikacji.  
  
```  
virtual BOOL SupportsAutosaveAtRestart() const;  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 `TRUE`Wskazuje, że autosaves Menedżera ponownego uruchomienia otwieranie dokumentów po ponownym uruchomieniu aplikacji; `FALSE` wskazuje Menedżera ponownego uruchomienia nie.  
  
##  <a name="supportsrestartmanager"></a>CWinApp::SupportsRestartManager  
 Określa, czy aplikacja obsługuje Menedżer ponownego uruchamiania.  
  
```  
virtual BOOL SupportsRestartManager() const;  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 `TRUE`Wskazuje, że aplikacja obsługuje Menedżer ponownego uruchamiania; `FALSE` wskazuje nie obsługuje aplikacji.  
  
##  <a name="unregister"></a>CWinApp::Unregister  
 Wyrejestrowuje wszystkie pliki w zarejestrowany przez obiekt aplikacji.  
  
```  
virtual BOOL Unregister();
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="remarks"></a>Uwagi  
 `Unregister` Funkcja cofa rejestrację wykonywaną przez obiekt aplikacji i [zarejestrować](#register) funkcji. Zwykle funkcjami są nazywane niejawnie przez MFC i dlatego nie będą widoczne w kodzie.  
  
 Zastąp tę funkcję, aby wykonać kroki wyrejestrowanie niestandardowych.  
  
##  <a name="unregistershellfiletypes"></a>CWinApp::UnregisterShellFileTypes  
 Wywołanie tej funkcji Członkowskich wyrejestrować wszystkich typów dokumentów aplikacji przy użyciu Menedżera plików systemu Windows.  
  
```  
void UnregisterShellFileTypes();
```  
  
##  <a name="winhelp"></a>CWinApp::WinHelp  
 Wywołanie tej funkcji Członkowskich, aby wyświetlić WinHelp aplikacji.  
  
```  
virtual void WinHelp(
    DWORD_PTR dwData,  
    UINT nCmd = HELP_CONTEXT);
```  
  
### <a name="parameters"></a>Parametry  
 `dwData`  
 Określa dodatkowe dane. Wartość zależy od wartości `nCmd` parametru.  
  
 `nCmd`  
 Określa typ żądanie pomocy. Aby uzyskać listę możliwych wartości i ich wpływ na `dwData` parametru, zobacz [WinHelp](http://msdn.microsoft.com/library/windows/desktop/bb762267) funkcji systemu Windows.  
  
### <a name="remarks"></a>Uwagi  
 Struktura wywołuje również tę funkcję, aby wyświetlić WinHelp aplikacji.  
  
 Platformę zostanie automatycznie zamknięte WinHelp aplikacji, gdy zakończenie aplikacji.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#53](../../mfc/reference/codesnippet/cpp/cwinapp-class_28.cpp)]  
  
##  <a name="writeprofilebinary"></a>CWinApp::WriteProfileBinary  
 Wywołanie tej funkcji Członkowskich do zapisania danych binarnych w określonej sekcji rejestru aplikacji lub. Pliku INI.  
  
```  
BOOL WriteProfileBinary(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPBYTE pData,  
    UINT nBytes);
```  
  
### <a name="parameters"></a>Parametry  
 `lpszSection`  
 Wskazuje zerem ciąg, który określa sekcja zawierająca wpis. Jeśli sekcja nie istnieje, jest tworzony. Nazwa sekcji jest niezależna; ciąg może być dowolnej kombinacji wielkich i małych liter.  
  
 `lpszEntry`  
 Wskazuje zerem ciąg, który zawiera wpis, w którym wartość ma zostać zapisany. Jeśli wpis nie istnieje w określonej sekcji, jest tworzony.  
  
 `pData`  
 Punkty danych do zapisania.  
  
 `nBytes`  
 Zawiera liczbę bajtów do zapisania.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="example"></a>Przykład  
 W tym przykładzie użyto `CWinApp* pApp = AfxGetApp();` można uzyskać w cwinapp — klasa pokazujący sposób który `WriteProfileBinary` i `GetProfileBinary` można używać z dowolnej funkcji w aplikacji MFC.  
  
 [!code-cpp[NVC_MFCWindowing#54](../../mfc/reference/codesnippet/cpp/cwinapp-class_29.cpp)]  
  
 Na przykład innego, zobacz przykład [CWinApp::GetProfileBinary](#getprofilebinary).  
  
##  <a name="writeprofileint"></a>CWinApp::WriteProfileInt  
 Wywołanie tej funkcji Członkowskich do zapisania określonej wartości w określonej sekcji rejestru aplikacji lub. Pliku INI.  
  
```  
BOOL WriteProfileInt(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    int nValue);
```  
  
### <a name="parameters"></a>Parametry  
 `lpszSection`  
 Wskazuje zerem ciąg, który określa sekcja zawierająca wpis. Jeśli sekcja nie istnieje, jest tworzony. Nazwa sekcji jest niezależna; ciąg może być dowolnej kombinacji wielkich i małych liter.  
  
 `lpszEntry`  
 Wskazuje zerem ciąg, który zawiera wpis, w którym wartość ma zostać zapisany. Jeśli wpis nie istnieje w określonej sekcji, jest tworzony.  
  
 `nValue`  
 Zawiera wartość do zapisania.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="example"></a>Przykład  
 W tym przykładzie użyto `CWinApp* pApp = AfxGetApp();` można uzyskać w cwinapp — klasa pokazujący sposób który `WriteProfileString`, `WriteProfileInt`, `GetProfileString`, i `GetProfileInt` można używać z dowolnej funkcji w aplikacji MFC.  
  
 [!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]  
  
 Na przykład innego, zobacz przykład [CWinApp::GetProfileInt](#getprofileint).  
  
##  <a name="writeprofilestring"></a>CWinApp::WriteProfileString  
 Wywołanie tej funkcji Członkowskich do zapisania określonego ciągu w określonej sekcji rejestru aplikacji lub. Pliku INI.  
  
```  
BOOL WriteProfileString(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPCTSTR lpszValue);
```  
  
### <a name="parameters"></a>Parametry  
 `lpszSection`  
 Wskazuje zerem ciąg, który określa sekcja zawierająca wpis. Jeśli sekcja nie istnieje, jest tworzony. Nazwa sekcji jest niezależna; ciąg może być dowolnej kombinacji wielkich i małych liter.  
  
 `lpszEntry`  
 Wskazuje zerem ciąg, który zawiera wpis, w którym wartość ma zostać zapisany. Jeśli wpis nie istnieje w określonej sekcji, jest tworzony. Jeśli ten parametr ma `NULL`, określone przez sekcję `lpszSection` zostanie usunięta.  
  
 `lpszValue`  
 Wskazuje ciąg, który ma zostać zapisany. Jeśli ten parametr ma `NULL`, wpis określony przez `lpszEntry` parametr zostanie usunięty.  
  
### <a name="return-value"></a>Wartość zwracana  
 Różna od zera, w przypadku powodzenia; w przeciwnym razie 0.  
  
### <a name="example"></a>Przykład  
 [!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]  
  
 Na przykład innego, zobacz przykład [CWinApp::GetProfileInt](#getprofileint).  
  
##  <a name="setappid"></a>CWinApp::SetAppID  
 Jawnie Ustawia identyfikator modelu użytkownika aplikacji dla aplikacji. Ta metoda powinna być wywoływana przed interfejs użytkownika jest widoczne dla użytkowników (najlepiej jest konstruktor aplikacji).  
  
```  
void SetAppID(LPCTSTR lpcszAppID);
```  
  
### <a name="parameters"></a>Parametry  
 `lpcszAppID`  
 Określa identyfikator modelu użytkownika aplikacji.  
  
### <a name="remarks"></a>Uwagi  
  
## <a name="see-also"></a>Zobacz też  
 [Cwinthread — klasa](../../mfc/reference/cwinthread-class.md)   
 [Diagram hierarchii](../../mfc/hierarchy-chart.md)   
 [Porady: Dodawanie obsługi Menedżera ponownego uruchamiania](../../mfc/how-to-add-restart-manager-support.md)



