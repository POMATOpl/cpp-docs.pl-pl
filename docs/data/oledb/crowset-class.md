---
title: Klasa CRowset | Dokumentacja firmy Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: reference
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAll
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
dev_langs:
- C++
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: d65f9c7c796724a77935693690ac73357867dab0
ms.sourcegitcommit: b217daee32d3413cf33753d9b4dc35a0022b1bfa
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/24/2018
ms.locfileid: "39233519"
---
# <a name="crowset-class"></a>Klasa CRowset
Hermetyzuje obiektu zestawu wierszy OLE DB i kilka powiązanych interfejsów i dostarcza metod manipulowania wierszy danych.  
  
## <a name="syntax"></a>Składnia

```cpp
template <class TAccessor = CAccessorBase>  
class CRowset  
```  
  
#### <a name="parameters"></a>Parametry  
 *TAccessor*  
 Klasa metody dostępu. Wartość domyślna to `CAccessorBase`.  
  
## <a name="requirements"></a>Wymagania  
 **Nagłówek:** atldbcli.h  

## <a name="members"></a>Elementy członkowskie  
  
### <a name="methods"></a>Metody  
  
|||  
|-|-|  
|[Addrefrows —](#addrefrows)|Zwiększa liczbę odwołań skojarzone z bieżącego wiersza.|  
|[Zamknij](#close)|Wersje wierszy i bieżący `IRowset` interfejsu.|  
|[Compare](#compare)|Porównuje dwa zakładki przy użyciu [IRowsetLocate::Compare](https://msdn.microsoft.com/library/ms709539.aspx).|  
|[CRowset](#crowset)|Tworzy nową `CRowset` obiektu i (opcjonalnie) kojarzy ją z `IRowset` interfejs dostarczany jako parametr.|  
|[Usuń](#delete)|Usuwa wiersze z wierszy przy użyciu [IRowsetChange:DeleteRows](https://msdn.microsoft.com/library/ms724362.aspx).|  
|[FindNextRow](#findnextrow)|Wyszukuje następny zgodny wiersz po zakładką.|  
|[Getapproximateposition —](#getapproximateposition)|Zwraca pozycję przybliżony wiersz odpowiadający zakładki.|  
|[GetData](#getdata)|Pobiera dane z zestawu wierszy kopię wiersza.|  
|[GetDataHere —](#getdatahere)|Pobiera dane z określonego bufora.|  
|[GetOriginalData](#getoriginaldata)|Pobiera dane ostatnio pobrana z lub przesłana do źródła danych, ignorowanie oczekujące zmiany.|  
|[GetRowStatus](#getrowstatus)|Zwraca stan wszystkich wierszy.|  
|[Wstaw](#insert)|Tworzy i wstawia nowy wiersz za pomocą [IRowsetChange:InsertRow](https://msdn.microsoft.com/library/ms716921.aspx).|  
|[Issamerow —](#issamerow)|Porównuje określony wiersz z bieżącego wiersza.|  
|[MoveFirst](#movefirst)|Powoduje przeniesienie lokalizacji pobierania następnej pozycji początkowej.|  
|[MoveLast](#movelast)|Przesuwa ostatni rekord.|  
|[MoveNext](#movenext)|Pobiera dane z następny kolejny wiersz lub określoną liczbę pozycji poza następnego wiersza.|  
|[Moveprev —](#moveprev)|Przenosi do poprzedniego rekordu.|  
|[Movetobookmark —](#movetobookmark)|Pobiera zakładki lub wiersz w określonym przesunięciu z tej zakładki.|  
|[MoveToRatio](#movetoratio)|Pobiera wiersze, rozpoczynając od ułamków pozycji w zestawie wierszy.|  
|[Releaserows —](#releaserows)|Wywołania [IRowset::ReleaseRows](https://msdn.microsoft.com/library/ms719771.aspx) zwolnić dojście do bieżącego wiersza.|  
|[SetData](#setdata)|Ustawia wartości danych w jednej lub kilku kolumn przy użyciu wiersza [IRowsetChange:SetData](https://msdn.microsoft.com/library/ms721232.aspx).|  
|[Cofnij](#undo)|Cofa wszelkie zmiany wprowadzone od czasu ostatniego pobrania wiersza lub [aktualizacji](../../data/oledb/crowset-update.md).|  
|[Aktualizacja](#update)|Przesyła wszystkie oczekujące zmiany wprowadzone od czasu ostatniego pobrania lub aktualizacji bieżący wiersz.|  
|[UpdateAll](#updateall)|Przesyła wszystkie oczekujące zmiany do wszystkich wierszy od czasu ostatniego pobrania lub aktualizacji.|  
  
## <a name="remarks"></a>Uwagi  
 W OLE DB zestawu wierszy jest obiekt, za pomocą którego program ustawia i pobiera dane.  
  
 Ta klasa nie jest przeznaczona do wystąpienia, ale raczej przekazany jako parametr szablonu `CTable` lub `CCommand` (`CRowset` jest ustawieniem domyślnym).  

## <a name="addrefrows"></a> CRowset::AddRefRows
Wywołania [IRowset::AddRefRows](https://msdn.microsoft.com/library/ms719619.aspx) do zwiększenia (po jednym) licznik odwołań skojarzonych z bieżącym dojście do wiersza.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT AddRefRows() throw();  
  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda zwiększa liczbę odwołań dla dojście do bieżącego wiersza. Wywołaj [releaserows —](../../data/oledb/crowset-releaserows.md) zmniejszyć liczbę. Wiersze zwrócone przez metody przenoszenia mają liczebności referencyjnej równej jeden.  

## <a name="close"></a> CRowset::Close
Wersje wierszy i bieżący [IRowset](https://msdn.microsoft.com/library/ms720986.aspx) interfejsu.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
void Close() throw();  
  
```  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda zwalnia wszystkie wiersze, obecnie w zestawie wierszy.  

## <a name="compare"></a> CRowset::Compare
Porównuje dwa zakładki przy użyciu [IRowsetLocate::Compare](https://msdn.microsoft.com/library/ms709539.aspx).  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,   
   const CBookmarkBase& bookmark2,   
   DBCOMPARE* pComparison) const throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *Bookmark1*  
 [in] Pierwszy zakładki do porównania.  
  
 *Bookmark2*  
 [in] Drugi zakładki do porównania.  
  
 *pComparison*  
 [out] Wskaźnik do wyniku porównania.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda wymaga opcjonalny interfejs `IRowsetLocate`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetLocate` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  
  
 Aby dowiedzieć się, jak korzystanie z zakładek w konsumentów, zobacz [przy użyciu zakładki](../../data/oledb/using-bookmarks.md).  

## <a name="crowset"></a> CRowset::CRowset
Tworzy nową `CRowset` obiektu i (opcjonalnie) kojarzy ją z [IRowset](https://msdn.microsoft.com/library/ms720986.aspx) interfejs dostarczany jako parametr.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
      CRowset();   

CRowset(IRowset* pRowset);  
```  
  
#### <a name="parameters"></a>Parametry  
 *pRowset*  
 [in] Wskaźnik do `IRowset` interfejsu ma zostać skojarzony z tą klasą.  

## <a name="delete"></a> CRowset::Delete
Wywołania [IRowsetChange::DeleteRows](https://msdn.microsoft.com/library/ms724362.aspx) można usunąć bieżący wiersz z zestawu wierszy.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT Delete() const throw();  
  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  

## <a name="findnextrow"></a> CRowset::FindNextRow
Wyszukuje następny zgodny wiersz po zakładką.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT FindNextRow(DBCOMPAREOP op,   
  BYTE* pData,   
   DBTYPE wType,   
   DBLENGTH nLength,   
   BYTE bPrecision,   
   BYTE bScale,   
   BOOL bSkipCurrent = TRUE,   
   CBookmarkBase* pBookmark = NULL) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *OP*  
 [in] Operacja używania przy porównywaniu wartości wiersza. W przypadku wartości zobacz [IRowsetFind::FindNextRow](https://msdn.microsoft.com/library/ms723091.aspx).  
  
 *pData*  
 [in] Wskaźnik do wartości, które mają być dopasowywane.  
  
 *wType*  
 [in] Wskazuje typ danych wartości części buforu. Informacje wskaźników typu, zobacz [typy danych](https://msdn.microsoft.com/library/ms723969.aspx) w *OLE DB Podręcznik programisty* w zestawie Windows SDK.  
  
 *nLength*  
 [in] Długość, w bajtach, struktury danych konsumentów przydzielonych do wartości danych. Aby uzyskać szczegółowe informacje, zobacz opis `cbMaxLen` w [struktury DBBINDING](https://msdn.microsoft.com/library/ms716845.aspx) w *OLE DB Podręcznik programisty.*  
  
 *bPrecision*  
 [in] Maksymalna dozwolona dokładność używany podczas pobierania danych. Używane tylko wtedy, gdy *wType* jest DBTYPE_NUMERIC. Aby uzyskać więcej informacji, zobacz [konwersje obejmujące DBTYPE_NUMERIC lub DBTYPE_DECIMAL](https://msdn.microsoft.com/library/ms719714.aspx) w *OLE DB Podręcznik programisty*.  
  
 *bScale*  
 [in] Skala używany podczas pobierania danych. Używane tylko wtedy, gdy *wType* DBTYPE_NUMERIC lub DBTYPE_DECIMAL. Aby uzyskać więcej informacji, zobacz [konwersje obejmujące DBTYPE_NUMERIC lub DBTYPE_DECIMAL](https://msdn.microsoft.com/library/ms719714.aspx) w *OLE DB Podręcznik programisty*.  
  
 *bSkipCurrent*  
 [in] Liczba wierszy z zakładki, od którego należy rozpocząć wyszukiwanie.  
  
 *pBookmark*  
 [in] Zakładki dla pozycji, od którego należy rozpocząć wyszukiwanie.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda wymaga opcjonalny interfejs `IRowsetFind`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetFind` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  
  
 Aby dowiedzieć się, jak korzystanie z zakładek w konsumentów, zobacz [przy użyciu zakładki](../../data/oledb/using-bookmarks.md).  

## <a name="getapproximateposition"></a> CRowset::GetApproximatePosition
Zwraca pozycję przybliżony wiersz odpowiadający zakładki.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,   
   DBCOUNTITEM* pPosition,   
   DBCOUNTITEM* pcRows) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *pBookmark*  
 [in] Wskaźnik do zakładki, która identyfikuje wiersz, w których pozycja ma zostać znaleziona. Wartość NULL, jeśli liczba wierszy jest wymagany tylko.  
  
 *pPosition*  
 [out] Wskaźnik do lokalizacji, w którym `GetApproximatePosition` zwraca pozycję wiersza. Wartość NULL, jeśli pozycja nie jest wymagana.  
  
 *pcRows*  
 [out] Wskaźnik do lokalizacji, w którym `GetApproximatePosition` zwraca łączną liczbę wierszy. Wartość NULL, jeśli liczba wierszy nie jest wymagana.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda wymaga opcjonalny interfejs `IRowsetScroll`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetScroll` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  
  
 Aby dowiedzieć się, jak korzystanie z zakładek w konsumentów, zobacz [przy użyciu zakładki](../../data/oledb/using-bookmarks.md).  

## <a name="getdata"></a> CRowset::GetData
Pobiera dane z zestawu wierszy kopię wiersza.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT GetData() throw();   


HRESULT GetData(int nAccessor) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *nAccessor*  
 [in] Numer indeksu (zero przesunięcie) dostępu na potrzeby uzyskiwania dostępu do danych.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Jeśli określisz metodę dostępu, który nie jest autoaccessor w [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), ta metoda umożliwia jawne uzyskanie danych, przekazując numer dostępu.  

## <a name="getdatahere"></a> CRowset::GetDataHere
Pobiera dane z bieżącego wiersza i umieszcza go w określonego bufora.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT GetDataHere(int nAccessor,   
  void* pBuffer) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *nAccessor*  
 [in] Numer indeksu dostępu na potrzeby uzyskiwania dostępu do danych.  
  
 *pBuffer*  
 [out] Bufor do której chcesz umieścić dane bieżącego rekordu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Na przykład jak używać tej funkcji, zobacz [MultiRead przykładowe](../../visual-cpp-samples.md).

## <a name="getoriginaldata"></a> CRowset::GetOriginalData
Wywołania `IRowsetUpdate::GetOriginalData` można pobrać danych ostatnio pobrana z lub przesłana do źródła danych.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT GetOriginalData() throw();  
  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda pobiera dane ostatnio pobrana z lub przesłana do źródła danych; go nie pobrać wartości na podstawie oczekujące zmiany.  
  
 Ta metoda wymaga opcjonalny interfejs `IRowsetUpdate`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetUpdate` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy. 

## <a name="getrowstatus"></a> CRowset::GetRowStatus
Zwraca stan wszystkich wierszy.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *pStatus*  
 [out] Wskaźnik do lokalizacji, gdzie `GetRowStatus` zwraca wartość stanu. Zobacz DBPENDINGSTATUS w odwołaniu do programisty OLE DB.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda wymaga opcjonalny interfejs `IRowsetUpdate`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetUpdate` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.   

## <a name="insert"></a> CRowset::Insert
Tworzy i inicjuje nowego wiersza przy użyciu danych z metody dostępu.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT Insert(int nAccessor = 0,   
   bool bGetHRow = false) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *nAccessor*  
 [in] Numer dostępu do użycia podczas wstawiania danych.  
  
 *bGetHRow*  
 [in] Wskazuje, czy uchwyt wstawionego wiersza są pobierane.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda wymaga opcjonalny interfejs `IRowsetChange`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetChange` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  
  
 Wstaw może zakończyć się niepowodzeniem, jeśli co najmniej jedna kolumna nie jest zapisywalna. Zmodyfikuj mapy kursora, aby rozwiązać ten problem.  
  
### <a name="example"></a>Przykład  
 Poniższy przykład pokazuje, jak dostęp do źródła danych za pomocą zestawu wierszy, a następnie wstawianie na ciąg przy użyciu tabeli, w tym zestawie wierszy.  
  
 Najpierw należy utworzyć klasę tabeli przez wstawienie nowego obiektu ATL do projektu. Na przykład, kliknij prawym przyciskiem myszy projekt w okienku obszaru roboczego i wybierz **nowy obiekt ATL**. Z **dostęp do danych** kategorii, wybierz opcję **konsumenta**. Utwórz typ obiektu odbiorcy **tabeli**. (Zaznaczenie **tabeli** tworzy zestawu wierszy bezpośrednio z tabeli; wybieranie **polecenia** tworzy wierszy za pomocą polecenia SQL.) Wybierz źródło danych, określając tabeli za pomocą którego można uzyskać dostępu tego źródła danych. Jeśli wywołanie obiektu konsumenta **CCustomerTable**, możesz następnie również zaimplementować kod wstawiania w następujący sposób:  
  
 [!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]  

## <a name="issamerow"></a> CRowset::IsSameRow
Porównuje określony wiersz z bieżącego wiersza.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT IsSameRow(HROW hRow) const throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *hRow*  
 [in] Dojście do wiersza do porównania z bieżącym wierszu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT. S_OK wskazuje, że wiersze są takie same. Aby uzyskać inne wartości, zobacz [IRowsetIndentity::IsSameRow](https://msdn.microsoft.com/library/ms719629.aspx) w *OLE DB Podręcznik programisty* w zestawie Windows SDK.  

## <a name="movefirst"></a> CRowset::MoveFirst
Przenosi kursor do położenie początkowe i pobiera początkowy wiersz.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT MoveFirst() throw();  
  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Wywołania [IRowset::RestartPosition](https://msdn.microsoft.com/library/ms712877.aspx) służące do zmiany położenia lokalizacji pobierania następnej pozycji początkowej (pozycja został lokalizacji pobierania następnego podczas tworzenia zestawu wierszy) i pobiera początkowy wiersz.  

## <a name="movelast"></a> CRowset::MoveLast
Przenosi kursor do ostatniego wiersza.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT MoveLast() throw();  
  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Wywołania [IRowset::RestartPosition](https://msdn.microsoft.com/library/ms712877.aspx) służące do zmiany położenia lokalizacji pobierania dalej do ostatniej pozycji i pobiera ostatni wiersz.  
  
 Ta metoda wymaga, aby ustawić `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy. (Lepszą wydajność, możesz również ustawić `DBPROP_QUICKRESTART` VARIANT_TRUE.)  

## <a name="movenext"></a> CRowset::MoveNext
Przenosi kursor do następnego rekordu.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT MoveNext() throw();HRESULT MoveNext(LONG lSkip,   
   bool bForward= true) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *lSkip*  
 [in] Liczba wierszy do pominięcia przed pobieranie.  
  
 *bForward*  
 [in] Przekaż **true** przejścia do następnego rekordu **false** umożliwiający przenoszenie do tyłu.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT. Zwraca DB_S_ENDOFROWSET, gdy zostanie osiągnięty koniec zestawu wierszy.  
  
### <a name="remarks"></a>Uwagi  
 Pobiera następny wiersz sekwencyjne z `CRowset` obiektu, uzupełnij poprzedniej pozycji. Ewentualnie możesz przejść od razu *lSkip* wierszy lub przechodzenie do tyłu.  
  
 Ta metoda wymaga, że można ustawić następujące właściwości przed wywołaniem `Open` dotyczącej tabeli lub zawierające zestaw wierszy polecenia:  
  
-   `DBPROP_CANSCROLLBACKWARDS` musi być VARIANT_TRUE, jeśli *lSkip* < 0  
  
-   `DBPROP_CANFETCHBACKWARDS` musi być VARIANT_TRUE, jeśli *bForward* = false  
  
 W przeciwnym razie (Jeśli *lSkip* > = 0 i *bForward* = true), nie musisz ustawiać żadnych dodatkowych właściwości.  

## <a name="moveprev"></a> CRowset::MovePrev
Przenosi kursor do poprzedniego rekordu.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT MovePrev() throw();  
  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda wymaga, ustaw opcję `DBPROP_CANFETCHBACKWARDS` lub `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy. 

## <a name="movetobookmark"></a> CRowset::MoveToBookmark
Pobiera wiersz oznaczone przez zakładki lub wiersz w określonym przesunięciu (*lSkip*) z tej zakładki.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,   
   LONG lSkip = 0) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *Zakładka*  
 [in] Zakładka, oznaczanie lokalizacji, z którego chcesz pobrać dane.  
  
 *lSkip*  
 [in] Liczbę wierszy z zakładki, aby wiersz docelowy. Jeśli *lSkip* wynosi zero, pierwszy wiersz pobrania jest zakładką wiersza. Jeśli *lSkip* wynosi 1, pierwszy wiersz pobrania jest wiersz po wierszu zakładką. Jeśli *lSkip* wynosi -1, pierwszy wiersz pobrania jest wierszy przed wierszem zakładką.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda wymaga opcjonalny interfejs `IRowsetLocate`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetLocate` VARIANT_TRUE i zestaw `DBPROP_CANFETCHBACKWARDS` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  
  
 Aby dowiedzieć się, jak korzystanie z zakładek w konsumentów, zobacz [przy użyciu zakładki](../../data/oledb/using-bookmarks.md).  
  
## <a name="movetoratio"></a> CRowset::MoveToRatio
Pobiera wiersze, rozpoczynając od ułamków pozycji w zestawie wierszy.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,   
   DBCOUNTITEM nDenominator,bool bForward = true) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *nNumerator*  
 [in] Licznik używany do określenia ułamkowe pozycyjne, z którego można pobrać danych.  
  
 *nDenominator*  
 [in] Denominator używany do określenia ułamkowe pozycyjne, z którego można pobrać danych.  
  
 *bForward*  
 [in] Wskazuje, czy do przechodzenia do przodu lub Wstecz. Wartość domyślna jest proste.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 `MoveToRatio` Pobiera wiersze, zgodnie z grubsza na następującą formułę:  
  
 `(nNumerator *  RowsetSize ) / nDenominator`  
  
 Gdzie `RowsetSize` jest rozmiar wierszy, mierzone w wierszach. Dokładność tę formułę, zależy od określonego dostawcy. Aby uzyskać więcej informacji, zobacz [IRowsetScroll::GetRowsAtRatio](https://msdn.microsoft.com/library/ms709602.aspx).  
  
 Ta metoda wymaga opcjonalny interfejs `IRowsetScroll`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetScroll` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  

## <a name="releaserows"></a> CRowset::ReleaseRows
Wywołania [IRowset::ReleaseRows](https://msdn.microsoft.com/library/ms719771.aspx) zwolnić dojście do bieżącego wiersza.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT ReleaseRows() throw();  
  
```  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  

## <a name="setdata"></a> CRowset::SetData
Ustawia wartości danych w jednej lub kilku kolumn w wierszu.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT SetData() const throw();   


HRESULT SetData(int nAccessor) const throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *nAccessor*  
 [in] Numer dostępu na potrzeby uzyskiwania dostępu do danych.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Aby uzyskać `SetData` formularz, który akceptuje żadnych argumentów, wszystkie metody dostępu są używane do aktualizowania. Zwykle wywołują `SetData` do ustawiania wartości danych w kolumnach w wierszu, następnie wywołać [aktualizacji](../../data/oledb/crowset-update.md) przesyłać tych zmian.  
  
 Ta metoda wymaga opcjonalny interfejs `IRowsetChange`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetChange` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  
  
 Operacja ustawienia może zakończyć się niepowodzeniem, jeśli co najmniej jedna kolumna nie jest zapisywalna. Zmodyfikuj mapy kursora, aby rozwiązać ten problem. 
  
## <a name="undo"></a> CRowset::Undo
Cofa wszelkie zmiany wprowadzone od czasu ostatniego pobrania wiersza lub [aktualizacji](../../data/oledb/crowset-update.md).  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,   
   HROW* phRow = NULL,   
   DBROWSTATUS* pStatus = NULL) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *pcRows*  
 [out] Wskaźnik do lokalizacji, w którym `Undo` zwraca liczbę wierszy nastąpiła próba Cofnij, jeśli jest to wymagane.  
  
 *phRow*  
 [out] Wskaźnik do lokalizacji, w którym `Undo` zwraca tablicę dojść do wszystkich wierszy nastąpiła próba Cofnij, jeśli jest to wymagane.  
  
 *pStatus*  
 [out] Wskaźnik do lokalizacji, w którym `Undo` zwraca wartość stanu wiersza. Brak stanu jest zwracany, jeśli *pStatus* ma wartość null.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Ta metoda wymaga opcjonalny interfejs `IRowsetUpdate`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetUpdate` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  

## <a name="update"></a> CRowset::Update
Przesyła wszystkie oczekujące zmiany wprowadzone do bieżącego wiersza od czasu ostatniego pobrania lub `Update` wywołania.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,   
   HROW* phRow = NULL,   
   DBROWSTATUS* pStatus = NULL) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *pcRows*  
 [out] Wskaźnik do lokalizacji, w którym `Update` zwraca liczbę wierszy nastąpiła próba aktualizacji, jeśli jest to wymagane.  
  
 *phRow*  
 [out] Wskaźnik do lokalizacji, w którym `Update` zwraca uchwyt wiersza nastąpiła próba aktualizacji. Brak dojścia jest zwracany, jeśli *phRow* ma wartość null.  
  
 *pStatus*  
 [out] Wskaźnik do lokalizacji, w którym `Update` zwraca wartość stanu wiersza. Brak stanu jest zwracany, jeśli *pStatus* ma wartość null.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  
  
### <a name="remarks"></a>Uwagi  
 Przesyła wszystkie oczekujące zmiany do bieżącego wiersza od czasu ostatniego pobrania lub zaktualizować tego wiersza (przy użyciu `Update` lub [UpdateAll](../../data/oledb/crowset-updateall.md)). Zwykle wywołują [SetData](../../data/oledb/crowset-setdata.md) do ustawiania wartości danych w kolumnach w wierszu, a następnie wywołaj `Update` przesyłać tych zmian.  
  
 Ta metoda wymaga opcjonalny interfejs `IRowsetUpdate`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetUpdate` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  

## <a name="updateall"></a> CRowset::UpdateAll
Przesyła wszystkie oczekujące zmiany wprowadzone do wszystkich wierszy od czasu ostatniego pobrania lub `Update` wywołania.  
  
### <a name="syntax"></a>Składnia  
  
```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,   
   HROW** pphRow = NULL,   
   DBROWSTATUS** ppStatus = NULL) throw();  
```  
  
#### <a name="parameters"></a>Parametry  
 *pcRows*  
 [out] Wskaźnik do lokalizacji, w którym `UpdateAll` zwraca liczbę wierszy nastąpiła próba aktualizacji, jeśli jest to wymagane.  
  
 *pphRow*  
 [out] Wskaźnik do pamięci, w którym `UpdateAll` zwraca uchwyt wiersza nastąpiła próba aktualizacji. Brak dojścia jest zwracany, jeśli *pphRow* ma wartość null.  
  
 *ppStatus*  
 [out] Wskaźnik do lokalizacji, w którym `Update` zwraca wartość stanu wiersza. Brak stanu jest zwracany, jeśli *ppStatus* ma wartość null.  
  
### <a name="remarks"></a>Uwagi  
 Przesyła wszystkie oczekujące zmiany do wszystkich wierszy, ponieważ te wiersze zostały ostatniego pobrania lub aktualizowania przy użyciu [aktualizacji](../../data/oledb/crowset-update.md) lub `UpdateAll`. `UpdateAll` zaktualizuje każdego wiersza, który został zmodyfikowany, niezależnie od tego, czy nadal masz uchwytu dla nich (zobacz *pphRow*) czy nie.  
  
 Na przykład, jeśli użyto `Insert` Aby wstawić pięć wierszy w zestawie wierszy, można wywołać `Update` pięć razy lub wywołanie `UpdateAll` raz, aby zaktualizować je wszystkie.  
  
 Ta metoda wymaga opcjonalny interfejs `IRowsetUpdate`, które mogą nie być obsługiwane na wszystkich dostawców; Jeśli tak jest, metoda zwraca E_NOINTERFACE. Należy także ustawić `DBPROP_IRowsetUpdate` VARIANT_TRUE przed wywołaniem `Open` dotyczącej tabeli lub polecenia zawierające zestaw wierszy.  
  
### <a name="return-value"></a>Wartość zwracana  
 Standardowa HRESULT.  

## <a name="see-also"></a>Zobacz też  
 [Przykładowe DBViewer](../../visual-cpp-samples.md)   
 [Przykładowe multiRead](../../visual-cpp-samples.md)   
 [Przykładowe multiRead atrybutów](../../visual-cpp-samples.md)   
 [Szablony konsumentów OLE DB](../../data/oledb/ole-db-consumer-templates-cpp.md)   
 [Szablony konsumentów OLE DB — dokumentacja](../../data/oledb/ole-db-consumer-templates-reference.md)