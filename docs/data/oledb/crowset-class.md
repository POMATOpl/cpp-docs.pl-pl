---
title: Klasa CRowset
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: e67e385a8ce0eb9a6b041d4a4f0d43e2db551c79
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/24/2020
ms.locfileid: "80211292"
---
# <a name="crowset-class"></a>Klasa CRowset

Hermetyzuje obiekt OLE DB zestawu wierszy oraz kilka powiązanych interfejsów i udostępnia metody operowania dla danych zestawu wierszy.

## <a name="syntax"></a>Składnia

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parametry

*TAccessor*<br/>
Klasa akcesora. Wartość domyślna to `CAccessorBase`.

## <a name="requirements"></a>Wymagania

**Nagłówek:** atldbcli. h

## <a name="members"></a>Members

### <a name="methods"></a>Metody

|||
|-|-|
|[AddRefRows](#addrefrows)|Zwiększa liczbę odwołań skojarzoną z bieżącym wierszem.|
|[Ściśle](#close)|Zwalnia wiersze i bieżący interfejs `IRowset`.|
|[Compare](#compare)|Porównuje dwie zakładki przy użyciu [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Tworzy nowy obiekt `CRowset` i (opcjonalnie) kojarzy go z interfejsem `IRowset` dostarczonym jako parametr.|
|[Usuwanie](#delete)|Usuwa wiersze z zestawu wierszy przy użyciu [IRowsetChange: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Znajduje następny pasujący wiersz po określonej zakładce.|
|[GetApproximatePosition](#getapproximateposition)|Zwraca przybliżoną pozycję wiersza odpowiadającego zakładce.|
|[GetData](#getdata)|Pobiera dane z kopii wiersza zestawu wierszy.|
|[GetDataHere](#getdatahere)|Pobiera dane z określonego buforu.|
|[GetOriginalData](#getoriginaldata)|Pobiera dane, które zostały ostatnio pobrane z lub przesłane do źródła danych, ignorując oczekujące zmiany.|
|[GetRowStatus](#getrowstatus)|Zwraca stan wszystkich wierszy.|
|[Wstawienia](#insert)|Tworzy i wstawia nowy wiersz przy użyciu [IRowsetChange: InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Porównuje określony wiersz z bieżącym wierszem.|
|[MoveFirst](#movefirst)|Zmienia położenie lokalizacji następnego pobrania na pozycję początkową.|
|[MoveLast](#movelast)|Przenosi do ostatniego rekordu.|
|[Element](#movenext)|Pobiera dane z następnego sekwencyjnego wiersza lub określoną liczbę pozycji poza następnym wierszem.|
|[MovePrev](#moveprev)|Przenosi do poprzedniego rekordu.|
|[MoveToBookmark](#movetobookmark)|Pobiera wiersz oznaczony zakładką lub wiersz w określonym przesunięciu od tej zakładki.|
|[MoveToRatio](#movetoratio)|Pobiera wiersze zaczynające się od pozycji ułamkowej w zestawie wierszy.|
|[ReleaseRows](#releaserows)|Wywołuje [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) w celu zwolnienia bieżącego uchwytu wiersza.|
|[Operację](#setdata)|Ustawia wartości danych w co najmniej jednej kolumnie wiersza przy użyciu [IRowsetChange: SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Anulowanie](#undo)|Cofa wszelkie zmiany wprowadzone w wierszu od momentu ostatniego pobrania lub [aktualizacji](../../data/oledb/crowset-update.md).|
|[Aktualizowanie](#update)|Przesyła wszystkie oczekujące zmiany wprowadzone do bieżącego wiersza od momentu ostatniego pobrania lub aktualizacji.|
|[UpdateAll](#updateall)|Przesyła wszystkie oczekujące zmiany wprowadzone do wszystkich wierszy od momentu ostatniego pobrania lub aktualizacji.|

## <a name="remarks"></a>Uwagi

W OLE DB zestaw wierszy jest obiektem, za pomocą którego program ustawia i pobiera dane.

Ta klasa nie jest przeznaczona do tworzenia wystąpienia, ale nie została przeniesiona jako parametr szablonu do `CTable` lub `CCommand` (`CRowset` jest wartością domyślną).

## <a name="crowsetaddrefrows"></a><a name="addrefrows"></a>CRowset:: AddRefRows

Wywołuje [IRowset:: AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) , aby zwiększyć (przez jeden) liczbę odwołań skojarzoną z bieżącym dojściem wiersza.

### <a name="syntax"></a>Składnia

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda zwiększa liczbę odwołań dla uchwytu bieżącego wiersza. Wywołaj [ReleaseRows](../../data/oledb/crowset-releaserows.md) , aby zmniejszyć liczbę. Wiersze zwracane przez metody Move mają liczbę odwołań o jednej.

## <a name="crowsetclose"></a><a name="close"></a>CRowset:: Close

Zwalnia wiersze i bieżący interfejs [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) .

### <a name="syntax"></a>Składnia

```cpp
void Close() throw();
```

### <a name="remarks"></a>Uwagi

Ta metoda zwalnia wszystkie wiersze znajdujące się obecnie w zestawie wierszy.

## <a name="crowsetcompare"></a><a name="compare"></a>CRowset:: Compare

Porównuje dwie zakładki przy użyciu [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Składnia

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parametry

*Bookmark1*<br/>
podczas Pierwsza zakładka do porównania.

*Bookmark2*<br/>
podczas Druga zakładka do porównania.

*pComparison*<br/>
określoną Wskaźnik do wyniku porównania.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda wymaga opcjonalnego interfejsu `IRowsetLocate`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetLocate` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

Aby uzyskać informacje o korzystaniu z zakładek w konsumenci, zobacz [using zakładki](../../data/oledb/using-bookmarks.md).

## <a name="crowsetcrowset"></a><a name="crowset"></a>CRowset:: CRowset

Tworzy nowy obiekt `CRowset` i (opcjonalnie) kojarzy go z interfejsem [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) dostarczonym jako parametr.

### <a name="syntax"></a>Składnia

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parametry

*pRowset*<br/>
podczas Wskaźnik do interfejsu `IRowset`, który ma zostać skojarzony z tą klasą.

## <a name="crowsetdelete"></a><a name="delete"></a>CRowset::D Usuń

Wywołuje [IRowsetChange::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85)) , aby usunąć bieżący wiersz z zestawu wierszy.

### <a name="syntax"></a>Składnia

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

## <a name="crowsetfindnextrow"></a><a name="findnextrow"></a>CRowset:: FindNextRow

Znajduje następny pasujący wiersz po określonej zakładce.

### <a name="syntax"></a>Składnia

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*op*<br/>
podczas Operacja do użycia w porównaniu wartości wierszy. Aby uzyskać wartości, zobacz [IRowsetFind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
podczas Wskaźnik do wartości, która ma zostać dopasowana.

*wType*<br/>
podczas Wskazuje typ danych części wartości w buforze. Aby uzyskać informacje na temat wskaźników typu, zobacz [typy danych](/previous-versions/windows/desktop/ms723969(v=vs.85)) w *odniesieniu do OLE DB programisty* w Windows SDK.

*nLength*<br/>
podczas Długość (w bajtach) struktury danych odbiorcy przydzieloną dla wartości danych. Aby uzyskać szczegółowe informacje, zobacz Opis `cbMaxLen` w [strukturach DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) w *dokumentacji programisty OLE DB.*

*bPrecision*<br/>
podczas Maksymalna precyzja użyta podczas pobierania danych. Używane tylko wtedy, gdy *wType* jest DBTYPE_NUMERIC. Aby uzyskać więcej informacji, zobacz [konwersje dotyczące DBTYPE_NUMERIC lub DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) w *Kompendium OLE DB programisty*.

*bScale*<br/>
podczas Skala używana podczas pobierania danych. Używane tylko wtedy, gdy *wType* jest DBTYPE_NUMERIC lub DBTYPE_DECIMAL. Aby uzyskać więcej informacji, zobacz [konwersje dotyczące DBTYPE_NUMERIC lub DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) w *Kompendium OLE DB programisty*.

*bSkipCurrent*<br/>
podczas Liczba wierszy z zakładki, w której ma zostać rozpoczęte wyszukiwanie.

*pBookmark*<br/>
podczas Zakładka dla pozycji, w której ma zostać rozpoczęte wyszukiwanie.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda wymaga opcjonalnego interfejsu `IRowsetFind`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetFind` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

Aby uzyskać informacje o korzystaniu z zakładek w konsumenci, zobacz [using zakładki](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetapproximateposition"></a><a name="getapproximateposition"></a>CRowset:: GetApproximatePosition

Zwraca przybliżoną pozycję wiersza odpowiadającego zakładce.

### <a name="syntax"></a>Składnia

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parametry

*pBookmark*<br/>
podczas Wskaźnik do zakładki, która identyfikuje wiersz, którego pozycja ma zostać znaleziona. Wartość NULL, jeśli jest wymagana tylko liczba wierszy.

*pPosition*<br/>
określoną Wskaźnik do lokalizacji, w której `GetApproximatePosition` zwraca pozycję wiersza. Wartość NULL, jeśli pozycja nie jest wymagana.

*pcRows*<br/>
określoną Wskaźnik do lokalizacji, w której `GetApproximatePosition` zwraca łączną liczbę wierszy. Wartość NULL, jeśli liczba wierszy nie jest wymagana.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda wymaga opcjonalnego interfejsu `IRowsetScroll`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetScroll` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

Aby uzyskać informacje o korzystaniu z zakładek w konsumenci, zobacz [using zakładki](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetdata"></a><a name="getdata"></a>CRowset:: GetData

Pobiera dane z kopii wiersza zestawu wierszy.

### <a name="syntax"></a>Składnia

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
podczas Numer indeksu (zero-offset) metody dostępu, która ma być używana do uzyskiwania dostępu do danych.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

W przypadku określenia akcesora, który nie jest autodostępnym w [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), Użyj tej metody, aby jawnie pobrać dane przez przekazanie numeru dostępu.

## <a name="crowsetgetdatahere"></a><a name="getdatahere"></a>CRowset:: GetDataHere

Pobiera dane z bieżącego wiersza i umieszcza je w określonym buforze.

### <a name="syntax"></a>Składnia

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
podczas Numer indeksu akcesora, który ma być używany do uzyskiwania dostępu do danych.

*pBuffer*<br/>
określoną Bufor, w którym mają zostać umieszczone dane dla bieżącego rekordu.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Przykład korzystania z tej funkcji można znaleźć w przykładowym [trybie odczytu](../../overview/visual-cpp-samples.md).

## <a name="crowsetgetoriginaldata"></a><a name="getoriginaldata"></a>CRowset:: GetOriginalData

Wywołuje `IRowsetUpdate::GetOriginalData` w celu pobrania danych ostatnio pobranych z lub przesłanych do źródła danych.

### <a name="syntax"></a>Składnia

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda pobiera dane ostatnio pobrane z lub przesłane do źródła danych. nie pobiera wartości w oparciu o oczekujące zmiany.

Ta metoda wymaga opcjonalnego interfejsu `IRowsetUpdate`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetUpdate` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

## <a name="crowsetgetrowstatus"></a><a name="getrowstatus"></a>CRowset:: GetRowStatus

Zwraca stan wszystkich wierszy.

### <a name="syntax"></a>Składnia

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parametry

*pStatus*<br/>
określoną Wskaźnik do lokalizacji, w której `GetRowStatus` zwraca wartość stanu. Zobacz DBPENDINGSTATUS w dokumentacji programisty OLE DB.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda wymaga opcjonalnego interfejsu `IRowsetUpdate`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetUpdate` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

## <a name="crowsetinsert"></a><a name="insert"></a>CRowset:: INSERT

Tworzy i inicjuje nowy wiersz przy użyciu danych z metody dostępu.

### <a name="syntax"></a>Składnia

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
podczas Numer metody dostępu do użycia podczas wstawiania danych.

*bGetHRow*<br/>
podczas Wskazuje, czy dojście dla wstawionego wiersza jest pobierane.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda wymaga opcjonalnego interfejsu `IRowsetChange`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetChange` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

Wstawianie może zakończyć się niepowodzeniem, jeśli co najmniej jedna kolumna nie jest zapisywalna. Zmodyfikuj mapę kursorów, aby usunąć ją.

### <a name="example"></a>Przykład

Poniższy przykład pokazuje, jak uzyskać dostęp do źródła danych za pośrednictwem zestawu wierszy, a następnie wstawić ciąg za pomocą tabeli w zestawie wierszy.

Najpierw Utwórz klasę tabeli, wstawiając nowy obiekt ATL do projektu. Na przykład kliknij prawym przyciskiem myszy projekt w okienku obszaru roboczego i wybierz polecenie **nowy obiekt ATL**. W kategorii **dostęp do danych** wybierz pozycję **Klient**. Utwórz obiekt odbiorcy typu **Table**. (Wybranie opcji **tabela** powoduje utworzenie zestawu wierszy bezpośrednio z tabeli; wybranie **polecenia** powoduje utworzenie zestawu wierszy za pośrednictwem polecenia SQL). Wybierz źródło danych, określając tabelę, za pomocą której chcesz uzyskać dostęp do tego źródła danych. Jeśli wywołasz **CCustomerTable**obiektu konsumenta, zaimplementuj kod wstawiania w następujący sposób:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="crowsetissamerow"></a><a name="issamerow"></a>CRowset:: IsSameRow

Porównuje określony wiersz z bieżącym wierszem.

### <a name="syntax"></a>Składnia

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parametry

*hRow*<br/>
podczas Uchwyt do wiersza, który ma zostać porównany z bieżącym wierszem.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT. S_OK wskazuje, że wiersze są takie same. W przypadku innych wartości, zobacz [IRowsetIndentity:: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) w *dokumentacji programisty OLE DB* w Windows SDK.

## <a name="crowsetmovefirst"></a><a name="movefirst"></a>CRowset:: MoveFirst

Przenosi kursor do pozycji początkowej i pobiera początkowy wiersz.

### <a name="syntax"></a>Składnia

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Wywołuje [IRowset:: operacja RestartPosition wykonywana](/previous-versions/windows/desktop/ms712877(v=vs.85)) w celu zmiany położenia lokalizacji następnego pobrania do początkowej pozycji (pozycja, która była lokalizacją następnego pobrania podczas tworzenia zestawu wierszy) i pobiera początkowy wiersz.

## <a name="crowsetmovelast"></a><a name="movelast"></a>CRowset:: MoveLast

Przenosi kursor do ostatniego wiersza.

### <a name="syntax"></a>Składnia

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Wywołuje [IRowset:: operacja RestartPosition wykonywana](/previous-versions/windows/desktop/ms712877(v=vs.85)) w celu zmiany położenia lokalizacji następnego pobrania do ostatniej pozycji i pobrania ostatniego wiersza.

Ta metoda wymaga ustawienia `DBPROP_CANSCROLLBACKWARDS` do VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy. (W celu uzyskania lepszej wydajności można również ustawić `DBPROP_QUICKRESTART` na VARIANT_TRUE).

## <a name="crowsetmovenext"></a><a name="movenext"></a>CRowset:: MoveNext

Przenosi kursor do następnego rekordu.

### <a name="syntax"></a>Składnia

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parametry

*lSkip*<br/>
podczas Liczba wierszy do pominięcia przed pobraniem.

*bForward*<br/>
podczas Przekaż **wartość true** , aby przejść do następnego rekordu, **Fałsz** , aby przejść do tyłu.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT. Po osiągnięciu końca zestawu wierszy zwraca DB_S_ENDOFROWSET.

### <a name="remarks"></a>Uwagi

Pobiera następny sekwencyjny wiersz z obiektu `CRowset`, zapamiętając poprzednią pozycję. Opcjonalnie możesz zrezygnować z *lSkip* wierszy lub przejść do tyłu.

Ta metoda wymaga ustawienia następujących właściwości przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy:

- `DBPROP_CANSCROLLBACKWARDS` musi być VARIANT_TRUE, jeśli *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` musi być VARIANT_TRUE, jeśli *bForward* = false

W przeciwnym razie (Jeśli *lSkip* > = 0 i *bForward* = true) nie trzeba ustawiać żadnych dodatkowych właściwości.

## <a name="crowsetmoveprev"></a><a name="moveprev"></a>CRowset:: MovePrev

Przenosi kursor do poprzedniego rekordu.

### <a name="syntax"></a>Składnia

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda wymaga ustawienia `DBPROP_CANFETCHBACKWARDS` lub `DBPROP_CANSCROLLBACKWARDS` do VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

## <a name="crowsetmovetobookmark"></a><a name="movetobookmark"></a>CRowset:: MoveToBookmark

Pobiera wiersz oznaczony zakładką lub wiersz w określonym przesunięciu (*lSkip*) z tej zakładki.

### <a name="syntax"></a>Składnia

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parametry

*Zakładka*<br/>
podczas Zakładka oznaczająca lokalizację, z której mają zostać pobrane dane.

*lSkip*<br/>
podczas Liczba wierszy z zakładki do wiersza docelowego. Jeśli *lSkip* ma wartość zero, pierwszy wiersz jest pobierany z zakładką. Jeśli *lSkip* ma wartość 1, pierwszy wiersz jest pobierany wiersz po wierszu oznaczonym zakładką. Jeśli *lSkip* ma wartość-1, pierwszy wiersz pobierany jest wiersz przed wierszem oznaczonym zakładką.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda wymaga opcjonalnego interfejsu `IRowsetLocate`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetLocate` na VARIANT_TRUE i ustawić `DBPROP_CANFETCHBACKWARDS` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

Aby uzyskać informacje o korzystaniu z zakładek w konsumenci, zobacz [using zakładki](../../data/oledb/using-bookmarks.md).

## <a name="crowsetmovetoratio"></a><a name="movetoratio"></a>CRowset:: MoveToRatio

Pobiera wiersze zaczynające się od pozycji ułamkowej w zestawie wierszy.

### <a name="syntax"></a>Składnia

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parametry

*nNumerator*<br/>
podczas Licznik używany do określenia ułamka, z którego mają zostać pobrane dane.

*nDenominator*<br/>
podczas Mianownik używany do określenia ułamka, z którego mają zostać pobrane dane.

*bForward*<br/>
podczas Wskazuje, czy przenieść do przodu czy do tyłu. Wartość domyślna to Prześlij dalej.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

`MoveToRatio` pobiera wiersze zgodnie z przybliżeniem do następującej formuły:

`(nNumerator *  RowsetSize ) / nDenominator`

Gdzie `RowsetSize` jest rozmiar zestawu wierszy, mierzony w wierszach. Dokładność tej formuły zależy od konkretnego dostawcy. Aby uzyskać szczegółowe informacje, zobacz [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Ta metoda wymaga opcjonalnego interfejsu `IRowsetScroll`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetScroll` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

## <a name="crowsetreleaserows"></a><a name="releaserows"></a>CRowset:: ReleaseRows

Wywołuje [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) w celu zwolnienia bieżącego uchwytu wiersza.

### <a name="syntax"></a>Składnia

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

## <a name="crowsetsetdata"></a><a name="setdata"></a>CRowset:: SetData

Ustawia wartości danych w co najmniej jednej kolumnie wiersza.

### <a name="syntax"></a>Składnia

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parametry

*nAccessor*<br/>
podczas Numer metody dostępu służącej do uzyskiwania dostępu do danych.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Dla formularza `SetData`, który nie akceptuje żadnych argumentów, do aktualizacji są używane wszystkie metody dostępu. Zazwyczaj Wywołaj `SetData`, aby ustawić wartości danych w kolumnach w wierszu, a następnie Wywołaj polecenie [Update](../../data/oledb/crowset-update.md) , aby przesłać te zmiany.

Ta metoda wymaga opcjonalnego interfejsu `IRowsetChange`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetChange` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

Operacja ustawienia może zakończyć się niepowodzeniem, jeśli co najmniej jedna kolumna nie jest zapisywalna. Zmodyfikuj mapę kursorów, aby usunąć ją.

## <a name="crowsetundo"></a><a name="undo"></a>CRowset:: Undo

Cofa wszelkie zmiany wprowadzone w wierszu od momentu ostatniego pobrania lub [aktualizacji](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Składnia

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*pcRows*<br/>
określoną Wskaźnik do lokalizacji, w której `Undo` zwraca liczbę wierszy, które próbowano cofnąć, jeśli jest to wymagane.

*phRow*<br/>
określoną Wskaźnik do lokalizacji, w której `Undo` zwraca tablicę dojść do wszystkich wierszy, które próbowano cofnąć, jeśli jest to wymagane.

*pStatus*<br/>
określoną Wskaźnik do lokalizacji, w której `Undo` zwraca wartość stanu wiersza. Jeśli *pStatus* ma wartość null, żaden stan nie jest zwracany.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Ta metoda wymaga opcjonalnego interfejsu `IRowsetUpdate`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetUpdate` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

## <a name="crowsetupdate"></a><a name="update"></a>CRowset:: Update

Przesyła wszystkie oczekujące zmiany wprowadzone do bieżącego wiersza od momentu ostatniego pobrania lub `Update` na nim.

### <a name="syntax"></a>Składnia

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*pcRows*<br/>
określoną Wskaźnik do lokalizacji, w której `Update` zwraca liczbę wierszy, które próbowano zaktualizować, jeśli jest to wymagane.

*phRow*<br/>
określoną Wskaźnik do lokalizacji, w której `Update` zwraca dojście wiersza, który próbował zaktualizować. Jeśli *phRow* ma wartość null, nie jest zwracana żadna dojście.

*pStatus*<br/>
określoną Wskaźnik do lokalizacji, w której `Update` zwraca wartość stanu wiersza. Jeśli *pStatus* ma wartość null, żaden stan nie jest zwracany.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

### <a name="remarks"></a>Uwagi

Przesyła wszystkie oczekujące zmiany dokonane w bieżącym wierszu od momentu ostatniego pobrania lub zaktualizowania tego wiersza (przy użyciu `Update` lub [UPDATEALL](../../data/oledb/crowset-updateall.md)). Zazwyczaj wywoływanie metody [SetData](../../data/oledb/crowset-setdata.md) w celu ustawienia wartości danych w kolumnach w wierszu, a następnie wywołaj `Update`, aby przesłać te zmiany.

Ta metoda wymaga opcjonalnego interfejsu `IRowsetUpdate`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetUpdate` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

## <a name="crowsetupdateall"></a><a name="updateall"></a>CRowset:: UpdateAll

Przesyła wszystkie oczekujące zmiany wprowadzone do wszystkich wierszy od momentu ostatniego pobrania lub `Update` na nim.

### <a name="syntax"></a>Składnia

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametry

*pcRows*<br/>
określoną Wskaźnik do lokalizacji, w której `UpdateAll` zwraca liczbę wierszy, które próbowano zaktualizować, jeśli jest to wymagane.

*pphRow*<br/>
określoną Wskaźnik do pamięci, w której `UpdateAll` zwraca dojście wiersza, który próbował zaktualizować. Jeśli *pphRow* ma wartość null, nie jest zwracana żadna dojście.

*ppStatus*<br/>
określoną Wskaźnik do lokalizacji, w której `Update` zwraca wartość stanu wiersza. Jeśli *ppStatus* ma wartość null, żaden stan nie jest zwracany.

### <a name="remarks"></a>Uwagi

Przesyła wszystkie oczekujące zmiany wprowadzone do wszystkich wierszy od momentu ostatniego pobrania lub zaktualizowania tych wierszy przy użyciu [aktualizacji](../../data/oledb/crowset-update.md) lub `UpdateAll`. `UpdateAll` zaktualizuje każdy wiersz, który został zmodyfikowany, bez względu na to, czy nadal masz dla nich uchwyt (zobacz *pphRow*).

Na przykład jeśli użyto `Insert` do wstawienia pięciu wierszy w zestawie wierszy, można wywołać `Update` pięć razy lub wywołać `UpdateAll` raz, aby zaktualizować je wszystkie.

Ta metoda wymaga opcjonalnego interfejsu `IRowsetUpdate`, co może nie być obsługiwane we wszystkich dostawcach. w takim przypadku metoda zwraca E_NOINTERFACE. Należy również ustawić `DBPROP_IRowsetUpdate` na VARIANT_TRUE przed wywołaniem `Open` w tabeli lub poleceniem zawierającym zestaw wierszy.

### <a name="return-value"></a>Wartość zwracana

Standardowa wartość HRESULT.

## <a name="see-also"></a>Zobacz też

[Przykład DBVIEWER](../../overview/visual-cpp-samples.md)<br/>
[Przykład dla odczytu](../../overview/visual-cpp-samples.md)<br/>
[Przykład atrybutów do odczytu](../../overview/visual-cpp-samples.md)<br/>
[OLE DB Szablony konsumentów](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Szablony konsumentów OLE DB — dokumentacja](../../data/oledb/ole-db-consumer-templates-reference.md)
